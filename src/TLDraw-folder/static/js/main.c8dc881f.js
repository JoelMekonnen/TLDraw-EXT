/*! For license information please see main.c8dc881f.js.LICENSE.txt */
!function(){var e={6123:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var a=i.apply(null,n);a&&e.push(a)}}else if("object"===o){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},8973:function(e,t,n){var r=n(171),i=n(5065),o=TypeError;e.exports=function(e){if(r(e))return e;throw o(i(e)+" is not a function")}},9363:function(e,t,n){var r=n(5508),i=n(3302),o=n(1684).f,a=r("unscopables"),s=Array.prototype;void 0==s[a]&&o(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},6183:function(e,t,n){"use strict";var r=n(9838).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},9799:function(e,t,n){var r=n(4965),i=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw o(i(e)+" is not an object")}},9821:function(e,t,n){var r=n(6494),i=n(3864),o=n(6425),a=function(e){return function(t,n,a){var s,u=r(t),l=o(u),c=i(a,l);if(e&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},1520:function(e,t,n){var r=n(8162),i=n(3011),o=n(4965),a=n(5508)("species"),s=Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,(i(t)&&(t===s||r(t.prototype))||o(t)&&null===(t=t[a]))&&(t=void 0)),void 0===t?s:t}},1180:function(e,t,n){var r=n(1520);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},3135:function(e,t,n){var r=n(4534),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},5249:function(e,t,n){var r=n(2105),i=n(171),o=n(3135),a=n(5508)("toStringTag"),s=Object,u="Arguments"==o(function(){return arguments}());e.exports=r?o:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=s(e),a))?n:u?o(t):"Object"==(r=o(t))&&i(t.callee)?"Arguments":r}},1147:function(e,t,n){var r=n(8320),i=n(412),o=n(2530),a=n(1684);e.exports=function(e,t,n){for(var s=i(t),u=a.f,l=o.f,c=0;c<s.length;c++){var d=s[c];r(e,d)||n&&r(n,d)||u(e,d,l(t,d))}}},7454:function(e,t,n){var r=n(7420),i=n(1684),o=n(431);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},431:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},3609:function(e,t,n){var r=n(171),i=n(1684),o=n(8138),a=n(2164);e.exports=function(e,t,n,s){s||(s={});var u=s.enumerable,l=void 0!==s.name?s.name:t;if(r(n)&&o(n,l,s),s.global)u?e[t]=n:a(t,n);else{try{s.unsafe?e[t]&&(u=!0):delete e[t]}catch(c){}u?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},2164:function(e,t,n){var r=n(9782),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},7420:function(e,t,n){var r=n(6111);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4620:function(e){var t="object"==typeof document&&document.all,n="undefined"==typeof t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:n}},916:function(e,t,n){var r=n(9782),i=n(4965),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},895:function(e){var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},4771:function(e){e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},2504:function(e,t,n){var r,i,o=n(9782),a=n(4771),s=o.process,u=o.Deno,l=s&&s.versions||u&&u.version,c=l&&l.v8;c&&(i=(r=c.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},8605:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3587:function(e,t,n){var r=n(9782),i=n(2530).f,o=n(7454),a=n(3609),s=n(2164),u=n(1147),l=n(9492);e.exports=function(e,t){var n,c,d,f,p,h=e.target,v=e.global,g=e.stat;if(n=v?r:g?r[h]||s(h,{}):(r[h]||{}).prototype)for(c in t){if(f=t[c],d=e.dontCallGetSet?(p=i(n,c))&&p.value:n[c],!l(v?c:h+(g?".":"#")+c,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;u(f,d)}(e.sham||d&&d.sham)&&o(f,"sham",!0),a(n,c,f,e)}}},6111:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},8635:function(e,t,n){"use strict";n(4541);var r=n(9050),i=n(3609),o=n(5493),a=n(6111),s=n(5508),u=n(7454),l=s("species"),c=RegExp.prototype;e.exports=function(e,t,n,d){var f=s(e),p=!a((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),h=p&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[f]=/./[f]),n.exec=function(){return t=!0,null},n[f](""),!t}));if(!p||!h||n){var v=r(/./[f]),g=t(f,""[e],(function(e,t,n,i,a){var s=r(e),u=t.exec;return u===o||u===c.exec?p&&!a?{done:!0,value:v(t,n,i)}:{done:!0,value:s(n,t,i)}:{done:!1}}));i(String.prototype,e,g[0]),i(c,f,g[1])}d&&u(c[f],"sham",!0)}},8504:function(e,t,n){"use strict";var r=n(8162),i=n(6425),o=n(895),a=n(5852);e.exports=function e(t,n,s,u,l,c,d,f){for(var p,h=l,v=0,g=!!d&&a(d,f);v<u;)v in s&&(p=g?g(s[v],v,n):s[v],c>0&&r(p)?h=e(t,n,p,i(p),h,c-1)-1:(o(h+1),t[h]=p),h++),v++;return h}},2256:function(e,t,n){var r=n(5830),i=Function.prototype,o=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})},5852:function(e,t,n){var r=n(9050),i=n(8973),o=n(5830),a=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},5830:function(e,t,n){var r=n(6111);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},7892:function(e,t,n){var r=n(5830),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},1774:function(e,t,n){var r=n(7420),i=n(8320),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),u=s&&"something"===function(){}.name,l=s&&(!r||r&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:u,CONFIGURABLE:l}},9050:function(e,t,n){var r=n(3135),i=n(4534);e.exports=function(e){if("Function"===r(e))return i(e)}},4534:function(e,t,n){var r=n(5830),i=Function.prototype,o=i.call,a=r&&i.bind.bind(o,o);e.exports=r?a:function(e){return function(){return o.apply(e,arguments)}}},6780:function(e,t,n){var r=n(9782),i=n(171);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},2135:function(e,t,n){var r=n(8973),i=n(486);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},4527:function(e,t,n){var r=n(4534),i=n(1446),o=Math.floor,a=r("".charAt),s=r("".replace),u=r("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,d,f){var p=n+e.length,h=r.length,v=c;return void 0!==d&&(d=i(d),v=l),s(f,v,(function(i,s){var l;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,p);case"<":l=d[u(s,1,-1)];break;default:var c=+s;if(0===c)return i;if(c>h){var f=o(c/10);return 0===f?i:f<=h?void 0===r[f-1]?a(s,1):r[f-1]+a(s,1):i}l=r[c-1]}return void 0===l?"":l}))}},9782:function(e,t,n){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||this||Function("return this")()},8320:function(e,t,n){var r=n(4534),i=n(1446),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},2819:function(e){e.exports={}},4836:function(e,t,n){var r=n(6780);e.exports=r("document","documentElement")},3373:function(e,t,n){var r=n(7420),i=n(6111),o=n(916);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},769:function(e,t,n){var r=n(4534),i=n(6111),o=n(3135),a=Object,s=r("".split);e.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?s(e,""):a(e)}:a},112:function(e,t,n){var r=n(4534),i=n(171),o=n(8749),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},5313:function(e,t,n){var r,i,o,a=n(6626),s=n(9782),u=n(4965),l=n(7454),c=n(8320),d=n(8749),f=n(9325),p=n(2819),h="Object already initialized",v=s.TypeError,g=s.WeakMap;if(a||d.state){var m=d.state||(d.state=new g);m.get=m.get,m.has=m.has,m.set=m.set,r=function(e,t){if(m.has(e))throw v(h);return t.facade=e,m.set(e,t),t},i=function(e){return m.get(e)||{}},o=function(e){return m.has(e)}}else{var y=f("state");p[y]=!0,r=function(e,t){if(c(e,y))throw v(h);return t.facade=e,l(e,y,t),t},i=function(e){return c(e,y)?e[y]:{}},o=function(e){return c(e,y)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return n}}}},8162:function(e,t,n){var r=n(3135);e.exports=Array.isArray||function(e){return"Array"==r(e)}},171:function(e,t,n){var r=n(4620),i=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},3011:function(e,t,n){var r=n(4534),i=n(6111),o=n(171),a=n(5249),s=n(6780),u=n(112),l=function(){},c=[],d=s("Reflect","construct"),f=/^\s*(?:class|function)\b/,p=r(f.exec),h=!f.exec(l),v=function(e){if(!o(e))return!1;try{return d(l,c,e),!0}catch(t){return!1}},g=function(e){if(!o(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!p(f,u(e))}catch(t){return!0}};g.sham=!0,e.exports=!d||i((function(){var e;return v(v.call)||!v(Object)||!v((function(){e=!0}))||e}))?g:v},9492:function(e,t,n){var r=n(6111),i=n(171),o=/#|\.prototype\./,a=function(e,t){var n=u[s(e)];return n==c||n!=l&&(i(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},u=a.data={},l=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},486:function(e){e.exports=function(e){return null===e||void 0===e}},4965:function(e,t,n){var r=n(171),i=n(4620),o=i.all;e.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===o}:function(e){return"object"==typeof e?null!==e:r(e)}},2192:function(e){e.exports=!1},4196:function(e,t,n){var r=n(6780),i=n(171),o=n(1778),a=n(5398),s=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&o(t.prototype,s(e))}},6425:function(e,t,n){var r=n(1234);e.exports=function(e){return r(e.length)}},8138:function(e,t,n){var r=n(4534),i=n(6111),o=n(171),a=n(8320),s=n(7420),u=n(1774).CONFIGURABLE,l=n(112),c=n(5313),d=c.enforce,f=c.get,p=String,h=Object.defineProperty,v=r("".slice),g=r("".replace),m=r([].join),y=s&&!i((function(){return 8!==h((function(){}),"length",{value:8}).length})),b=String(String).split("String"),w=e.exports=function(e,t,n){"Symbol("===v(p(t),0,7)&&(t="["+g(p(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||u&&e.name!==t)&&(s?h(e,"name",{value:t,configurable:!0}):e.name=t),y&&n&&a(n,"arity")&&e.length!==n.arity&&h(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?s&&h(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var r=d(e);return a(r,"source")||(r.source=m(b,"string"==typeof t?t:"")),e};Function.prototype.toString=w((function(){return o(this)&&f(this).source||l(this)}),"toString")},596:function(e){var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},3302:function(e,t,n){var r,i=n(9799),o=n(3415),a=n(8605),s=n(2819),u=n(4836),l=n(916),c=n(9325),d="prototype",f="script",p=c("IE_PROTO"),h=function(){},v=function(e){return"<"+f+">"+e+"</"+f+">"},g=function(e){e.write(v("")),e.close();var t=e.parentWindow.Object;return e=null,t},m=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}m="undefined"!=typeof document?document.domain&&r?g(r):function(){var e,t=l("iframe"),n="java"+f+":";return t.style.display="none",u.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(v("document.F=Object")),e.close(),e.F}():g(r);for(var e=a.length;e--;)delete m[d][a[e]];return m()};s[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(h[d]=i(e),n=new h,h[d]=null,n[p]=e):n=m(),void 0===t?n:o.f(n,t)}},3415:function(e,t,n){var r=n(7420),i=n(3526),o=n(1684),a=n(9799),s=n(6494),u=n(1467);t.f=r&&!i?Object.defineProperties:function(e,t){a(e);for(var n,r=s(t),i=u(t),l=i.length,c=0;l>c;)o.f(e,n=i[c++],r[n]);return e}},1684:function(e,t,n){var r=n(7420),i=n(3373),o=n(3526),a=n(9799),s=n(4560),u=TypeError,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d="enumerable",f="configurable",p="writable";t.f=r?o?function(e,t,n){if(a(e),t=s(t),a(n),"function"===typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=c(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:f in n?n[f]:r[f],enumerable:d in n?n[d]:r[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=s(t),a(n),i)try{return l(e,t,n)}catch(r){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},2530:function(e,t,n){var r=n(7420),i=n(7892),o=n(3509),a=n(431),s=n(6494),u=n(4560),l=n(8320),c=n(3373),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=s(e),t=u(t),c)try{return d(e,t)}catch(n){}if(l(e,t))return a(!i(o.f,e,t),e[t])}},9814:function(e,t,n){var r=n(6945),i=n(8605).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},1186:function(e,t){t.f=Object.getOwnPropertySymbols},1778:function(e,t,n){var r=n(4534);e.exports=r({}.isPrototypeOf)},6945:function(e,t,n){var r=n(4534),i=n(8320),o=n(6494),a=n(9821).indexOf,s=n(2819),u=r([].push);e.exports=function(e,t){var n,r=o(e),l=0,c=[];for(n in r)!i(s,n)&&i(r,n)&&u(c,n);for(;t.length>l;)i(r,n=t[l++])&&(~a(c,n)||u(c,n));return c}},1467:function(e,t,n){var r=n(6945),i=n(8605);e.exports=Object.keys||function(e){return r(e,i)}},3509:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},3131:function(e,t,n){var r=n(7892),i=n(171),o=n(4965),a=TypeError;e.exports=function(e,t){var n,s;if("string"===t&&i(n=e.toString)&&!o(s=r(n,e)))return s;if(i(n=e.valueOf)&&!o(s=r(n,e)))return s;if("string"!==t&&i(n=e.toString)&&!o(s=r(n,e)))return s;throw a("Can't convert object to primitive value")}},412:function(e,t,n){var r=n(6780),i=n(4534),o=n(9814),a=n(1186),s=n(9799),u=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=a.f;return n?u(t,n(e)):t}},2279:function(e,t,n){var r=n(7892),i=n(9799),o=n(171),a=n(3135),s=n(5493),u=TypeError;e.exports=function(e,t){var n=e.exec;if(o(n)){var l=r(n,e,t);return null!==l&&i(l),l}if("RegExp"===a(e))return r(s,e,t);throw u("RegExp#exec called on incompatible receiver")}},5493:function(e,t,n){"use strict";var r=n(7892),i=n(4534),o=n(5217),a=n(1537),s=n(4274),u=n(7193),l=n(3302),c=n(5313).get,d=n(8988),f=n(1748),p=u("native-string-replace",String.prototype.replace),h=RegExp.prototype.exec,v=h,g=i("".charAt),m=i("".indexOf),y=i("".replace),b=i("".slice),w=function(){var e=/a/,t=/b*/g;return r(h,e,"a"),r(h,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),x=s.BROKEN_CARET,k=void 0!==/()??/.exec("")[1];(w||k||x||d||f)&&(v=function(e){var t,n,i,s,u,d,f,S=this,_=c(S),P=o(e),E=_.raw;if(E)return E.lastIndex=S.lastIndex,t=r(v,E,P),S.lastIndex=E.lastIndex,t;var C=_.groups,I=x&&S.sticky,T=r(a,S),M=S.source,j=0,A=P;if(I&&(T=y(T,"y",""),-1===m(T,"g")&&(T+="g"),A=b(P,S.lastIndex),S.lastIndex>0&&(!S.multiline||S.multiline&&"\n"!==g(P,S.lastIndex-1))&&(M="(?: "+M+")",A=" "+A,j++),n=new RegExp("^(?:"+M+")",T)),k&&(n=new RegExp("^"+M+"$(?!\\s)",T)),w&&(i=S.lastIndex),s=r(h,I?n:S,A),I?s?(s.input=b(s.input,j),s[0]=b(s[0],j),s.index=S.lastIndex,S.lastIndex+=s[0].length):S.lastIndex=0:w&&s&&(S.lastIndex=S.global?s.index+s[0].length:i),k&&s&&s.length>1&&r(p,s[0],n,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(s[u]=void 0)})),s&&C)for(s.groups=d=l(null),u=0;u<C.length;u++)d[(f=C[u])[0]]=s[f[1]];return s}),e.exports=v},1537:function(e,t,n){"use strict";var r=n(9799);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},4274:function(e,t,n){var r=n(6111),i=n(9782).RegExp,o=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=o||r((function(){return!i("a","y").sticky})),s=o||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:o}},8988:function(e,t,n){var r=n(6111),i=n(9782).RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},1748:function(e,t,n){var r=n(6111),i=n(9782).RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},9629:function(e,t,n){var r=n(486),i=TypeError;e.exports=function(e){if(r(e))throw i("Can't call method on "+e);return e}},9325:function(e,t,n){var r=n(7193),i=n(9020),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},8749:function(e,t,n){var r=n(9782),i=n(2164),o="__core-js_shared__",a=r[o]||i(o,{});e.exports=a},7193:function(e,t,n){var r=n(2192),i=n(8749);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.31.0",mode:r?"pure":"global",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"})},9838:function(e,t,n){var r=n(4534),i=n(6501),o=n(5217),a=n(9629),s=r("".charAt),u=r("".charCodeAt),l=r("".slice),c=function(e){return function(t,n){var r,c,d=o(a(t)),f=i(n),p=d.length;return f<0||f>=p?e?"":void 0:(r=u(d,f))<55296||r>56319||f+1===p||(c=u(d,f+1))<56320||c>57343?e?s(d,f):r:e?l(d,f,f+2):c-56320+(r-55296<<10)+65536}};e.exports={codeAt:c(!1),charAt:c(!0)}},3969:function(e,t,n){var r=n(2504),i=n(6111),o=n(9782).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},3864:function(e,t,n){var r=n(6501),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},6494:function(e,t,n){var r=n(769),i=n(9629);e.exports=function(e){return r(i(e))}},6501:function(e,t,n){var r=n(596);e.exports=function(e){var t=+e;return t!==t||0===t?0:r(t)}},1234:function(e,t,n){var r=n(6501),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},1446:function(e,t,n){var r=n(9629),i=Object;e.exports=function(e){return i(r(e))}},3086:function(e,t,n){var r=n(7892),i=n(4965),o=n(4196),a=n(2135),s=n(3131),u=n(5508),l=TypeError,c=u("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var n,u=a(e,c);if(u){if(void 0===t&&(t="default"),n=r(u,e,t),!i(n)||o(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},4560:function(e,t,n){var r=n(3086),i=n(4196);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},2105:function(e,t,n){var r={};r[n(5508)("toStringTag")]="z",e.exports="[object z]"===String(r)},5217:function(e,t,n){var r=n(5249),i=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},5065:function(e){var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},9020:function(e,t,n){var r=n(4534),i=0,o=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},5398:function(e,t,n){var r=n(3969);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3526:function(e,t,n){var r=n(7420),i=n(6111);e.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},6626:function(e,t,n){var r=n(9782),i=n(171),o=r.WeakMap;e.exports=i(o)&&/native code/.test(String(o))},5508:function(e,t,n){var r=n(9782),i=n(7193),o=n(8320),a=n(9020),s=n(3969),u=n(5398),l=r.Symbol,c=i("wks"),d=u?l.for||l:l&&l.withoutSetter||a;e.exports=function(e){return o(c,e)||(c[e]=s&&o(l,e)?l[e]:d("Symbol."+e)),c[e]}},9149:function(e,t,n){"use strict";var r=n(3587),i=n(8504),o=n(8973),a=n(1446),s=n(6425),u=n(1180);r({target:"Array",proto:!0},{flatMap:function(e){var t,n=a(this),r=s(n);return o(e),(t=u(n,0)).length=i(t,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},8442:function(e,t,n){"use strict";var r=n(3587),i=n(8504),o=n(1446),a=n(6425),s=n(6501),u=n(1180);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=o(this),n=a(t),r=u(t,0);return r.length=i(r,t,t,n,0,void 0===e?1:s(e)),r}})},5671:function(e,t,n){n(9363)("flatMap")},9575:function(e,t,n){n(9363)("flat")},4541:function(e,t,n){"use strict";var r=n(3587),i=n(5493);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},4113:function(e,t,n){"use strict";var r=n(2256),i=n(7892),o=n(4534),a=n(8635),s=n(6111),u=n(9799),l=n(171),c=n(486),d=n(6501),f=n(1234),p=n(5217),h=n(9629),v=n(6183),g=n(2135),m=n(4527),y=n(2279),b=n(5508)("replace"),w=Math.max,x=Math.min,k=o([].concat),S=o([].push),_=o("".indexOf),P=o("".slice),E="$0"==="a".replace(/./,"$0"),C=!!/./[b]&&""===/./[b]("a","$0");a("replace",(function(e,t,n){var o=C?"$":"$0";return[function(e,n){var r=h(this),o=c(e)?void 0:g(e,b);return o?i(o,e,r,n):i(t,p(r),e,n)},function(e,i){var a=u(this),s=p(e);if("string"==typeof i&&-1===_(i,o)&&-1===_(i,"$<")){var c=n(t,a,s,i);if(c.done)return c.value}var h=l(i);h||(i=p(i));var g=a.global;if(g){var b=a.unicode;a.lastIndex=0}for(var E=[];;){var C=y(a,s);if(null===C)break;if(S(E,C),!g)break;""===p(C[0])&&(a.lastIndex=v(s,f(a.lastIndex),b))}for(var I,T="",M=0,j=0;j<E.length;j++){for(var A=p((C=E[j])[0]),O=w(x(d(C.index),s.length),0),L=[],z=1;z<C.length;z++)S(L,void 0===(I=C[z])?I:String(I));var D=C.groups;if(h){var N=k([A],L,O,s);void 0!==D&&S(N,D);var R=p(r(i,void 0,N))}else R=m(A,s,O,L,D,i);O>=M&&(T+=P(s,M,O)+R,M=O+A.length)}return T+P(s,M)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||C)},548:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,o),!0;case 6:return c.fn.call(c.context,t,r,i,o,a),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var f,p=c.length;for(l=0;l<p;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,r);break;case 4:c[l].fn.call(c[l].context,t,r,i);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];c[l].fn.apply(c[l].context,u)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,l=[],c=s.length;u<c;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},3108:function(e,t,n){e=n.nmd(e);var r="__lodash_hash_undefined__",i=1,o=2,a=9007199254740991,s="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",d="[object Date]",f="[object Error]",p="[object Function]",h="[object GeneratorFunction]",v="[object Map]",g="[object Number]",m="[object Null]",y="[object Object]",b="[object Promise]",w="[object Proxy]",x="[object RegExp]",k="[object Set]",S="[object String]",_="[object Symbol]",P="[object Undefined]",E="[object WeakMap]",C="[object ArrayBuffer]",I="[object DataView]",T=/^\[object .+?Constructor\]$/,M=/^(?:0|[1-9]\d*)$/,j={};j["[object Float32Array]"]=j["[object Float64Array]"]=j["[object Int8Array]"]=j["[object Int16Array]"]=j["[object Int32Array]"]=j["[object Uint8Array]"]=j["[object Uint8ClampedArray]"]=j["[object Uint16Array]"]=j["[object Uint32Array]"]=!0,j[s]=j[u]=j[C]=j[c]=j[I]=j[d]=j[f]=j[p]=j[v]=j[g]=j[y]=j[x]=j[k]=j[S]=j[E]=!1;var A="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,O="object"==typeof self&&self&&self.Object===Object&&self,L=A||O||Function("return this")(),z=t&&!t.nodeType&&t,D=z&&e&&!e.nodeType&&e,N=D&&D.exports===z,R=N&&A.process,B=function(){try{return R&&R.binding&&R.binding("util")}catch(e){}}(),F=B&&B.isTypedArray;function U(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function K(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function V(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var W,H,Y=Array.prototype,X=Function.prototype,q=Object.prototype,$=L["__core-js_shared__"],G=X.toString,Q=q.hasOwnProperty,Z=function(){var e=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),J=q.toString,ee=RegExp("^"+G.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=N?L.Buffer:void 0,ne=L.Symbol,re=L.Uint8Array,ie=q.propertyIsEnumerable,oe=Y.splice,ae=ne?ne.toStringTag:void 0,se=Object.getOwnPropertySymbols,ue=te?te.isBuffer:void 0,le=(W=Object.keys,H=Object,function(e){return W(H(e))}),ce=Re(L,"DataView"),de=Re(L,"Map"),fe=Re(L,"Promise"),pe=Re(L,"Set"),he=Re(L,"WeakMap"),ve=Re(Object,"create"),ge=Ke(ce),me=Ke(de),ye=Ke(fe),be=Ke(pe),we=Ke(he),xe=ne?ne.prototype:void 0,ke=xe?xe.valueOf:void 0;function Se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _e(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ee(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Pe;++t<n;)this.add(e[t])}function Ce(e){var t=this.__data__=new _e(e);this.size=t.size}function Ie(e,t){var n=He(e),r=!n&&We(e),i=!n&&!r&&Ye(e),o=!n&&!r&&!i&&Qe(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=s.length;for(var l in e)!t&&!Q.call(e,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Ue(l,u))||s.push(l);return s}function Te(e,t){for(var n=e.length;n--;)if(Ve(e[n][0],t))return n;return-1}function Me(e){return null==e?void 0===e?P:m:ae&&ae in Object(e)?function(e){var t=Q.call(e,ae),n=e[ae];try{e[ae]=void 0;var r=!0}catch(o){}var i=J.call(e);r&&(t?e[ae]=n:delete e[ae]);return i}(e):function(e){return J.call(e)}(e)}function je(e){return Ge(e)&&Me(e)==s}function Ae(e,t,n,r,a){return e===t||(null==e||null==t||!Ge(e)&&!Ge(t)?e!==e&&t!==t:function(e,t,n,r,a,l){var p=He(e),h=He(t),m=p?u:Fe(e),b=h?u:Fe(t),w=(m=m==s?y:m)==y,P=(b=b==s?y:b)==y,E=m==b;if(E&&Ye(e)){if(!Ye(t))return!1;p=!0,w=!1}if(E&&!w)return l||(l=new Ce),p||Qe(e)?ze(e,t,n,r,a,l):function(e,t,n,r,a,s,u){switch(n){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case C:return!(e.byteLength!=t.byteLength||!s(new re(e),new re(t)));case c:case d:case g:return Ve(+e,+t);case f:return e.name==t.name&&e.message==t.message;case x:case S:return e==t+"";case v:var l=K;case k:var p=r&i;if(l||(l=V),e.size!=t.size&&!p)return!1;var h=u.get(e);if(h)return h==t;r|=o,u.set(e,t);var m=ze(l(e),l(t),r,a,s,u);return u.delete(e),m;case _:if(ke)return ke.call(e)==ke.call(t)}return!1}(e,t,m,n,r,a,l);if(!(n&i)){var T=w&&Q.call(e,"__wrapped__"),M=P&&Q.call(t,"__wrapped__");if(T||M){var j=T?e.value():e,A=M?t.value():t;return l||(l=new Ce),a(j,A,n,r,l)}}if(!E)return!1;return l||(l=new Ce),function(e,t,n,r,o,a){var s=n&i,u=De(e),l=u.length,c=De(t),d=c.length;if(l!=d&&!s)return!1;var f=l;for(;f--;){var p=u[f];if(!(s?p in t:Q.call(t,p)))return!1}var h=a.get(e);if(h&&a.get(t))return h==t;var v=!0;a.set(e,t),a.set(t,e);var g=s;for(;++f<l;){var m=e[p=u[f]],y=t[p];if(r)var b=s?r(y,m,p,t,e,a):r(m,y,p,e,t,a);if(!(void 0===b?m===y||o(m,y,n,r,a):b)){v=!1;break}g||(g="constructor"==p)}if(v&&!g){var w=e.constructor,x=t.constructor;w==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x||(v=!1)}return a.delete(e),a.delete(t),v}(e,t,n,r,a,l)}(e,t,n,r,Ae,a))}function Oe(e){return!(!$e(e)||function(e){return!!Z&&Z in e}(e))&&(Xe(e)?ee:T).test(Ke(e))}function Le(e){if(!function(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||q;return e===n}(e))return le(e);var t=[];for(var n in Object(e))Q.call(e,n)&&"constructor"!=n&&t.push(n);return t}function ze(e,t,n,r,a,s){var u=n&i,l=e.length,c=t.length;if(l!=c&&!(u&&c>l))return!1;var d=s.get(e);if(d&&s.get(t))return d==t;var f=-1,p=!0,h=n&o?new Ee:void 0;for(s.set(e,t),s.set(t,e);++f<l;){var v=e[f],g=t[f];if(r)var m=u?r(g,v,f,t,e,s):r(v,g,f,e,t,s);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!U(t,(function(e,t){if(i=t,!h.has(i)&&(v===e||a(v,e,n,r,s)))return h.push(t);var i}))){p=!1;break}}else if(v!==g&&!a(v,g,n,r,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function De(e){return function(e,t,n){var r=t(e);return He(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Ze,Be)}function Ne(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Re(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Oe(n)?n:void 0}Se.prototype.clear=function(){this.__data__=ve?ve(null):{},this.size=0},Se.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Se.prototype.get=function(e){var t=this.__data__;if(ve){var n=t[e];return n===r?void 0:n}return Q.call(t,e)?t[e]:void 0},Se.prototype.has=function(e){var t=this.__data__;return ve?void 0!==t[e]:Q.call(t,e)},Se.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ve&&void 0===t?r:t,this},_e.prototype.clear=function(){this.__data__=[],this.size=0},_e.prototype.delete=function(e){var t=this.__data__,n=Te(t,e);return!(n<0)&&(n==t.length-1?t.pop():oe.call(t,n,1),--this.size,!0)},_e.prototype.get=function(e){var t=this.__data__,n=Te(t,e);return n<0?void 0:t[n][1]},_e.prototype.has=function(e){return Te(this.__data__,e)>-1},_e.prototype.set=function(e,t){var n=this.__data__,r=Te(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Pe.prototype.clear=function(){this.size=0,this.__data__={hash:new Se,map:new(de||_e),string:new Se}},Pe.prototype.delete=function(e){var t=Ne(this,e).delete(e);return this.size-=t?1:0,t},Pe.prototype.get=function(e){return Ne(this,e).get(e)},Pe.prototype.has=function(e){return Ne(this,e).has(e)},Pe.prototype.set=function(e,t){var n=Ne(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Ee.prototype.add=Ee.prototype.push=function(e){return this.__data__.set(e,r),this},Ee.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.clear=function(){this.__data__=new _e,this.size=0},Ce.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ce.prototype.get=function(e){return this.__data__.get(e)},Ce.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.set=function(e,t){var n=this.__data__;if(n instanceof _e){var r=n.__data__;if(!de||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Pe(r)}return n.set(e,t),this.size=n.size,this};var Be=se?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}(se(e),(function(t){return ie.call(e,t)})))}:function(){return[]},Fe=Me;function Ue(e,t){return!!(t=null==t?a:t)&&("number"==typeof e||M.test(e))&&e>-1&&e%1==0&&e<t}function Ke(e){if(null!=e){try{return G.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Ve(e,t){return e===t||e!==e&&t!==t}(ce&&Fe(new ce(new ArrayBuffer(1)))!=I||de&&Fe(new de)!=v||fe&&Fe(fe.resolve())!=b||pe&&Fe(new pe)!=k||he&&Fe(new he)!=E)&&(Fe=function(e){var t=Me(e),n=t==y?e.constructor:void 0,r=n?Ke(n):"";if(r)switch(r){case ge:return I;case me:return v;case ye:return b;case be:return k;case we:return E}return t});var We=je(function(){return arguments}())?je:function(e){return Ge(e)&&Q.call(e,"callee")&&!ie.call(e,"callee")},He=Array.isArray;var Ye=ue||function(){return!1};function Xe(e){if(!$e(e))return!1;var t=Me(e);return t==p||t==h||t==l||t==w}function qe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function $e(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ge(e){return null!=e&&"object"==typeof e}var Qe=F?function(e){return function(t){return e(t)}}(F):function(e){return Ge(e)&&qe(e.length)&&!!j[Me(e)]};function Ze(e){return null!=(t=e)&&qe(t.length)&&!Xe(t)?Ie(e):Le(e);var t}e.exports=function(e,t){return Ae(e,t)}},2061:function(e,t,n){var r="Expected a function",i=NaN,o="[object Symbol]",a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,f="object"==typeof self&&self&&self.Object===Object&&self,p=d||f||Function("return this")(),h=Object.prototype.toString,v=Math.max,g=Math.min,m=function(){return p.Date.now()};function y(e,t,n){var i,o,a,s,u,l,c=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError(r);function h(t){var n=i,r=o;return i=o=void 0,c=t,s=e.apply(r,n)}function y(e){var n=e-l;return void 0===l||n>=t||n<0||f&&e-c>=a}function x(){var e=m();if(y(e))return k(e);u=setTimeout(x,function(e){var n=t-(e-l);return f?g(n,a-(e-c)):n}(e))}function k(e){return u=void 0,p&&i?h(e):(i=o=void 0,s)}function S(){var e=m(),n=y(e);if(i=arguments,o=this,l=e,n){if(void 0===u)return function(e){return c=e,u=setTimeout(x,t),d?h(e):s}(l);if(f)return u=setTimeout(x,t),h(l)}return void 0===u&&(u=setTimeout(x,t)),s}return t=w(t)||0,b(n)&&(d=!!n.leading,a=(f="maxWait"in n)?v(w(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),S.cancel=function(){void 0!==u&&clearTimeout(u),c=0,i=l=o=u=void 0},S.flush=function(){return void 0===u?s:k(m())},S}function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function w(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&h.call(e)==o}(e))return i;if(b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=u.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):s.test(e)?i:+e}e.exports=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new TypeError(r);return b(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),y(e,t,{leading:i,maxWait:t,trailing:o})}},8422:function(e,t,n){var r=200,i="__lodash_hash_undefined__",o="[object Function]",a="[object GeneratorFunction]",s=/^\[object .+?Constructor\]$/,u="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,c=u||l||Function("return this")();function d(e,t){return!!(e?e.length:0)&&function(e,t,n){if(t!==t)return function(e,t,n,r){var i=e.length,o=n+(r?1:-1);for(;r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,p,n);var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,0)>-1}function f(e,t,n){for(var r=-1,i=e?e.length:0;++r<i;)if(n(t,e[r]))return!0;return!1}function p(e){return e!==e}function h(e,t){return e.has(t)}function v(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var g=Array.prototype,m=Function.prototype,y=Object.prototype,b=c["__core-js_shared__"],w=function(){var e=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),x=m.toString,k=y.hasOwnProperty,S=y.toString,_=RegExp("^"+x.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=g.splice,E=N(c,"Map"),C=N(c,"Set"),I=N(Object,"create");function T(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function M(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function j(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function A(e){var t=-1,n=e?e.length:0;for(this.__data__=new j;++t<n;)this.add(e[t])}function O(e,t){for(var n,r,i=e.length;i--;)if((n=e[i][0])===(r=t)||n!==n&&r!==r)return i;return-1}function L(e){if(!R(e)||(t=e,w&&w in t))return!1;var t,n=function(e){var t=R(e)?S.call(e):"";return t==o||t==a}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}(e)?_:s;return n.test(function(e){if(null!=e){try{return x.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e))}T.prototype.clear=function(){this.__data__=I?I(null):{}},T.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},T.prototype.get=function(e){var t=this.__data__;if(I){var n=t[e];return n===i?void 0:n}return k.call(t,e)?t[e]:void 0},T.prototype.has=function(e){var t=this.__data__;return I?void 0!==t[e]:k.call(t,e)},T.prototype.set=function(e,t){return this.__data__[e]=I&&void 0===t?i:t,this},M.prototype.clear=function(){this.__data__=[]},M.prototype.delete=function(e){var t=this.__data__,n=O(t,e);return!(n<0)&&(n==t.length-1?t.pop():P.call(t,n,1),!0)},M.prototype.get=function(e){var t=this.__data__,n=O(t,e);return n<0?void 0:t[n][1]},M.prototype.has=function(e){return O(this.__data__,e)>-1},M.prototype.set=function(e,t){var n=this.__data__,r=O(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},j.prototype.clear=function(){this.__data__={hash:new T,map:new(E||M),string:new T}},j.prototype.delete=function(e){return D(this,e).delete(e)},j.prototype.get=function(e){return D(this,e).get(e)},j.prototype.has=function(e){return D(this,e).has(e)},j.prototype.set=function(e,t){return D(this,e).set(e,t),this},A.prototype.add=A.prototype.push=function(e){return this.__data__.set(e,i),this},A.prototype.has=function(e){return this.__data__.has(e)};var z=C&&1/v(new C([,-0]))[1]==1/0?function(e){return new C(e)}:function(){};function D(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function N(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return L(n)?n:void 0}function R(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return e&&e.length?function(e,t,n){var i=-1,o=d,a=e.length,s=!0,u=[],l=u;if(n)s=!1,o=f;else if(a>=r){var c=t?null:z(e);if(c)return v(c);s=!1,o=h,l=new A}else l=t?[]:u;e:for(;++i<a;){var p=e[i],g=t?t(p):p;if(p=n||0!==p?p:0,s&&g===g){for(var m=l.length;m--;)if(l[m]===g)continue e;t&&l.push(g),u.push(p)}else o(l,g,n)||(l!==u&&l.push(g),u.push(p))}return u}(e):[]}},4162:function(e,t,n){var r,i=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function i(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(n){return i(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),r=0,i=t.length;r<i;r++){var a=t.charCodeAt(r);n[2*r]=a>>>8,n[2*r+1]=a%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return o.decompress(t);for(var n=new Array(t.length/2),r=0,i=n.length;r<i;r++)n[r]=256*t[2*r]+t[2*r+1];var a=[];return n.forEach((function(t){a.push(e(t))})),o.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return i(n,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var r,i,o,a={},s={},u="",l="",c="",d=2,f=3,p=2,h=[],v=0,g=0;for(o=0;o<e.length;o+=1)if(u=e.charAt(o),Object.prototype.hasOwnProperty.call(a,u)||(a[u]=f++,s[u]=!0),l=c+u,Object.prototype.hasOwnProperty.call(a,l))c=l;else{if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(r=0;r<p;r++)v<<=1,g==t-1?(g=0,h.push(n(v)),v=0):g++;for(i=c.charCodeAt(0),r=0;r<8;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1}else{for(i=1,r=0;r<p;r++)v=v<<1|i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i=0;for(i=c.charCodeAt(0),r=0;r<16;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[c]}else for(i=a[c],r=0;r<p;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1;0==--d&&(d=Math.pow(2,p),p++),a[l]=f++,c=String(u)}if(""!==c){if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(r=0;r<p;r++)v<<=1,g==t-1?(g=0,h.push(n(v)),v=0):g++;for(i=c.charCodeAt(0),r=0;r<8;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1}else{for(i=1,r=0;r<p;r++)v=v<<1|i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i=0;for(i=c.charCodeAt(0),r=0;r<16;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[c]}else for(i=a[c],r=0;r<p;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(i=2,r=0;r<p;r++)v=v<<1|1&i,g==t-1?(g=0,h.push(n(v)),v=0):g++,i>>=1;for(;;){if(v<<=1,g==t-1){h.push(n(v));break}g++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,r){var i,o,a,s,u,l,c,d=[],f=4,p=4,h=3,v="",g=[],m={val:r(0),position:n,index:1};for(i=0;i<3;i+=1)d[i]=i;for(a=0,u=Math.pow(2,2),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;switch(a){case 0:for(a=0,u=Math.pow(2,8),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;c=e(a);break;case 1:for(a=0,u=Math.pow(2,16),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;c=e(a);break;case 2:return""}for(d[3]=c,o=c,g.push(c);;){if(m.index>t)return"";for(a=0,u=Math.pow(2,h),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;switch(c=a){case 0:for(a=0,u=Math.pow(2,8),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;d[p++]=e(a),c=p-1,f--;break;case 1:for(a=0,u=Math.pow(2,16),l=1;l!=u;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=r(m.index++)),a|=(s>0?1:0)*l,l<<=1;d[p++]=e(a),c=p-1,f--;break;case 2:return g.join("")}if(0==f&&(f=Math.pow(2,h),h++),d[c])v=d[c];else{if(c!==p)return null;v=o+o.charAt(0)}g.push(v),d[p++]=o+v.charAt(0),o=v,0==--f&&(f=Math.pow(2,h),h++)}}};return o}();void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)},534:function(e,t,n){"use strict";var r=n(7313),i=n(2224);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},h={};function v(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(h,e)||!d.call(p,e)&&(f.test(e)?h[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function z(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var D,N=Object.assign;function R(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var B=!1;function F(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var u="\n"+i[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=a&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?R(e):""}function U(e){switch(e.tag){case 5:return R(e.type);case 16:return R("Lazy");case 13:return R("Suspense");case 19:return R("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function K(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case k:return"Portal";case P:return"Profiler";case _:return"StrictMode";case T:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:K(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return K(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return N({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function G(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Z(e,t){Q(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return N({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function oe(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var me=N({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Se=null,_e=null;function Pe(e){if(e=bi(e)){if("function"!==typeof ke)throw Error(o(280));var t=e.stateNode;t&&(t=xi(t),ke(e.stateNode,e.type,t))}}function Ee(e){Se?_e?_e.push(e):_e=[e]:Se=e}function Ce(){if(Se){var e=Se,t=_e;if(_e=Se=null,Pe(e),t)for(e=0;e<t.length;e++)Pe(t[e])}}function Ie(e,t){return e(t)}function Te(){}var Me=!1;function je(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ie(e,t,n)}finally{Me=!1,(null!==Se||null!==_e)&&(Te(),Ce())}}function Ae(e,t){var n=e.stateNode;if(null===n)return null;var r=xi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Oe=!1;if(c)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ce){Oe=!1}function ze(e,t,n,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var De=!1,Ne=null,Re=!1,Be=null,Fe={onError:function(e){De=!0,Ne=e}};function Ue(e,t,n,r,i,o,a,s,u){De=!1,Ne=null,ze.apply(Fe,arguments)}function Ke(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ke(e)!==e)throw Error(o(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ke(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return We(i),e;if(a===r)return We(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=a;break}if(u===r){s=!0,r=i,n=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===n){s=!0,n=a,r=i;break}if(u===r){s=!0,r=a,n=i;break}u=u.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ye(e):null}function Ye(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ye(e);if(null!==t)return t;e=e.sibling}return null}var Xe=i.unstable_scheduleCallback,qe=i.unstable_cancelCallback,$e=i.unstable_shouldYield,Ge=i.unstable_requestPaint,Qe=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var lt=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=dt(s):0!==(o&=a)&&(r=dt(o))}else 0!==(a=n&~i)?r=dt(a):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,kt,St,_t,Pt,Et=!1,Ct=[],It=null,Tt=null,Mt=null,jt=new Map,At=new Map,Ot=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":jt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Dt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Nt(e){var t=yi(e.target);if(null!==t){var n=Ke(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Pt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Rt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Bt(e,t,n){Rt(e)&&n.delete(t)}function Ft(){Et=!1,null!==It&&Rt(It)&&(It=null),null!==Tt&&Rt(Tt)&&(Tt=null),null!==Mt&&Rt(Mt)&&(Mt=null),jt.forEach(Bt),At.forEach(Bt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ft)))}function Kt(e){function t(t){return Ut(t,e)}if(0<Ct.length){Ut(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&Ut(It,e),null!==Tt&&Ut(Tt,e),null!==Mt&&Ut(Mt,e),jt.forEach(t),At.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Nt(n),null===n.blockedOn&&Ot.shift()}var Vt=w.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,n,r){var i=bt,o=Vt.transition;Vt.transition=null;try{bt=1,Xt(e,t,n,r)}finally{bt=i,Vt.transition=o}}function Yt(e,t,n,r){var i=bt,o=Vt.transition;Vt.transition=null;try{bt=4,Xt(e,t,n,r)}finally{bt=i,Vt.transition=o}}function Xt(e,t,n,r){if(Wt){var i=$t(e,t,n,r);if(null===i)Wr(e,t,r,qt,n),zt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return It=Dt(It,e,t,n,r,i),!0;case"dragenter":return Tt=Dt(Tt,e,t,n,r,i),!0;case"mouseover":return Mt=Dt(Mt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return jt.set(o,Dt(jt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,At.set(o,Dt(At.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(zt(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&xt(o),null===(o=$t(e,t,n,r))&&Wr(e,t,r,qt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var qt=null;function $t(e,t,n,r){if(qt=null,null!==(e=yi(e=xe(r))))if(null===(t=Ke(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Zt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Zt,r=n.length,i="value"in Qt?Qt.value:Qt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return N(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,un,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(ln),dn=N({},ln,{view:0,detail:0}),fn=on(dn),pn=N({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(an=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=an=0,un=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),hn=on(pn),vn=on(N({},pn,{dataTransfer:0})),gn=on(N({},dn,{relatedTarget:0})),mn=on(N({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=N({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),wn=on(N({},ln,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Pn(){return _n}var En=N({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=on(En),In=on(N({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=on(N({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pn})),Mn=on(N({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=N({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),An=on(jn),On=[9,13,27,32],Ln=c&&"CompositionEvent"in window,zn=null;c&&"documentMode"in document&&(zn=document.documentMode);var Dn=c&&"TextEvent"in window&&!zn,Nn=c&&(!Ln||zn&&8<zn&&11>=zn),Rn=String.fromCharCode(32),Bn=!1;function Fn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Kn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ee(r),0<(t=Yr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Yn=null,Xn=null;function qn(e){Rr(e,0)}function $n(e){if(X(wi(e)))return e}function Gn(e,t){if("change"===e)return t}var Qn=!1;if(c){var Zn;if(c){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}Zn=Jn}else Zn=!1;Qn=Zn&&(!document.documentMode||9<document.documentMode)}function tr(){Yn&&(Yn.detachEvent("onpropertychange",nr),Xn=Yn=null)}function nr(e){if("value"===e.propertyName&&$n(Xn)){var t=[];Hn(t,Xn,e,xe(e)),je(qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(Yn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Xn)}function or(e,t){if("click"===e)return $n(t)}function ar(e,t){if("input"===e||"change"===e)return $n(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=cr(n,o);var a=cr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,mr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==q(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Yr(mr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Sr={},_r={};function Pr(e){if(Sr[e])return Sr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in _r)return Sr[e]=n[t];return e}c&&(_r=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Er=Pr("animationend"),Cr=Pr("animationiteration"),Ir=Pr("animationstart"),Tr=Pr("transitionend"),Mr=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){Mr.set(e,t),u(t,[e])}for(var Or=0;Or<jr.length;Or++){var Lr=jr[Or];Ar(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Ar(Er,"onAnimationEnd"),Ar(Cr,"onAnimationIteration"),Ar(Ir,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(Tr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dr=new Set("cancel close invalid load scroll toggle".split(" ").concat(zr));function Nr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,u,l){if(Ue.apply(this,arguments),De){if(!De)throw Error(o(198));var c=Ne;De=!1,Ne=null,Re||(Re=!0,Be=c)}}(r,t,void 0,e),e.currentTarget=null}function Rr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;Nr(i,s,l),o=u}else for(a=0;a<r.length;a++){if(u=(s=r[a]).instance,l=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;Nr(i,s,l),o=u}}}if(Re)throw e=Be,Re=!1,Be=null,e}function Br(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Fr(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Kr(e){if(!e[Ur]){e[Ur]=!0,a.forEach((function(t){"selectionchange"!==t&&(Dr.has(t)||Fr(t,!1,e),Fr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Fr("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Gt(t)){case 1:var i=Ht;break;case 4:i=Yt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=yi(s)))return;if(5===(u=a.tag)||6===u){r=o=a;continue e}s=s.parentNode}}r=r.return}je((function(){var r=o,i=xe(n),a=[];e:{var s=Mr.get(e);if(void 0!==s){var u=cn,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Cn;break;case"focusin":l="focus",u=gn;break;case"focusout":l="blur",u=gn;break;case"beforeblur":case"afterblur":u=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Tn;break;case Er:case Cr:case Ir:u=mn;break;case Tr:u=Mn;break;case"scroll":u=fn;break;case"wheel":u=An;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=In}var c=0!==(4&t),d=!c&&"scroll"===e,f=c?null!==s?s+"Capture":null:s;c=[];for(var p,h=r;null!==h;){var v=(p=h).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==f&&(null!=(v=Ae(h,f))&&c.push(Hr(h,v,p)))),d)break;h=h.return}0<c.length&&(s=new u(s,l,null,n,i),a.push({event:s,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===we||!(l=n.relatedTarget||n.fromElement)||!yi(l)&&!l[hi])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?yi(l):null)&&(l!==(d=Ke(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=hn,v="onMouseLeave",f="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(c=In,v="onPointerLeave",f="onPointerEnter",h="pointer"),d=null==u?s:wi(u),p=null==l?s:wi(l),(s=new c(v,h+"leave",u,n,i)).target=d,s.relatedTarget=p,v=null,yi(i)===r&&((c=new c(f,h+"enter",l,n,i)).target=p,c.relatedTarget=d,v=c),d=v,u&&l)e:{for(f=l,h=0,p=c=u;p;p=Xr(p))h++;for(p=0,v=f;v;v=Xr(v))p++;for(;0<h-p;)c=Xr(c),h--;for(;0<p-h;)f=Xr(f),p--;for(;h--;){if(c===f||null!==f&&c===f.alternate)break e;c=Xr(c),f=Xr(f)}c=null}else c=null;null!==u&&qr(a,s,u,c,!1),null!==l&&null!==d&&qr(a,d,l,c,!0)}if("select"===(u=(s=r?wi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var g=Gn;else if(Wn(s))if(Qn)g=ar;else{g=ir;var m=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Hn(a,g,n,i):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=r?wi(r):window,e){case"focusin":(Wn(m)||"true"===m.contentEditable)&&(gr=m,mr=r,yr=null);break;case"focusout":yr=mr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(a,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":wr(a,n,i)}var y;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Kn?Fn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Nn&&"ko"!==n.locale&&(Kn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Kn&&(y=en()):(Zt="value"in(Qt=i)?Qt.value:Qt.textContent,Kn=!0)),0<(m=Yr(r,b)).length&&(b=new wn(b,e,null,n,i),a.push({event:b,listeners:m}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=Dn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Bn=!0,Rn);case"textInput":return(e=t.data)===Rn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Kn)return"compositionend"===e||!Ln&&Fn(e,t)?(e=en(),Jt=Zt=Qt=null,Kn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Yr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y))}Rr(a,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Yr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ae(e,n))&&r.unshift(Hr(e,o,i)),null!=(o=Ae(e,t))&&r.push(Hr(e,o,i))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,i?null!=(u=Ae(n,o))&&a.unshift(Hr(n,u,s)):i||null!=(u=Ae(n,o))&&a.push(Hr(n,u,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var $r=/\r\n?/g,Gr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace($r,"\n").replace(Gr,"")}function Zr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(o(425))}function Jr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function ui(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Kt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Kt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),fi="__reactFiber$"+di,pi="__reactProps$"+di,hi="__reactContainer$"+di,vi="__reactEvents$"+di,gi="__reactListeners$"+di,mi="__reactHandles$"+di;function yi(e){var t=e[fi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[hi]||n[fi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[fi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[fi]||e[hi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function xi(e){return e[pi]||null}var ki=[],Si=-1;function _i(e){return{current:e}}function Pi(e){0>Si||(e.current=ki[Si],ki[Si]=null,Si--)}function Ei(e,t){Si++,ki[Si]=e.current,e.current=t}var Ci={},Ii=_i(Ci),Ti=_i(!1),Mi=Ci;function ji(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ai(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Pi(Ti),Pi(Ii)}function Li(e,t,n){if(Ii.current!==Ci)throw Error(o(168));Ei(Ii,t),Ei(Ti,n)}function zi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,V(e)||"Unknown",i));return N({},n,r)}function Di(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Mi=Ii.current,Ei(Ii,e),Ei(Ti,Ti.current),!0}function Ni(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=zi(e,t,Mi),r.__reactInternalMemoizedMergedChildContext=e,Pi(Ti),Pi(Ii),Ei(Ii,e)):Pi(Ti),Ei(Ti,n)}var Ri=null,Bi=!1,Fi=!1;function Ui(e){null===Ri?Ri=[e]:Ri.push(e)}function Ki(){if(!Fi&&null!==Ri){Fi=!0;var e=0,t=bt;try{var n=Ri;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ri=null,Bi=!1}catch(i){throw null!==Ri&&(Ri=Ri.slice(e+1)),Xe(Je,Ki),i}finally{bt=t,Fi=!1}}return null}var Vi=[],Wi=0,Hi=null,Yi=0,Xi=[],qi=0,$i=null,Gi=1,Qi="";function Zi(e,t){Vi[Wi++]=Yi,Vi[Wi++]=Hi,Hi=e,Yi=t}function Ji(e,t,n){Xi[qi++]=Gi,Xi[qi++]=Qi,Xi[qi++]=$i,$i=e;var r=Gi;e=Qi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Gi=1<<32-at(t)+i|n<<i|r,Qi=o+e}else Gi=1<<o|n<<i|r,Qi=e}function eo(e){null!==e.return&&(Zi(e,1),Ji(e,1,0))}function to(e){for(;e===Hi;)Hi=Vi[--Wi],Vi[Wi]=null,Yi=Vi[--Wi],Vi[Wi]=null;for(;e===$i;)$i=Xi[--qi],Xi[qi]=null,Qi=Xi[--qi],Xi[qi]=null,Gi=Xi[--qi],Xi[qi]=null}var no=null,ro=null,io=!1,oo=null;function ao(e,t){var n=Al(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$i?{id:Gi,overflow:Qi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Al(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function uo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function lo(e){if(io){var t=ro;if(t){var n=t;if(!so(e,t)){if(uo(e))throw Error(o(418));t=li(n.nextSibling);var r=no;t&&so(e,t)?ao(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(uo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function co(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function fo(e){if(e!==no)return!1;if(!io)return co(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(uo(e))throw po(),Error(o(418));for(;t;)ao(e,t),t=li(t.nextSibling)}if(co(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?li(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=li(e.nextSibling)}function ho(){ro=no=null,io=!1}function vo(e){null===oo?oo=[e]:oo.push(e)}var go=w.ReactCurrentBatchConfig;function mo(e,t){if(e&&e.defaultProps){for(var n in t=N({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yo=_i(null),bo=null,wo=null,xo=null;function ko(){xo=wo=bo=null}function So(e){var t=yo.current;Pi(yo),e._currentValue=t}function _o(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Po(e,t){bo=e,xo=wo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ws=!0),e.firstContext=null)}function Eo(e){var t=e._currentValue;if(xo!==e)if(e={context:e,memoizedValue:t,next:null},null===wo){if(null===bo)throw Error(o(308));wo=e,bo.dependencies={lanes:0,firstContext:e}}else wo=wo.next=e;return t}var Co=null;function Io(e){null===Co?Co=[e]:Co.push(e)}function To(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Io(t)):(n.next=i.next,i.next=n),t.interleaved=n,Mo(e,r)}function Mo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var jo=!1;function Ao(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tu)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Mo(e,n)}return null===(i=r.interleaved)?(t.next=t,Io(r)):(t.next=i.next,i.next=t),r.interleaved=t,Mo(e,n)}function Do(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function No(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ro(e,t,n,r){var i=e.updateQueue;jo=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,l=u.next;u.next=null,null===a?o=l:a.next=l,a=u;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(null!==o){var d=i.baseState;for(a=0,c=l=u=null,s=o;;){var f=s.lane,p=s.eventTime;if((r&f)===f){null!==c&&(c=c.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,v=s;switch(f=t,p=n,v.tag){case 1:if("function"===typeof(h=v.payload)){d=h.call(p,d,f);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(f="function"===typeof(h=v.payload)?h.call(p,d,f):h)||void 0===f)break e;d=N({},d,f);break e;case 2:jo=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[s]:f.push(s))}else p={eventTime:p,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(l=c=p,u=d):c=c.next=p,a|=f;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(f=s).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===c&&(u=d),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Nu|=a,e.lanes=a,e.memoizedState=d}}function Bo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Fo=(new r.Component).refs;function Uo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:N({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ko={isMounted:function(e){return!!(e=e._reactInternals)&&Ke(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tl(),i=nl(e),o=Lo(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,i))&&(rl(t,e,i,r),Do(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tl(),i=nl(e),o=Lo(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,i))&&(rl(t,e,i,r),Do(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tl(),r=nl(e),i=Lo(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=zo(e,i,r))&&(rl(t,e,r,n),Do(t,e,r))}};function Vo(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(i,o))}function Wo(e,t,n){var r=!1,i=Ci,o=t.contextType;return"object"===typeof o&&null!==o?o=Eo(o):(i=Ai(t)?Mi:Ii.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?ji(e,i):Ci),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ko,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ho(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ko.enqueueReplaceState(t,t.state,null)}function Yo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Fo,Ao(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=Eo(o):(o=Ai(t)?Mi:Ii.current,i.context=ji(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Uo(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Ko.enqueueReplaceState(i,i.state,null),Ro(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Xo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;t===Fo&&(t=i.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function qo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $o(e){return(0,e._init)(e._payload)}function Go(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Ll(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Rl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var o=n.type;return o===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===A&&$o(o)===t.type)?((r=i(t,n.props)).ref=Xo(e,t,n),r.return=e,r):((r=zl(n.type,n.key,n.props,null,e.mode,r)).ref=Xo(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Dl(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Rl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=zl(t.type,t.key,t.props,null,e.mode,n)).ref=Xo(e,null,t),n.return=e,n;case k:return(t=Bl(t,e.mode,n)).return=e,t;case A:return f(e,(0,t._init)(t._payload),n)}if(te(t)||z(t))return(t=Dl(t,e.mode,n,null)).return=e,t;qo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?l(e,t,n,r):null;case k:return n.key===i?c(e,t,n,r):null;case A:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||z(n))return null!==i?null:d(e,t,n,r,null);qo(e,n)}return null}function h(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case A:return h(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||z(r))return d(t,e=e.get(n)||null,r,i,null);qo(t,r)}return null}function v(i,o,s,u){for(var l=null,c=null,d=o,v=o=0,g=null;null!==d&&v<s.length;v++){d.index>v?(g=d,d=null):g=d.sibling;var m=p(i,d,s[v],u);if(null===m){null===d&&(d=g);break}e&&d&&null===m.alternate&&t(i,d),o=a(m,o,v),null===c?l=m:c.sibling=m,c=m,d=g}if(v===s.length)return n(i,d),io&&Zi(i,v),l;if(null===d){for(;v<s.length;v++)null!==(d=f(i,s[v],u))&&(o=a(d,o,v),null===c?l=d:c.sibling=d,c=d);return io&&Zi(i,v),l}for(d=r(i,d);v<s.length;v++)null!==(g=h(d,i,v,s[v],u))&&(e&&null!==g.alternate&&d.delete(null===g.key?v:g.key),o=a(g,o,v),null===c?l=g:c.sibling=g,c=g);return e&&d.forEach((function(e){return t(i,e)})),io&&Zi(i,v),l}function g(i,s,u,l){var c=z(u);if("function"!==typeof c)throw Error(o(150));if(null==(u=c.call(u)))throw Error(o(151));for(var d=c=null,v=s,g=s=0,m=null,y=u.next();null!==v&&!y.done;g++,y=u.next()){v.index>g?(m=v,v=null):m=v.sibling;var b=p(i,v,y.value,l);if(null===b){null===v&&(v=m);break}e&&v&&null===b.alternate&&t(i,v),s=a(b,s,g),null===d?c=b:d.sibling=b,d=b,v=m}if(y.done)return n(i,v),io&&Zi(i,g),c;if(null===v){for(;!y.done;g++,y=u.next())null!==(y=f(i,y.value,l))&&(s=a(y,s,g),null===d?c=y:d.sibling=y,d=y);return io&&Zi(i,g),c}for(v=r(i,v);!y.done;g++,y=u.next())null!==(y=h(v,i,g,y.value,l))&&(e&&null!==y.alternate&&v.delete(null===y.key?g:y.key),s=a(y,s,g),null===d?c=y:d.sibling=y,d=y);return e&&v.forEach((function(e){return t(i,e)})),io&&Zi(i,g),c}return function e(r,o,a,u){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:e:{for(var l=a.key,c=o;null!==c;){if(c.key===l){if((l=a.type)===S){if(7===c.tag){n(r,c.sibling),(o=i(c,a.props.children)).return=r,r=o;break e}}else if(c.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===A&&$o(l)===c.type){n(r,c.sibling),(o=i(c,a.props)).ref=Xo(r,c,a),o.return=r,r=o;break e}n(r,c);break}t(r,c),c=c.sibling}a.type===S?((o=Dl(a.props.children,r.mode,u,a.key)).return=r,r=o):((u=zl(a.type,a.key,a.props,null,r.mode,u)).ref=Xo(r,o,a),u.return=r,r=u)}return s(r);case k:e:{for(c=a.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Bl(a,r.mode,u)).return=r,r=o}return s(r);case A:return e(r,o,(c=a._init)(a._payload),u)}if(te(a))return v(r,o,a,u);if(z(a))return g(r,o,a,u);qo(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=Rl(a,r.mode,u)).return=r,r=o),s(r)):n(r,o)}}var Qo=Go(!0),Zo=Go(!1),Jo={},ea=_i(Jo),ta=_i(Jo),na=_i(Jo);function ra(e){if(e===Jo)throw Error(o(174));return e}function ia(e,t){switch(Ei(na,t),Ei(ta,e),Ei(ea,Jo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Pi(ea),Ei(ea,t)}function oa(){Pi(ea),Pi(ta),Pi(na)}function aa(e){ra(na.current);var t=ra(ea.current),n=ue(t,e.type);t!==n&&(Ei(ta,e),Ei(ea,n))}function sa(e){ta.current===e&&(Pi(ea),Pi(ta))}var ua=_i(0);function la(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ca=[];function da(){for(var e=0;e<ca.length;e++)ca[e]._workInProgressVersionPrimary=null;ca.length=0}var fa=w.ReactCurrentDispatcher,pa=w.ReactCurrentBatchConfig,ha=0,va=null,ga=null,ma=null,ya=!1,ba=!1,wa=0,xa=0;function ka(){throw Error(o(321))}function Sa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function _a(e,t,n,r,i,a){if(ha=a,va=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fa.current=null===e||null===e.memoizedState?ss:us,e=n(r,i),ba){a=0;do{if(ba=!1,wa=0,25<=a)throw Error(o(301));a+=1,ma=ga=null,t.updateQueue=null,fa.current=ls,e=n(r,i)}while(ba)}if(fa.current=as,t=null!==ga&&null!==ga.next,ha=0,ma=ga=va=null,ya=!1,t)throw Error(o(300));return e}function Pa(){var e=0!==wa;return wa=0,e}function Ea(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ma?va.memoizedState=ma=e:ma=ma.next=e,ma}function Ca(){if(null===ga){var e=va.alternate;e=null!==e?e.memoizedState:null}else e=ga.next;var t=null===ma?va.memoizedState:ma.next;if(null!==t)ma=t,ga=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ga=e).memoizedState,baseState:ga.baseState,baseQueue:ga.baseQueue,queue:ga.queue,next:null},null===ma?va.memoizedState=ma=e:ma=ma.next=e}return ma}function Ia(e,t){return"function"===typeof t?t(e):t}function Ta(e){var t=Ca(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=ga,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var u=s=null,l=null,c=a;do{var d=c.lane;if((ha&d)===d)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(u=l=f,s=r):l=l.next=f,va.lanes|=d,Nu|=d}c=c.next}while(null!==c&&c!==a);null===l?s=r:l.next=u,sr(r,t.memoizedState)||(ws=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,va.lanes|=a,Nu|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ma(e){var t=Ca(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sr(a,t.memoizedState)||(ws=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function ja(){}function Aa(e,t){var n=va,r=Ca(),i=t(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,ws=!0),r=r.queue,Wa(za.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ma&&1&ma.memoizedState.tag){if(n.flags|=2048,Ba(9,La.bind(null,n,r,i,t),void 0,null),null===Mu)throw Error(o(349));0!==(30&ha)||Oa(n,t,i)}return i}function Oa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function La(e,t,n,r){t.value=n,t.getSnapshot=r,Da(t)&&Na(e)}function za(e,t,n){return n((function(){Da(t)&&Na(e)}))}function Da(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Na(e){var t=Mo(e,1);null!==t&&rl(t,e,1,-1)}function Ra(e){var t=Ea();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,va,e),[t.memoizedState,e]}function Ba(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fa(){return Ca().memoizedState}function Ua(e,t,n,r){var i=Ea();va.flags|=e,i.memoizedState=Ba(1|t,n,void 0,void 0===r?null:r)}function Ka(e,t,n,r){var i=Ca();r=void 0===r?null:r;var o=void 0;if(null!==ga){var a=ga.memoizedState;if(o=a.destroy,null!==r&&Sa(r,a.deps))return void(i.memoizedState=Ba(t,n,o,r))}va.flags|=e,i.memoizedState=Ba(1|t,n,o,r)}function Va(e,t){return Ua(8390656,8,e,t)}function Wa(e,t){return Ka(2048,8,e,t)}function Ha(e,t){return Ka(4,2,e,t)}function Ya(e,t){return Ka(4,4,e,t)}function Xa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qa(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ka(4,4,Xa.bind(null,t,e),n)}function $a(){}function Ga(e,t){var n=Ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Sa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qa(e,t){var n=Ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Sa(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Za(e,t,n){return 0===(21&ha)?(e.baseState&&(e.baseState=!1,ws=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),va.lanes|=n,Nu|=n,e.baseState=!0),t)}function Ja(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=pa.transition;pa.transition={};try{e(!1),t()}finally{bt=n,pa.transition=r}}function es(){return Ca().memoizedState}function ts(e,t,n){var r=nl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))is(t,n);else if(null!==(n=To(e,t,n,r))){rl(n,e,r,tl()),os(n,t,r)}}function ns(e,t,n){var r=nl(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))is(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var u=t.interleaved;return null===u?(i.next=i,Io(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=To(e,t,i,r))&&(rl(n,e,r,i=tl()),os(n,t,r))}}function rs(e){var t=e.alternate;return e===va||null!==t&&t===va}function is(e,t){ba=ya=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function os(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var as={readContext:Eo,useCallback:ka,useContext:ka,useEffect:ka,useImperativeHandle:ka,useInsertionEffect:ka,useLayoutEffect:ka,useMemo:ka,useReducer:ka,useRef:ka,useState:ka,useDebugValue:ka,useDeferredValue:ka,useTransition:ka,useMutableSource:ka,useSyncExternalStore:ka,useId:ka,unstable_isNewReconciler:!1},ss={readContext:Eo,useCallback:function(e,t){return Ea().memoizedState=[e,void 0===t?null:t],e},useContext:Eo,useEffect:Va,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ua(4194308,4,Xa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ua(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ua(4,2,e,t)},useMemo:function(e,t){var n=Ea();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ea();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,va,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ea().memoizedState=e},useState:Ra,useDebugValue:$a,useDeferredValue:function(e){return Ea().memoizedState=e},useTransition:function(){var e=Ra(!1),t=e[0];return e=Ja.bind(null,e[1]),Ea().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=va,i=Ea();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Mu)throw Error(o(349));0!==(30&ha)||Oa(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Va(za.bind(null,r,a,e),[e]),r.flags|=2048,Ba(9,La.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Ea(),t=Mu.identifierPrefix;if(io){var n=Qi;t=":"+t+"R"+(n=(Gi&~(1<<32-at(Gi)-1)).toString(32)+n),0<(n=wa++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=xa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Eo,useCallback:Ga,useContext:Eo,useEffect:Wa,useImperativeHandle:qa,useInsertionEffect:Ha,useLayoutEffect:Ya,useMemo:Qa,useReducer:Ta,useRef:Fa,useState:function(){return Ta(Ia)},useDebugValue:$a,useDeferredValue:function(e){return Za(Ca(),ga.memoizedState,e)},useTransition:function(){return[Ta(Ia)[0],Ca().memoizedState]},useMutableSource:ja,useSyncExternalStore:Aa,useId:es,unstable_isNewReconciler:!1},ls={readContext:Eo,useCallback:Ga,useContext:Eo,useEffect:Wa,useImperativeHandle:qa,useInsertionEffect:Ha,useLayoutEffect:Ya,useMemo:Qa,useReducer:Ma,useRef:Fa,useState:function(){return Ma(Ia)},useDebugValue:$a,useDeferredValue:function(e){var t=Ca();return null===ga?t.memoizedState=e:Za(t,ga.memoizedState,e)},useTransition:function(){return[Ma(Ia)[0],Ca().memoizedState]},useMutableSource:ja,useSyncExternalStore:Aa,useId:es,unstable_isNewReconciler:!1};function cs(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ps="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=Lo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hu||(Hu=!0,Yu=r),fs(0,t)},n}function vs(e,t,n){(n=Lo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){fs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){fs(0,t),"function"!==typeof r&&(null===Xu?Xu=new Set([this]):Xu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ps;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=El.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Lo(-1,1)).tag=2,zo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bs=w.ReactCurrentOwner,ws=!1;function xs(e,t,n,r){t.child=null===e?Zo(t,null,n,r):Qo(t,e.child,n,r)}function ks(e,t,n,r,i){n=n.render;var o=t.ref;return Po(t,i),r=_a(e,t,n,r,o,i),n=Pa(),null===e||ws?(io&&n&&eo(t),t.flags|=1,xs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function Ss(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Ol(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=zl(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,_s(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(a,r)&&e.ref===t.ref)return Hs(e,t,i)}return t.flags|=1,(e=Ll(o,r)).ref=t.ref,e.return=t,t.child=e}function _s(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(ur(o,r)&&e.ref===t.ref){if(ws=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Hs(e,t,i);0!==(131072&e.flags)&&(ws=!0)}}return Cs(e,t,n,r,i)}function Ps(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ei(Lu,Ou),Ou|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ei(Lu,Ou),Ou|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ei(Lu,Ou),Ou|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ei(Lu,Ou),Ou|=r;return xs(e,t,i,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cs(e,t,n,r,i){var o=Ai(n)?Mi:Ii.current;return o=ji(t,o),Po(t,i),n=_a(e,t,n,r,o,i),r=Pa(),null===e||ws?(io&&r&&eo(t),t.flags|=1,xs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function Is(e,t,n,r,i){if(Ai(n)){var o=!0;Di(t)}else o=!1;if(Po(t,i),null===t.stateNode)Ws(e,t),Wo(t,n,r),Yo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;"object"===typeof l&&null!==l?l=Eo(l):l=ji(t,l=Ai(n)?Mi:Ii.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==l)&&Ho(t,a,r,l),jo=!1;var f=t.memoizedState;a.state=f,Ro(t,r,a,i),u=t.memoizedState,s!==r||f!==u||Ti.current||jo?("function"===typeof c&&(Uo(t,n,c,r),u=t.memoizedState),(s=jo||Vo(t,n,s,r,f,u,l))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Oo(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:mo(t.type,s),a.props=l,d=t.pendingProps,f=a.context,"object"===typeof(u=n.contextType)&&null!==u?u=Eo(u):u=ji(t,u=Ai(n)?Mi:Ii.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||f!==u)&&Ho(t,a,r,u),jo=!1,f=t.memoizedState,a.state=f,Ro(t,r,a,i);var h=t.memoizedState;s!==d||f!==h||Ti.current||jo?("function"===typeof p&&(Uo(t,n,p,r),h=t.memoizedState),(l=jo||Vo(t,n,l,r,f,h,u)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,h,u),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,h,u)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),a.props=r,a.state=h,a.context=u,r=l):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Ts(e,t,n,r,o,i)}function Ts(e,t,n,r,i,o){Es(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Ni(t,n,!1),Hs(e,t,o);r=t.stateNode,bs.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Qo(t,e.child,null,o),t.child=Qo(t,null,s,o)):xs(e,t,s,o),t.memoizedState=r.state,i&&Ni(t,n,!0),t.child}function Ms(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),ia(e,t.containerInfo)}function js(e,t,n,r,i){return ho(),vo(i),t.flags|=256,xs(e,t,n,r),t.child}var As,Os,Ls,zs,Ds={dehydrated:null,treeContext:null,retryLane:0};function Ns(e){return{baseLanes:e,cachePool:null,transitions:null}}function Rs(e,t,n){var r,i=t.pendingProps,a=ua.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ei(ua,1&a),null===e)return lo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,s?(i=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Nl(u,i,0,null),e=Dl(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ns(n),t.memoizedState=Ds,e):Bs(t,u));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,s){if(n)return 256&t.flags?(t.flags&=-257,Fs(e,t,s,r=ds(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Nl({mode:"visible",children:r.children},i,0,null),(a=Dl(a,i,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&Qo(t,e.child,null,s),t.child.memoizedState=Ns(s),t.memoizedState=Ds,a);if(0===(1&t.mode))return Fs(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var u=r.dgst;return r=u,Fs(e,t,s,r=ds(a=Error(o(419)),r,void 0))}if(u=0!==(s&e.childLanes),ws||u){if(null!==(r=Mu)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Mo(e,i),rl(r,e,i,-1))}return gl(),Fs(e,t,s,r=ds(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ro=li(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Xi[qi++]=Gi,Xi[qi++]=Qi,Xi[qi++]=$i,Gi=e.id,Qi=e.overflow,$i=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,u,i,r,a,n);if(s){s=i.fallback,u=t.mode,r=(a=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Ll(a,l)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Ll(r,s):(s=Dl(s,u,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,u=null===(u=e.child.memoizedState)?Ns(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Ds,i}return e=(s=e.child).sibling,i=Ll(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Bs(e,t){return(t=Nl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fs(e,t,n,r){return null!==r&&vo(r),Qo(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),_o(e.return,t,n)}function Ks(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Vs(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=ua.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ei(ua,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===la(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ks(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===la(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ks(t,!0,n,null,o);break;case"together":Ks(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ws(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Ll(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ll(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ys(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Xs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function qs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xs(t),null;case 1:case 17:return Ai(t.type)&&Oi(),Xs(t),null;case 3:return r=t.stateNode,oa(),Pi(Ti),Pi(Ii),da(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fo(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(sl(oo),oo=null))),Os(e,t),Xs(t),null;case 5:sa(t);var i=ra(na.current);if(n=t.type,null!==e&&null!=t.stateNode)Ls(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Xs(t),null}if(e=ra(ea.current),fo(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[fi]=t,r[pi]=a,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(i=0;i<zr.length;i++)Br(zr[i],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":G(r,a),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Br("invalid",r);break;case"textarea":ie(r,a),Br("invalid",r)}for(var u in ye(n,a),i=null,a)if(a.hasOwnProperty(u)){var l=a[u];"children"===u?"string"===typeof l?r.textContent!==l&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,l,e),i=["children",""+l]):s.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&Br("scroll",r)}switch(n){case"input":Y(r),J(r,a,!0);break;case"textarea":Y(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Jr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[fi]=t,e[pi]=r,As(e,t,!1,!1),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),i=r;break;case"iframe":case"object":case"embed":Br("load",e),i=r;break;case"video":case"audio":for(i=0;i<zr.length;i++)Br(zr[i],e);i=r;break;case"source":Br("error",e),i=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),i=r;break;case"details":Br("toggle",e),i=r;break;case"input":G(e,r),i=$(e,r),Br("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=N({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Br("invalid",e)}for(a in ye(n,i),l=i)if(l.hasOwnProperty(a)){var c=l[a];"style"===a?ge(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&fe(e,c):"number"===typeof c&&fe(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Br("scroll",e):null!=c&&b(e,a,c,u))}switch(n){case"input":Y(e),J(e,r,!1);break;case"textarea":Y(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Xs(t),null;case 6:if(e&&null!=t.stateNode)zs(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=ra(na.current),ra(ea.current),fo(t)){if(r=t.stateNode,n=t.memoizedProps,r[fi]=t,(a=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fi]=t,t.stateNode=r}return Xs(t),null;case 13:if(Pi(ua),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),ho(),t.flags|=98560,a=!1;else if(a=fo(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[fi]=t}else ho(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Xs(t),a=!1}else null!==oo&&(sl(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ua.current)?0===zu&&(zu=3):gl())),null!==t.updateQueue&&(t.flags|=4),Xs(t),null);case 4:return oa(),Os(e,t),null===e&&Kr(t.stateNode.containerInfo),Xs(t),null;case 10:return So(t.type._context),Xs(t),null;case 19:if(Pi(ua),null===(a=t.memoizedState))return Xs(t),null;if(r=0!==(128&t.flags),null===(u=a.rendering))if(r)Ys(a,!1);else{if(0!==zu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=la(e))){for(t.flags|=128,Ys(a,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(u=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,e=u.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ei(ua,1&ua.current|2),t.child}e=e.sibling}null!==a.tail&&Qe()>Vu&&(t.flags|=128,r=!0,Ys(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=la(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ys(a,!0),null===a.tail&&"hidden"===a.tailMode&&!u.alternate&&!io)return Xs(t),null}else 2*Qe()-a.renderingStartTime>Vu&&1073741824!==n&&(t.flags|=128,r=!0,Ys(a,!1),t.lanes=4194304);a.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=a.last)?n.sibling=u:t.child=u,a.last=u)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qe(),t.sibling=null,n=ua.current,Ei(ua,r?1&n|2:1&n),t):(Xs(t),null);case 22:case 23:return fl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ou)&&(Xs(t),6&t.subtreeFlags&&(t.flags|=8192)):Xs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function $s(e,t){switch(to(t),t.tag){case 1:return Ai(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return oa(),Pi(Ti),Pi(Ii),da(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return sa(t),null;case 13:if(Pi(ua),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));ho()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Pi(ua),null;case 4:return oa(),null;case 10:return So(t.type._context),null;case 22:case 23:return fl(),null;default:return null}}As=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(){},Ls=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ra(ea.current);var o,a=null;switch(n){case"input":i=$(e,i),r=$(e,r),a=[];break;case"select":i=N({},i,{value:void 0}),r=N({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(c in ye(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var u=i[c];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var l=r[c];if(u=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&l!==u&&(null!=l||null!=u))if("style"===c)if(u){for(o in u)!u.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&u[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(a||(a=[]),a.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(a=a||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Br("scroll",e),a||u===l||(a=[])):(a=a||[]).push(c,l))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},zs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Gs=!1,Qs=!1,Zs="function"===typeof WeakSet?WeakSet:Set,Js=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Pl(e,t,r)}else n.current=null}function tu(e,t,n){try{n()}catch(r){Pl(e,t,r)}}var nu=!1;function ru(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&tu(t,n,o)}i=i.next}while(i!==r)}}function iu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ou(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function au(e){var t=e.alternate;null!==t&&(e.alternate=null,au(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fi],delete t[pi],delete t[vi],delete t[gi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}var du=null,fu=!1;function pu(e,t,n){for(n=n.child;null!==n;)hu(e,t,n),n=n.sibling}function hu(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Qs||eu(n,t);case 6:var r=du,i=fu;du=null,pu(e,t,n),fu=i,null!==(du=r)&&(fu?(e=du,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):du.removeChild(n.stateNode));break;case 18:null!==du&&(fu?(e=du,n=n.stateNode,8===e.nodeType?ui(e.parentNode,n):1===e.nodeType&&ui(e,n),Kt(e)):ui(du,n.stateNode));break;case 4:r=du,i=fu,du=n.stateNode.containerInfo,fu=!0,pu(e,t,n),du=r,fu=i;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&tu(n,t,a),i=i.next}while(i!==r)}pu(e,t,n);break;case 1:if(!Qs&&(eu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Pl(n,t,s)}pu(e,t,n);break;case 21:pu(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,pu(e,t,n),Qs=r):pu(e,t,n);break;default:pu(e,t,n)}}function vu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zs),t.forEach((function(t){var r=Tl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:du=u.stateNode,fu=!1;break e;case 3:case 4:du=u.stateNode.containerInfo,fu=!0;break e}u=u.return}if(null===du)throw Error(o(160));hu(a,s,i),du=null,fu=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(c){Pl(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gu(t,e),yu(e),4&r){try{ru(3,e,e.return),iu(3,e)}catch(g){Pl(e,e.return,g)}try{ru(5,e,e.return)}catch(g){Pl(e,e.return,g)}}break;case 1:gu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return);break;case 5:if(gu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return),32&e.flags){var i=e.stateNode;try{fe(i,"")}catch(g){Pl(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,u=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===u&&"radio"===a.type&&null!=a.name&&Q(i,a),be(u,s);var c=be(u,a);for(s=0;s<l.length;s+=2){var d=l[s],f=l[s+1];"style"===d?ge(i,f):"dangerouslySetInnerHTML"===d?de(i,f):"children"===d?fe(i,f):b(i,d,f,c)}switch(u){case"input":Z(i,a);break;case"textarea":oe(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var h=a.value;null!=h?ne(i,!!a.multiple,h,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(g){Pl(e,e.return,g)}}break;case 6:if(gu(t,e),yu(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Pl(e,e.return,g)}}break;case 3:if(gu(t,e),yu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Kt(t.containerInfo)}catch(g){Pl(e,e.return,g)}break;case 4:default:gu(t,e),yu(e);break;case 13:gu(t,e),yu(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Ku=Qe())),4&r&&vu(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(c=Qs)||d,gu(t,e),Qs=c):gu(t,e),yu(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for(Js=e,d=e.child;null!==d;){for(f=Js=d;null!==Js;){switch(h=(p=Js).child,p.tag){case 0:case 11:case 14:case 15:ru(4,p,p.return);break;case 1:eu(p,p.return);var v=p.stateNode;if("function"===typeof v.componentWillUnmount){r=p,n=p.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Pl(r,n,g)}}break;case 5:eu(p,p.return);break;case 22:if(null!==p.memoizedState){ku(f);continue}}null!==h?(h.return=p,Js=h):ku(f)}d=d.sibling}e:for(d=null,f=e;;){if(5===f.tag){if(null===d){d=f;try{i=f.stateNode,c?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(u=f.stateNode,s=void 0!==(l=f.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,u.style.display=ve("display",s))}catch(g){Pl(e,e.return,g)}}}else if(6===f.tag){if(null===d)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(g){Pl(e,e.return,g)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gu(t,e),yu(e),4&r&&vu(e);case 21:}}function yu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(fe(i,""),r.flags&=-33),cu(e,uu(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;lu(e,uu(e),a);break;default:throw Error(o(161))}}catch(s){Pl(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bu(e,t,n){Js=e,wu(e,t,n)}function wu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var i=Js,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Gs;if(!a){var s=i.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=Gs;var l=Qs;if(Gs=a,(Qs=u)&&!l)for(Js=i;null!==Js;)u=(a=Js).child,22===a.tag&&null!==a.memoizedState?Su(i):null!==u?(u.return=a,Js=u):Su(i);for(;null!==o;)Js=o,wu(o,t,n),o=o.sibling;Js=i,Gs=s,Qs=l}xu(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Js=o):xu(e)}}function xu(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||iu(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:mo(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Bo(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bo(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var f=d.dehydrated;null!==f&&Kt(f)}}}break;default:throw Error(o(163))}Qs||512&t.flags&&ou(t)}catch(p){Pl(t,t.return,p)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function ku(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function Su(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{iu(4,t)}catch(u){Pl(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(u){Pl(t,i,u)}}var o=t.return;try{ou(t)}catch(u){Pl(t,o,u)}break;case 5:var a=t.return;try{ou(t)}catch(u){Pl(t,a,u)}}}catch(u){Pl(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var _u,Pu=Math.ceil,Eu=w.ReactCurrentDispatcher,Cu=w.ReactCurrentOwner,Iu=w.ReactCurrentBatchConfig,Tu=0,Mu=null,ju=null,Au=0,Ou=0,Lu=_i(0),zu=0,Du=null,Nu=0,Ru=0,Bu=0,Fu=null,Uu=null,Ku=0,Vu=1/0,Wu=null,Hu=!1,Yu=null,Xu=null,qu=!1,$u=null,Gu=0,Qu=0,Zu=null,Ju=-1,el=0;function tl(){return 0!==(6&Tu)?Qe():-1!==Ju?Ju:Ju=Qe()}function nl(e){return 0===(1&e.mode)?1:0!==(2&Tu)&&0!==Au?Au&-Au:null!==go.transition?(0===el&&(el=vt()),el):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Gt(e.type)}function rl(e,t,n,r){if(50<Qu)throw Qu=0,Zu=null,Error(o(185));mt(e,n,r),0!==(2&Tu)&&e===Mu||(e===Mu&&(0===(2&Tu)&&(Ru|=n),4===zu&&ul(e,Au)),il(e,r),1===n&&0===Tu&&0===(1&t.mode)&&(Vu=Qe()+500,Bi&&Ki()))}function il(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,u=i[a];-1===u?0!==(s&n)&&0===(s&r)||(i[a]=pt(s,t)):u<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=ft(e,e===Mu?Au:0);if(0===r)null!==n&&qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&qe(n),1===t)0===e.tag?function(e){Bi=!0,Ui(e)}(ll.bind(null,e)):Ui(ll.bind(null,e)),ai((function(){0===(6&Tu)&&Ki()})),n=null;else{switch(wt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ml(n,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ol(e,t){if(Ju=-1,el=0,0!==(6&Tu))throw Error(o(327));var n=e.callbackNode;if(Sl()&&e.callbackNode!==n)return null;var r=ft(e,e===Mu?Au:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=ml(e,r);else{t=r;var i=Tu;Tu|=2;var a=vl();for(Mu===e&&Au===t||(Wu=null,Vu=Qe()+500,pl(e,t));;)try{bl();break}catch(u){hl(e,u)}ko(),Eu.current=a,Tu=i,null!==ju?t=0:(Mu=null,Au=0,t=zu)}if(0!==t){if(2===t&&(0!==(i=ht(e))&&(r=i,t=al(e,i))),1===t)throw n=Du,pl(e,0),ul(e,r),il(e,Qe()),n;if(6===t)ul(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=ml(e,r))&&(0!==(a=ht(e))&&(r=a,t=al(e,a))),1===t))throw n=Du,pl(e,0),ul(e,r),il(e,Qe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:kl(e,Uu,Wu);break;case 3:if(ul(e,r),(130023424&r)===r&&10<(t=Ku+500-Qe())){if(0!==ft(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(kl.bind(null,e,Uu,Wu),t);break}kl(e,Uu,Wu);break;case 4:if(ul(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pu(r/1960))-r)){e.timeoutHandle=ri(kl.bind(null,e,Uu,Wu),r);break}kl(e,Uu,Wu);break;default:throw Error(o(329))}}}return il(e,Qe()),e.callbackNode===n?ol.bind(null,e):null}function al(e,t){var n=Fu;return e.current.memoizedState.isDehydrated&&(pl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=Uu,Uu=n,null!==t&&sl(t)),e}function sl(e){null===Uu?Uu=e:Uu.push.apply(Uu,e)}function ul(e,t){for(t&=~Bu,t&=~Ru,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function ll(e){if(0!==(6&Tu))throw Error(o(327));Sl();var t=ft(e,0);if(0===(1&t))return il(e,Qe()),null;var n=ml(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=al(e,r))}if(1===n)throw n=Du,pl(e,0),ul(e,t),il(e,Qe()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kl(e,Uu,Wu),il(e,Qe()),null}function cl(e,t){var n=Tu;Tu|=1;try{return e(t)}finally{0===(Tu=n)&&(Vu=Qe()+500,Bi&&Ki())}}function dl(e){null!==$u&&0===$u.tag&&0===(6&Tu)&&Sl();var t=Tu;Tu|=1;var n=Iu.transition,r=bt;try{if(Iu.transition=null,bt=1,e)return e()}finally{bt=r,Iu.transition=n,0===(6&(Tu=t))&&Ki()}}function fl(){Ou=Lu.current,Pi(Lu)}function pl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==ju)for(n=ju.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:oa(),Pi(Ti),Pi(Ii),da();break;case 5:sa(r);break;case 4:oa();break;case 13:case 19:Pi(ua);break;case 10:So(r.type._context);break;case 22:case 23:fl()}n=n.return}if(Mu=e,ju=e=Ll(e.current,null),Au=Ou=t,zu=0,Du=null,Bu=Ru=Nu=0,Uu=Fu=null,null!==Co){for(t=0;t<Co.length;t++)if(null!==(r=(n=Co[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Co=null}return e}function hl(e,t){for(;;){var n=ju;try{if(ko(),fa.current=as,ya){for(var r=va.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ya=!1}if(ha=0,ma=ga=va=null,ba=!1,wa=0,Cu.current=null,null===n||null===n.return){zu=1,Du=t,ju=null;break}e:{var a=e,s=n.return,u=n,l=t;if(t=Au,u.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l,d=u,f=d.tag;if(0===(1&d.mode)&&(0===f||11===f||15===f)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=ms(s);if(null!==h){h.flags&=-257,ys(h,s,u,0,t),1&h.mode&&gs(a,c,t),l=c;var v=(t=h).updateQueue;if(null===v){var g=new Set;g.add(l),t.updateQueue=g}else v.add(l);break e}if(0===(1&t)){gs(a,c,t),gl();break e}l=Error(o(426))}else if(io&&1&u.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ys(m,s,u,0,t),vo(cs(l,u));break e}}a=l=cs(l,u),4!==zu&&(zu=2),null===Fu?Fu=[a]:Fu.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,No(a,hs(0,l,t));break e;case 1:u=l;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Xu||!Xu.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,No(a,vs(a,u,t));break e}}a=a.return}while(null!==a)}xl(n)}catch(w){t=w,ju===n&&null!==n&&(ju=n=n.return);continue}break}}function vl(){var e=Eu.current;return Eu.current=as,null===e?as:e}function gl(){0!==zu&&3!==zu&&2!==zu||(zu=4),null===Mu||0===(268435455&Nu)&&0===(268435455&Ru)||ul(Mu,Au)}function ml(e,t){var n=Tu;Tu|=2;var r=vl();for(Mu===e&&Au===t||(Wu=null,pl(e,t));;)try{yl();break}catch(i){hl(e,i)}if(ko(),Tu=n,Eu.current=r,null!==ju)throw Error(o(261));return Mu=null,Au=0,zu}function yl(){for(;null!==ju;)wl(ju)}function bl(){for(;null!==ju&&!$e();)wl(ju)}function wl(e){var t=_u(e.alternate,e,Ou);e.memoizedProps=e.pendingProps,null===t?xl(e):ju=t,Cu.current=null}function xl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=qs(n,t,Ou)))return void(ju=n)}else{if(null!==(n=$s(n,t)))return n.flags&=32767,void(ju=n);if(null===e)return zu=6,void(ju=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(ju=t);ju=t=e}while(null!==t);0===zu&&(zu=5)}function kl(e,t,n){var r=bt,i=Iu.transition;try{Iu.transition=null,bt=1,function(e,t,n,r){do{Sl()}while(null!==$u);if(0!==(6&Tu))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,a),e===Mu&&(ju=Mu=null,Au=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||qu||(qu=!0,Ml(tt,(function(){return Sl(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Iu.transition,Iu.transition=null;var s=bt;bt=1;var u=Tu;Tu|=4,Cu.current=null,function(e,t){if(ei=Wt,pr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break e}var s=0,u=-1,l=-1,c=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==n||0!==i&&3!==f.nodeType||(u=s+i),f!==a||0!==r&&3!==f.nodeType||(l=s+r),3===f.nodeType&&(s+=f.nodeValue.length),null!==(h=f.firstChild);)p=f,f=h;for(;;){if(f===e)break t;if(p===n&&++c===i&&(u=s),p===a&&++d===r&&(l=s),null!==(h=f.nextSibling))break;p=(f=p).parentNode}f=h}n=-1===u||-1===l?null:{start:u,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var g=v.memoizedProps,m=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:mo(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(o(163))}}catch(x){Pl(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}v=nu,nu=!1}(e,n),mu(n,e),hr(ti),Wt=!!ei,ti=ei=null,e.current=n,bu(n,e,i),Ge(),Tu=u,bt=s,Iu.transition=a}else e.current=n;if(qu&&(qu=!1,$u=e,Gu=i),a=e.pendingLanes,0===a&&(Xu=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),il(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hu)throw Hu=!1,e=Yu,Yu=null,e;0!==(1&Gu)&&0!==e.tag&&Sl(),a=e.pendingLanes,0!==(1&a)?e===Zu?Qu++:(Qu=0,Zu=e):Qu=0,Ki()}(e,t,n,r)}finally{Iu.transition=i,bt=r}return null}function Sl(){if(null!==$u){var e=wt(Gu),t=Iu.transition,n=bt;try{if(Iu.transition=null,bt=16>e?16:e,null===$u)var r=!1;else{if(e=$u,$u=null,Gu=0,0!==(6&Tu))throw Error(o(331));var i=Tu;for(Tu|=4,Js=e.current;null!==Js;){var a=Js,s=a.child;if(0!==(16&Js.flags)){var u=a.deletions;if(null!==u){for(var l=0;l<u.length;l++){var c=u[l];for(Js=c;null!==Js;){var d=Js;switch(d.tag){case 0:case 11:case 15:ru(8,d,a)}var f=d.child;if(null!==f)f.return=d,Js=f;else for(;null!==Js;){var p=(d=Js).sibling,h=d.return;if(au(d),d===c){Js=null;break}if(null!==p){p.return=h,Js=p;break}Js=h}}}var v=a.alternate;if(null!==v){var g=v.child;if(null!==g){v.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}Js=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Js=s;else e:for(;null!==Js;){if(0!==(2048&(a=Js).flags))switch(a.tag){case 0:case 11:case 15:ru(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Js=y;break e}Js=a.return}}var b=e.current;for(Js=b;null!==Js;){var w=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Js=w;else e:for(s=b;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:iu(9,u)}}catch(k){Pl(u,u.return,k)}if(u===s){Js=null;break e}var x=u.sibling;if(null!==x){x.return=u.return,Js=x;break e}Js=u.return}}if(Tu=i,Ki(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(k){}r=!0}return r}finally{bt=n,Iu.transition=t}}return!1}function _l(e,t,n){e=zo(e,t=hs(0,t=cs(n,t),1),1),t=tl(),null!==e&&(mt(e,1,t),il(e,t))}function Pl(e,t,n){if(3===e.tag)_l(e,e,n);else for(;null!==t;){if(3===t.tag){_l(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Xu||!Xu.has(r))){t=zo(t,e=vs(t,e=cs(n,e),1),1),e=tl(),null!==t&&(mt(t,1,e),il(t,e));break}}t=t.return}}function El(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&n,Mu===e&&(Au&n)===n&&(4===zu||3===zu&&(130023424&Au)===Au&&500>Qe()-Ku?pl(e,0):Bu|=n),il(e,t)}function Cl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=tl();null!==(e=Mo(e,t))&&(mt(e,t,n),il(e,n))}function Il(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cl(e,n)}function Tl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Cl(e,n)}function Ml(e,t){return Xe(e,t)}function jl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Al(e,t,n,r){return new jl(e,t,n,r)}function Ol(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ll(e,t){var n=e.alternate;return null===n?((n=Al(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function zl(e,t,n,r,i,a){var s=2;if(r=e,"function"===typeof e)Ol(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Dl(n.children,i,a,t);case _:s=8,i|=8;break;case P:return(e=Al(12,n,t,2|i)).elementType=P,e.lanes=a,e;case T:return(e=Al(13,n,t,i)).elementType=T,e.lanes=a,e;case M:return(e=Al(19,n,t,i)).elementType=M,e.lanes=a,e;case O:return Nl(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:s=10;break e;case C:s=9;break e;case I:s=11;break e;case j:s=14;break e;case A:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Al(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Dl(e,t,n,r){return(e=Al(7,e,r,t)).lanes=n,e}function Nl(e,t,n,r){return(e=Al(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Rl(e,t,n){return(e=Al(6,e,null,t)).lanes=n,e}function Bl(e,t,n){return(t=Al(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fl(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ul(e,t,n,r,i,o,a,s,u){return e=new Fl(e,t,n,s,u),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Al(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ao(o),e}function Kl(e){if(!e)return Ci;e:{if(Ke(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ai(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ai(n))return zi(e,n,t)}return t}function Vl(e,t,n,r,i,o,a,s,u){return(e=Ul(n,r,!0,e,0,o,0,s,u)).context=Kl(null),n=e.current,(o=Lo(r=tl(),i=nl(n))).callback=void 0!==t&&null!==t?t:null,zo(n,o,i),e.current.lanes=i,mt(e,i,r),il(e,r),e}function Wl(e,t,n,r){var i=t.current,o=tl(),a=nl(i);return n=Kl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Lo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zo(i,t,a))&&(rl(e,i,a,o),Do(e,i,a)),a}function Hl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Yl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Xl(e,t){Yl(e,t),(e=e.alternate)&&Yl(e,t)}_u=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ti.current)ws=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ws=!1,function(e,t,n){switch(t.tag){case 3:Ms(t),ho();break;case 5:aa(t);break;case 1:Ai(t.type)&&Di(t);break;case 4:ia(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ei(yo,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ei(ua,1&ua.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Rs(e,t,n):(Ei(ua,1&ua.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ei(ua,1&ua.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ei(ua,ua.current),r)break;return null;case 22:case 23:return t.lanes=0,Ps(e,t,n)}return Hs(e,t,n)}(e,t,n);ws=0!==(131072&e.flags)}else ws=!1,io&&0!==(1048576&t.flags)&&Ji(t,Yi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ws(e,t),e=t.pendingProps;var i=ji(t,Ii.current);Po(t,n),i=_a(null,t,r,e,i,n);var a=Pa();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ai(r)?(a=!0,Di(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ao(t),i.updater=Ko,t.stateNode=i,i._reactInternals=t,Yo(t,r,e,n),t=Ts(null,t,r,!0,a,n)):(t.tag=0,io&&a&&eo(t),xs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ws(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Ol(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===j)return 14}return 2}(r),e=mo(r,e),i){case 0:t=Cs(null,t,r,e,n);break e;case 1:t=Is(null,t,r,e,n);break e;case 11:t=ks(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,mo(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Cs(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 1:return r=t.type,i=t.pendingProps,Is(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 3:e:{if(Ms(t),null===e)throw Error(o(387));r=t.pendingProps,i=(a=t.memoizedState).element,Oo(e,t),Ro(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=js(e,t,r,n,i=cs(Error(o(423)),t));break e}if(r!==i){t=js(e,t,r,n,i=cs(Error(o(424)),t));break e}for(ro=li(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=Zo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ho(),r===i){t=Hs(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 5:return aa(t),null===e&&lo(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(t.flags|=32),Es(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&lo(t),null;case 13:return Rs(e,t,n);case 4:return ia(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Qo(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ks(e,t,r,i=t.elementType===r?i:mo(r,i),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Ei(yo,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!Ti.current){t=Hs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var u=a.dependencies;if(null!==u){s=a.child;for(var l=u.firstContext;null!==l;){if(l.context===r){if(1===a.tag){(l=Lo(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),_o(a.return,n,t),u.lanes|=n;break}l=l.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),_o(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Po(t,n),r=r(i=Eo(i)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return i=mo(r=t.type,t.pendingProps),Ss(e,t,r,i=mo(r.type,i),n);case 15:return _s(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:mo(r,i),Ws(e,t),t.tag=1,Ai(r)?(e=!0,Di(t)):e=!1,Po(t,n),Wo(t,r,i),Yo(t,r,i,n),Ts(null,t,r,!0,e,n);case 19:return Vs(e,t,n);case 22:return Ps(e,t,n)}throw Error(o(156,t.tag))};var ql="function"===typeof reportError?reportError:function(e){console.error(e)};function $l(e){this._internalRoot=e}function Gl(e){this._internalRoot=e}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jl(){}function ec(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=Hl(a);s.call(e)}}Wl(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Hl(a);o.call(e)}}var a=Vl(t,r,e,0,null,!1,0,"",Jl);return e._reactRootContainer=a,e[hi]=a.current,Kr(8===e.nodeType?e.parentNode:e),dl(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Hl(u);s.call(e)}}var u=Ul(e,0,!1,null,0,!1,0,"",Jl);return e._reactRootContainer=u,e[hi]=u.current,Kr(8===e.nodeType?e.parentNode:e),dl((function(){Wl(t,u,n,r)})),u}(n,t,e,i,r);return Hl(a)}Gl.prototype.render=$l.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Wl(e,t,null,null)},Gl.prototype.unmount=$l.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl((function(){Wl(null,e,null,null)})),t[hi]=null}},Gl.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Nt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),il(t,Qe()),0===(6&Tu)&&(Vu=Qe()+500,Ki()))}break;case 13:dl((function(){var t=Mo(e,1);if(null!==t){var n=tl();rl(t,e,1,n)}})),Xl(e,1)}},kt=function(e){if(13===e.tag){var t=Mo(e,134217728);if(null!==t)rl(t,e,134217728,tl());Xl(e,134217728)}},St=function(e){if(13===e.tag){var t=nl(e),n=Mo(e,t);if(null!==n)rl(n,e,t,tl());Xl(e,t)}},_t=function(){return bt},Pt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=xi(r);if(!i)throw Error(o(90));X(r),Z(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=cl,Te=dl;var tc={usingClientEntryPoint:!1,Events:[bi,wi,xi,Ee,Ce,cl]},nc={findFiberByHostInstance:yi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{it=ic.inject(rc),ot=ic}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ql(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Ql(e))throw Error(o(299));var n=!1,r="",i=ql;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Ul(e,1,!1,null,0,n,0,r,i),e[hi]=t.current,Kr(8===e.nodeType?e.parentNode:e),new $l(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!Zl(t))throw Error(o(200));return ec(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Ql(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=ql;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Vl(t,null,e,1,null!=n?n:null,i,0,a,s),e[hi]=t.current,Kr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Gl(t)},t.render=function(e,t,n){if(!Zl(t))throw Error(o(200));return ec(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zl(e))throw Error(o(40));return!!e._reactRootContainer&&(dl((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[hi]=null}))})),!0)},t.unstable_batchedUpdates=cl,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zl(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return ec(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1739:function(e,t,n){"use strict";var r=n(1168);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},1168:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(534)},5918:function(e,t,n){"use strict";var r=n(7313),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,o={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!u.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:c,props:o,_owner:s.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},306:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||h}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||h}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var w=b.prototype=new y;w.constructor=b,v(w,m.prototype),w.isPureReactComponent=!0;var x=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,r){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)k.call(t,i)&&!_.hasOwnProperty(i)&&(o[i]=t[i]);var u=arguments.length-2;if(1===u)o.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];o.children=l}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===o[i]&&(o[i]=u[i]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:S.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return a=a(u=e),e=""===o?"."+I(u,0):o,x(a)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),T(a,t,i,"",(function(e){return e}))):null!=a&&(E(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+e)),t.push(a)),1;if(u=0,o=""===o?".":o+":",x(e))for(var l=0;l<e.length;l++){var c=o+I(s=e[l],l);u+=T(s,t,i,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=T(s=s.value,t,i,c=o+I(s,l++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function M(e,t,n){if(null==e)return e;var r=[],i=0;return T(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},O={transition:null},L={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=o,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=S.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)k.call(t,l)&&!_.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){u=Array(l);for(var c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}return{$$typeof:n,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=P,t.createFactory=function(e){var t=P.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.2.0"},7313:function(e,t,n){"use strict";e.exports=n(306)},6417:function(e,t,n){"use strict";e.exports=n(5918)},3095:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,u=e[s],l=s+1,c=e[l];if(0>o(u,n))l<i&&0>o(c,u)?(e[r]=c,e[l]=n,r=l):(e[r]=u,e[s]=n,r=s);else{if(!(l<i&&0>o(c,n)))break e;e[r]=c,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var l=[],c=[],d=1,f=null,p=3,h=!1,v=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(l,t)}t=r(c)}}function x(e){if(g=!1,w(e),!v)if(null!==r(l))v=!0,O(k);else{var t=r(c);null!==t&&L(x,t.startTime-e)}}function k(e,n){v=!1,g&&(g=!1,y(E),E=-1),h=!0;var o=p;try{for(w(n),f=r(l);null!==f&&(!(f.expirationTime>n)||e&&!T());){var a=f.callback;if("function"===typeof a){f.callback=null,p=f.priorityLevel;var s=a(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?f.callback=s:f===r(l)&&i(l),w(n)}else i(l);f=r(l)}if(null!==f)var u=!0;else{var d=r(c);null!==d&&L(x,d.startTime-n),u=!1}return u}finally{f=null,p=o,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,_=!1,P=null,E=-1,C=5,I=-1;function T(){return!(t.unstable_now()-I<C)}function M(){if(null!==P){var e=t.unstable_now();I=e;var n=!0;try{n=P(!0,e)}finally{n?S():(_=!1,P=null)}}else _=!1}if("function"===typeof b)S=function(){b(M)};else if("undefined"!==typeof MessageChannel){var j=new MessageChannel,A=j.port2;j.port1.onmessage=M,S=function(){A.postMessage(null)}}else S=function(){m(M,0)};function O(e){P=e,_||(_=!0,S())}function L(e,n){E=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||h||(v=!0,O(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(c,e),null===r(l)&&e===r(c)&&(g?(y(E),E=-1):g=!0,L(x,o-a))):(e.sortIndex=s,n(l,e),v||h||(v=!0,O(k))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},2224:function(e,t,n){"use strict";e.exports=n(3095)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return r[e]}}));return a.default=function(){return r},n.d(o,a),o}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".f64a5f0e.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="tldraw-cra-example:";n.l=function(r,i,o,a){if(e[r])e[r].push(i);else{var s,u;if(void 0!==o)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=r),e[r]=[i];var f=function(t,n){s.onerror=s.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/",function(){var e={179:0};n.f.j=function(t,r){var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise((function(n,r){i=e[t]=[n,r]}));r.push(i[2]=o);var a=n.p+n.u(t),s=new Error;n.l(a,(function(r){if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var i,o,a=r[0],s=r[1],u=r[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(u)u(n)}for(t&&t(r);l<a.length;l++)o=a[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunktldraw_cra_example=self.webpackChunktldraw_cra_example||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),n.nc=void 0,function(){"use strict";var e={};n.r(e),n.d(e,{ArrayOfValidator:function(){return Dt},DictValidator:function(){return Bt},ObjectValidator:function(){return Nt},UnionValidator:function(){return Rt},ValidationError:function(){return At},Validator:function(){return zt},any:function(){return Kt},array:function(){return Jt},arrayOf:function(){return en},bigint:function(){return Qt},boolean:function(){return Gt},dict:function(){return sn},integer:function(){return Xt},jsonDict:function(){return an},jsonValue:function(){return on},literal:function(){return Zt},literalEnum:function(){return pn},model:function(){return ln},nonZeroInteger:function(){return $t},nonZeroNumber:function(){return Yt},nullable:function(){return fn},number:function(){return Wt},object:function(){return nn},optional:function(){return dn},positiveInteger:function(){return qt},positiveNumber:function(){return Ht},setEnum:function(){return cn},string:function(){return Vt},union:function(){return un},unknown:function(){return Ut},unknownObject:function(){return tn}});var t=n(7313),r=n.t(t,2),i=n(1739);function o(e){if(Array.isArray(e))return e}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){return o(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||s(e,t)||u()}n(8442),n(9575),n(9149),n(5671),n(4541),n(4113);function c(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){return function(e){if(Array.isArray(e))return a(e)}(e)||c(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){return o(e)||c(e)||s(e)||u()}var p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",h="a0",v="A00000000000000000000000000";function g(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-"a".charCodeAt(0)+2;if(e>="A"&&e<="Z")return"Z".charCodeAt(0)-e.charCodeAt(0)+2;throw new Error("Invalid index key head: "+e)}function m(e){if(e.length!==g(e.charAt(0)))throw new Error("invalid integer part of index key: "+e)}function y(e){if(void 0===e)throw Error("n is undefined")}function b(e){m(e);for(var t=f(e.split("")),n=t[0],r=t.slice(1),i=!0,o=r.length-1;i&&o>=0;o--){var a=p.indexOf(r[o])+1;a===p.length?r[o]="0":(r[o]=p.charAt(a),i=!1)}if(i){if("Z"===n)return"a0";if("z"===n)return;var s=String.fromCharCode(n.charCodeAt(0)+1);return s>"a"?r.push("0"):r.pop(),s+r.join("")}return n+r.join("")}function w(e,t){if(void 0!==t&&e>=t)throw new Error(e+" >= "+t);if("0"===e.slice(-1)||t&&"0"===t.slice(-1))throw new Error("trailing zero");if(t){for(var n=0;(e.charAt(n)||"0")===t.charAt(n);)n++;if(n>0)return t.slice(0,n)+w(e.slice(n),t.slice(n))}var r=e?p.indexOf(e.charAt(0)):0,i=void 0!==t?p.indexOf(t.charAt(0)):p.length;if(i-r>1){var o=Math.round(.5*(r+i));return p.charAt(o)}return t&&t.length>1?t.slice(0,1):p.charAt(r)+w(e.slice(1),void 0)}function x(e){var t=g(e.charAt(0));if(t>e.length)throw new Error("invalid index: "+e);return e.slice(0,t)}function k(e){if(e===v)throw new Error("invalid index: "+e);var t=x(e);if("0"===e.slice(t.length).slice(-1))throw new Error("invalid index: "+e)}function S(e,t){if(void 0!==e&&k(e),void 0!==t&&k(t),void 0!==e&&void 0!==t&&e>=t)throw new Error(e+" >= "+t);if(void 0===e&&void 0===t)return h;if(void 0===e){if(void 0===t)throw Error("b is undefined");var n=x(t),r=t.slice(n.length);if(n===v)return n+w("",r);if(n<t)return n;var i=function(e){m(e);for(var t=f(e.split("")),n=t[0],r=t.slice(1),i=!0,o=r.length-1;i&&o>=0;o--){var a=p.indexOf(r[o])-1;-1===a?r[o]=p.slice(-1):(r[o]=p.charAt(a),i=!1)}if(i){if("a"===n)return"Z"+p.slice(-1);if("A"===n)return;var s=String.fromCharCode(n.charCodeAt(0)-1);return s<"Z"?r.push(p.slice(-1)):r.pop(),s+r.join("")}return n+r.join("")}(n);return y(i),i}if(void 0===t){var o=x(e),a=e.slice(o.length),s=b(o);return void 0===s?o+w(a,void 0):s}var u=x(e),l=e.slice(u.length),c=x(t),d=t.slice(c.length);if(u===c)return u+w(l,d);var g=b(u);return y(g),g<t?g:u+w(l,void 0)}function _(e,t,n){if(0===n)return[];if(1===n)return[S(e,t)];if(void 0===t){for(var r=S(e,t),i=[r],o=0;o<n-1;o++)r=S(r,t),i.push(r);return i}if(void 0===e){for(var a=S(e,t),s=[a],u=0;u<n-1;u++)a=S(e,a),s.push(a);return s.reverse(),s}var l=Math.floor(n/2),c=S(e,t);return[].concat(d(_(e,c,l)),[c],d(_(c,t,n-l-1)))}function P(e,t,n){return _(e,t,n)}function E(e,t){return _(e,void 0,t)}function C(e,t){return _(e,t,1)[0]}function I(e){return _(e,void 0,1)[0]}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"a1";return[t].concat(d(_(t,void 0,e)))}function M(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function O(e){var t=function(e,t){if("object"!==A(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===A(t)?t:String(t)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}function z(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function D(e,t,n){return(t=O(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=function(){function e(){j(this,e),D(this,"arraySize",0),D(this,"array",Array(8)),D(this,"set",null)}return z(e,[{key:"isEmpty",get:function(){if(this.array)return 0===this.arraySize;if(this.set)return 0===this.set.size;throw new Error("no set or array")}},{key:"add",value:function(e){if(this.array)return-1===this.array.indexOf(e)&&(this.arraySize<8?(this.array[this.arraySize]=e,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(e),!0));if(this.set)return!this.set.has(e)&&(this.set.add(e),!0);throw new Error("no set or array")}},{key:"remove",value:function(e){if(this.array){var t=this.array.indexOf(e);return-1!==t&&(this.array[t]=void 0,this.arraySize--,t!==this.arraySize&&(this.array[t]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return!!this.set.has(e)&&(this.set.delete(e),!0);throw new Error("no set or array")}},{key:"visit",value:function(e){if(this.array)for(var t=0;t<this.arraySize;t++){var n=this.array[t];"undefined"!==typeof n&&e(n)}else{if(!this.set)throw new Error("no set or array");this.set.forEach(e)}}}]),e}();function R(e){return e&&"object"===typeof e&&"parents"in e}function B(e){for(var t=0,n=e.parents.length;t<n;t++)if(e.parents[t].__unsafe__getWithoutCapture(),e.parents[t].lastChangedEpoch!==e.parentEpochs[t])return!0;return!1}var F=function e(t,n){if(t.children.remove(n)&&t.children.isEmpty&&R(t))for(var r=0,i=t.parents.length;r<i;r++)e(t.parents[r],t)},U=function e(t,n){if(t.children.add(n)&&R(t))for(var r=0,i=t.parents.length;r<i;r++)e(t.parents[r],t)};function K(e,t){return e===t||Object.is(e,t)||Boolean(e&&t&&"function"===typeof e.equals&&e.equals(t))}var V=Object.freeze([]),W=Symbol.for("__@tldraw/state__"),H=globalThis;H[W]?console.error('Multiple versions of @tldraw/state detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of @tldraw/state is loaded.'):H[W]=!0;var Y=z((function e(t,n){j(this,e),D(this,"offset",0),D(this,"numNewParents",0),D(this,"maybeRemoved",void 0),this.below=t,this.child=n})),X=null;function q(e){X=new Y(X,e)}function $(){var e,t=X;if(X=t.below,t.numNewParents>0||t.offset!==t.child.parents.length){for(var n=t.offset;n<t.child.parents.length;n++){var r=t.child.parents[n];t.child.parents.indexOf(r)>=t.offset&&F(r,t.child)}if(t.child.parents.length=t.offset,t.child.parentEpochs.length=t.offset,null!==(e=X)&&void 0!==e&&e.maybeRemoved)for(var i=0;i<X.maybeRemoved.length;i++){var o=X.maybeRemoved[i];-1===t.child.parents.indexOf(o)&&F(o,t.child)}}}function G(e){if(X){var t=X.child.parents.indexOf(e);if(t<0&&(X.numNewParents++,X.child.isActivelyListening&&U(e,X.child)),t<0||t>=X.offset){if(t!==X.offset&&t>0){var n=X.child.parents[X.offset];X.maybeRemoved?-1===X.maybeRemoved.indexOf(n)&&X.maybeRemoved.push(n):X.maybeRemoved=[n]}X.child.parents[X.offset]=e,X.child.parentEpochs[X.offset]=e.lastChangedEpoch,X.offset++}}}var Q=Symbol("RESET_VALUE"),Z=function(){function e(t){j(this,e),D(this,"index",0),D(this,"buffer",void 0),this.capacity=t,this.buffer=new Array(t)}return z(e,[{key:"pushEntry",value:function(e,t,n){void 0!==n&&(n!==Q?(this.buffer[this.index]=[e,t,n],this.index=(this.index+1)%this.capacity):this.clear())}},{key:"clear",value:function(){this.index=0,this.buffer.fill(void 0)}},{key:"getChangesSince",value:function(e){for(var t=this.index,n=this.capacity,r=this.buffer,i=0;i<n;i++){var o=(t-1+n-i)%n,a=r[o];if(!a)return Q;var s=l(a,2),u=s[0],c=s[1];if(0===i&&e>=c)return[];if(u<=e&&e<c){for(var d=i+1,f=new Array(d),p=0;p<d;p++)f[p]=r[(o+p)%n][2];return f}}return Q}}]),e}();function J(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}var ee=-1,te=0,ne=!1;var re=function(){function e(t){j(this,e),D(this,"initialAtomValues",new Map),this.parent=t}return z(e,[{key:"isRoot",get:function(){return null===this.parent}},{key:"commit",value:function(){var e=this;if(this.isRoot){var t=this.initialAtomValues;this.initialAtomValues=new Map,ie(t.keys())}else this.initialAtomValues.forEach((function(t,n){e.parent.initialAtomValues.has(n)||e.parent.initialAtomValues.set(n,t)}))}},{key:"abort",value:function(){te++,this.initialAtomValues.forEach((function(e,t){var n;t.set(e),null===(n=t.historyBuffer)||void 0===n||n.clear()})),this.commit()}}]),e}();function ie(e){if(ne)throw new Error("cannot change atoms during reaction cycle");try{ne=!0;var t,n=new Set,r=function e(t){t.lastTraversedEpoch!==te&&(t.lastTraversedEpoch=te,"maybeScheduleEffect"in t?n.add(t):t.children.visit(e))},i=J(e);try{for(i.s();!(t=i.n()).done;){t.value.children.visit(r)}}catch(s){i.e(s)}finally{i.f()}var o,a=J(n);try{for(a.s();!(o=a.n()).done;){o.value.maybeScheduleEffect()}}catch(s){a.e(s)}finally{a.f()}}finally{ne=!1}}var oe=null;function ae(e){return oe?e():function(e){var t=new re(oe);oe=t;try{var n=!1,r=e((function(){return n=!0}));return n?t.abort():t.commit(),r}catch(ok){throw t.abort(),ok}finally{oe=oe.parent}}(e)}var se=function(){function e(t,n,r){var i;j(this,e),D(this,"isEqual",void 0),D(this,"computeDiff",void 0),D(this,"lastChangedEpoch",te),D(this,"children",new N),D(this,"historyBuffer",void 0),this.name=t,this.current=n,this.isEqual=null!==(i=null===r||void 0===r?void 0:r.isEqual)&&void 0!==i?i:null,r&&(r.historyLength&&(this.historyBuffer=new Z(r.historyLength)),this.computeDiff=r.computeDiff)}return z(e,[{key:"__unsafe__getWithoutCapture",value:function(){return this.current}},{key:"value",get:function(){return G(this),this.current}},{key:"set",value:function(e,t){var n,r,i,o;if(null!==(n=null===(r=this.isEqual)||void 0===r?void 0:r.call(this,this.current,e))&&void 0!==n?n:K(this.current,e))return this.current;(te++,this.historyBuffer)&&this.historyBuffer.pushEntry(this.lastChangedEpoch,te,null!==(i=null!==t&&void 0!==t?t:null===(o=this.computeDiff)||void 0===o?void 0:o.call(this,this.current,e,this.lastChangedEpoch,te))&&void 0!==i?i:Q);this.lastChangedEpoch=te;var a=this.current;return this.current=e,function(e,t){oe?oe.initialAtomValues.has(e)||oe.initialAtomValues.set(e,t):ie([e])}(this,a),e}},{key:"update",value:function(e){return this.set(e(this.current))}},{key:"getDiffSince",value:function(e){var t,n;return G(this),e>=this.lastChangedEpoch?V:null!==(t=null===(n=this.historyBuffer)||void 0===n?void 0:n.getChangesSince(e))&&void 0!==t?t:Q}}]),e}();function ue(e,t,n){return new se(e,t,n)}var le=Symbol("UNINITIALIZED"),ce=function(e){return e===le},de=z((function e(t,n){j(this,e),this.value=t,this.diff=n}));function fe(e,t){return new de(e,t)}var pe=function(){function e(t,n,r){var i;j(this,e),D(this,"lastChangedEpoch",ee),D(this,"lastTraversedEpoch",ee),D(this,"lastCheckedEpoch",ee),D(this,"parents",[]),D(this,"parentEpochs",[]),D(this,"children",new N),D(this,"historyBuffer",void 0),D(this,"state",le),D(this,"computeDiff",void 0),D(this,"isEqual",void 0),this.name=t,this.derive=n,null!==r&&void 0!==r&&r.historyLength&&(this.historyBuffer=new Z(r.historyLength)),this.computeDiff=null===r||void 0===r?void 0:r.computeDiff,this.isEqual=null!==(i=null===r||void 0===r?void 0:r.isEqual)&&void 0!==i?i:K}return z(e,[{key:"isActivelyListening",get:function(){return!this.children.isEmpty}},{key:"__unsafe__getWithoutCapture",value:function(){var e=this.lastChangedEpoch===ee;if(!e&&(this.lastCheckedEpoch===te||!B(this)))return this.lastCheckedEpoch=te,this.state;try{q(this);var t=this.derive(this.state,this.lastCheckedEpoch),n=t instanceof de?t.value:t;if(this.state===le||!this.isEqual(n,this.state)){if(this.historyBuffer&&!e){var r,i,o=t instanceof de?t.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,te,null!==(r=null!==o&&void 0!==o?o:null===(i=this.computeDiff)||void 0===i?void 0:i.call(this,this.state,n,this.lastCheckedEpoch,te))&&void 0!==r?r:Q)}this.lastChangedEpoch=te,this.state=n}return this.lastCheckedEpoch=te,this.state}finally{$()}}},{key:"value",get:function(){var e=this.__unsafe__getWithoutCapture();return G(this),e}},{key:"getDiffSince",value:function(e){var t,n;return this.value,e>=this.lastChangedEpoch?V:null!==(t=null===(n=this.historyBuffer)||void 0===n?void 0:n.getChangesSince(e))&&void 0!==t?t:Q}}]),e}();function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=n.get,i=Symbol.for("__@tldraw/state__computed__"+t);return n.get=function(){var n=this[i];return n||(n=new pe(t,r.bind(this),e),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:n})),n.value},n}function ve(){if(1===arguments.length){var e=arguments[0];return function(t,n,r){return he(e,t,n,r)}}return"string"===typeof arguments[0]?new pe(arguments[0],arguments[1],arguments[2]):he(void 0,arguments[0],arguments[1],arguments[2])}var ge=function(){function e(t,n,r){var i=this;j(this,e),D(this,"_isActivelyListening",!1),D(this,"lastTraversedEpoch",ee),D(this,"lastReactedEpoch",ee),D(this,"_scheduleCount",0),D(this,"parentEpochs",[]),D(this,"parents",[]),D(this,"_scheduleEffect",void 0),D(this,"maybeExecute",(function(){i._isActivelyListening&&i.execute()})),this.name=t,this.runEffect=n,this._scheduleEffect=null===r||void 0===r?void 0:r.scheduleEffect}return z(e,[{key:"isActivelyListening",get:function(){return this._isActivelyListening}},{key:"scheduleCount",get:function(){return this._scheduleCount}},{key:"maybeScheduleEffect",value:function(){this._isActivelyListening&&this.lastReactedEpoch!==te&&(!this.parents.length||B(this)?this.scheduleEffect():this.lastReactedEpoch=te)}},{key:"scheduleEffect",value:function(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}},{key:"attach",value:function(){this._isActivelyListening=!0;for(var e=0,t=this.parents.length;e<t;e++)U(this.parents[e],this)}},{key:"detach",value:function(){this._isActivelyListening=!1;for(var e=0,t=this.parents.length;e<t;e++)F(this.parents[e],this)}},{key:"execute",value:function(){try{q(this);var e=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=te,e}finally{$()}}}]),e}();function me(e,t,n){var r=new ge(e,t,n);return r.attach(),r.scheduleEffect(),function(){r.detach()}}function ye(e,n){var r=t.useRef(n);r.current=n;var i=l(t.useMemo((function(){var t=null,n=new ge("useStateTracking(".concat(e,")"),(function(){var e;return null===(e=r.current)||void 0===e?void 0:e.call(r)}),{scheduleEffect:function(){var e;null===(e=t)||void 0===e||e()}});return[n,function(e){return t=e,function(){t=null}},function(){return n.scheduleCount}]}),[e]),3),o=i[0],a=i[1],s=i[2];return t.useSyncExternalStore(a,s,s),t.useEffect((function(){return o.attach(),o.maybeScheduleEffect(),function(){o.detach()}}),[o]),o.execute()}var be={apply:function(e,t,n){var r,i;return ye(null!==(r=null!==(i=e.displayName)&&void 0!==i?i:e.name)&&void 0!==r?r:"tracked(???)",(function(){return e.apply(t,n)}))}},we=Symbol.for("react.memo"),xe=Symbol.for("react.forward_ref");function ke(e){var n=null,r=e.$$typeof;return r===we&&(n=(e=e.type).compare),r===xe?(0,t.memo)((0,t.forwardRef)(new Proxy(e.render,be))):(0,t.memo)(new Proxy(e,be),n)}function Se(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:V;(0,t.useEffect)((function(){var t=new ge(e,n);return t.attach(),t.execute(),function(){t.detach()}}),r)}function _e(){var e=arguments,n=3===e.length?e[2]:[e[0]],r=3===e.length?e[0]:"useValue(".concat(e[0].name,")"),i=(0,t.useRef)(!0);i.current=!0;var o=(0,t.useMemo)((function(){return 1===e.length?e[0]:ve(r,(function(){if(i.current)return e[1]();try{return e[1]()}catch(t){return{}}}))}),n);try{var a=(0,t.useMemo)((function(){return{subscribe:function(e){return me("useValue(".concat(r,")"),(function(){o.value,e()}))},getSnapshot:function(){return o.value}}}),[o]),s=a.subscribe,u=a.getSnapshot;return(0,t.useSyncExternalStore)(s,u,u)}finally{i.current=!1}}var Pe=function(){function e(t){j(this,e),D(this,"nextValue",void 0),D(this,"diff",void 0),this.previousValue=t}return z(e,[{key:"get",value:function(){var e,t,n,r,i,o,a=null!==(e=null===(t=this.diff)||void 0===t||null===(n=t.removed)||void 0===n?void 0:n.size)&&void 0!==e?e:0,s=null!==(r=null===(i=this.diff)||void 0===i||null===(o=i.added)||void 0===o?void 0:o.size)&&void 0!==r?r:0;if(0!==a||0!==s)return{value:this.nextValue,diff:this.diff}}},{key:"_add",value:function(e,t){var n,r,i,o,a;(null!==(n=this.nextValue)&&void 0!==n||(this.nextValue=new Set(this.previousValue)),this.nextValue.add(e),null!==(r=this.diff)&&void 0!==r||(this.diff={}),t)?null===(i=this.diff.removed)||void 0===i||i.delete(e):(null!==(a=(o=this.diff).added)&&void 0!==a||(o.added=new Set),this.diff.added.add(e))}},{key:"add",value:function(e){var t,n=this.previousValue.has(e);if(n){var r,i;if(!(null===(r=this.diff)||void 0===r||null===(i=r.removed)||void 0===i?void 0:i.has(e)))return;return this._add(e,n)}(null===(t=this.nextValue)||void 0===t?void 0:t.has(e))||this._add(e,n)}},{key:"_remove",value:function(e,t){var n,r,i,o,a;(null!==(n=this.nextValue)&&void 0!==n||(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(e),null!==(r=this.diff)&&void 0!==r||(this.diff={}),t)?(null!==(o=(i=this.diff).removed)&&void 0!==o||(i.removed=new Set),this.diff.removed.add(e)):null===(a=this.diff.added)||void 0===a||a.delete(e)}},{key:"remove",value:function(e){var t,n,r=this.previousValue.has(e);if(!r){var i,o;if(!(null===(i=this.diff)||void 0===i||null===(o=i.added)||void 0===o?void 0:o.has(e)))return;return this._remove(e,r)}(null===(t=this.diff)||void 0===t||null===(n=t.removed)||void 0===n?void 0:n.has(e))||this._remove(e,r)}}]),e}();function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e,t){var n,r=[],i=J(e);try{e:for(i.s();!(n=i.n()).done;){var o,a=n.value,s=J(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(t?t(a,u):a===u)continue e}}catch(l){s.e(l)}finally{s.f()}r.push(a)}}catch(l){i.e(l)}finally{i.f()}return r}function Te(e){return e.filter((function(e){return void 0!==e&&null!==e}))}function Me(e){return e[e.length-1]}function je(e,t){var n,r,i=1/0,o=J(e);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=t(a);s<i&&(n=a,i=s)}}catch(u){o.e(u)}finally{o.f()}return n}function Ae(e){return function t(){try{return e.apply(void 0,arguments)}catch(n){throw n instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(n,t),n}}}function Oe(e,t){var n=t&&e&&"object"===typeof e&&t in e?e[t]:e;throw new Error("Unknown switch case ".concat(n))}var Le=Ae((function(e,t){if(!e)throw new Error(t||"Assertion Error")})),ze=Ae((function(e,t){if(null==e)throw new Error(null!==t&&void 0!==t?t:"value must be defined");return e}));function De(e,t){var n=void 0,r=function(){n||((n={}).promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))),clearTimeout(n.timeout);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return n.latestArgs=i,n.timeout=setTimeout((function(){var t=n;n=void 0;try{t.resolve(e.apply(void 0,d(t.latestArgs)))}catch(ok){t.reject(ok)}}),t),n.promise};return r.cancel=function(){n&&clearTimeout(n.timeout)},r}var Ne=new WeakMap;function Re(e,t){if("object"===typeof e&&null!==e){var n=Ne.get(e);n||(n={tags:{},extras:{}},Ne.set(e,n)),t.tags&&(n.tags=Ce(Ce({},n.tags),t.tags)),t.extras&&(n.extras=Ce(Ce({},n.extras),t.extras))}}function Be(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t+""}function Fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0,n=0,r=0,i=0;function o(){var e=t^t<<11;return t=n,n=r,r=i,(i^=(i>>>19^e^e>>>8)>>>0)/4294967296*2}for(var a=0;a<e.length+64;a++)t^=0|e.charCodeAt(a),o();return o}function Ue(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=l(t,2),o=i[0],a=i[1],s=l(n,2),u=s[0],c=s[1],d=u+(e-o)/(a-o)*(c-u);return r?u<c?Math.max(Math.min(d,c),u):Math.max(Math.min(d,u),c):d}function Ke(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ve(e,t){if(Ke(e,t))return e[t]}function We(e){if(!e)return e;if(Array.isArray(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(We(e[r]));return t}if("object"===typeof e){for(var i=Object.keys(e),o=i.length,a={},s=0;s<o;s++){var u=i[s];a[u]=We(e[u])}return a}return e}function He(e){return Object.keys(e)}function Ye(e){return Object.values(e)}function Xe(e){return Object.entries(e)}function qe(e){return Object.fromEntries(e)}function $e(e,t){var n,r={},i=!1,o=J(Xe(e));try{for(o.s();!(n=o.n()).done;){var a=l(n.value,2),s=a[0],u=a[1];t(s,u)?r[s]=u:i=!0}}catch(c){o.e(c)}finally{o.f()}return i?r:e}function Ge(e,t){var n,r={},i=J(Xe(e));try{for(i.s();!(n=i.n()).done;){var o=l(n.value,2),a=o[0],s=t(a,o[1]);r[a]=s}}catch(u){i.e(u)}finally{i.f()}return r}var Qe,Ze=function(){return"undefined"!==typeof process&&!1},Je=[],et=function(){var e,t=J(Je.splice(0,Je.length));try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}};function tt(){Qe||(Qe=requestAnimationFrame((function(){Qe=void 0,et()})))}function nt(e,t){return e.id>t.id?1:-1}function rt(e){return null!==e}var it="undefined"!==typeof window&&window.structuredClone?window.structuredClone:function(e){return e?JSON.parse(JSON.stringify(e)):e},ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"}),"")},at=function(){function e(t,n){var r,i,o=this;j(this,e),D(this,"createDefaultProperties",void 0),D(this,"migrations",void 0),D(this,"validator",void 0),D(this,"scope",void 0),D(this,"isInstance",(function(e){return(null===e||void 0===e?void 0:e.typeName)===o.typeName})),this.typeName=t,this.createDefaultProperties=n.createDefaultProperties,this.migrations=n.migrations,this.validator=null!==(r=n.validator)&&void 0!==r?r:{validate:function(e){return e}},this.scope=null!==(i=n.scope)&&void 0!==i?i:"document"}return z(e,[{key:"create",value:function(e){for(var t=Ce(Ce({},this.createDefaultProperties()),{},{id:this.createId()}),n=0,r=Object.entries(e);n<r.length;n++){var i=l(r[n],2),o=i[0],a=i[1];void 0!==a&&(t[o]=a)}return t.typeName=this.typeName,t}},{key:"clone",value:function(e){return Ce(Ce({},it(e)),{},{id:this.createId()})}},{key:"createId",value:function(e){return this.typeName+":"+(null!==e&&void 0!==e?e:ot())}},{key:"createCustomId",value:function(e){return this.typeName+":"+e}},{key:"parseId",value:function(e){if(!this.isId(e))throw new Error('ID "'.concat(e,'" is not a valid ID for type "').concat(this.typeName,'"'));return e.slice(this.typeName.length+1)}},{key:"isId",value:function(e){if(!e)return!1;for(var t=0;t<this.typeName.length;t++)if(e[t]!==this.typeName[t])return!1;return":"===e[this.typeName.length]}},{key:"withDefaultProperties",value:function(t){return new e(this.typeName,{createDefaultProperties:t,migrations:this.migrations,validator:this.validator,scope:this.scope})}},{key:"validate",value:function(e){return this.validator.validate(e)}}]),e}();function st(e,t){var n;return new at(e,{createDefaultProperties:function(){return{}},migrations:null!==(n=t.migrations)&&void 0!==n?n:{currentVersion:0,firstVersion:0,migrators:{}},validator:t.validator,scope:t.scope})}var ut=function(){function e(){j(this,e),D(this,"items",new WeakMap)}return z(e,[{key:"get",value:function(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}}]),e}(),lt=n(3108);function ct(e,t){for(var n=0,r=Object.entries(e);n<r.length;n++){var i=l(r[n],2),o=i[0],a=i[1],s=t[o];if("eq"in a&&s!==a.eq)return!1;if("neq"in a&&s===a.neq)return!1;if("gt"in a&&("number"!==typeof s||s<=a.gt))return!1}return!0}function dt(e,t,n){for(var r=Object.fromEntries(Object.keys(n).map((function(e){return[e,new Set]}))),i=0,o=Object.entries(n);i<o.length;i++){var a=l(o[i],2),s=a[0],u=a[1];if("eq"in u){var c=e.index(t,s).value.get(u.eq);if(c){var d,f=J(c);try{for(f.s();!(d=f.n()).done;){var p=d.value;r[s].add(p)}}catch(M){f.e(M)}finally{f.f()}}}else if("neq"in u){var h,v=J(e.index(t,s).value);try{for(v.s();!(h=v.n()).done;){var g=l(h.value,2),m=g[0],y=g[1];if(m!==u.neq){var b,w=J(y);try{for(w.s();!(b=w.n()).done;){var x=b.value;r[s].add(x)}}catch(M){w.e(M)}finally{w.f()}}}}catch(M){v.e(M)}finally{v.f()}}else if("gt"in u){var k,S=J(e.index(t,s).value);try{for(S.s();!(k=S.n()).done;){var _=l(k.value,2),P=_[0],E=_[1];if(P>u.gt){var C,I=J(E);try{for(I.s();!(C=I.n()).done;){var T=C.value;r[s].add(T)}}catch(M){I.e(M)}finally{I.f()}}}}catch(M){S.e(M)}finally{S.f()}}}return function(e){if(0===e.length)return new Set;var t,n=e[0],r=e.slice(1),i=new Set,o=J(n);try{var a=function(){var e=t.value;r.every((function(t){return t.has(e)}))&&i.add(e)};for(o.s();!(t=o.n()).done;)a()}catch(M){o.e(M)}finally{o.f()}return i}(Object.values(r))}var ft=function(){function e(t,n){j(this,e),D(this,"indexCache",new Map),D(this,"historyCache",new Map),this.atoms=t,this.history=n}return z(e,[{key:"filterHistory",value:function(e){var t=this;if(this.historyCache.has(e))return this.historyCache.get(e);var n=ve("filterHistory:"+e,(function(n,r){if(ce(n))return t.history.value;var i=t.history.getDiffSince(r);if(i===Q)return t.history.value;var o,a={added:{},removed:{},updated:{}},s=0,u=0,c=0,d=J(i);try{for(d.s();!(o=d.n()).done;){var f,p=o.value,h=J(Ye(p.added));try{for(h.s();!(f=h.n()).done;){var v=f.value;if(v.typeName===e)if(a.removed[v.id]){var g=a.removed[v.id];delete a.removed[v.id],u--,g!==v&&(a.updated[v.id]=[g,v],c++)}else a.added[v.id]=v,s++}}catch(P){h.e(P)}finally{h.f()}var m,y=J(Ye(p.updated));try{for(y.s();!(m=y.n()).done;){var b=l(m.value,2),w=b[0],x=b[1];x.typeName===e&&(a.added[x.id]?a.added[x.id]=x:a.updated[x.id]?a.updated[x.id]=[a.updated[x.id][0],x]:(a.updated[x.id]=[w,x],c++))}}catch(P){y.e(P)}finally{y.f()}var k,S=J(Ye(p.removed));try{for(S.s();!(k=S.n()).done;){var _=k.value;_.typeName===e&&(a.added[_.id]?(delete a.added[_.id],s--):a.updated[_.id]?(a.removed[_.id]=a.updated[_.id][0],delete a.updated[_.id],c--,u++):(a.removed[_.id]=_,u++))}}catch(P){S.e(P)}finally{S.f()}}}catch(P){d.e(P)}finally{d.f()}return s||u||c?fe(t.history.value,a):n}),{historyLength:100});return this.historyCache.set(e,n),n}},{key:"index",value:function(e,t){var n=e+":"+t;if(this.indexCache.has(n))return this.indexCache.get(n);var r=this.__uncached_createIndex(e,t);return this.indexCache.set(n,r),r}},{key:"__uncached_createIndex",value:function(e,t){var n=this,r=this.filterHistory(e),i=function(){r.value;var i,o=new Map,a=J(Ye(n.atoms.value));try{for(a.s();!(i=a.n()).done;){var s=i.value.value;if(s.typeName===e){var u=s[t];o.has(u)||o.set(u,new Set),o.get(u).add(s.id)}}}catch(l){a.e(l)}finally{a.f()}return o};return ve("index:"+e+":"+t,(function(n,o){if(ce(n))return i();var a=r.getDiffSince(o);if(a===Q)return i();var s,u=new Map,c=function(e,t){var r,i=u.get(e);i||(i=new Pe(null!==(r=n.get(e))&&void 0!==r?r:new Set)),i.add(t),u.set(e,i)},d=function(e,t){var r,i=u.get(e);i||(i=new Pe(null!==(r=n.get(e))&&void 0!==r?r:new Set)),i.remove(t),u.set(e,i)},f=J(a);try{for(f.s();!(s=f.n()).done;){var p,h=s.value,v=J(Ye(h.added));try{for(v.s();!(p=v.n()).done;){var g=p.value;if(g.typeName===e)c(g[t],g.id)}}catch(L){v.e(L)}finally{v.f()}var m,y=J(Ye(h.updated));try{for(y.s();!(m=y.n()).done;){var b=l(m.value,2),w=b[0],x=b[1];if(x.typeName===e){var k=w[t],S=x[t];k!==S&&(d(k,x.id),c(S,x.id))}}}catch(L){y.e(L)}finally{y.f()}var _,P=J(Ye(h.removed));try{for(P.s();!(_=P.n()).done;){var E=_.value;if(E.typeName===e)d(E[t],E.id)}}catch(L){P.e(L)}finally{P.f()}}}catch(L){f.e(L)}finally{f.f()}var C,I=void 0,T=void 0,M=J(u);try{for(M.s();!(C=M.n()).done;){var j=l(C.value,2),A=j[0],O=j[1].get();O&&(I||(I=new Map(n)),T||(T=new Map),0===O.value.size?I.delete(A):I.set(A,O.value),T.set(A,O.diff))}}catch(L){M.e(L)}finally{M.f()}return I&&T?fe(I,T):n}),{historyLength:100})}},{key:"record",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return{}},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"record:"+e+(n?":"+n.toString():""),i=this.ids(e,n,r);return ve(r,(function(){var e,n=J(i.value);try{for(n.s();!(e=n.n()).done;){var r,o=e.value;return null===(r=t.atoms.value[o])||void 0===r?void 0:r.value}}catch(a){n.e(a)}finally{n.f()}}))}},{key:"records",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return{}},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"records:"+e+(n?":"+n.toString():""),i=this.ids(e,n,"ids:"+r);return ve(r,(function(){return d(i.value).map((function(e){var n=t.atoms.value[e];if(!n)throw new Error("no atom found for record id: "+e);return n.value}))}))}},{key:"ids",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return{}},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ids:"+e+(n?":"+n.toString():""),i=this.filterHistory(e),o=function(){i.value;var r=n();return 0===Object.keys(r).length?new Set(Ye(t.atoms.value).flatMap((function(t){var n=t.value;return n.typeName===e?n.id:[]}))):dt(t,e,r)},a=function(e){var t=o(),n=function(e,t){var n,r={},i=J(t);try{for(i.s();!(n=i.n()).done;){var o,a=n.value;e.has(a)||(null!==(o=r.added)&&void 0!==o||(r.added=new Set),r.added.add(a))}}catch(d){i.e(d)}finally{i.f()}var s,u=J(e);try{for(u.s();!(s=u.n()).done;){var l,c=s.value;t.has(c)||(null!==(l=r.removed)&&void 0!==l||(r.removed=new Set),r.removed.add(c))}}catch(d){u.e(d)}finally{u.f()}return r.added||r.removed?r:void 0}(e,t);return n?fe(t,n):e},s=ve("ids_query:"+r,n,{isEqual:lt});return ve("query:"+r,(function(t,n){var r=s.value;if(ce(t))return o();if(n<s.lastChangedEpoch)return a(t);var u=i.getDiffSince(n);if(u===Q)return a(t);var c,d=new Pe(t),f=J(u);try{for(f.s();!(c=f.n()).done;){var p,h=c.value,v=J(Ye(h.added));try{for(v.s();!(p=v.n()).done;){var g=p.value;g.typeName===e&&ct(r,g)&&d.add(g.id)}}catch(P){v.e(P)}finally{v.f()}var m,y=J(Ye(h.updated));try{for(y.s();!(m=y.n()).done;){var b=l(m.value,2),w=(b[0],b[1]);w.typeName===e&&(ct(r,w)?d.add(w.id):d.remove(w.id))}}catch(P){y.e(P)}finally{y.f()}var x,k=J(Ye(h.removed));try{for(k.s();!(x=k.n()).done;){var S=x.value;S.typeName===e&&d.remove(S.id)}}catch(P){k.e(P)}finally{k.f()}}}catch(P){f.e(P)}finally{f.f()}var _=d.get();return _?fe(_.value,_.diff):t}),{historyLength:50})}},{key:"exec",value:function(e,t){var n=dt(this,e,t);if(0===n.size)return V;var r=this.atoms.value;return d(n).map((function(e){return r[e].value}))}}]),e}();var pt=function(){function e(t){var n=this;j(this,e),D(this,"id",ot()),D(this,"atoms",ue("store_atoms",{})),D(this,"history",ue("history",0,{historyLength:1e3})),D(this,"query",new ft(this.atoms,this.history)),D(this,"listeners",new Set),D(this,"historyAccumulator",new vt),D(this,"historyReactor",void 0),D(this,"schema",void 0),D(this,"props",void 0),D(this,"scopedTypes",void 0),D(this,"onAfterCreate",void 0),D(this,"onAfterChange",void 0),D(this,"onBeforeDelete",void 0),D(this,"onAfterDelete",void 0),D(this,"_runCallbacks",!0),D(this,"put",(function(e,t){ae((function(){for(var r,i={},o={},a=n.atoms.__unsafe__getWithoutCapture(),s=null,u=!1,c=0,d=e.length;c<d;c++){var f,p=(null!==(f=s)&&void 0!==f?f:a)[(r=e[c]).id];if(p){var h=p.__unsafe__getWithoutCapture();r=n.schema.validateRecord(n,r,null!==t&&void 0!==t?t:"updateRecord",h),p.set(r);var v=p.__unsafe__getWithoutCapture();h!==v&&(u=!0,i[r.id]=[h,v])}else u=!0,o[(r=n.schema.validateRecord(n,r,null!==t&&void 0!==t?t:"createRecord",null)).id]=r,s||(s=Ce({},a)),s[r.id]=ue("atom:"+r.id,r)}if(s&&n.atoms.set(s),u){n.updateHistory({added:o,updated:i,removed:{}});var g=n.onAfterCreate,m=n.onAfterChange;g&&n._runCallbacks&&Object.values(o).forEach((function(e){g(e)})),m&&n._runCallbacks&&Object.values(i).forEach((function(e){var t=l(e,2),n=t[0],r=t[1];m(n,r)}))}}))})),D(this,"remove",(function(e){ae((function(){if(n.onBeforeDelete&&n._runCallbacks){var t,r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=n.atoms.__unsafe__getWithoutCapture()[i];o&&n.onBeforeDelete(o.value)}}catch(l){r.e(l)}finally{r.f()}}var a=void 0;if(n.atoms.update((function(t){var n,r,i=void 0,o=J(e);try{for(o.s();!(r=o.n()).done;){var s=r.value;s in t&&(i||(i=Ce({},t)),a||(a={}),delete i[s],a[s]=t[s].value)}}catch(l){o.e(l)}finally{o.f()}return null!==(n=i)&&void 0!==n?n:t})),a&&(n.updateHistory({added:{},updated:{},removed:a}),n.onAfterDelete&&n._runCallbacks))for(var s=0,u=e.length;s<u;s++)n.onAfterDelete(a[e[s]])}))})),D(this,"get",(function(e){var t;return null===(t=n.atoms.value[e])||void 0===t?void 0:t.value})),D(this,"unsafeGetWithoutCapture",(function(e){var t;return null===(t=n.atoms.value[e])||void 0===t?void 0:t.__unsafe__getWithoutCapture()})),D(this,"serialize",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"document",r={},i=J(Xe(n.atoms.value));try{for(i.s();!(e=i.n()).done;){var o=l(e.value,2),a=o[0],s=o[1].value;("all"===t||n.scopedTypes[t].has(s.typeName))&&(r[a]=s)}}catch(u){i.e(u)}finally{i.f()}return r})),D(this,"allRecords",(function(){return Ye(n.atoms.value).map((function(e){return e.value}))})),D(this,"clear",(function(){n.remove(He(n.atoms.value))})),D(this,"update",(function(e,t){var r=n.atoms.value[e];r?n.put([t(r.__unsafe__getWithoutCapture())]):console.error("Record ".concat(e," not found. This is probably an error"))})),D(this,"has",(function(e){return!!n.atoms.value[e]})),D(this,"listen",(function(e,t){var r,i;n._flushHistory();var o={onHistory:e,filters:{source:null!==(r=null===t||void 0===t?void 0:t.source)&&void 0!==r?r:"all",scope:null!==(i=null===t||void 0===t?void 0:t.scope)&&void 0!==i?i:"all"}};return n.listeners.add(o),n.historyReactor.scheduler.isActivelyListening||n.historyReactor.start(),function(){n.listeners.delete(o),0===n.listeners.size&&n.historyReactor.stop()}})),D(this,"isMergingRemoteChanges",!1),D(this,"mergeRemoteChanges",(function(e){if(n.isMergingRemoteChanges)return e();try{n.isMergingRemoteChanges=!0,ae(e)}finally{n.isMergingRemoteChanges=!1}})),D(this,"createComputedCache",(function(e,t){var r=new ut;return{get:function(i){var o=n.atoms.value[i];if(o)return r.get(o,(function(){return ve(e+":"+i,(function(){return t(o.value)}))})).value}}})),D(this,"createSelectedComputedCache",(function(e,t,r){var i=new ut;return{get:function(o){var a=n.atoms.value[o];if(a){var s=ve(e+":"+o+":selector",(function(){return t(a.value)}));return i.get(a,(function(){return ve(e+":"+o,(function(){return r(s.value)}))})).value}}}})),D(this,"_integrityChecker",void 0),D(this,"_isPossiblyCorrupted",!1);var r=t.initialData,i=t.schema;this.schema=i,this.props=t.props,r&&this.atoms.set(qe(Xe(r).map((function(e){var t=l(e,2),r=t[0],i=t[1];return[r,ue("atom:"+r,n.schema.validateRecord(n,i,"initialize",null))]})))),this.historyReactor=function(e,t,n){var r=new ge(e,t,n);return{scheduler:r,start:function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.force)&&void 0!==t&&t;r.attach(),n?r.scheduleEffect():r.maybeScheduleEffect()},stop:function(){r.detach()}}}("Store.historyReactor",(function(){n.history.value,n._flushHistory()}),{scheduleEffect:function(e){return function(e){if(Ze())return e();Je.includes(e)||(Je.push(e),tt())}(e)}}),this.scopedTypes={document:new Set(Ye(this.schema.types).filter((function(e){return"document"===e.scope})).map((function(e){return e.typeName}))),session:new Set(Ye(this.schema.types).filter((function(e){return"session"===e.scope})).map((function(e){return e.typeName}))),presence:new Set(Ye(this.schema.types).filter((function(e){return"presence"===e.scope})).map((function(e){return e.typeName})))}}return z(e,[{key:"_flushHistory",value:function(){if(this.historyAccumulator.hasChanges()){var e,t=J(this.historyAccumulator.flush());try{for(t.s();!(e=t.n()).done;){var n,r=e.value,i=r.changes,o=r.source,a=null,s=null,u=null,l=J(this.listeners);try{for(l.s();!(n=l.n()).done;){var c=n.value,d=c.onHistory,f=c.filters;if("all"===f.source||f.source===o)if("all"!==f.scope)if("document"===f.scope){var p;if(null!==(p=s)&&void 0!==p||(s=this.filterChangesByScope(i,"document")),!s)continue;d({changes:s,source:o})}else if("session"===f.scope){var h;if(null!==(h=a)&&void 0!==h||(a=this.filterChangesByScope(i,"session")),!a)continue;d({changes:a,source:o})}else{var v;if(null!==(v=u)&&void 0!==v||(u=this.filterChangesByScope(i,"presence")),!u)continue;d({changes:u,source:o})}else d({changes:i,source:o})}}catch(g){l.e(g)}finally{l.f()}}}catch(g){t.e(g)}finally{t.f()}}}},{key:"filterChangesByScope",value:function(e,t){var n=this,r={added:$e(e.added,(function(e,r){return n.scopedTypes[t].has(r.typeName)})),updated:$e(e.updated,(function(e,r){return n.scopedTypes[t].has(r[1].typeName)})),removed:$e(e.removed,(function(e,r){return n.scopedTypes[t].has(r.typeName)}))};return 0===Object.keys(r.added).length&&0===Object.keys(r.updated).length&&0===Object.keys(r.removed).length?null:r}},{key:"updateHistory",value:function(e){this.historyAccumulator.add({changes:e,source:this.isMergingRemoteChanges?"remote":"user"}),0===this.listeners.size&&this.historyAccumulator.clear(),this.history.set(this.history.value+1,e)}},{key:"validate",value:function(e){var t=this;this.allRecords().forEach((function(n){return t.schema.validateRecord(t,n,e,null)}))}},{key:"getSnapshot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"document";return{store:this.serialize(e),schema:this.schema.serialize()}}},{key:"loadSnapshot",value:function(e){var t=this,n=this.schema.migrateStoreSnapshot(e);if("error"===n.type)throw new Error("Failed to migrate snapshot: ".concat(n.reason));ae((function(){t.clear(),t.put(Object.values(n.value)),t.ensureStoreIsUsable()}))}},{key:"extractingChanges",value:function(e){var t=[],n=this.historyAccumulator.intercepting((function(e){return t.push(e.changes)}));try{return ae(e),ht(t)}finally{n()}}},{key:"applyDiff",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._runCallbacks;try{this._runCallbacks=n,ae((function(){var n=Ye(e.added).concat(Ye(e.updated).map((function(e){var t=l(e,2);t[0];return t[1]}))),r=He(e.removed);n.length&&t.put(n),r.length&&t.remove(r)}))}finally{this._runCallbacks=r}}},{key:"ensureStoreIsUsable",value:function(){var e,t;null!==(e=this._integrityChecker)&&void 0!==e||(this._integrityChecker=this.schema.createIntegrityChecker(this)),null===(t=this._integrityChecker)||void 0===t||t.call(this)}},{key:"markAsPossiblyCorrupted",value:function(){this._isPossiblyCorrupted=!0}},{key:"isPossiblyCorrupted",value:function(){return this._isPossiblyCorrupted}}]),e}();function ht(e){var t,n={added:{},removed:{},updated:{}},r=J(e);try{for(r.s();!(t=r.n()).done;){var i,o=t.value,a=J(Xe(o.added));try{for(a.s();!(i=a.n()).done;){var s=l(i.value,2),u=s[0],c=s[1];if(n.removed[u]){var d=n.removed[u];delete n.removed[u],d!==c&&(n.updated[u]=[d,c])}else n.added[u]=c}}catch(S){a.e(S)}finally{a.f()}var f,p=J(Xe(o.updated));try{for(p.s();!(f=p.n()).done;){var h=l(f.value,2),v=h[0],g=l(h[1],2),m=(g[0],g[1]);n.added[v]?(n.added[v]=m,delete n.updated[v],delete n.removed[v]):n.updated[v]?(n.updated[v][1]=m,delete n.removed[v]):(n.updated[v]=o.updated[v],delete n.removed[v])}}catch(S){p.e(S)}finally{p.f()}var y,b=J(Xe(o.removed));try{for(b.s();!(y=b.n()).done;){var w=l(y.value,2),x=w[0],k=w[1];n.added[x]?delete n.added[x]:n.updated[x]?(n.removed[x]=n.updated[x][0],delete n.updated[x]):n.removed[x]=k}}catch(S){b.e(S)}finally{b.f()}}}catch(S){r.e(S)}finally{r.f()}return n}var vt=function(){function e(){j(this,e),D(this,"_history",[]),D(this,"_interceptors",new Set)}return z(e,[{key:"intercepting",value:function(e){var t=this;return this._interceptors.add(e),function(){t._interceptors.delete(e)}}},{key:"add",value:function(e){this._history.push(e);var t,n=J(this._interceptors);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"flush",value:function(){var e=function(e){for(var t,n=[],r=e[0],i=1,o=e.length;i<o;i++)t=e[i],r.source!==t.source?(n.push(r),r=t):r={source:r.source,changes:ht([r.changes,t.changes])};return n.push(r),n}(this._history);return this._history=[],e}},{key:"clear",value:function(){this._history=[]}},{key:"hasChanges",value:function(){return this._history.length>0}}]),e}();function gt(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var mt=["typeName","id"];function yt(e){var t=e.currentVersion,n=e.firstVersion,r=e.migrators,i=void 0===r?{}:r,o=e.subTypeKey,a=e.subTypeMigrations;if("number"===typeof t&&"number"===typeof n){if(t===n)throw Error("Current version is equal to initial version.");if(t<n)throw Error("Current version is lower than initial version.")}return{firstVersion:null!==n&&void 0!==n?n:0,currentVersion:null!==t&&void 0!==t?t:0,migrators:i,subTypeKey:o,subTypeMigrations:a}}var bt=function(e){return e.IncompatibleSubtype="incompatible-subtype",e.UnknownType="unknown-type",e.TargetVersionTooNew="target-version-too-new",e.TargetVersionTooOld="target-version-too-old",e.MigrationError="migration-error",e.UnrecognizedSubtype="unrecognized-subtype",e}(bt||{});function wt(e){var t=e.record,n=e.migrations,r=e.fromVersion,i=e.toVersion,o=r;if(!function(e){return"object"===typeof e&&null!==e&&"id"in e&&"typeName"in e}(t))throw new Error("[migrateRecord] object is not a record");for(var a=t.typeName,s=t.id,u=gt(t,mt);o<i;){var l=o+1,c=n.migrators[l];if(!c)return{type:"error",reason:"target-version-too-new"};u=c.up(u),o=l}for(;o>i;){var d=o-1,f=n.migrators[o];if(!f)return{type:"error",reason:"target-version-too-old"};u=f.down(u),o=d}return{type:"success",value:Ce(Ce({},u),{},{id:s,typeName:a})}}function xt(e){for(var t=e.value,n=e.migrations,r=e.fromVersion,i=e.toVersion,o=r;o<i;){var a=o+1,s=n.migrators[a];if(!s)return{type:"error",reason:"target-version-too-new"};t=s.up(t),o=a}for(;o>i;){var u=o-1,l=n.migrators[o];if(!l)return{type:"error",reason:"target-version-too-old"};t=l.down(t),o=u}return{type:"success",value:t}}var kt=function(){function e(t,n){j(this,e),this.types=t,this.options=n}return z(e,[{key:"currentStoreVersion",get:function(){var e,t;return null!==(e=null===(t=this.options.snapshotMigrations)||void 0===t?void 0:t.currentVersion)&&void 0!==e?e:0}},{key:"validateRecord",value:function(e,t,n,r){try{var i=Ve(this.types,t.typeName);if(!i)throw new Error("Missing definition for record type ".concat(t.typeName));return i.validate(t)}catch(o){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:e,record:t,phase:n,recordBefore:r,error:o});throw o}}},{key:"migratePersistedRecord",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"up",i=Ve(this.types,e.typeName),o=t.recordVersions[e.typeName];if(!o||!i)return{type:"error",reason:bt.UnknownType};var a=i.migrations.currentVersion,s=o.version;if(a!==s){var u=wt("up"===r?{record:e,migrations:i.migrations,fromVersion:s,toVersion:a}:{record:e,migrations:i.migrations,fromVersion:a,toVersion:s});if("error"===u.type)return u;e=u.value}if(!i.migrations.subTypeKey)return{type:"success",value:e};var l=null===(n=i.migrations.subTypeMigrations)||void 0===n?void 0:n[e[i.migrations.subTypeKey]],c="subTypeVersions"in o?o.subTypeVersions[e[i.migrations.subTypeKey]]:void 0;if(void 0===l)return{type:"error",reason:bt.UnrecognizedSubtype};if(void 0===c)return{type:"error",reason:bt.IncompatibleSubtype};var d=wt("up"===r?{record:e,migrations:l,fromVersion:c,toVersion:l.currentVersion}:{record:e,migrations:l,fromVersion:l.currentVersion,toVersion:c});return"error"===d.type?d:{type:"success",value:d.value}}},{key:"migrateStoreSnapshot",value:function(e){var t,n=e.store,r=this.options.snapshotMigrations;if(!r)return{type:"success",value:n};var i=r.currentVersion,o=null!==(t=e.schema.storeVersion)&&void 0!==t?t:0;if(i<o)return{type:"error",reason:bt.TargetVersionTooOld};if(i>o){var a=xt({value:n,migrations:r,fromVersion:o,toVersion:i});if("error"===a.type)return a;n=a.value}var s,u=[],l=J(Ye(n));try{for(l.s();!(s=l.n()).done;){var c=s.value,d=this.migratePersistedRecord(c,e.schema);if("error"===d.type)return d;d.value&&d.value!==c&&u.push(d.value)}}catch(v){l.e(v)}finally{l.f()}if(u.length){n=Ce({},n);var f,p=J(u);try{for(p.s();!(f=p.n()).done;){var h=f.value;n[h.id]=h}}catch(v){p.e(v)}finally{p.f()}}return{type:"success",value:n}}},{key:"createIntegrityChecker",value:function(e){var t,n,r;return null!==(t=null===(n=(r=this.options).createIntegrityChecker)||void 0===n?void 0:n.call(r,e))&&void 0!==t?t:void 0}},{key:"serialize",value:function(){var e,t;return{schemaVersion:1,storeVersion:null!==(e=null===(t=this.options.snapshotMigrations)||void 0===t?void 0:t.currentVersion)&&void 0!==e?e:0,recordVersions:Object.fromEntries(Ye(this.types).map((function(e){return[e.typeName,e.migrations.subTypeKey&&e.migrations.subTypeMigrations?{version:e.migrations.currentVersion,subTypeKey:e.migrations.subTypeKey,subTypeVersions:e.migrations.subTypeMigrations?Object.fromEntries(Object.entries(e.migrations.subTypeMigrations).map((function(e){var t=l(e,2);return[t[0],t[1].currentVersion]}))):void 0}:{version:e.migrations.currentVersion}]})))}}},{key:"serializeEarliestVersion",value:function(){var e,t;return{schemaVersion:1,storeVersion:null!==(e=null===(t=this.options.snapshotMigrations)||void 0===t?void 0:t.firstVersion)&&void 0!==e?e:0,recordVersions:Object.fromEntries(Ye(this.types).map((function(e){return[e.typeName,e.migrations.subTypeKey&&e.migrations.subTypeMigrations?{version:e.migrations.firstVersion,subTypeKey:e.migrations.subTypeKey,subTypeVersions:e.migrations.subTypeMigrations?Object.fromEntries(Object.entries(e.migrations.subTypeMigrations).map((function(e){var t=l(e,2);return[t[0],t[1].firstVersion]}))):void 0}:{version:e.migrations.firstVersion}]})))}}}],[{key:"create",value:function(t,n){return new e(t,null!==n&&void 0!==n?n:{})}}]),e}(),St=function(e,t){if(e.schemaVersion>t.schemaVersion)return 1;if(e.schemaVersion<t.schemaVersion)return-1;if(e.storeVersion>t.storeVersion)return 1;if(e.storeVersion<t.storeVersion)return-1;for(var n=0,r=Object.keys(e.recordVersions);n<r.length;n++){var i=r[n],o=e.recordVersions[i],a=t.recordVersions[i];if(o.version>a.version)return 1;if(o.version<a.version)return-1;if("subTypeVersions"in o&&!("subTypeVersions"in a))return 1;if(!("subTypeVersions"in o)&&"subTypeVersions"in a)return-1;if("subTypeVersions"in o&&"subTypeVersions"in a)for(var s=0,u=Object.keys(o.subTypeVersions);s<u.length;s++){var l=u[s],c=o.subTypeVersions[l],d=a.subTypeVersions[l];if(c>d)return 1;if(c<d)return-1}}return 0};function _t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pt(e,t){return Pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pt(e,t)}function Et(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pt(e,t)}function Ct(e){return Ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ct(e)}function It(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ok){return!1}}function Tt(e){var t=It();return function(){var n,r=Ct(e);if(t){var i=Ct(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===A(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _t(e)}(this,n)}}function Mt(e,t,n){return Mt=It()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Pt(i,n.prototype),i},Mt.apply(null,arguments)}function jt(e){var t="function"===typeof Map?new Map:void 0;return jt=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Mt(e,arguments,Ct(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Pt(r,e)},jt(e)}var At=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];j(this,n);var o=function(e){if(!e.length)return null;var t,n="",r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;"number"===typeof i?n+=".".concat(i):i.startsWith("(")?n.endsWith(")")?n="".concat(n.slice(0,-1),", ").concat(i.slice(1)):n+=i:n+=".".concat(i)}}catch(o){r.e(o)}finally{r.f()}return n.startsWith(".")?n.slice(1):n}(i),a=e.split("\n").map((function(e,t){return 0===t?e:"  ".concat(e)})).join("\n");return D(_t(r=t.call(this,i?"At ".concat(o,": ").concat(a):a)),"name","ValidationError"),r.rawMessage=e,r.path=i,r}return z(n)}(jt(Error));function Ot(e,t){try{return t()}catch(n){if(n instanceof At)throw new At(n.rawMessage,[e].concat(d(n.path)));throw new At(n.toString(),[e])}}function Lt(e){if(null===e)return"null";if(Array.isArray(e))return"an array";var t=typeof e;switch(t){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return"a ".concat(t);case"object":return"an ".concat(t);case"undefined":return"undefined";default:Oe(t)}}var zt=function(){function e(t){j(this,e),this.validationFn=t}return z(e,[{key:"validate",value:function(e){return this.validationFn(e)}},{key:"nullable",value:function(){return fn(this)}},{key:"optional",value:function(){return dn(this)}},{key:"refine",value:function(t){var n=this;return new e((function(e){return t(n.validate(e))}))}},{key:"check",value:function(e,t){return"string"===typeof e?this.refine((function(n){return Ot("(check ".concat(e,")"),(function(){return t(n)})),n})):this.refine((function(t){return e(t),t}))}}]),e}(),Dt=function(e){Et(n,e);var t=Tt(n);function n(e){var r;return j(this,n),r=t.call(this,(function(t){for(var n=Jt.validate(t),r=function(t){Ot(t,(function(){return e.validate(n[t])}))},i=0;i<n.length;i++)r(i);return n})),r.itemValidator=e,r}return z(n,[{key:"nonEmpty",value:function(){return this.check((function(e){if(0===e.length)throw new At("Expected a non-empty array")}))}},{key:"lengthGreaterThan1",value:function(){return this.check((function(e){if(e.length<=1)throw new At("Expected an array with length greater than 1")}))}}]),n}(zt),Nt=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return j(this,n),(r=t.call(this,(function(t){if("object"!==typeof t||null===t)throw new At("Expected object, got ".concat(Lt(t)));for(var n=function(){var e=l(o[r],2),n=e[0],i=e[1];Ot(n,(function(){i.validate(Ve(t,n))}))},r=0,o=Object.entries(e);r<o.length;r++)n();if(!i)for(var a=0,s=Object.keys(t);a<s.length;a++){var u=s[a];if(!Ke(e,u))throw new At("Unexpected property",[u])}return t}))).config=e,r.shouldAllowUnknownProperties=i,r}return z(n,[{key:"allowUnknownProperties",value:function(){return new n(this.config,!0)}},{key:"extend",value:function(e){return new n(Ce(Ce({},this.config),e))}}]),n}(zt),Rt=function(e){Et(n,e);var t=Tt(n);function n(e,r,i){var o;return j(this,n),(o=t.call(this,(function(t){if("object"!==typeof t||null===t)throw new At("Expected an object, got ".concat(Lt(t)),[]);var n=Ve(t,e);if("string"!==typeof n)throw new At('Expected a string for key "'.concat(e,'", got ').concat(Lt(n)));var i=Ke(r,n)?r[n]:void 0;return void 0===i?o.unknownValueValidation(t,n):Ot("(".concat(e," = ").concat(n,")"),(function(){return i.validate(t)}))}))).key=e,o.config=r,o.unknownValueValidation=i,o}return z(n,[{key:"validateUnknownVariants",value:function(e){return new n(this.key,this.config,e)}}]),n}(zt),Bt=function(e){Et(n,e);var t=Tt(n);function n(e,r){var i;return j(this,n),(i=t.call(this,(function(t){if("object"!==typeof t||null===t)throw new At("Expected object, got ".concat(Lt(t)));for(var n=function(){var t=l(o[i],2),n=t[0],a=t[1];Ot(n,(function(){e.validate(n),r.validate(a)}))},i=0,o=Object.entries(t);i<o.length;i++)n();return t}))).keyValidator=e,i.valueValidator=r,i}return z(n)}(zt);function Ft(e){return new zt((function(t){if(typeof t!==e)throw new At("Expected ".concat(e,", got ").concat(Lt(t)));return t}))}var Ut=new zt((function(e){return e})),Kt=new zt((function(e){return e})),Vt=Ft("string"),Wt=Ft("number").check((function(e){if(Number.isNaN(e))throw new At("Expected a number, got NaN");if(!Number.isFinite(e))throw new At("Expected a finite number, got ".concat(e))})),Ht=Wt.check((function(e){if(e<0)throw new At("Expected a positive number, got ".concat(e))})),Yt=Wt.check((function(e){if(e<=0)throw new At("Expected a non-zero positive number, got ".concat(e))})),Xt=Wt.check((function(e){if(!Number.isInteger(e))throw new At("Expected an integer, got ".concat(e))})),qt=Xt.check((function(e){if(e<0)throw new At("Expected a positive integer, got ".concat(e))})),$t=Xt.check((function(e){if(e<=0)throw new At("Expected a non-zero positive integer, got ".concat(e))})),Gt=Ft("boolean"),Qt=Ft("bigint");function Zt(e){return new zt((function(t){if(t!==e)throw new At("Expected ".concat(e,", got ").concat(JSON.stringify(t)));return e}))}var Jt=new zt((function(e){if(!Array.isArray(e))throw new At("Expected an array, got ".concat(Lt(e)));return e}));function en(e){return new Dt(e)}var tn=new zt((function(e){if("object"!==typeof e||null===e)throw new At("Expected object, got ".concat(Lt(e)));return e}));function nn(e){return new Nt(e)}function rn(e){return null===e||"number"===typeof e||"string"===typeof e||"boolean"===typeof e||(Array.isArray(e)?e.every(rn):"object"===typeof e&&Object.values(e).every(rn))}var on=new zt((function(e){if(rn(e))return e;throw new At("Expected json serializable value, got ".concat(typeof e))}));function an(){return sn(Vt,on)}function sn(e,t){return new Bt(e,t)}function un(e,t){return new Rt(e,t,(function(n,r){throw new At("Expected one of ".concat(Object.keys(t).map((function(e){return JSON.stringify(e)})).join(" or "),", got ").concat(JSON.stringify(r)),[e])}))}function ln(e,t){return new zt((function(n){return Ot(n&&"object"===typeof n&&"id"in n&&"string"===typeof n.id?"".concat(e,"(id = ").concat(n.id,")"):e,(function(){return t.validate(n)}))}))}function cn(e){return new zt((function(t){if(!e.has(t)){var n=Array.from(e,(function(e){return JSON.stringify(e)})).join(" or ");throw new At("Expected ".concat(n,", got ").concat(t))}return t}))}function dn(e){return new zt((function(t){if(void 0!==t)return e.validate(t)}))}function fn(e){return new zt((function(t){return null===t?null:e.validate(t)}))}function pn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cn(new Set(t))}function hn(e){return Vt.refine((function(t){if(!t.startsWith("".concat(e,":")))throw new Error("".concat(e,' ID must start with "').concat(e,':"'));return t}))}var vn=hn("asset");function gn(e,t){return nn({id:vn,typeName:Zt("asset"),type:Zt(e),props:t,meta:on})}var mn,yn=["meta"],bn=ln("camera",nn({typeName:Zt("camera"),id:hn("camera"),x:Wt,y:Wt,z:Wt,meta:on})),wn=1,xn=yt({currentVersion:wn,migrators:D({},wn,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,yn))}})}),kn=st("camera",{validator:bn,migrations:xn,scope:"session"}).withDefaultProperties((function(){return{x:0,y:0,z:1,meta:{}}})),Sn=nn({x:Wt,y:Wt,z:Wt.optional()}),_n=nn({x:Wt,y:Wt,w:Wt,h:Wt}),Pn=cn(new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"])),En=cn(new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"])),Cn=nn({color:Pn,type:En,rotation:Wt}),In=Wt.check((function(e){if(e<0||e>1)throw new At("Opacity must be between 0 and 1")})),Tn=new Set(["starting","paused","active","stopping"]),Mn=nn({points:en(Sn),size:Ht,color:Pn,opacity:Wt,state:cn(Tn),delay:Wt}),jn=["meta"],An=hn("page"),On=ln("page",nn({typeName:Zt("page"),id:An,name:Vt,index:Vt,meta:on})),Ln=1,zn=yt({currentVersion:Ln,migrators:D({},Ln,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,jn))}})}),Dn=st("page",{validator:On,migrations:zn,scope:"document"}).withDefaultProperties((function(){return{meta:{}}}));function Nn(e){return Dn.isId(e)}var Rn=["exportBackground"],Bn=["dialog"],Fn=["isToolLocked"],Un=["propsForNextShape"],Kn=["propsForNextShape"],Vn=["labelColor"],Wn=["followingUserId"],Hn=["zoomBrush"],Yn=["verticalAlign"],Xn=["delay"],qn=["userId"],$n=["isPenMode","isGridMode"],Gn=["opacity"],Qn=["propsForNextShape"],Zn=["opacityForNextShape"],Jn=["chatMessage","isChatting"],er=["highlightedUserIds"],tr=["propsForNextShape"],nr=["stylesForNextShape"],rr=["meta"];hn("instance");var ir,or=2,ar=3,sr=4,ur=5,lr=6,cr=7,dr=8,fr=9,pr=10,hr=11,vr=12,gr=13,mr=14,yr=15,br=16,wr=17,xr=yt({currentVersion:wr,migrators:(mn={},D(mn,1,{up:function(e){return Ce(Ce({},e),{},{exportBackground:!0})},down:function(e){e.exportBackground;return gt(e,Rn)}}),D(mn,or,{up:function(e){e.dialog;return gt(e,Bn)},down:function(e){return Ce(Ce({},e),{},{dialog:null})}}),D(mn,ar,{up:function(e){return Ce(Ce({},e),{},{isToolLocked:!1})},down:function(e){e.isToolLocked;return gt(e,Fn)}}),D(mn,sr,{up:function(e){var t=e.propsForNextShape;return Ce(Ce({},gt(e,Un)),{},{propsForNextShape:Object.fromEntries(Object.entries(t).filter((function(e){var t=l(e,1)[0];return["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(t)})))})},down:function(e){return e}}),D(mn,ur,{up:function(e){var t=e.propsForNextShape;return Ce(Ce({},gt(e,Kn)),{},{propsForNextShape:Ce(Ce({},t),{},{labelColor:"black"})})},down:function(e){var t=e.propsForNextShape,n=(t.labelColor,gt(t,Vn));return Ce(Ce({},e),{},{propsForNextShape:Ce({},n)})}}),D(mn,lr,{up:function(e){return Ce(Ce({},e),{},{followingUserId:null})},down:function(e){e.followingUserId;return gt(e,Wn)}}),D(mn,cr,{up:function(e){var t=e.propsForNextShape.align;return"justify"===t&&(t="start"),Ce(Ce({},e),{},{propsForNextShape:Ce(Ce({},e.propsForNextShape),{},{align:t})})},down:function(e){return Ce({},e)}}),D(mn,dr,{up:function(e){return Ce(Ce({},e),{},{zoomBrush:null})},down:function(e){e.zoomBrush;return gt(e,Hn)}}),D(mn,fr,{up:function(e){return Ce(Ce({},e),{},{propsForNextShape:Ce(Ce({},e.propsForNextShape),{},{verticalAlign:"middle"})})},down:function(e){var t=e.propsForNextShape,n=(t.verticalAlign,gt(t,Yn));return Ce(Ce({},e),{},{propsForNextShape:n})}}),D(mn,pr,{up:function(e){return null!==e.scribble?Ce(Ce({},e),{},{scribble:Ce(Ce({},e.scribble),{},{delay:0})}):Ce({},e)},down:function(e){if(null!==e.scribble){var t=e.scribble,n=(t.delay,gt(t,Xn));return Ce(Ce({},e),{},{scribble:n})}return Ce({},e)}}),D(mn,hr,{up:function(e){e.userId;return gt(e,qn)},down:function(e){return Ce(Ce({},e),{},{userId:"user:none"})}}),D(mn,vr,{up:function(e){return Ce(Ce({},e),{},{isPenMode:!1,isGridMode:!1})},down:function(e){e.isPenMode,e.isGridMode;return gt(e,$n)}}),D(mn,gr,{up:function(e){var t=e.propsForNextShape,n=t.opacity,r=gt(t,Gn);return Ce(Ce({},gt(e,Qn)),{},{opacityForNextShape:Number(null!==n&&void 0!==n?n:"1"),propsForNextShape:r})},down:function(e){var t=e.opacityForNextShape,n=gt(e,Zn);return Ce(Ce({},n),{},{propsForNextShape:Ce(Ce({},n.propsForNextShape),{},{opacity:t<.175?"0.1":t<.375?"0.25":t<.625?"0.5":t<.875?"0.75":"1"})})}}),D(mn,mr,{up:function(e){return Ce(Ce({},e),{},{chatMessage:"",isChatting:!1})},down:function(e){e.chatMessage,e.isChatting;return gt(e,Jn)}}),D(mn,yr,{up:function(e){return Ce(Ce({},e),{},{highlightedUserIds:[]})},down:function(e){e.highlightedUserIds;return gt(e,er)}}),D(mn,br,{up:function(e){e.propsForNextShape;return Ce(Ce({},gt(e,tr)),{},{stylesForNextShape:{}})},down:function(e){e.stylesForNextShape;return Ce(Ce({},gt(e,nr)),{},{propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}})}}),D(mn,wr,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,rr))}}),mn)}),kr="instance:instance",Sr=Vt.refine((function(e){if(!e.startsWith("page:")&&!e.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return e})),_r=hn("shape");var Pr,Er,Cr=["croppingId"],Ir=["instanceId","cameraId"],Tr=["meta"],Mr=ln("instance_page_state",nn({typeName:Zt("instance_page_state"),id:hn("instance_page_state"),pageId:An,selectedIds:en(_r),hintingIds:en(_r),erasingIds:en(_r),hoveredId:_r.nullable(),editingId:_r.nullable(),croppingId:_r.nullable(),focusLayerId:_r.nullable(),meta:on})),jr=2,Ar=3,Or=yt({currentVersion:Ar,migrators:(ir={},D(ir,1,{up:function(e){return Ce(Ce({},e),{},{croppingId:null})},down:function(e){e.croppingId;return gt(e,Cr)}}),D(ir,jr,{up:function(e){e.instanceId,e.cameraId;return gt(e,Ir)},down:function(e){return Ce(Ce({},e),{},{instanceId:kr,cameraId:kn.createId("void")})}}),D(ir,Ar,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Tr))}}),ir)}),Lr=st("instance_page_state",{migrations:Or,validator:Mr,scope:"session"}).withDefaultProperties((function(){return{editingId:null,croppingId:null,selectedIds:[],hoveredId:null,erasingIds:[],hintingIds:[],focusLayerId:null,meta:{}}})),zr=["meta"],Dr=ln("pointer",nn({typeName:Zt("pointer"),id:hn("pointer"),x:Wt,y:Wt,lastActivityTimestamp:Wt,meta:on})),Nr=1,Rr=yt({currentVersion:Nr,migrators:D({},Nr,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,zr))}})}),Br=st("pointer",{validator:Dr,migrations:Rr,scope:"session"}).withDefaultProperties((function(){return{x:0,y:0,lastActivityTimestamp:0,meta:{}}})),Fr=Br.createId("pointer"),Ur=["delay"],Kr=["instanceId"],Vr=["chatMessage"],Wr=["meta"],Hr=ln("instance_presence",nn({typeName:Zt("instance_presence"),id:hn("instance_presence"),userId:Vt,userName:Vt,lastActivityTimestamp:Wt,followingUserId:Vt.nullable(),cursor:nn({x:Wt,y:Wt,type:En,rotation:Wt}),color:Vt,camera:nn({x:Wt,y:Wt,z:Wt}),screenBounds:_n,selectedIds:en(hn("shape")),currentPageId:hn("page"),brush:_n.nullable(),scribble:Mn.nullable(),chatMessage:Vt,meta:on})),Yr=2,Xr=3,qr=4,$r=yt({currentVersion:qr,migrators:(Pr={},D(Pr,1,{up:function(e){return null!==e.scribble?Ce(Ce({},e),{},{scribble:Ce(Ce({},e.scribble),{},{delay:0})}):Ce({},e)},down:function(e){if(null!==e.scribble){var t=e.scribble,n=(t.delay,gt(t,Ur));return Ce(Ce({},e),{},{scribble:n})}return Ce({},e)}}),D(Pr,Yr,{up:function(e){e.instanceId;return gt(e,Kr)},down:function(e){return Ce(Ce({},e),{},{instanceId:kr})}}),D(Pr,Xr,{up:function(e){return Ce(Ce({},e),{},{chatMessage:""})},down:function(e){e.chatMessage;return gt(e,Vr)}}),D(Pr,qr,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Wr))}}),Pr)}),Gr=st("instance_presence",{migrations:$r,validator:Hr,scope:"presence"}).withDefaultProperties((function(){return{lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedIds:[],brush:null,scribble:null,chatMessage:"",meta:{}}})),Qr=["name"],Zr=["meta"],Jr=ln("document",nn({typeName:Zt("document"),id:Zt("document:document"),gridSize:Wt,name:Vt,meta:on})),ei=2,ti=yt({currentVersion:ei,migrators:(Er={},D(Er,1,{up:function(e){return Ce(Ce({},e),{},{name:""})},down:function(e){e.name;return gt(e,Qr)}}),D(Er,ei,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Zr))}}),Er)}),ni=st("document",{migrations:ti,validator:Jr,scope:"document"}).withDefaultProperties((function(){return{gridSize:10,name:"",meta:{}}})),ri=ni.createId("document");function ii(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function oi(e){"asset"===e.typeName&&("src"in e&&(e.src="<redacted>"),"src"in e.props&&(e.props.src="<redacted>"))}var ai=function(e){var t=e.error,n=e.phase,r=e.record,i=e.recordBefore;throw Re(t,{tags:{origin:"store.validateRecord",storePhase:n,isExistingValidationIssue:"initialize"===n},extras:{recordBefore:i?oi(it(i)):void 0,recordAfter:oi(it(r))}}),t};function si(e){var t=e.query.ids("page");return function n(){if(!e.has(ri))return e.put([ni.create({id:ri,name:e.props.defaultName})]),n();if(!e.has(Fr))return e.put([Br.create({id:Fr})]),n();var r=t.value;if(0===r.size)return e.put([Dn.create({name:"Page 1",index:"a1",meta:{}})]),n();var i=function(){return d(r).map((function(t){return e.get(t)})).sort(ii)[0].id},o=e.get(kr);if(!o)return e.put([e.schema.types.instance.create({id:kr,currentPageId:i(),exportBackground:!0})]),n();if(!r.has(o.currentPageId))return e.put([Ce(Ce({},o),{},{currentPageId:i()})]),n();var a,s=new Set,u=new Set,l=J(r);try{for(l.s();!(a=l.n()).done;){var c=a.value,f=Lr.createId(c);e.has(f)||s.add(f);var p=kn.createId(c);e.has(p)||u.add(p)}}catch(h){l.e(h)}finally{l.f()}s.size>0&&e.put(d(s).map((function(e){return Lr.create({id:e,pageId:Lr.parseId(e)})}))),u.size>0&&e.put(d(u).map((function(e){return kn.create({id:e})})))}}var ui,li,ci,di,fi=gn("bookmark",nn({title:Vt,description:Vt,image:Vt,src:Vt.nullable()})),pi=yt({}),hi=["isAnimated"],vi=["width","height"],gi=["w","h"],mi=gn("image",nn({w:Wt,h:Wt,name:Vt,isAnimated:Gt,mimeType:Vt.nullable(),src:Vt.nullable()})),yi=2,bi=yt({currentVersion:yi,migrators:(ui={},D(ui,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{isAnimated:!1})})},down:function(e){var t=e.props,n=(t.isAnimated,gt(t,hi));return Ce(Ce({},e),{},{props:n})}}),D(ui,yi,{up:function(e){var t=e.props,n=t.width,r=t.height,i=gt(t,vi);return Ce(Ce({},e),{},{props:Ce({w:n,h:r},i)})},down:function(e){var t=e.props,n=t.w,r=t.h,i=gt(t,gi);return Ce(Ce({},e),{},{props:Ce({width:n,height:r},i)})}}),ui)}),wi=["isAnimated"],xi=["width","height"],ki=["w","h"],Si=gn("video",nn({w:Wt,h:Wt,name:Vt,isAnimated:Gt,mimeType:Vt.nullable(),src:Vt.nullable()})),_i=2,Pi=yt({currentVersion:_i,migrators:(li={},D(li,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{isAnimated:!1})})},down:function(e){var t=e.props,n=(t.isAnimated,gt(t,wi));return Ce(Ce({},e),{},{props:n})}}),D(li,_i,{up:function(e){var t=e.props,n=t.width,r=t.height,i=gt(t,xi);return Ce(Ce({},e),{},{props:Ce({w:n,h:r},i)})},down:function(e){var t=e.props,n=t.w,r=t.h,i=gt(t,ki);return Ce(Ce({},e),{},{props:Ce({width:n,height:r},i)})}}),li)}),Ei=["meta"],Ci=ln("asset",un("type",{image:mi,video:Si,bookmark:fi})),Ii=1,Ti=yt({subTypeKey:"type",subTypeMigrations:{image:bi,video:Pi,bookmark:pi},currentVersion:Ii,migrators:D({},Ii,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Ei))}})}),Mi=st("asset",{migrations:Ti,validator:Ci,scope:"document"}).withDefaultProperties((function(){return{meta:{}}})),ji=function(){function e(t,n,r){j(this,e),this.id=t,this.defaultValue=n,this.type=r}return z(e,[{key:"validate",value:function(e){return this.type.validate(e)}}],[{key:"define",value:function(t,n){var r=n.defaultValue,i=n.type;return new e(t,r,void 0===i?Kt:i)}},{key:"defineEnum",value:function(e,t){var n=t.defaultValue,r=t.values;return new Ai(e,n,r)}}]),e}(),Ai=function(t){Et(r,t);var n=Tt(r);function r(t,i,o){var a;return j(this,r),(a=n.call(this,t,i,pn.apply(e,d(o)))).values=o,a}return z(r)}(ji),Oi=["isLocked"],Li=["opacity"],zi=["props"],Di=["opacity"],Ni=["meta"],Ri=2,Bi=3,Fi=yt({currentVersion:Bi,migrators:(ci={},D(ci,1,{up:function(e){return Ce(Ce({},e),{},{isLocked:!1})},down:function(e){e.isLocked;return Ce({},gt(e,Oi))}}),D(ci,Ri,{up:function(e){var t=e.props,n=t.opacity,r=gt(t,Li);return Ce(Ce({},gt(e,zi)),{},{opacity:Number(null!==n&&void 0!==n?n:"1"),props:r})},down:function(e){var t=e.opacity,n=gt(e,Di);return Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{opacity:t<.175?"0.1":t<.375?"0.25":t<.625?"0.5":t<.875?"0.75":"1"})})}}),D(ci,Bi,{up:function(e){return Ce(Ce({},e),{},{meta:{}})},down:function(e){e.meta;return Ce({},gt(e,Ni))}}),ci)});function Ui(e){return!!e&&"shape"===e.typeName}function Ki(e){return!!e&&e.startsWith("shape:")}function Vi(e){return"shape:".concat(null!==e&&void 0!==e?e:ot())}function Wi(e){for(var t=new Map,n=0,r=Object.entries(e);n<r.length;n++){var i=l(r[n],2),o=i[0],a=i[1];if(a instanceof ji){if(t.has(a))throw new Error("Duplicate style prop ".concat(a.id,". Each style prop can only be used once within a shape."));t.set(a,o)}}return t}function Hi(e){return st("shape",{migrations:yt({currentVersion:Fi.currentVersion,firstVersion:Fi.firstVersion,migrators:Fi.migrators,subTypeKey:"type",subTypeMigrations:Ge(e,(function(e,t){var n;return null!==(n=t.migrations)&&void 0!==n?n:yt({})}))}),scope:"document",validator:ln("shape",un("type",Ge(e,(function(e,t){return function(e,t,n){return nn({id:_r,typeName:Zt("shape"),x:Wt,y:Wt,rotation:Wt,index:Vt,parentId:Sr,type:Zt(e),isLocked:Gt,opacity:In,props:t?nn(t):on,meta:n?nn(n):on})}(e,t.props,t.meta)}))))}).withDefaultProperties((function(){return{x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}}))}var Yi=2,Xi=3,qi=4,$i=yt({currentVersion:qi,migrators:(di={},D(di,1,{up:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=l(e,2),n=(t[0],t[1]);return"shape"!==n.typeName||"icon"!==n.type&&"code"!==n.type})))},down:function(e){return e}}),D(di,Yi,{up:function(e){return e},down:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=l(e,2);t[0];return"instance_presence"!==t[1].typeName})))}}),D(di,Xi,{up:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=l(e,2);t[0];return!t[1].typeName.match(/^(user|user_presence)$/)})))},down:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=l(e,2);t[0];return"pointer"!==t[1].typeName})))}}),D(di,qi,{up:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=l(e,2);t[0];return!t[1].typeName.match("user_document")})))},down:function(e){return e}}),di)});function Gi(e){var t,n=e.shapes,r=new Map,i=J(Ye(n));try{for(i.s();!(t=i.n()).done;){var o,a,s=J(Wi(null!==(o=t.value.props)&&void 0!==o?o:{}).keys());try{for(s.s();!(a=s.n()).done;){var u=a.value;if(r.has(u.id)&&r.get(u.id)!==u)throw new Error("Multiple StyleProp instances with the same id: ".concat(u.id));r.set(u.id,u)}}catch(f){s.e(f)}finally{s.f()}}}catch(f){i.e(f)}finally{i.f()}var c=Hi(n),d=function(e){var t,n={},r=J(e);try{for(r.s();!(t=r.n()).done;){var i=l(t.value,2),o=i[0],a=i[1];n[o]=dn(a)}}catch(f){r.e(f)}finally{r.f()}var s=ln("instance",nn({typeName:Zt("instance"),id:hn("instance"),currentPageId:An,followingUserId:Vt.nullable(),brush:_n.nullable(),opacityForNextShape:In,stylesForNextShape:nn(n),cursor:Cn,scribble:Mn.nullable(),isFocusMode:Gt,isDebugMode:Gt,isToolLocked:Gt,exportBackground:Gt,screenBounds:_n,zoomBrush:_n.nullable(),isPenMode:Gt,isGridMode:Gt,chatMessage:Vt,isChatting:Gt,highlightedUserIds:en(Vt),meta:on}));return st("instance",{migrations:xr,validator:s,scope:"session"}).withDefaultProperties((function(){return{followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribble:null,cursor:{type:"default",color:"black",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],meta:{}}}))}(r);return kt.create({asset:Mi,camera:kn,document:ni,instance:d,instance_page_state:Lr,page:Dn,shape:c,instance_presence:Gr,pointer:Br},{snapshotMigrations:$i,onValidationFailure:ai,createIntegrityChecker:si})}var Qi=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"],Zi={lightMode:{text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4263eb",semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#adb5bd",semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4dabf7",semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#40c057",semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#ff8787",semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e599f7",semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#f76707",semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#ffc078",semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}}},darkMode:{text:"#f8f9fa",background:"#212529",solid:"#28292e",black:{solid:"#e1e1e1",semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4156be",semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#3b7b5e",semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#93989f",semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#588fc9",semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#599f57",semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#c67877",semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#b583c9",semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#bf612e",semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#aa3c37",semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#873fa3",semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#cba371",semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}}}};function Ji(e){return e.isDarkMode?Zi.darkMode:Zi.lightMode}var eo,to,no,ro,io=ji.defineEnum("tldraw:color",{defaultValue:"black",values:Qi}),oo=ji.defineEnum("tldraw:labelColor",{defaultValue:"black",values:Qi}),ao=ji.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),so=ji.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),uo=ji.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),lo={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},co=ji.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),fo=["labelColor"],po=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],ho=ji.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:po}),vo=ji.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:po}),go=un("type",{binding:nn({type:Zt("binding"),boundShapeId:_r,normalizedAnchor:Sn,isExact:Gt}),point:nn({type:Zt("point"),x:Wt,y:Wt})}),mo={labelColor:oo,color:io,fill:so,dash:ao,size:co,arrowheadStart:ho,arrowheadEnd:vo,font:uo,start:go,end:go,bend:Wt,text:Vt},yo=1,bo=yt({currentVersion:yo,migrators:D({},yo,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{labelColor:"black"})})},down:function(e){var t=e.props,n=(t.labelColor,gt(t,fo));return Ce(Ce({},e),{},{props:n})}})}),wo=["assetId"],xo={w:Yt,h:Yt,assetId:vn.nullable(),url:Vt},ko=1,So=yt({currentVersion:ko,migrators:D({},ko,{up:function(e){return void 0===e.props.assetId?Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{assetId:null})}):e},down:function(e){if(null===e.props.assetId){var t=e.props,n=(t.assetId,gt(t,wo));return Ce(Ce({},e),{},{props:n})}return e}})}),_o=["isPen"],Po=nn({type:pn("free","straight"),points:en(Sn)}),Eo={color:io,fill:so,dash:ao,size:co,segments:en(Po),isComplete:Gt,isClosed:Gt,isPen:Gt},Co=1,Io=yt({currentVersion:Co,migrators:D({},Co,{up:function(e){var t=e.props.segments[0].points;if(0===t.length)return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{isPen:!1})});var n=!(0===t[0].z||.5===t[0].z);return t[1]&&(n=n&&!(0===t[1].z||.5===t[1].z)),Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{isPen:n})})},down:function(e){var t=e.props,n=(t.isPen,gt(t,_o));return Ce(Ce({},e),{},{props:Ce({},n)})}})}),To=["tmpOldUrl"],Mo=["doesResize"],jo=["tmpOldUrl"],Ao=["overridePermissions"],Oo=/(^\/r\/[^/]+\/?$)/,Lo=function(e){try{return new URL(e)}catch(t){return}},zo=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","lite.tldraw.com","www.tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(Oo))return e},fromEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(Oo))return e}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=Lo(e),n=t&&t.pathname.match(/\/s\/([^/]+)\/?/);if(n)return"https://codesandbox.io/embed/".concat(n[1])},fromEmbedUrl:function(e){var t=Lo(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return"https://codesandbox.io/s/".concat(n[1])}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=e.match(/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/);if(t){var n=l(t,3),r=(n[0],n[1]),i=n[2];return"https://codepen.io/".concat(r,"/embed/").concat(i)}},fromEmbedUrl:function(e){var t=e.match(/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/);if(t){var n=l(t,3),r=(n[0],n[1]),i=n[2];return"https://codepen.io/".concat(r,"/pen/").concat(i)}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,canUnmount:!1,toEmbedUrl:function(e){var t=e.match(/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/);if(t){var n=l(t,2),r=(n[0],n[1]);return"https://scratch.mit.edu/projects/embed/".concat(r)}},fromEmbedUrl:function(e){var t=e.match(/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/);if(t){var n=l(t,2),r=(n[0],n[1]);return"https://scratch.mit.edu/projects/".concat(r)}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,canUnmount:!1,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:function(e){var t=Lo(e);if(t){var n=t.hostname.replace(/^www./,"");if("youtu.be"===n){var r=t.pathname.split("/").filter(Boolean)[0];return"https://www.youtube.com/embed/".concat(r)}if(("youtube.com"===n||"m.youtube.com"===n)&&t.pathname.match(/^\/watch/)){var i=t.searchParams.get("v");return"https://www.youtube.com/embed/".concat(i)}}},fromEmbedUrl:function(e){var t=Lo(e);if(t&&"youtube.com"===t.hostname.replace(/^www./,"")){var n=t.pathname.match(/^\/embed\/([^/]+)\/?/);if(n)return"https://www.youtube.com/watch?v=".concat(n[1])}}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:function(e){if(e.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!e.includes("figma.com/embed"))return"https://www.figma.com/embed?embed_host=share&url=".concat(e)},fromEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/^\/embed\/?$/)){var n=t.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){if(e.includes("/maps/")){var t,n=e.match(/@(.*),(.*),(.*)z/);if(n){var r=l(n,4),i=r[1],o=r[2],a=r[3],s=new URL(e).host.replace("www.","");t="https://".concat(s,"/maps/embed/v1/view?key=").concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NEXT_PUBLIC_GC_API_KEY,"&center=").concat(i,",").concat(o,"&zoom=").concat(a)}else t="";return t}},fromEmbedUrl:function(e){var t=Lo(e);if(t&&(t.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&t.searchParams.has("center")&&t.searchParams.get("zoom"))){var n=t.searchParams.get("zoom"),r=l(t.searchParams.get("center").split(","),2),i=r[0],o=r[1];return"https://www.google.com/maps/@".concat(i,",").concat(o,",").concat(n,"z")}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:function(e){var t=Lo(e),n=null===t||void 0===t?void 0:t.searchParams.get("cid");if(null!==t&&void 0!==t&&t.pathname.match(/\/calendar\/u\/0/)&&n){t.pathname="/calendar/embed";for(var r=0,i=Array.from(t.searchParams.keys());r<i.length;r++){var o=i[r];t.searchParams.delete(o)}return t.searchParams.set("src",n),t.href}},fromEmbedUrl:function(e){var t=Lo(e),n=null===t||void 0===t?void 0:t.searchParams.get("src");if(null!==t&&void 0!==t&&t.pathname.match(/\/calendar\/embed/)&&n){t.pathname="/calendar/u/0";for(var r=0,i=Array.from(t.searchParams.keys());r<i.length;r++){var o=i[r];t.searchParams.delete(o)}return t.searchParams.set("cid",n),t.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=Lo(e);if(null!==t&&void 0!==t&&t.pathname.match(/^\/presentation/)&&null!==t&&void 0!==t&&t.pathname.match(/\/pub\/?$/)){t.pathname=t.pathname.replace(/\/pub$/,"/embed");for(var n=0,r=Array.from(t.searchParams.keys());n<r.length;n++){var i=r[n];t.searchParams.delete(i)}return t.href}},fromEmbedUrl:function(e){var t=Lo(e);if(null!==t&&void 0!==t&&t.pathname.match(/^\/presentation/)&&null!==t&&void 0!==t&&t.pathname.match(/\/embed\/?$/)){t.pathname=t.pathname.replace(/\/embed$/,"/pub");for(var n=0,r=Array.from(t.searchParams.keys());n<r.length;n++){var i=r[n];t.searchParams.delete(i)}return t.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!e.split("/").pop())return;return e}},fromEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!e.split("/").pop())return;return e}}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/))return"".concat(e,"?embed=true")},fromEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/)&&t.searchParams.has("embed"))return t.searchParams.delete("embed"),t.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/^\/map\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/^\/embed\/map\//))return t.pathname=t.pathname.replace(/^\/embed/,""),t.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,canUnmount:!1,toEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/^\/(artist|album)\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/^\/embed\/(artist|album)\//))return t.origin+t.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:function(e){var t=Lo(e);if(t&&"vimeo.com"===t.hostname&&t.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+t.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:function(e){var t=Lo(e);if(t&&"player.vimeo.com"===t.hostname){var n=t.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:function(e){var t=Lo(e);if(t&&t.hash.match(/#room=/))return e},fromEmbedUrl:function(e){var t=Lo(e);if(t&&t.hash.match(/#room=/))return e}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:function(e){var t=Lo(e);if(t&&t.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return"".concat(t.origin,"/embed").concat(t.pathname,"?cell=*");if(t&&t.pathname.match(/^\/d\/([^/]+)\/?$/)){var n=t.pathname.replace(/^\/d/,"");return"".concat(t.origin,"/embed").concat(n,"?cell=*")}},fromEmbedUrl:function(e){var t=Lo(e);return t&&t.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/)?"".concat(t.origin).concat(t.pathname.replace("/embed",""),"#cell-*"):t&&t.pathname.match(/^\/embed\/([^/]+)\/?$/)?"".concat(t.origin).concat(t.pathname.replace("/embed","/d"),"#cell-*"):void 0}}],Do={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},No={w:Yt,h:Yt,url:Vt},Ro=2,Bo=3,Fo=4,Uo=yt({currentVersion:Fo,migrators:(eo={},D(eo,1,{up:function(e){for(var t,n,r=e.props.url,i=new URL(r).host.replace("www.",""),o=0,a=zo;o<a.length;o++){var s=a[o];if(s.hostnames.includes(i))try{n=s.fromEmbedUrl(r)}catch(u){console.warn(u)}}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{tmpOldUrl:e.props.url,url:null!==(t=n)&&void 0!==t?t:""})})},down:function(e){var t,n=e.props.tmpOldUrl;if(!n||""===n)for(var r=e.props.url,i=new URL(r).host.replace("www.",""),o=0,a=zo;o<a.length;o++){var s=a[o];if(s.hostnames.includes(i))try{n=s.toEmbedUrl(r)}catch(c){console.warn(c)}}var u=e.props,l=(u.tmpOldUrl,gt(u,To));return Ce(Ce({},e),{},{props:Ce(Ce({},l),{},{url:null!==(t=n)&&void 0!==t?t:""})})}}),D(eo,Ro,{up:function(e){var t=e.props,n=(t.doesResize,gt(t,Mo));return Ce(Ce({},e),{},{props:Ce({},n)})},down:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{doesResize:!0})})}}),D(eo,Bo,{up:function(e){var t=e.props,n=(t.tmpOldUrl,gt(t,jo));return Ce(Ce({},e),{},{props:Ce({},n)})},down:function(e){return Ce(Ce({},e),{},{props:Ce({},e.props)})}}),D(eo,Fo,{up:function(e){var t=e.props,n=(t.overridePermissions,gt(t,Ao));return Ce(Ce({},e),{},{props:Ce({},n)})},down:function(e){return Ce(Ce({},e),{},{props:Ce({},e.props)})}}),eo)}),Ko={w:Yt,h:Yt,name:Vt},Vo=yt({}),Wo=ji.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),Ho=ji.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),Yo=["url"],Xo=["labelColor"],qo=["verticalAlign"],$o=ji.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),Go={geo:$o,labelColor:oo,color:io,fill:so,dash:ao,size:co,font:uo,align:Wo,verticalAlign:Ho,url:Vt,w:Yt,h:Yt,growY:Ht,text:Vt},Qo=2,Zo=3,Jo=4,ea=5,ta=6,na=yt({currentVersion:ta,migrators:(to={},D(to,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{url:""})})},down:function(e){var t=e.props,n=(t.url,gt(t,Yo));return Ce(Ce({},e),{},{props:n})}}),D(to,Qo,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{labelColor:"black"})})},down:function(e){var t=e.props,n=(t.labelColor,gt(t,Xo));return Ce(Ce({},e),{},{props:n})}}),D(to,Zo,{up:function(e){var t=e.props.align;return"justify"===t&&(t="start"),Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){return Ce({},e)}}),D(to,Jo,{up:function(e){return Ce({},e)},down:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{geo:"check-box"===e.props.geo?"rectangle":e.props.geo})})}}),D(to,ea,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{verticalAlign:"middle"})})},down:function(e){var t=e.props,n=(t.verticalAlign,gt(t,qo));return Ce(Ce({},e),{},{props:n})}}),D(to,ta,{up:function(e){var t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy"}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){var t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})}}),to)}),ra=yt({}),ia={color:io,size:co,segments:en(Po),isComplete:Gt,isPen:Gt},oa=yt({}),aa=["url"],sa=["crop"],ua=nn({topLeft:Sn,bottomRight:Sn}),la={w:Yt,h:Yt,playing:Gt,url:Vt,assetId:vn.nullable(),crop:ua.nullable()},ca=2,da=yt({currentVersion:ca,migrators:(no={},D(no,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{url:""})})},down:function(e){var t=e.props,n=(t.url,gt(t,aa));return Ce(Ce({},e),{},{props:n})}}),D(no,ca,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{crop:null})})},down:function(e){var t=e.props,n=(t.crop,gt(t,sa));return Ce(Ce({},e),{},{props:n})}}),no)}),fa=nn({id:Vt,type:cn(new Set(["vertex","virtual","create"])),canBind:Gt.optional(),index:Vt,x:Wt,y:Wt}),pa=ji.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),ha={color:io,dash:ao,size:co,spline:pa,handles:sn(Vt,fa)},va=yt({}),ga=["url"],ma=["verticalAlign"],ya={color:io,size:co,font:uo,align:Wo,verticalAlign:Ho,growY:Ht,url:Vt,text:Vt},ba=2,wa=3,xa=4,ka=yt({currentVersion:xa,migrators:(ro={},D(ro,1,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{url:""})})},down:function(e){var t=e.props,n=(t.url,gt(t,ga));return Ce(Ce({},e),{},{props:n})}}),D(ro,ba,{up:function(e){var t=e.props.align;return"justify"===t&&(t="start"),Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){return Ce({},e)}}),D(ro,wa,{up:function(e){var t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy"}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){var t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})}}),D(ro,xa,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{verticalAlign:"middle"})})},down:function(e){var t=e.props,n=(t.verticalAlign,gt(t,ma));return Ce(Ce({},e),{},{props:n})}}),ro)}),Sa={color:io,size:co,font:uo,align:Wo,w:Yt,text:Vt,scale:Yt,autoSize:Gt},_a=1,Pa=yt({currentVersion:_a,migrators:D({},_a,{up:function(e){var t=e.props.align;return"justify"===t&&(t="start"),Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{align:t})})},down:function(e){return Ce({},e)}})}),Ea=["url"],Ca={w:Yt,h:Yt,time:Wt,playing:Gt,url:Vt,assetId:vn.nullable()},Ia=1,Ta=yt({currentVersion:Ia,migrators:D({},Ia,{up:function(e){return Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},{url:""})})},down:function(e){var t=e.props,n=(t.url,gt(t,Ea));return Ce(Ce({},e),{},{props:n})}})}),Ma=[{locale:"ar",label:"\u0639\u0631\u0628\u064a"},{locale:"ca",label:"Catal\xe0"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espa\xf1ol"},{locale:"fa",label:"\u0641\u0627\u0631\u0633\u06cc"},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Fran\xe7ais"},{locale:"gl",label:"Galego"},{locale:"he",label:"\u05e2\u05d1\u05e8\u05d9\u05ea"},{locale:"it",label:"Italiano"},{locale:"ja",label:"\u65e5\u672c\u8a9e"},{locale:"ko-kr",label:"\ud55c\uad6d\uc5b4"},{locale:"ku",label:"\u06a9\u0648\u0631\u062f\u06cc"},{locale:"hi-in",label:"\u0939\u093f\u0928\u094d\u0926\u0940"},{locale:"hu",label:"Magyar"},{locale:"my",label:"\u1019\u103c\u1014\u103a\u1019\u102c\u1005\u102c"},{locale:"ne",label:"\u0928\u0947\u092a\u093e\u0932\u0940"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugu\xeas - Brasil"},{locale:"pt-pt",label:"Portugu\xeas - Europeu"},{locale:"ro",label:"Rom\xe2n\u0103"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:"\u0c24\u0c46\u0c32\u0c41\u0c17\u0c41"},{locale:"th",label:"\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22"},{locale:"tr",label:"T\xfcrk\xe7e"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Ti\u1ebfng Vi\u1ec7t"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:"\u7e41\u9ad4\u4e2d\u6587 (\u53f0\u7063)"}];function ja(){var e;return function(e){var t,n=J(e);try{for(n.s();!(t=n.n()).done;){var r=Oa(t.value);if(r)return r}}catch(i){n.e(i)}finally{n.f()}return"en"}("undefined"!==typeof window&&null!==(e=window.navigator.languages)&&void 0!==e?e:["en"])}var Aa={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function Oa(e){var t=Ma.find((function(t){return t.locale===e.toLowerCase()}));if(t)return t.locale;var n=e.split(/[-_]/).map((function(e){return e.toLowerCase()})),r=l(n,2),i=r[0];if(r[1]){var o=Ma.find((function(e){return e.locale===i}));if(o)return o.locale}return i in Aa?Aa[i]:null}var La=n(6417),za="2.0.0-alpha.14",Da={fonts:{draw:"https://unpkg.com/@tldraw/assets@".concat(za,"/fonts/Shantell_Sans-Normal-SemiBold.woff2"),serif:"https://unpkg.com/@tldraw/assets@".concat(za,"/fonts/IBMPlexSerif-Medium.woff2"),sansSerif:"https://unpkg.com/@tldraw/assets@".concat(za,"/fonts/IBMPlexSans-Medium.woff2"),monospace:"https://unpkg.com/@tldraw/assets@".concat(za,"/fonts/IBMPlexMono-Medium.woff2")}};function Na(){Na=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(I){u=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof f?t:f,a=Object.create(o.prototype),s=new P(i||[]);return r(a,"_invoke",{value:x(e,n,s)}),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(I){return{type:"throw",arg:I}}}e.wrap=l;var d={};function f(){}function p(){}function h(){}var v={};u(v,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(E([])));m&&m!==t&&n.call(m,o)&&(v=m);var y=h.prototype=f.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,o,a,s){var u=c(e[r],e,o);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==A(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return C()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=c(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return p.prototype=h,r(y,"constructor",{value:h,configurable:!0}),r(h,"constructor",{value:p,configurable:!0}),p.displayName=u(h,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new w(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=E,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function Ra(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}function Ba(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ra(o,r,i,a,s,"next",e)}function s(e){Ra(o,r,i,a,s,"throw",e)}a(void 0)}))}}var Fa=n(6123),Ua=t.createContext({}),Ka=function(){return t.useContext(Ua)},Va={openWindow:function(e,t){return window.open(e,t,"noopener noreferrer")},refreshPage:function(){return window.location.reload()},hardReset:function(){var e=Ba(Na().mark((function e(){var t,n;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=(n=window).__tldraw__hardReset)||void 0===t?void 0:t.call(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};function Wa(){Va.hardReset()}var Ha={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},easeInSine:function(e){return 1-Math.cos(e*Math.PI/2)},easeOutSine:function(e){return Math.sin(e*Math.PI/2)},easeInOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},easeInExpo:function(e){return e<=0?0:Math.pow(2,10*e-10)},easeOutExpo:function(e){return e>=1?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return e<=0?0:e>=1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2}},Ya=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;j(this,e),this.x=t,this.y=n,this.z=r}return z(e,[{key:"pressure",get:function(){return this.z}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.x,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.y,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.z;return this.x=e,this.y=t,this.z=n,this}},{key:"setTo",value:function(e){var t=e.x,n=void 0===t?0:t,r=e.y,i=void 0===r?0:r,o=e.z,a=void 0===o?1:o;return this.x=n,this.y=i,this.z=a,this}},{key:"rot",value:function(e){if(0===e)return this;var t=this.x,n=this.y,r=Math.sin(e),i=Math.cos(e);return this.x=t*i-n*r,this.y=t*r+n*i,this}},{key:"rotWith",value:function(e,t){if(0===t)return this;var n=this.x-e.x,r=this.y-e.y,i=Math.sin(t),o=Math.cos(t);return this.x=e.x+(n*o-r*i),this.y=e.y+(n*i+r*o),this}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"subXY",value:function(e,t){return this.x-=e,this.y-=t,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"addXY",value:function(e,t){return this.x+=e,this.y+=t,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"clamp",value:function(e,t){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),void 0!==t&&(this.x=Math.min(this.x,t),this.y=Math.min(this.y,t)),this}},{key:"div",value:function(e){return this.x/=e,this.y/=e,this}},{key:"divV",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"mul",value:function(e){return this.x*=e,this.y*=e,this}},{key:"mulV",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"abs",value:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}},{key:"nudge",value:function(t,n){var r=e.Tan(t,this);return this.add(r.mul(n))}},{key:"neg",value:function(){return this.x*=-1,this.y*=-1,this}},{key:"cross",value:function(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}},{key:"dpr",value:function(t){return e.Dpr(this,t)}},{key:"cpr",value:function(t){return e.Cpr(this,t)}},{key:"len2",value:function(){return e.Len2(this)}},{key:"len",value:function(){return e.Len(this)}},{key:"pry",value:function(t){return e.Pry(this,t)}},{key:"per",value:function(){var e=this.x,t=this.y;return this.x=t,this.y=-e,this}},{key:"uni",value:function(){return e.Uni(this)}},{key:"tan",value:function(t){return e.Tan(this,t)}},{key:"dist",value:function(t){return e.Dist(this,t)}},{key:"distanceToLineSegment",value:function(t,n){return e.DistanceToLineSegment(t,n,this)}},{key:"slope",value:function(t){return e.Slope(this,t)}},{key:"snapToGrid",value:function(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}},{key:"angle",value:function(t){return e.Angle(this,t)}},{key:"toAngle",value:function(){return e.ToAngle(this)}},{key:"lrp",value:function(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this}},{key:"equals",value:function(t){return e.Equals(this,t)}},{key:"equalsXY",value:function(t,n){return e.EqualsXY(this,t,n)}},{key:"norm",value:function(){var e=this.len();return this.x=0===e?0:this.x/e,this.y=0===e?0:this.y/e,this}},{key:"toFixed",value:function(){return e.ToFixed(this)}},{key:"toString",value:function(){return e.ToString(e.ToFixed(this))}},{key:"toJson",value:function(){return e.ToJson(this)}},{key:"toArray",value:function(){return e.ToArray(this)}}],[{key:"Add",value:function(t,n){return new e(t.x+n.x,t.y+n.y)}},{key:"AddXY",value:function(t,n,r){return new e(t.x+n,t.y+r)}},{key:"Sub",value:function(t,n){return new e(t.x-n.x,t.y-n.y)}},{key:"SubXY",value:function(t,n,r){return new e(t.x-n,t.y-r)}},{key:"AddScalar",value:function(t,n){return new e(t.x+n,t.y+n)}},{key:"SubScalar",value:function(t,n){return new e(t.x-n,t.y-n)}},{key:"Div",value:function(t,n){return new e(t.x/n,t.y/n)}},{key:"Mul",value:function(t,n){return new e(t.x*n,t.y*n)}},{key:"DivV",value:function(t,n){return new e(t.x/n.x,t.y/n.y)}},{key:"MulV",value:function(t,n){return new e(t.x*n.x,t.y*n.y)}},{key:"Neg",value:function(t){return new e(-t.x,-t.y)}},{key:"Per",value:function(t){return new e(t.y,-t.x)}},{key:"Dist2",value:function(t,n){return e.Sub(t,n).len2()}},{key:"Abs",value:function(t){return new e(Math.abs(t.x),Math.abs(t.y))}},{key:"Dist",value:function(e,t){return Math.hypot(e.y-t.y,e.x-t.x)}},{key:"Dpr",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"Cross",value:function(t,n){return new e(t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z)}},{key:"Cpr",value:function(e,t){return e.x*t.y-t.x*e.y}},{key:"Len2",value:function(e){return e.x*e.x+e.y*e.y}},{key:"Len",value:function(t){return Math.sqrt(e.Len2(t))}},{key:"Pry",value:function(t,n){return e.Dpr(t,n)/e.Len(n)}},{key:"Uni",value:function(t){return e.Div(t,e.Len(t))}},{key:"Tan",value:function(t,n){return e.Uni(e.Sub(t,n))}},{key:"Min",value:function(t,n){return new e(Math.min(t.x,n.x),Math.min(t.y,n.y))}},{key:"Max",value:function(t,n){return new e(Math.max(t.x,n.x),Math.max(t.y,n.y))}},{key:"From",value:function(t){var n=t.x,r=t.y,i=t.z;return new e(n,r,void 0===i?1:i)}},{key:"FromArray",value:function(t){return new e(t[0],t[1])}},{key:"Rot",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Math.sin(n),i=Math.cos(n);return new e(t.x*i-t.y*r,t.x*r+t.y*i)}},{key:"RotWith",value:function(t,n,r){var i=t.x-n.x,o=t.y-n.y,a=Math.sin(r),s=Math.cos(r);return new e(n.x+(i*s-o*a),n.y+(i*a+o*s))}},{key:"NearestPointOnLineThroughPoint",value:function(t,n,r){return e.Mul(n,e.Sub(r,t).pry(n)).add(t)}},{key:"NearestPointOnLineSegment",value:function(t,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=e.Tan(n,t),a=e.Add(t,e.Mul(o,e.Sub(r,t).pry(o)));if(i){if(a.x<Math.min(t.x,n.x))return e.Cast(t.x<n.x?t:n);if(a.x>Math.max(t.x,n.x))return e.Cast(t.x>n.x?t:n);if(a.y<Math.min(t.y,n.y))return e.Cast(t.y<n.y?t:n);if(a.y>Math.max(t.y,n.y))return e.Cast(t.y>n.y?t:n)}return a}},{key:"DistanceToLineThroughPoint",value:function(t,n,r){return e.Dist(r,e.NearestPointOnLineThroughPoint(t,n,r))}},{key:"DistanceToLineSegment",value:function(t,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return e.Dist(r,e.NearestPointOnLineSegment(t,n,r,i))}},{key:"Snap",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new e(Math.round(t.x/n)*n,Math.round(t.y/n)*n)}},{key:"Cast",value:function(t){return t instanceof e?t:e.From(t)}},{key:"Slope",value:function(e,t){return e.x===t.y?NaN:(e.y-t.y)/(e.x-t.x)}},{key:"Angle",value:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}},{key:"Lrp",value:function(t,n,r){return e.Sub(n,t).mul(r).add(t)}},{key:"Med",value:function(t,n){return new e((t.x+n.x)/2,(t.y+n.y)/2)}},{key:"Equals",value:function(e,t){return Math.abs(e.x-t.x)<1e-4&&Math.abs(e.y-t.y)<1e-4}},{key:"EqualsXY",value:function(e,t,n){return e.x===t&&e.y===n}},{key:"Clockwise",value:function(e,t,n){return(n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y)<0}},{key:"Rescale",value:function(t,n){var r=e.Len(t);return new e(n*t.x/r,n*t.y/r)}},{key:"ScaleWithOrigin",value:function(t,n,r){return e.Sub(t,r).mul(n).add(r)}},{key:"ToFixed",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return new e(+t.x.toFixed(n),+t.y.toFixed(n),+t.z.toFixed(n))}},{key:"Nudge",value:function(t,n,r){return e.Add(t,e.Tan(n,t).mul(r))}},{key:"ToString",value:function(e){return"".concat(e.x,", ").concat(e.y)}},{key:"ToAngle",value:function(e){var t=Math.atan2(e.y,e.x);return t<0&&(t+=2*Math.PI),t}},{key:"ToArray",value:function(e){return[e.x,e.y,e.z]}},{key:"ToJson",value:function(e){return{x:e.x,y:e.y,z:e.z}}},{key:"Average",value:function(t){for(var n=t.length,r=new e(0,0),i=0;i<n;i++)r.add(t[i]);return r.div(n)}},{key:"Clamp",value:function(t,n,r){return void 0===r?new e(Math.min(Math.max(t.x,n)),Math.min(Math.max(t.y,n))):new e(Math.min(Math.max(t.x,n),r),Math.min(Math.max(t.y,n),r))}},{key:"PointsBetween",value:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,i=[],o=0;o<r;o++){var a=Ha.easeInQuad(o/(r-1)),s=e.Lrp(t,n,a);s.z=Math.min(1,.5+.65*Math.abs(.5-Xa(a))),i.push(s)}return i}},{key:"SnapToGrid",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return new e(Math.round(t.x/n)*n,Math.round(t.y/n)*n)}}]),e}(),Xa=function(e){return e<.5?2*e*e:(4-2*e)*e-1},qa=Math.PI,$a=qa/2,Ga=2*qa,Qa=Math.PI/180,Za=Math.sin;function Ja(e,t,n){return Math.max(t,"undefined"!==typeof n?Math.min(e,n):e)}function es(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return e?Math.round(e*t)/t:0}function ts(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return Math.abs(e-t)<=n}function ns(e,t){var n=Math.pow(e-t,2)/Math.pow(e+t,2);return qa*(e+t)*(1+3*n/(10+Math.sqrt(4-3*n)))}function rs(e){return(e%=Ga)<0?e+=Ga:0===e&&(e=0),e}function is(e,t){var n=(t-e)%Ga;return 2*n%Ga-n}function os(e,t,n){return e+is(e,t)*n}function as(e,t){return is(e,t)}function ss(e){return(Ga+e)%Ga}function us(e,t){var n=Ga/t,r=Math.floor((ss(e)+n/2)/n)*n%Ga;return r<qa&&(r+=Ga),r>qa&&(r-=Ga),r}function ls(e,t){return e===t||ts(e%(Math.PI/2)-t%(Math.PI/2),0)}function cs(e,t,n,r){var i=function(e,t,n){return as(Ya.Angle(e,t),Ya.Angle(e,n))}(e,n,r);return t*Ga*(i/Ga)}function ds(e,t,n,r){return new Ya(e+n*Math.cos(r),t+n*Math.sin(r))}function fs(e,t,n){for(var r=e/2,i=t/2,o=[],a=0;a<n;a++){var s=a*(Ga/n)-$a;o.push(new Ya(r+r*Math.cos(s),i+i*Math.sin(s)))}return o}function ps(e,t,n,r){return e<r&&n<t}function hs(e,t,n,r){var i=Math.max(e,n),o=Math.min(t,r);return i<=o?[i,o]:null}function vs(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}function gs(e,t){for(var n,r,i=0,o=0;o<t.length;o++)n=t[o],r=t[(o+1)%t.length],n.y<=e.y?r.y>e.y&&vs(n,r,e)>0&&(i+=1):r.y<=e.y&&vs(n,r,e)<0&&(i-=1);return 0!==i}function ms(e){return+e.toFixed(4)}function ys(e){return+e.toFixed(2)}var bs=function(e){return Math.abs(e)<Number.MAX_SAFE_INTEGER},ws=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;j(this,e),D(this,"x",0),D(this,"y",0),D(this,"w",0),D(this,"h",0),this.x=t,this.y=n,this.w=r,this.h=i}return z(e,[{key:"point",get:function(){return new Ya(this.x,this.y)},set:function(e){this.x=e.x,this.y=e.y}},{key:"minX",get:function(){return this.x},set:function(e){this.x=e}},{key:"midX",get:function(){return this.x+this.w/2}},{key:"maxX",get:function(){return this.x+this.w}},{key:"minY",get:function(){return this.y},set:function(e){this.y=e}},{key:"midY",get:function(){return this.y+this.h/2}},{key:"maxY",get:function(){return this.y+this.h}},{key:"width",get:function(){return this.w},set:function(e){this.w=e}},{key:"height",get:function(){return this.h},set:function(e){this.h=e}},{key:"aspectRatio",get:function(){return this.width/this.height}},{key:"center",get:function(){return new Ya(this.midX,this.midY)},set:function(e){this.minX=e.x-this.width/2,this.minY=e.y-this.height/2}},{key:"corners",get:function(){return[new Ya(this.minX,this.minY),new Ya(this.maxX,this.minY),new Ya(this.maxX,this.maxY),new Ya(this.minX,this.maxY)]}},{key:"snapPoints",get:function(){return[new Ya(this.minX,this.minY),new Ya(this.maxX,this.minY),new Ya(this.maxX,this.maxY),new Ya(this.minX,this.maxY),this.center]}},{key:"sides",get:function(){var e=this.corners;return[[e[0],e[1]],[e[1],e[2]],[e[2],e[3]],[e[3],e[0]]]}},{key:"size",get:function(){return new Ya(this.w,this.h)}},{key:"toFixed",value:function(){return this.x=es(this.x),this.y=es(this.y),this.w=es(this.w),this.h=es(this.h),this}},{key:"setTo",value:function(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.x=e,this.y=t,this.w=n,this.h=r,this}},{key:"expand",value:function(e){var t=Math.min(this.minX,e.minX),n=Math.min(this.minY,e.minY),r=Math.max(this.maxX,e.maxX),i=Math.max(this.maxY,e.maxY);return this.x=t,this.y=n,this.w=r-t,this.h=i-n,this}},{key:"expandBy",value:function(e){return this.x-=e,this.y-=e,this.w+=2*e,this.h+=2*e,this}},{key:"scale",value:function(e){return this.x/=e,this.y/=e,this.w/=e,this.h/=e,this}},{key:"clone",value:function(){return new e(this.x,this.y,this.w,this.h)}},{key:"translate",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"snapToGrid",value:function(e){var t=Math.round(this.minX/e)*e,n=Math.round(this.minY/e)*e,r=Math.round(this.maxX/e)*e,i=Math.round(this.maxY/e)*e;this.minX=t,this.minY=n,this.width=Math.max(1,r-t),this.height=Math.max(1,i-n)}},{key:"collides",value:function(t){return e.Collides(this,t)}},{key:"contains",value:function(t){return e.Contains(this,t)}},{key:"includes",value:function(t){return e.Includes(this,t)}},{key:"containsPoint",value:function(t,n){return e.ContainsPoint(this,t,n)}},{key:"getHandlePoint",value:function(e){switch(e){case"top_left":return new Ya(this.minX,this.minY);case"top_right":return new Ya(this.maxX,this.minY);case"bottom_left":return new Ya(this.minX,this.maxY);case"bottom_right":return new Ya(this.maxX,this.maxY);case"top":return new Ya(this.midX,this.minY);case"right":return new Ya(this.maxX,this.midY);case"bottom":return new Ya(this.midX,this.maxY);case"left":return new Ya(this.minX,this.midY)}}},{key:"toJson",value:function(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}},{key:"resize",value:function(e,t,n){var r=this.minX,i=this.minY,o=this.maxX,a=this.maxY,s=this.minX,u=this.minY,l=this.maxX,c=this.maxY;switch(e){case"left":case"top_left":case"bottom_left":s+=t;break;case"right":case"top_right":case"bottom_right":l+=t}switch(e){case"top":case"top_left":case"top_right":u+=n;break;case"bottom":case"bottom_left":case"bottom_right":c+=n}if((l-s)/(o-r)<0){var d=l;l=s,s=d}if((c-u)/(a-i)<0){var f=c;c=u,u=f}this.minX=s,this.minY=u,this.width=Math.abs(l-s),this.height=Math.abs(c-u)}},{key:"union",value:function(e){var t=Math.min(this.minX,e.x),n=Math.min(this.minY,e.y),r=Math.max(this.maxX,e.w+e.x),i=Math.max(this.maxY,e.h+e.y);return this.x=t,this.y=n,this.width=r-t,this.height=i-n,this}},{key:"equals",value:function(t){return e.Equals(this,t)}}],[{key:"From",value:function(t){return new e(t.x,t.y,t.w,t.h)}},{key:"FromPoints",value:function(t){if(0===t.length)return new e;for(var n,r=1/0,i=1/0,o=-1/0,a=-1/0,s=0,u=t.length;s<u;s++)n=t[s],r=Math.min(n.x,r),i=Math.min(n.y,i),o=Math.max(n.x,o),a=Math.max(n.y,a);return new e(r,i,o-r,a-i)}},{key:"Expand",value:function(t,n){var r=Math.min(n.minX,t.minX),i=Math.min(n.minY,t.minY);return new e(r,i,Math.max(n.maxX,t.maxX)-r,Math.max(n.maxY,t.maxY)-i)}},{key:"ExpandBy",value:function(t,n){return new e(t.minX-n,t.minY-n,t.width+2*n,t.height+2*n)}},{key:"Resize",value:function(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.minX,s=t.minY,u=t.maxX,l=t.maxY,c=t.minX,d=t.minY,f=t.maxX,p=t.maxY;switch(n){case"left":case"top_left":case"bottom_left":c+=r;break;case"right":case"top_right":case"bottom_right":f+=r}switch(n){case"top":case"top_left":case"top_right":d+=i;break;case"bottom":case"bottom_left":case"bottom_right":p+=i}var h=(f-c)/(u-a),v=(p-d)/(l-s),g=h<0,m=v<0;if(o){var y=(u-a)/(l-s),b=Math.abs(f-c),w=Math.abs(p-d),x=b*(v<0?1:-1)*(1/y),k=w*(h<0?1:-1)*y,S=y<b/w;switch(n){case"top_left":S?d=p+x:c=f+k;break;case"top_right":S?d=p+x:f=c-k;break;case"bottom_right":S?p=d-x:f=c-k;break;case"bottom_left":S?p=d-x:c=f+k;break;case"bottom":case"top":var _=(c+f)/2,P=w*y;c=_-P/2,f=_+P/2;break;case"left":case"right":var E=(d+p)/2,C=b/y;d=E-C/2,p=E+C/2}}if(g){var I=f;f=c,c=I}if(m){var T=p;p=d,d=T}var M=new e(c,d,Math.abs(f-c),Math.abs(p-d));return{box:M,scaleX:+(M.width/t.width*(h>0?1:-1)).toFixed(5),scaleY:+(M.height/t.height*(v>0?1:-1)).toFixed(5)}}},{key:"Equals",value:function(e,t){return t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h}}]),e}();D(ws,"Collides",(function(e,t){return!(e.maxX<t.minX||e.minX>t.maxX||e.maxY<t.minY||e.minY>t.maxY)})),D(ws,"Contains",(function(e,t){return e.minX<t.minX&&e.minY<t.minY&&e.maxY>t.maxY&&e.maxX>t.maxX})),D(ws,"Includes",(function(e,t){return ws.Collides(e,t)||ws.Contains(e,t)})),D(ws,"ContainsPoint",(function(e,t,n){return"number"===typeof t?!(t<e.minX||n<e.minY||t>e.maxX||n>e.maxY):!(t.x<e.minX||t.y<e.minY||t.x>e.maxX||t.y>e.maxY)})),D(ws,"Common",(function(e){for(var t=1/0,n=1/0,r=-1/0,i=-1/0,o=0;o<e.length;o++){var a=e[o];t=Math.min(t,a.minX),n=Math.min(n,a.minY),r=Math.max(r,a.maxX),i=Math.max(i,a.maxY)}return new ws(t,n,r-t,i-n)})),D(ws,"Sides",(function(e){var t=e.corners;return[[t[0],t[1]],[t[1],t[2]],[t[2],t[3]],[t[3],t[0]]]}));var xs,ks=function(){function e(t){j(this,e),D(this,"_values",void 0),D(this,"_computed",{}),this._values=t}return z(e,[{key:"values",get:function(){return this._values},set:function(e){this._values=e,this._computed={}}},{key:"length",get:function(){if(void 0!==this._computed.length)return this._computed.length;for(var e=this.lut,t=e[0],n=0,r=1;r<e.length;r++){var i=e[r];n+=t.dist(i),t=i}return this._computed.length=n,n}},{key:"bounds",get:function(){if(void 0!==this._computed.bounds)return this._computed.bounds;var e,t=1/0,n=1/0,r=-1/0,i=-1/0,o=J(this.lut);try{for(o.s();!(e=o.n()).done;){var a=e.value;t=Math.min(a.x,t),n=Math.min(a.y,n),r=Math.max(a.x,r),i=Math.max(a.y,i)}}catch(u){o.e(u)}finally{o.f()}var s=new ws(t,n,r-t,i-n);return this._computed.bounds=s,s}},{key:"lut",get:function(){if(this._computed.lut)return this._computed.lut;for(var e=this.values.p,t=[],n=0;n<e+1;n++)t.push(this.getPoint(n/e));return this._computed.lut=t,t}},{key:"midPoint",get:function(){if(this._computed.midPoint)return this._computed.midPoint;var e=this.getPoint(.5);return this._computed.midPoint=e,e}},{key:"path",get:function(){if(this._computed.path)return this._computed.path;var e=this.getPath();return this._computed.path=e,e}},{key:"getPointAtLength",value:function(e){var t=Math.max(0,Math.min(1,e/this.length));return this.getPoint(t)}},{key:"getNormal",value:function(e){return this.getPoint(e-.0025).tan(this.getPoint(e+.0025)).per().uni().toFixed()}},{key:"getNormalAtLength",value:function(e){return this.getNormal(e/this.length)}},{key:"getClosestPointTo",value:function(e){for(var t=this.lut,n=0,r=t[0],i=t[0].dist(e),o=1;o<t.length;o++){var a=Ya.Dist(t[o],e);a<i&&(i=a,r=t[o],n=o/t.length)}for(var s=1/this.values.p,u=Math.max(0,n-s/2);u<Math.min(1,n+s/2);u+=s/10){var l=this.getPoint(u),c=Ya.Dist(l,e);c<i&&(i=c,r=l)}return{point:r,distance:i}}},{key:"update",value:function(e){this._computed={},this.values=Ce(Ce({},this.values),e)}}]),e}();xs=Symbol.iterator;var Ss=function(e){Et(n,e);var t=Tt(n);function n(e,r,i,o){var a,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:25;return j(this,n),D(_t(a=t.call(this,{a:e,b:r,c:i,d:o,p:s})),xs,Na().mark((function e(){var t,n,r,i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.values,n=t.a,r=t.b,i=t.c,o=t.d,e.delegateYield([n,r,i,o],"t0",2);case 2:case"end":return e.stop()}}),e,this)}))),a}return z(n,[{key:"getPath",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.values,n=t.a,r=t.b,i=t.c,o=t.d;return Ya.Equals(n,o)?"":"".concat(e?"M".concat(n.x.toFixed(2),",").concat(n.y.toFixed(2),"C"):"").concat(r.x.toFixed(2),",").concat(r.y.toFixed(2)," ").concat(i.x.toFixed(2),",").concat(i.y.toFixed(2)," ").concat(o.x.toFixed(2),",").concat(o.y.toFixed(2))}},{key:"getPoint",value:function(e){var t=this.values,n=t.a,r=t.b,i=t.c,o=t.d;return e<=0?Ya.From(n):e>=1?Ya.From(o):new Ya((1-e)*(1-e)*(1-e)*n.x+(1-e)*(1-e)*3*e*r.x+3*(1-e)*(e*e)*i.x+e*e*e*o.x,(1-e)*(1-e)*(1-e)*n.y+(1-e)*(1-e)*3*e*r.y+3*(1-e)*(e*e)*i.y+e*e*e*o.y)}},{key:"getX",value:function(e){var t=this.values,n=t.a,r=t.b,i=t.c,o=t.d;return(1-e)*(1-e)*(1-e)*n.x+(1-e)*(1-e)*3*e*r.x+3*(1-e)*(e*e)*i.x+e*e*e*o.x}},{key:"getY",value:function(e){var t=this.values,n=t.a,r=t.b,i=t.c,o=t.d;return(1-e)*(1-e)*(1-e)*n.y+(1-e)*(1-e)*3*e*r.y+3*(1-e)*(e*e)*i.y+e*e*e*o.y}}]),n}(ks),_s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;j(this,e),D(this,"computed",{}),this.points=t,this.p=n,this.k=r}return z(e,[{key:"length",get:function(){if(void 0!==this.computed.length)return this.computed.length;var e=this.segments.reduce((function(e,t){return e+t.length}),0);return this.computed.length=e,e}},{key:"bounds",get:function(){if(void 0!==this.computed.bounds)return this.computed.bounds;var e=this.segments,t=ws.Common(e.map((function(e){return e.bounds})));return this.computed.bounds=t,t}},{key:"head",get:function(){return this.points[0]}},{key:"tail",get:function(){var e=this.points;return e[e.length-1]}},{key:"path",get:function(){if(void 0!==this.computed.path)return this.computed.path;var e=this.segments.map((function(e){return e.path})).filter((function(e){return void 0!==e&&null!==e&&""!==e})).join(" ");return this.computed.path=e,e}},{key:"addPoint",value:function(e){var t=this.points,n=this.k,r=this.p;return t.push(e),this.computed={},this.getSegmentsFromPoints(this.points,r,n),this}},{key:"removePoint",value:function(e){var t=this.points,n=this.k,r=this.p,i="number"===typeof e?Math.floor(e):t.indexOf(e);return-1===i||(t.splice(i,1),this.computed={},this.getSegmentsFromPoints(this.points,r,n)),this}},{key:"getPointAtLength",value:function(e){var t=this.segments,n=e;if(e<=0)return t[0].getPoint(0);if(e>=this.length)return t[t.length-1].getPoint(1);for(var r=0;r<t.length;r++){var i=t[r],o=i.length;if(n<o)return i.getPoint(n/o);n-=i.length}return t[t.length-1].getPoint(1)}},{key:"getPoint",value:function(e){return e<=0?this.segments[0].getPoint(0):e>=1?this.segments[this.segments.length-1].getPoint(1):this.getPointAtLength(e*this.length)}},{key:"getNormal",value:function(e){var t=this.length;return this.getNormalAtLength(e*t)}},{key:"getNormalAtLength",value:function(e){var t=this.segments;if(e<0)return new Ya(0,0);var n,r=e,i=J(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=o.length;if(r<=a)return o.getNormal(r/a);r-=a}}catch(s){i.e(s)}finally{i.f()}return new Ya(0,0)}},{key:"getClosestPointTo",value:function(e){var t,n=this.head,r=this.segments,i=n,o=Ya.Dist(e,n),a=J(r);try{for(a.s();!(t=a.n()).done;){var s=t.value.getClosestPointTo(e);s.distance<o&&(o=s.distance,i=s.point)}}catch(u){a.e(u)}finally{a.f()}return{point:i,distance:o}}}]),e}(),Ps=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return j(this,n),D(_t(r=t.call(this,e,i,o)),"segments",void 0),r.segments=r.getSegmentsFromPoints(e,i,o),r}return z(n,[{key:"getSegmentsFromPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.25,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,r=e.length,i=r-2,o=[],a=0;a<r-1;a++){var s=0===a?e[0]:e[a-1],u=e[a],l=e[a+1],c=a===i?l:e[a+2];o.push(new Ss(u,0===a?s:new Ya(u.x+(l.x-s.x)/6*t,u.y+(l.y-s.y)/6*t),a===i?l:new Ya(l.x-(c.x-u.x)/6*t,l.y-(c.y-u.y)/6*t),l,n))}return o}}],[{key:"FromPoints",value:function(e){return new n(e)}}]),n}(_s),Es=function(e){Et(n,e);var t=Tt(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return j(this,n),(i=t.call(this,{a:e,b:r,p:o})).a=e,i.b=r,i.values.p=Math.max(10,Math.ceil(i.length/20)),i}return z(n,[{key:"length",get:function(){return Ya.Dist(this.a,this.b)}},{key:"tangent",get:function(){return Ya.Tan(this.a,this.b)}},{key:"angle",get:function(){return Ya.Angle(this.a,this.b)}},{key:"bounds",get:function(){return ws.FromPoints([this.a,this.b])}},{key:"getX",value:function(e){var t=this.values,n=t.a,r=t.b;return n.x+(r.x-n.x)*e}},{key:"getY",value:function(e){var t=this.values,n=t.a,r=t.b;return n.y+(r.y-n.y)*e}},{key:"getPoint",value:function(e){var t=this.values,n=t.a,r=t.b;return e<=0?Ya.From(n):e>=1?Ya.From(r):Ya.Lrp(n,r,e)}},{key:"getPath",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.values,n=t.a,r=t.b;return Ya.Equals(n,r)?"":e?"M".concat(n.x,",").concat(n.y,"L").concat(r.x,",").concat(r.y):"".concat(r.x,",").concat(r.y)}},{key:"getNormal",value:function(){var e=this.values,t=e.a,n=e.b;return Ya.Sub(t,n).per().uni().toFixed()}},{key:"getClosestPointTo",value:function(e){var t=this.values,n=t.a,r=t.b,i=Ya.NearestPointOnLineSegment(n,r,e),o=i.dist(e);return{point:i,distance:o}}}],[{key:"Length",value:function(e){return Ya.Dist(e.a,e.b)}},{key:"Tangent",value:function(e){return Ya.Tan(e.a,e.b)}},{key:"Angle",value:function(e){return Ya.Angle(e.a,e.b)}}]),n}(ks),Cs=function(){function e(t,n,r,i,o,a){j(this,e),D(this,"a",1),D(this,"b",0),D(this,"c",0),D(this,"d",1),D(this,"e",0),D(this,"f",0),this.a=t,this.b=n,this.c=r,this.d=i,this.e=o,this.f=a}return z(e,[{key:"equals",value:function(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}},{key:"identity",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}},{key:"multiply",value:function(e){var t=e,n=this.a,r=this.b,i=this.c,o=this.d,a=this.e,s=this.f;return this.a=n*t.a+i*t.b,this.c=n*t.c+i*t.d,this.e=n*t.e+i*t.f+a,this.b=r*t.a+o*t.b,this.d=r*t.c+o*t.d,this.f=r*t.e+o*t.f+s,this}},{key:"rotate",value:function(t,n,r){return 0===t?this:void 0===n?this.multiply(e.Rotate(t)):this.translate(n,r).multiply(e.Rotate(t)).translate(-n,-r)}},{key:"translate",value:function(t,n){return this.multiply(e.Translate(t,n))}},{key:"scale",value:function(t,n){return this.multiply(e.Scale(t,n))}},{key:"invert",value:function(){var e=this.a,t=this.b,n=this.c,r=this.d,i=this.e,o=this.f,a=e*r-t*n;return this.a=r/a,this.b=t/-a,this.c=n/-a,this.d=e/a,this.e=(r*i-n*o)/-a,this.f=(t*i-e*o)/a,this}},{key:"applyToPoint",value:function(t){return e.applyToPoint(this,t)}},{key:"applyToPoints",value:function(t){return e.applyToPoints(this,t)}},{key:"decomposed",value:function(){return e.Decompose(this)}},{key:"toCssString",value:function(){return e.toCssString(this)}},{key:"setTo",value:function(e){return Object.assign(this,e),this}},{key:"decompose",value:function(){return e.Decompose(this)}},{key:"clone",value:function(){return new e(this.a,this.b,this.c,this.d,this.e,this.f)}}],[{key:"Identity",value:function(){return new e(1,0,0,1,0,0)}},{key:"Translate",value:function(t,n){return new e(1,0,0,1,t,n)}},{key:"Rotate",value:function(t,n,r){if(0===t)return e.Identity();var i=Math.cos(t),o=Math.sin(t),a=new e(i,o,-o,i,0,0);return void 0===n?a:e.Compose(e.Translate(n,r),a,e.Translate(-n,-r))}},{key:"Multiply",value:function(e,t){return{a:e.a*t.a+e.c*t.b,c:e.a*t.c+e.c*t.d,e:e.a*t.e+e.c*t.f+e.e,b:e.b*t.a+e.d*t.b,d:e.b*t.c+e.d*t.d,f:e.b*t.e+e.d*t.f+e.f}}},{key:"Inverse",value:function(e){var t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:e.b/-t,c:e.c/-t,d:e.a/t,e:(e.d*e.e-e.c*e.f)/-t,f:(e.b*e.e-e.a*e.f)/t}}},{key:"Absolute",value:function(e){var t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:e.b/-t,c:e.c/-t,d:e.a/t,e:(e.d*e.e-e.c*e.f)/t,f:(e.b*e.e-e.a*e.f)/-t}}},{key:"Compose",value:function(){for(var t=e.Identity(),n=0,r=arguments.length;n<r;n++)t.multiply(n<0||arguments.length<=n?void 0:arguments[n]);return t}},{key:"Decompose",value:function(e){var t,n,r;if(0!==e.a||0!==e.c){var i=Math.hypot(e.a,e.c);t=i,n=(e.a*e.d-e.b*e.c)/i,r=Math.acos(e.a/i)*(e.c>0?-1:1)}else if(0!==e.b||0!==e.d){var o=Math.hypot(e.b,e.d);t=(e.a*e.d-e.b*e.c)/o,n=o,r=$a+Math.acos(e.b/o)*(e.d>0?-1:1)}else t=0,n=0,r=0;return{x:e.e,y:e.f,scaleX:t,scaleY:n,rotation:ss(r)}}},{key:"Smooth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return e.a=Math.round(e.a*t)/t,e.b=Math.round(e.b*t)/t,e.c=Math.round(e.c*t)/t,e.d=Math.round(e.d*t)/t,e.e=Math.round(e.e*t)/t,e.f=Math.round(e.f*t)/t,e}},{key:"toCssString",value:function(e){return"matrix(".concat(ms(e.a),", ").concat(ms(e.b),", ").concat(ms(e.c),", ").concat(ms(e.d),", ").concat(ms(e.e),", ").concat(ms(e.f),")")}},{key:"applyToPoint",value:function(e,t){return new Ya(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z)}},{key:"applyToXY",value:function(e,t,n){return[e.a*t+e.c*n+e.e,e.b*t+e.d*n+e.f]}},{key:"applyToPoints",value:function(e,t){return t.map((function(t){return new Ya(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z)}))}},{key:"applyToBounds",value:function(e,t){return new ws(e.e+t.minX,e.f+t.minY,t.width,t.height)}},{key:"From",value:function(t){return new e(t.a,t.b,t.c,t.d,t.e,t.f)}}]),e}();D(Cs,"Scale",(function(e,t,n,r){var i=new Cs(e,0,0,0,t,0);return void 0===n?i:Cs.Compose(Cs.Translate(n,r),i,Cs.Translate(-n,-r))}));var Is=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return j(this,n),D(_t(r=t.call(this,e,i,o)),"segments",void 0),r.segments=r.getSegmentsFromPoints(e,o),r}return z(n,[{key:"getSegmentsFromPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=[],r=0;r<e.length-1;r++)n.push(new Es(e[r],e[r+1],t));return n}}],[{key:"FromPoints",value:function(e){return new n(e)}}]),n}(_s),Ts=Math.PI+1e-4;function Ms(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.size,r=void 0===n?16:n,i=t.smoothing,o=void 0===i?.5:i,a=t.start,s=void 0===a?{}:a,u=t.end,l=void 0===u?{}:u,c=t.last,d=void 0!==c&&c,f=s.cap,p=void 0===f||f,h=l.cap,v=void 0===h||h;if(0===e.length||r<=0)return[];for(var g,m=e[0],y=e[e.length-1],b=y.runningLength,w=!1===s.taper?0:!0===s.taper?Math.max(r,b):s.taper,x=!1===l.taper?0:!0===l.taper?Math.max(r,b):l.taper,k=Math.pow(r*o,2),S=[],_=[],P=e[0].vector,E=e[0].point,C=E,I=E,T=C,M=!1,j=0;j<e.length;j++){g=e[j];var A=e[j],O=A.point,L=A.vector,z=g.vector.dpr(P),D=(j<e.length-1?e[j+1]:e[j]).vector,N=j<e.length-1?D.dpr(g.vector):1,R=null!==N&&N<.2;if(z<0&&!M||R){if(N>-.62&&b-g.runningLength>g.radius){var B=P.clone().mul(g.radius);P.clone().cpr(D)<0?(I=Ya.Add(O,B),T=Ya.Sub(O,B)):(I=Ya.Sub(O,B),T=Ya.Add(O,B)),S.push(I),_.push(T)}else for(var F=P.clone().mul(g.radius).per(),U=Ya.Sub(g.input,F),K=0;K<1;K+=.07692307692307693)I=Ya.RotWith(U,g.input,Ts*K),S.push(I),T=Ya.RotWith(U,g.input,Ts+Ts*-K),_.push(T);E=I,C=T,R&&(M=!0)}else if(M=!1,g!==m&&g!==y){var V=Ya.Lrp(D,L,N).per().mul(g.radius);I=Ya.Sub(O,V),(j<=1||Ya.Dist2(E,I)>k)&&(S.push(I),E=I),T=Ya.Add(O,V),(j<=1||Ya.Dist2(C,T)>k)&&(_.push(T),C=T),P=L}else{var W=Ya.Per(L).mul(g.radius);S.push(Ya.Sub(O,W)),_.push(Ya.Add(O,W))}}var H=m.point,Y=e.length>1?e[e.length-1].point:Ya.AddXY(m.point,1,1);if(1===e.length&&(!w&&!x||d)){for(var X=Ya.Add(H,Ya.Sub(H,Y).uni().per().mul(-m.radius)),q=[],$=1/13,G=$;G<=1;G+=$)q.push(Ya.RotWith(X,H,2*Ts*G));return q}var Q=[];if(w||x&&1===e.length);else if(p)for(var Z=.125;Z<=1;Z+=.125){var J=Ya.RotWith(_[0],H,Ts*Z);Q.push(J)}else{var ee=Ya.Sub(S[0],_[0]),te=Ya.Mul(ee,.5),ne=Ya.Mul(ee,.51);Q.push(Ya.Sub(H,te),Ya.Sub(H,ne),Ya.Add(H,ne),Ya.Add(H,te))}var re=[],ie=y.vector.clone().per().neg();if(x||w&&1===e.length)re.push(Y);else if(v)for(var oe=Ya.Add(Y,Ya.Mul(ie,y.radius)),ae=1/29,se=ae;se<1;se+=ae)re.push(Ya.RotWith(oe,Y,3*Ts*se));else re.push(Ya.Add(Y,Ya.Mul(ie,y.radius)),Ya.Add(Y,Ya.Mul(ie,.99*y.radius)),Ya.Sub(Y,Ya.Mul(ie,.99*y.radius)),Ya.Sub(Y,Ya.Mul(ie,y.radius)));return S.concat(re,_.reverse(),Q)}var js=.025,As=.01;function Os(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.streamline,i=void 0===r?.5:r,o=n.size,a=void 0===o?16:o,s=n.simulatePressure,u=void 0!==s&&s;if(0===e.length)return[];var l=.15+.85*(1-i),c=e.map(Ya.From),f=0;if(!u)for(var p=c[0];p&&!(p.z>=js);)c.shift(),p=c[0];if(!u)for(var h=c[c.length-1];h&&!(h.z>=As);)c.pop(),h=c[c.length-1];if(0===c.length)return[{point:Ya.From(e[0]),input:Ya.From(e[0]),pressure:u?.5:.15,vector:new Ya(1,1),distance:0,runningLength:0,radius:1}];for(var v=c[1];v&&!(Ya.Dist(v,c[0])>a/3);)c[0].z=Math.max(c[0].z,v.z),c.splice(1,1),v=c[1];var g=c.pop();for(v=c[c.length-1];v&&!(Ya.Dist(v,g)>a/3);)c.pop(),v=c[c.length-1],f++;c.push(g);var m=n.last||!n.simulatePressure||c.length>1&&Ya.Dist(c[c.length-1],c[c.length-2])<a||f>0;if(2===c.length&&n.simulatePressure){var y=c[1];c=c.slice(0,-1);for(var b=1;b<5;b++){var w=Ya.Lrp(c[0],y,b/4);w.z=(c[0].z+(y.z-c[0].z))*b/4,c.push(w)}}var x,k,S=[{point:c[0],input:c[0],pressure:u?.5:c[0].z,vector:new Ya(1,1),distance:0,runningLength:0,radius:1}],_=0,P=S[0];m&&i>0&&c.push(c[c.length-1].clone());for(var E=1,C=c.length;E<C;E++)x=!l||n.last&&E===C-1?c[E].clone():c[E].clone().lrp(P.point,1-l),P.point.equals(x)||(_+=k=Ya.Dist(x,P.point),E<4&&_<a||(P={input:c[E],point:x,pressure:u?.5:c[E].z,vector:Ya.Sub(P.point,x).uni(),distance:k,runningLength:_,radius:1},S.push(P)));if(null!==(t=S[1])&&void 0!==t&&t.vector&&(S[0].vector=S[1].vector.clone()),_<1){var I=Math.max.apply(Math,[.5].concat(d(S.map((function(e){return e.pressure})))));S.forEach((function(e){return e.pressure=I}))}return S}var Ls=Math.min,zs=.275;function Ds(e,t){var n,r,i=t.size,o=void 0===i?16:i,a=t.thinning,s=void 0===a?.5:a,u=t.simulatePressure,l=void 0===u||u,c=t.easing,d=void 0===c?function(e){return e}:c,f=t.start,p=void 0===f?{}:f,h=t.end,v=void 0===h?{}:h,g=p.easing,m=void 0===g?Ha.easeOutQuad:g,y=v.easing,b=void 0===y?Ha.easeOutCubic:y,w=e[e.length-1].runningLength,x=e[0].pressure;if(!l&&w<o){var k=e.reduce((function(e,t){return Math.max(e,t.pressure)}),.5);return e.forEach((function(e){e.pressure=k,e.radius=o*d(.5-s*(.5-e.pressure))})),e}for(var S,_=0,P=e.length;_<P&&!((r=e[_]).runningLength>5*o);_++){var E=Ls(1,r.distance/o);if(l){var C=Ls(1,1-E);S=Ls(1,x+E*zs*(C-x))}else S=Ls(1,x+.5*(r.pressure-x));x+=.5*(S-x)}for(var I=0;I<e.length;I++){if(r=e[I],s){var T=r.pressure,M=Ls(1,r.distance/o);if(l){var j=Ls(1,1-M);T=Ls(1,x+M*zs*(j-x))}else T=Ls(1,x+M*zs*(T-x));r.radius=o*d(.5-s*(.5-T)),x=T}else r.radius=o/2;void 0===n&&(n=r.radius)}var A=!1===p.taper?0:!0===p.taper?Math.max(o,w):p.taper,O=!1===v.taper?0:!0===v.taper?Math.max(o,w):v.taper;if(A||O)for(var L=0;L<e.length;L++){var z=(r=e[L]).runningLength,D=z<A?m(z/A):1,N=w-z<O?b((w-z)/O):1;r.radius=Math.max(.01,r.radius*Math.min(D,N))}return e}function Ns(e,t,n,r){var i=e.x-n.x,o=e.y-n.y,a=r.x-n.x,s=r.y-n.y,u=t.x-e.x,l=t.y-e.y,c=a*o-s*i,d=u*o-l*i,f=s*u-a*l;if(0===c||0===d)return null;if(0===f)return null;if(0!==f){var p=c/f,h=d/f;if(0<=p&&p<=1&&0<=h&&h<=1)return Ya.AddXY(e,p*u,p*l)}return null}function Rs(e,t,n,r){var i=(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y),o=2*((t.x-e.x)*(e.x-n.x)+(t.y-e.y)*(e.y-n.y)),a=o*o-4*i*(n.x*n.x+n.y*n.y+e.x*e.x+e.y*e.y-2*(n.x*e.x+n.y*e.y)-r*r);if(a<0)return null;if(0===a)return null;var s=Math.sqrt(a),u=(-o+s)/(2*i),l=(-o-s)/(2*i);if((u<0||u>1)&&(l<0||l>1))return null;var c=[];return 0<=u&&u<=1&&c.push(Ya.Lrp(e,t,u)),0<=l&&l<=1&&c.push(Ya.Lrp(e,t,l)),0===c.length?null:c}function Bs(e,t,n){for(var r,i=[],o=0,a=n.length-1;o<a;o++)(r=Ns(e,t,n[o],n[o+1]))&&i.push(r);return 0===i.length?null:i}function Fs(e,t,n){for(var r,i=[],o=1,a=n.length;o<a+1;o++)(r=Ns(e,t,n[o-1],n[o%n.length]))&&i.push(r);return 0===i.length?null:i}function Us(e,t,n){for(var r,i=[],o=0,a=n.length;o<a;o++)(r=Rs(n[o],n[(o+1)%n.length],e,t))&&i.push.apply(i,d(r));return 0===i.length?null:i}function Ks(e,t,n){for(var r,i=[],o=1,a=n.length;o<a;o++)(r=Rs(n[o-1],n[o],e,t))&&i.push.apply(i,d(r));return 0===i.length?null:i}function Vs(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function Ws(e,t,n,r){return Vs(e,n,r)!==Vs(t,n,r)&&Vs(e,t,n)!==Vs(e,t,r)}function Hs(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)gs(n=e[o],t)&&i.push(n);for(var s=0,u=t.length;s<u;s++)gs(n=t[s],e)&&i.push(n);for(var l=0,c=e.length;l<c;l++){n=e[l],r=e[(l+1)%e.length];for(var d=0,f=t.length;d<f;d++){var p=Ns(n,r,t[d],t[(d+1)%t.length]);null!==p&&i.push(p)}}return 0===i.length?null:function(e){var t=Ya.Average(e);return e.sort((function(e,n){return Ya.Angle(t,e)-Ya.Angle(t,n)}))}(i)}function Ys(e){return"".concat(ms(e.x),",").concat(ms(e.y)," ")}function Xs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0,n=0,r=0,i=0;function o(){var e=t^t<<11;return t=n,n=r,r=i,(i^=(i>>>19^e^e>>>8)>>>0)/4294967296*2}for(var a=0;a<e.length+64;a++)t^=0|e.charCodeAt(a),o();return o}function qs(e){for(var t,n,r,i="M",o=0,a=e.length;o<a;o+=3)t=e[o],n=e[o+1],r=e[o+2],i+="".concat(Ys(t),"L").concat(Ys(n),"Q").concat(Ys(r));return i+="".concat(Ys(e[0]))}function $s(e,t,n,r,i){for(var o,a=[],s=Xs(e),u=t[0],l=t.length,c=0,d=l*i;c<d;c++){o=Ya.AddXY(t[(c+1)%l],s()*n,s()*n);var f=Ya.Sub(o,u),p=Ya.Len(f),h=Ya.Div(f,p).mul(Math.min(p/4,r));a.push(Ya.Add(u,h),Ya.Add(o,h.neg()),o),u=o}return a}function Gs(e,t,n){for(var r,i,o="M".concat(Ys(t[0]),"L"),a="M".concat(Ys(t[0]),"L"),s="M".concat(Ys(t[0]),"L"),u=n/3,l=2*n,c=Xs(e),d=t[0],f=t[0],p=0,h=t.length-1;p<h;p++){r=Ya.AddXY(t[p+1],c()*u,c()*u),i=Ya.AddXY(t[p+1],c(),c()*u);var v=Ya.Sub(r,d),g=Ya.Len(v),m=Ya.Div(v,g).mul(Math.min(g/4,l)),y=Ya.Add(d,m),b=Ya.Add(r,m.neg()),w=Ya.Sub(i,f),x=Ya.Len(w),k=Ya.Div(w,x).mul(Math.min(x/4,l)),S=Ya.Add(f,k),_=Ya.Add(i,k.neg());p===h-1?(o+="".concat(Ys(y)," L ").concat(Ys(r)),a+="".concat(Ys(y)," L ").concat(Ys(r)),s+="".concat(Ys(S)," L ").concat(Ys(i))):(o+="".concat(Ys(y),"L ").concat(Ys(b),"Q ").concat(Ys(r)),a+="".concat(Ys(y),"L ").concat(Ys(b),"Q ").concat(Ys(r)),s+="".concat(Ys(S),"L ").concat(Ys(_),"Q ").concat(Ys(i)),d=r,f=i)}return[o,a+s]}var Qs={peopleMenu:tu("peopleMenu"),highlighterTool:tu("highlighterTool",{all:!0})},Zs={preventDefaultLogging:eu("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:eu("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:eu("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:eu("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:eu("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:eu("debugSvg",{defaults:{all:!1}}),throwToBlob:eu("throwToBlob",{defaults:{all:!1}}),logMessages:eu("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:eu("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:eu("debugCursors",{defaults:{all:!1}}),forceSrgb:eu("forceSrgbColors",{defaults:{all:!1}})};if("undefined"!==typeof window&&(window.tldrawLog=function(e){Zs.logMessages.set(Zs.logMessages.value.concat(e))}),"undefined"!==typeof Element){var Js=Element.prototype.removeChild;me("element removal logging",(function(){Zs.elementRemovalLogging.value?Element.prototype.removeChild=function(e){return console.warn("[tldraw] removing child:",e),Js.call(this,e)}:Element.prototype.removeChild=Js}))}function eu(e,t){var n=t.defaults,r=t.shouldStoreForSession;return nu({name:e,defaults:n,shouldStoreForSession:void 0===r||r})}function tu(e){return nu({name:e,defaults:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{all:!0,production:!1},shouldStoreForSession:!0})}function nu(e){var t=function(e){var t,n,r,i,o,a;switch(null!==(t=null!==(n=null!==(r=ru((function(){return{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.TLDRAW_ENV})))&&void 0!==r?r:ru((function(){return{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.VERCEL_PUBLIC_TLDRAW_ENV})))&&void 0!==n?n:ru((function(){return{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NEXT_PUBLIC_TLDRAW_ENV})))&&void 0!==t?t:"production"){case"production":return null!==(i=e.defaults.production)&&void 0!==i?i:e.defaults.all;case"preview":case"staging":return null!==(o=e.defaults.staging)&&void 0!==o?o:e.defaults.all;default:return null!==(a=e.defaults.development)&&void 0!==a?a:e.defaults.all}}(e),n=e.shouldStoreForSession?function(e){try{var t,n;return JSON.parse(null!==(t=null===(n=window)||void 0===n?void 0:n.sessionStorage.getItem("tldraw_debug:".concat(e)))&&void 0!==t?t:"null")}catch(r){return null}}(e.name):null,r=ue("debug:".concat(e.name),null!==n&&void 0!==n?n:t);return"undefined"!==typeof window&&(e.shouldStoreForSession&&me("debug:".concat(e.name),(function(){var n=r.value;try{n===t?window.sessionStorage.removeItem("tldraw_debug:".concat(e.name)):window.sessionStorage.setItem("tldraw_debug:".concat(e.name),JSON.stringify(n))}catch(i){}})),Object.defineProperty(window,"tldraw".concat(e.name.replace(/^[a-z]/,(function(e){return e.toUpperCase()}))),{get:function(){return r.value},set:function(e){r.set(e)},configurable:!0})),Object.assign(r,e)}function ru(e){try{return e()}catch(t){return null}}function iu(e){if(e instanceof HTMLElement)return e;if(e.parentElement)return iu(e.parentElement);throw Error("Could not find a parent element of an HTML type!")}function ou(e){e.preventDefault(),Zs.preventDefaultLogging.value&&console.warn("preventDefault called on event:",e)}function au(e,t){if(e.setPointerCapture(t.pointerId),Zs.pointerCaptureTracking.value){var n,r=Zs.pointerCaptureTrackingObject.value;r.set(e,(null!==(n=r.get(e))&&void 0!==n?n:0)+1)}Zs.pointerCaptureLogging.value&&console.warn("setPointerCapture called on element:",e,t)}function su(e,t){if(e.hasPointerCapture(t.pointerId)){if(e.releasePointerCapture(t.pointerId),Zs.pointerCaptureTracking.value){var n=Zs.pointerCaptureTrackingObject.value;1===n.get(e)?n.delete(e):n.has(e)?n.set(e,n.get(e)-1):console.warn("Release without capture")}Zs.pointerCaptureLogging.value&&console.warn("releasePointerCapture called on element:",e,t)}}var uu=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function lu(e){var t=uu.map((function(t){var n=t.offsetX,r=t.offsetY,i=t.blur,o=t.spread,a=t.color,s=new Ya(n,r).rot(-e),u=s.x,l=s.y;return"".concat(u,"px ").concat(l,"px ").concat(i,"px ").concat(o,"px ").concat(a)}));return t.join(", ")}function cu(){var e=l((0,t.useState)(!1),2),n=e[0],r=e[1];return(0,t.useEffect)((function(){var e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=function(){r(e.matches)};return t(),e.addEventListener("change",t),function(){return e.removeEventListener("change",t)}}),[]),n}var du=function(e,t){return e.length<=t?e:e.substring(0,t-3)+"..."},fu=function(e){return e.stopPropagation()};function pu(e,t){e.isKilled=!0;var n=t.getBoundingClientRect(),r=n.top,i=n.left;return{point:{x:e.clientX-i,y:e.clientY-r,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:"pen"===e.pointerType}}function hu(e){return"".concat(ms(e.x),",").concat(ms(e.y)," ")}function vu(e,t){return"".concat(ms((e.x+t.x)/2),",").concat(ms((e.y+t.y)/2)," ")}function gu(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.length;if(n<2)return"";var r=e[0],i=e[1];if(2===n)return"M".concat(hu(r),"L").concat(hu(i));for(var o="",a=2,s=n-1;a<s;a++)o+=vu(r=e[a],i=e[a+1]);return t?"M".concat(vu(e[0],e[1]),"Q").concat(hu(e[1])).concat(vu(e[1],e[2]),"T").concat(o).concat(vu(e[n-1],e[0])).concat(vu(e[0],e[1]),"Z"):"M".concat(hu(e[0]),"Q").concat(hu(e[1])).concat(vu(e[1],e[2])).concat(e.length>3?"T":"").concat(o,"L").concat(hu(e[n-1]))}function mu(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.length;if(n<2)return"";var r=e[0].point,i=e[1].point;if(2===n)return"M".concat(hu(r),"L").concat(hu(i));for(var o="",a=2,s=n-1;a<s;a++)o+=vu(r=e[a].point,i=e[a+1].point);return t?"M".concat(vu(e[0].point,e[1].point),"Q").concat(hu(e[1].point)).concat(vu(e[1].point,e[2].point),"T").concat(o).concat(vu(e[n-1].point,e[0].point)).concat(vu(e[0].point,e[1].point),"Z"):"M".concat(hu(e[0].point),"Q").concat(hu(e[1].point)).concat(vu(e[1].point,e[2].point)).concat(e.length>3?"T":"").concat(o,"L").concat(hu(e[n-1].point))}var yu=(0,t.createContext)(null);function bu(e){var t=e.container,n=e.children;return(0,La.jsx)(yu.Provider,{value:t,children:n})}function wu(){return ze((0,t.useContext)(yu),"useContainer used outside of <Tldraw />")}var xu=["input","select","button","textarea"];function ku(){var e=document.activeElement;return!(!e||!(e.getAttribute("contenteditable")||xu.indexOf(e.tagName.toLowerCase())>-1))}function Su(){return(0,La.jsx)("div",{className:"tl-background"})}function _u(e,n,r,i,o,a){(0,t.useLayoutEffect)((function(){var t=e.current;if(t&&void 0!==n){var s="translate(".concat(n,"px, ").concat(r,"px)");void 0!==i&&(s+=" scale(".concat(i,")")),void 0!==o&&(s+=" rotate(".concat(o,"rad)")),a&&(s+=" translate(".concat(a.x,"px, ").concat(a.y,"px)")),t.style.transform=s}}))}for(var Pu=function(e){var n=e.brush,r=e.color,i=e.opacity,o=(0,t.useRef)(null);return _u(o,n.x,n.y),(0,La.jsx)("svg",{className:"tl-overlays__item",ref:o,children:r?(0,La.jsxs)("g",{className:"tl-brush",opacity:i,children:[(0,La.jsx)("rect",{width:ms(Math.max(1,n.w)),height:ms(Math.max(1,n.h)),fill:r,opacity:.75}),(0,La.jsx)("rect",{width:ms(Math.max(1,n.w)),height:ms(Math.max(1,n.h)),fill:"none",stroke:r,opacity:.1})]}):(0,La.jsx)("rect",{className:"tl-brush tl-brush__default",width:ms(Math.max(1,n.w)),height:ms(Math.max(1,n.h))})})},Eu=function(e){var n=e.className,r=e.zoom,i=e.point,o=e.color,a=e.viewport,s=e.opacity,u=void 0===s?1:s,l=(0,t.useRef)(null);return _u(l,Ja(i.x,a.minX+5/r,a.maxX-5/r),Ja(i.y,a.minY+5/r,a.maxY-5/r),1/r,Ya.Angle(a.center,i)),(0,La.jsxs)("svg",{ref:l,className:Fa("tl-overlays__item",n),children:[(0,La.jsx)("use",{href:"#cursor_hint",color:o,strokeWidth:3,stroke:"var(--color-background)"}),(0,La.jsx)("use",{href:"#cursor_hint",color:o,opacity:u})]})},Cu=(0,t.memo)((function(e){var n=e.className,r=e.zoom,i=e.point,o=e.color,a=e.name,s=e.chatMessage,u=(0,t.useRef)(null);return _u(u,null===i||void 0===i?void 0:i.x,null===i||void 0===i?void 0:i.y,1/r),i?(0,La.jsxs)("div",{ref:u,className:Fa("tl-overlays__item",n),children:[(0,La.jsx)("svg",{className:"tl-cursor",children:(0,La.jsx)("use",{href:"#cursor",color:o})}),s?(0,La.jsxs)(La.Fragment,{children:[a&&(0,La.jsx)("div",{className:"tl-nametag-title",style:{color:o},children:a}),(0,La.jsx)("div",{className:"tl-nametag-chat",style:{backgroundColor:o},children:s})]}):a&&(0,La.jsx)("div",{className:"tl-nametag",style:{backgroundColor:o},children:a})]}):null})),Iu=2e3,Tu=(Symbol("remove"),320),Mu=[.1,.25,.5,1,2,4,8],ju=.1,Au=8,Ou={},Lu=1;Lu<=Math.ceil(Au);Lu++)Ou[Lu+"_dark"]="hash_pattern_zoom_".concat(Lu,"_dark"),Ou[Lu+"_light"]="hash_pattern_zoom_".concat(Lu,"_light");var zu={duration:0,easing:Ha.easeInOutCubic},Du=.09,Nu=[{min:-1,mid:.15,step:100},{min:.05,mid:.375,step:25},{min:.15,mid:1,step:5},{min:.7,mid:2.5,step:1}],Ru=6e4,Bu=3e3,Fu=-10,Uu=function(e){var t=e.x,n=e.y,r=e.z,i=e.size;return(0,La.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[(0,La.jsx)("defs",{children:Nu.map((function(e,o){var a=e.min,s=e.mid,u=e.step,l=u*i*r,c=.5+t*r,d=.5+n*r,f=c>0?c%l:l+c%l,p=d>0?d%l:l+d%l,h=r<s?Ue(r,[a,s],[0,1]):1;return(0,La.jsx)("pattern",{id:"grid-".concat(u),width:l,height:l,patternUnits:"userSpaceOnUse",children:(0,La.jsx)("circle",{className:"tl-grid-dot",cx:f,cy:p,r:1,opacity:h})},"grid-pattern-".concat(o))}))}),Nu.map((function(e,t){var n=e.step;return(0,La.jsx)("rect",{width:"100%",height:"100%",fill:"url(#grid-".concat(n,")")},"grid-rect-".concat(t))}))]})},Ku=function(e){var t=e.handle,n=e.className;return(0,La.jsxs)("g",{className:Fa("tl-handle",{"tl-handle__hint":"vertex"!==t.type},n),children:[(0,La.jsx)("circle",{className:"tl-handle__bg"}),(0,La.jsx)("circle",{className:"tl-handle__fg"})]})},Vu=function(e){var t=e.scribble,n=e.zoom,r=e.color,i=e.opacity,o=e.className;if(t.points.length){var a=gu(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ms(Ds(Os(e,t),t),t)}(t.points,{size:t.size/n,start:{taper:!0,easing:Ha.linear},last:"stopping"===t.state,simulatePressure:!1,streamline:.32}));return(0,La.jsx)("svg",{className:o?Fa("tl-overlays__item",o):o,children:(0,La.jsx)("path",{className:"tl-scribble",d:a,fill:null!==r&&void 0!==r?r:"var(--color-".concat(t.color,")"),opacity:null!==i&&void 0!==i?i:t.opacity})})}},Wu=function(e){var t=e.error;return(0,La.jsx)("div",{className:"tl-shape-error-boundary",children:t})},Hu=function(){return(0,La.jsx)("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"})};function Yu(e){var t,n,r,i,o=e.points,a=2.5/e.zoom,s=o.reduce((function(e,t){return Math.min(e,t.x)}),1/0),u=o.reduce((function(e,t){return Math.max(e,t.x)}),-1/0),l=o.reduce((function(e,t){return Math.min(e,t.y)}),1/0),c=o.reduce((function(e,t){return Math.max(e,t.y)}),-1/0),d=o.some((function(e){return e.x===s&&e.y===l}));return d?(t=s,n=l,r=u,i=c):(t=s,n=c,r=u,i=l),(0,La.jsxs)("g",{className:"tl-snap-line",children:[(0,La.jsx)("line",{x1:t,y1:n,x2:r,y2:i}),o.map((function(e,t){return(0,La.jsx)("g",{transform:"translate(".concat(e.x,",").concat(e.y,")"),children:(0,La.jsx)("path",{className:"tl-snap-point",d:"M ".concat(-a,",").concat(-a," L ").concat(a,",").concat(a," M ").concat(-a,",").concat(a," L ").concat(a,",").concat(-a)})},t)}))]})}function Xu(e){var n,r=e.gaps,i=e.direction,o=3.5/e.zoom,a=[-1/0,1/0],s=null,u="horizontal"===i,l=J(r);try{for(l.s();!(n=l.n()).done;){var c=n.value;(s=hs(a[0],a[1],u?c.startEdge[0].y:c.startEdge[0].x,u?c.startEdge[1].y:c.startEdge[1].x))&&((s=hs((a=s)[0],a[1],u?c.endEdge[0].y:c.endEdge[0].x,u?c.endEdge[1].y:c.endEdge[1].x))&&(a=s))}}catch(f){l.e(f)}finally{l.f()}if(null===a)return null;var d=(a[0]+a[1])/2;return(0,La.jsx)("g",{className:"tl-snap-line",children:r.map((function(e,n){var r=e.startEdge,i=e.endEdge;return(0,La.jsx)(t.Fragment,{children:u?(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("line",{x1:r[0].x,y1:d-2*o,x2:r[1].x,y2:d+2*o}),(0,La.jsx)("line",{x1:i[0].x,y1:d-2*o,x2:i[1].x,y2:d+2*o}),(0,La.jsx)("line",{x1:r[0].x,y1:d,x2:i[0].x,y2:d}),(0,La.jsx)("line",{x1:(r[0].x+i[0].x)/2,y1:d-o,x2:(r[0].x+i[0].x)/2,y2:d+o})]}):(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("line",{x1:d-2*o,y1:r[0].y,x2:d+2*o,y2:r[1].y}),(0,La.jsx)("line",{x1:d-2*o,y1:i[0].y,x2:d+2*o,y2:i[1].y}),(0,La.jsx)("line",{x1:d,y1:r[0].y,x2:d,y2:i[0].y}),(0,La.jsx)("line",{x1:d-o,y1:(r[0].y+i[0].y)/2,x2:d+o,y2:(r[0].y+i[0].y)/2})]})},n)}))})}var qu=function(e){var t=e.className,n=e.line,r=e.zoom;return(0,La.jsx)("svg",{className:Fa("tl-overlays__item",t),children:"points"===n.type?(0,La.jsx)(Yu,Ce(Ce({},n),{},{zoom:r})):"gaps"===n.type?(0,La.jsx)(Xu,Ce(Ce({},n),{},{zoom:r})):null})},$u=function(){return(0,La.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",children:(0,La.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,La.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),(0,La.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:(0,La.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})},Gu=function(){return null},Qu=["children","fallback"],Zu={error:null},Ju=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"state",Zu),e}return z(n,[{key:"componentDidCatch",value:function(e){var t,n;null===(t=(n=this.props).onError)||void 0===t||t.call(n,e)}},{key:"render",value:function(){var e=this.state.error;if(null!==e){var t=this.props.fallback;return(0,La.jsx)(t,{error:e})}return this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(t.Component);function el(e){var t=e.children,n=e.fallback,r=gt(e,Qu);return null===n?(0,La.jsx)(La.Fragment,{children:t}):(0,La.jsx)(Ju,Ce(Ce({fallback:n},r),{},{children:t}))}var tl=function(){function e(t){j(this,e),this.shape=t}return z(e,[{key:"equals",value:function(e){var t,n,r,i;return(null===(t=this.shape)||void 0===t?void 0:t.props)===(null===e||void 0===e||null===(n=e.shape)||void 0===n?void 0:n.props)&&(null===(r=this.shape)||void 0===r?void 0:r.meta)===(null===e||void 0===e||null===(i=e.shape)||void 0===i?void 0:i.meta)}}]),e}(),nl=function(e){var t=e.shape,n=e.util;return ye("Indicator:"+t.type,(function(){return n.indicator(t)}))},rl=function(e){var t=e.editor,n=e.id,r=_e("shape",(function(){return new tl(t.store.get(n))}),[t,n]),i=sl().ShapeIndicatorErrorFallback;return r.shape?(0,La.jsx)(el,{fallback:i,onError:function(e){return t.annotateError(e,{origin:"react.shapeIndicator",willCrashApp:!1})},children:(0,La.jsx)(nl,{shape:r.shape,util:t.getShapeUtil(r.shape)},r.shape.id)}):null},il=t.memo((function(e){var t=e.id,n=e.className,r=e.color,i=e.opacity,o=Ka(),a=_e("transform",(function(){var e=o.getPageTransformById(t);return e?e.toCssString():""}),[o,t]);return(0,La.jsx)("svg",{className:Fa("tl-overlays__item",n),children:(0,La.jsx)("g",{className:"tl-shape-indicator",transform:a,stroke:null!==r&&void 0!==r?r:"var(--color-selected)",opacity:i,children:(0,La.jsx)(rl,{editor:o,id:t})})})})),ol=(0,t.createContext)({});function al(e){var t=e.overrides,n=e.children;return(0,La.jsx)(ol.Provider,{value:Ce({Background:Su,SvgDefs:Gu,Brush:Pu,ZoomBrush:Pu,CollaboratorBrush:Pu,Cursor:Cu,CollaboratorCursor:Cu,CollaboratorHint:Eu,CollaboratorShapeIndicator:il,Grid:Uu,Scribble:Vu,SnapLine:qu,Handle:Ku,CollaboratorScribble:Vu,ErrorFallback:Jd,ShapeErrorFallback:Wu,ShapeIndicatorErrorFallback:Hu,Spinner:$u},t),children:n})}function sl(){return(0,t.useContext)(ol)}var ul=["textarea","input"];function ll(){return ll="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ct(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},ll.apply(this,arguments)}var cl=function(e,t){return void 0===e&&(e=t),Array.isArray(e)?e:[e,e]},dl=function(e,t){return[e[0]+t[0],e[1]+t[1]]},fl=function(e,t){return[e[0]-t[0],e[1]-t[1]]},pl=function(e,t){e[0]+=t[0],e[1]+=t[1]};function hl(e,t,n){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*n):e*t*n/(t+n*e)}function vl(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.15;return 0===r?function(e,t,n){return Math.max(t,Math.min(e,n))}(e,t,n):e<t?-hl(t-e,n-t,r)+t:e>n?+hl(e-n,n-t,r)+n:e}function gl(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function ml(e,t,n){return(t=gl(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yl(Object(n),!0).forEach((function(t){ml(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wl={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function xl(e){return e?e[0].toUpperCase()+e.slice(1):""}var kl=["enter","leave"];function Sl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=wl[e],i=r&&r[t]||t;return"on"+xl(e)+xl(i)+(function(){var e=arguments.length>1?arguments[1]:void 0;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&!kl.includes(e)}(n,i)?"Capture":"")}var _l=["gotpointercapture","lostpointercapture"];function Pl(e){var t=e.substring(2).toLowerCase(),n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));var r=_l.includes(t)?"capturecapture":"capture",i=!!~t.indexOf(r);return i&&(t=t.replace("capture","")),{device:t,capture:i,passive:n}}function El(e){return"touches"in e}function Cl(e){return El(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function Il(e,t){try{var n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=(t.clientX+e.clientX)/2,o=(t.clientY+e.clientY)/2,a=Math.hypot(n,r);return{angle:-180*Math.atan2(n,r)/Math.PI,distance:a,origin:[i,o]}}catch(s){}return null}function Tl(e){return function(e){return Array.from(e.touches).filter((function(t){var n,r;return t.target===e.currentTarget||(null===(n=e.currentTarget)||void 0===n||null===(r=n.contains)||void 0===r?void 0:r.call(n,t.target))}))}(e).map((function(e){return e.identifier}))}function Ml(e,t){var n=l(Array.from(e.touches).filter((function(e){return t.includes(e.identifier)})),2);return Il(n[0],n[1])}function jl(e){var t=e.deltaX,n=e.deltaY,r=e.deltaMode;return 1===r?(t*=40,n*=40):2===r&&(t*=800,n*=800),[t,n]}function Al(e){if("function"===typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(void 0,n)}return e}function Ol(){}function Ll(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?Ol:1===t.length?t[0]:function(){for(var e,n=0,r=t;n<r.length;n++){e=r[n].apply(this,arguments)||e}return e}}function zl(e,t){return Object.assign({},t,e||{})}var Dl=function(){function e(t,n,r){j(this,e),this.ctrl=t,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}return z(e,[{key:"state",get:function(){return this.ctrl.state[this.key]},set:function(e){this.ctrl.state[this.key]=e}},{key:"shared",get:function(){return this.ctrl.state.shared}},{key:"eventStore",get:function(){return this.ctrl.gestureEventStores[this.key]}},{key:"timeoutStore",get:function(){return this.ctrl.gestureTimeoutStores[this.key]}},{key:"config",get:function(){return this.ctrl.config[this.key]}},{key:"sharedConfig",get:function(){return this.ctrl.config.shared}},{key:"handler",get:function(){return this.ctrl.handlers[this.key]}},{key:"reset",value:function(){var e=this.state,t=this.shared,n=this.ingKey,r=this.args;t[n]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}},{key:"start",value:function(e){var t=this.state,n=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=n.from?Al(n.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}},{key:"computeValues",value:function(e){var t=this.state;t._values=e,t.values=this.config.transform(e)}},{key:"computeInitial",value:function(){var e=this.state;e._initial=e._values,e.initial=e.values}},{key:"compute",value:function(e){var t=this.state,n=this.config,r=this.shared;t.args=this.args;var i=0;if(e&&(t.event=e,n.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,function(e){var t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){var n=e.shiftKey,r=e.altKey,i=e.metaKey,o=e.ctrlKey;Object.assign(t,{shiftKey:n,altKey:r,metaKey:i,ctrlKey:o})}return t}(e)),r.down=r.pressed=r.buttons%2===1||r.touches>0,i=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){var o=t._delta.map(Math.abs);pl(t._distance,o)}this.axisIntent&&this.axisIntent(e);var a=l(t._movement,2),s=a[0],u=a[1],c=l(n.threshold,2),d=c[0],f=c[1],p=t._step,h=t.values;if(n.hasCustomTransform?(!1===p[0]&&(p[0]=Math.abs(s)>=d&&h[0]),!1===p[1]&&(p[1]=Math.abs(u)>=f&&h[1])):(!1===p[0]&&(p[0]=Math.abs(s)>=d&&Math.sign(s)*d),!1===p[1]&&(p[1]=Math.abs(u)>=f&&Math.sign(u)*f)),t.intentional=!1!==p[0]||!1!==p[1],t.intentional){var v=[0,0];if(n.hasCustomTransform){var g=l(h,2),m=g[0],y=g[1];v[0]=!1!==p[0]?m-p[0]:0,v[1]=!1!==p[1]?y-p[1]:0}else v[0]=!1!==p[0]?s-p[0]:0,v[1]=!1!==p[1]?u-p[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(v);var b=t.offset,w=t._active&&!t._blocked||t.active;w&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in n&&(t._bounds=Al(n.bounds,t)),this.setup&&this.setup()),t.movement=v,this.computeOffset()));var x=l(t.offset,2),k=x[0],S=x[1],_=l(t._bounds,2),P=l(_[0],2),E=P[0],C=P[1],I=l(_[1],2),T=I[0],M=I[1];t.overflow=[k<E?-1:k>C?1:0,S<T?-1:S>M?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);var j=t._active&&n.rubberband||[0,0];if(t.offset=function(e,t,n){var r=l(t,2),i=r[0],o=r[1],a=l(n,2),s=a[0],u=a[1],c=l(e,2),d=l(c[0],2),f=d[0],p=d[1],h=l(c[1],2),v=h[0],g=h[1];return[vl(i,f,p,s),vl(o,v,g,u)]}(t._bounds,t.offset,j),t.delta=fl(t.offset,b),this.computeMovement(),w&&(!t.last||i>32)){t.delta=fl(t.offset,b);var A=t.delta.map(Math.abs);pl(t.distance,A),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&i>0&&(t.velocity=[A[0]/i,A[1]/i],t.timeDelta=i)}}}},{key:"emit",value:function(){var e=this.state,t=this.shared,n=this.config;if(e._active||this.clean(),!e._blocked&&e.intentional||e._force||n.triggerAllEvents){var r=this.handler(bl(bl(bl({},t),e),{},D({},this.aliasKey,e.values)));void 0!==r&&(e.memo=r)}}},{key:"clean",value:function(){this.eventStore.clean(),this.timeoutStore.clean()}}]),e}();var Nl=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ml(_t(e=t.call.apply(t,[this].concat(i))),"aliasKey","xy"),e}return z(n,[{key:"reset",value:function(){ll(Ct(n.prototype),"reset",this).call(this),this.state.axis=void 0}},{key:"init",value:function(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}},{key:"computeOffset",value:function(){this.state.offset=dl(this.state.lastOffset,this.state.movement)}},{key:"computeMovement",value:function(){this.state.movement=fl(this.state.offset,this.state.lastOffset)}},{key:"axisIntent",value:function(e){var t=this.state,n=this.config;if(!t.axis&&e){var r="object"===typeof n.axisThreshold?n.axisThreshold[Cl(e)]:n.axisThreshold;t.axis=function(e,t){var n=l(e,2),r=n[0],i=n[1],o=Math.abs(r),a=Math.abs(i);return o>a&&o>t?"x":a>o&&a>t?"y":void 0}(t._movement,r)}t._blocked=(n.lockDirection||!!n.axis)&&!t.axis||!!n.axis&&n.axis!==t.axis}},{key:"restrictToAxis",value:function(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}}]),n}(Dl),Rl=function(e){return e},Bl={enabled:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]},eventOptions:function(e,t,n){return bl(bl({},n.shared.eventOptions),e)},preventDefault:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]},triggerAllEvents:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]},rubberband:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case!0:return[.15,.15];case!1:return[0,0];default:return cl(e)}},from:function(e){return"function"===typeof e?e:null!=e?cl(e):void 0},transform:function(e,t,n){var r=e||n.shared.transform;return this.hasCustomTransform=!!r,r||Rl},threshold:function(e){return cl(e,0)}};var Fl=bl(bl({},Bl),{},{axis:function(e,t,n){var r=n.axis;if(this.lockDirection="lock"===r,!this.lockDirection)return r},axisThreshold:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0},bounds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("function"===typeof e)return function(t){return Fl.bounds(e(t))};if("current"in e)return function(){return e.current};if("function"===typeof HTMLElement&&e instanceof HTMLElement)return e;var t=e.left,n=void 0===t?-1/0:t,r=e.right,i=void 0===r?1/0:r,o=e.top,a=void 0===o?-1/0:o,s=e.bottom;return[[n,i],[a,void 0===s?1/0:s]]}});var Ul="undefined"!==typeof window&&window.document&&window.document.createElement;function Kl(){return Ul&&"ontouchstart"in window||Ul&&window.navigator.maxTouchPoints>1}var Vl={isBrowser:Ul,gesture:function(){try{return"constructor"in GestureEvent}catch(ok){return!1}}(),touch:Kl(),touchscreen:Kl(),pointer:Ul&&"onpointerdown"in window,pointerLock:Ul&&"exitPointerLock"in window.document},Wl={mouse:0,touch:0,pen:8};bl(bl({},Fl),{},{device:function(e,t,n){var r=n.pointer,i=void 0===r?{}:r,o=i.touch,a=void 0!==o&&o,s=i.lock,u=void 0!==s&&s,l=i.mouse,c=void 0!==l&&l;return this.pointerLock=u&&Vl.pointerLock,Vl.touch&&a?"touch":this.pointerLock?"mouse":Vl.pointer&&!c?"pointer":Vl.touch?"touch":"mouse"},preventScrollAxis:function(e,t,n){var r=n.preventScroll;if(this.preventScrollDelay="number"===typeof r?r:r||void 0===r&&e?250:void 0,Vl.touchscreen&&!1!==r)return e||(void 0!==r?"y":void 0)},pointerCapture:function(e,t,n){var r=n.pointer,i=void 0===r?{}:r,o=i.capture,a=void 0===o||o,s=i.buttons,u=void 0===s?1:s,l=i.keys,c=void 0===l||l;return this.pointerButtons=u,this.keys=c,!this.pointerLock&&"pointer"===this.device&&a},threshold:function(e,t,n){var r=n.filterTaps,i=void 0!==r&&r,o=n.tapsThreshold,a=void 0===o?3:o,s=n.axis,u=cl(e,i?a:(void 0===s?void 0:s)?1:0);return this.filterTaps=i,this.tapsThreshold=a,u},swipe:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.velocity,n=void 0===t?.5:t,r=e.distance,i=void 0===r?50:r,o=e.duration,a=void 0===o?250:o;return{velocity:this.transform(cl(n)),distance:this.transform(cl(i)),duration:a}},delay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case!0:return 180;case!1:return 0;default:return e}},axisThreshold:function(e){return e?bl(bl({},Wl),e):Wl},keyboardDisplacement:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:10}});function Hl(e){var t=l(e.overflow,2),n=t[0],r=t[1],i=l(e._delta,2),o=i[0],a=i[1],s=l(e._direction,2),u=s[0],c=s[1];(n<0&&o>0&&u<0||n>0&&o<0&&u>0)&&(e._movement[0]=e._movementBound[0]),(r<0&&a>0&&c<0||r>0&&a<0&&c>0)&&(e._movement[1]=e._movementBound[1])}var Yl=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ml(_t(e=t.call.apply(t,[this].concat(i))),"ingKey","pinching"),ml(_t(e),"aliasKey","da"),e}return z(n,[{key:"init",value:function(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}},{key:"reset",value:function(){ll(Ct(n.prototype),"reset",this).call(this);var e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}},{key:"computeOffset",value:function(){var e=this.state,t=e.type,n=e.movement,r=e.lastOffset;this.state.offset="wheel"===t?dl(n,r):[(1+n[0])*r[0],n[1]+r[1]]}},{key:"computeMovement",value:function(){var e=this.state,t=e.offset,n=e.lastOffset;this.state.movement=[t[0]/n[0],t[1]-n[1]]}},{key:"axisIntent",value:function(){var e=this.state,t=l(e._movement,2),n=t[0],r=t[1];if(!e.axis){var i=30*Math.abs(n)-Math.abs(r);i<0?e.axis="angle":i>0&&(e.axis="scale")}}},{key:"restrictToAxis",value:function(e){this.config.lockDirection&&("scale"===this.state.axis?e[1]=0:"angle"===this.state.axis&&(e[0]=0))}},{key:"cancel",value:function(){var e=this,t=this.state;t.canceled||setTimeout((function(){t.canceled=!0,t._active=!1,e.compute(),e.emit()}),0)}},{key:"touchStart",value:function(e){this.ctrl.setEventIds(e);var t=this.state,n=this.ctrl.touchIds;if((!t._active||!t._touchIds.every((function(e){return n.has(e)})))&&!(n.size<2)){this.start(e),t._touchIds=Array.from(n).slice(0,2);var r=Ml(e,t._touchIds);r&&this.pinchStart(e,r)}}},{key:"pointerStart",value:function(e){if(null==e.buttons||e.buttons%2===1){this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);var t=this.state,n=t._pointerEvents,r=this.ctrl.pointerIds;if((!t._active||!Array.from(n.keys()).every((function(e){return r.has(e)})))&&(n.size<2&&n.set(e.pointerId,e),!(t._pointerEvents.size<2))){this.start(e);var i=Il.apply(void 0,d(Array.from(n.values())));i&&this.pinchStart(e,i)}}}},{key:"pinchStart",value:function(e,t){this.state.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}},{key:"touchMove",value:function(e){if(this.state._active){var t=Ml(e,this.state._touchIds);t&&this.pinchMove(e,t)}}},{key:"pointerMove",value:function(e){var t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),this.state._active){var n=Il.apply(void 0,d(Array.from(t.values())));n&&this.pinchMove(e,n)}}},{key:"pinchMove",value:function(e,t){var n=this.state,r=n._values[1],i=t.angle-r,o=0;Math.abs(i)>270&&(o+=Math.sign(i)),this.computeValues([t.distance,t.angle-360*o]),n.origin=t.origin,n.turns=o,n._movement=[n._values[0]/n._initial[0]-1,n._values[1]-n._initial[1]],this.compute(e),this.emit()}},{key:"touchEnd",value:function(e){var t=this;this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some((function(e){return!t.ctrl.touchIds.has(e)}))&&(this.state._active=!1,this.compute(e),this.emit())}},{key:"pointerEnd",value:function(e){var t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch(n){}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}},{key:"gestureStart",value:function(e){e.cancelable&&e.preventDefault();var t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}},{key:"gestureMove",value:function(e){if(e.cancelable&&e.preventDefault(),this.state._active){var t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];var n=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=fl(t._movement,n),this.compute(e),this.emit()}}},{key:"gestureEnd",value:function(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}},{key:"wheel",value:function(e){var t=this.config.modifierKey;t&&!e[t]||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}},{key:"wheelStart",value:function(e){this.start(e),this.wheelChange(e)}},{key:"wheelChange",value:function(e){"uv"in e||e.cancelable&&e.preventDefault();var t=this.state;t._delta=[-jl(e)[1]/100*t.offset[0],0],pl(t._movement,t._delta),Hl(t),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}},{key:"wheelEnd",value:function(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}},{key:"bind",value:function(e){var t=this.config.device;t&&(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this)),e("lostPointerCapture","",this[t+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}]),n}(Dl),Xl=bl(bl({},Bl),{},{device:function(e,t,n){var r=n.shared,i=n.pointer,o=(void 0===i?{}:i).touch,a=void 0!==o&&o;if(r.target&&!Vl.touch&&Vl.gesture)return"gesture";if(Vl.touch&&a)return"touch";if(Vl.touchscreen){if(Vl.pointer)return"pointer";if(Vl.touch)return"touch"}},bounds:function(e,t,n){var r=n.scaleBounds,i=void 0===r?{}:r,o=n.angleBounds,a=void 0===o?{}:o,s=function(e){var t=zl(Al(i,e),{min:-1/0,max:1/0});return[t.min,t.max]},u=function(e){var t=zl(Al(a,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!==typeof i&&"function"!==typeof a?[s(),u()]:function(e){return[s(e),u(e)]}},threshold:function(e,t,n){this.lockDirection="lock"===n.axis;var r=cl(e,this.lockDirection?[.1,3]:0);return r},modifierKey:function(e){return void 0===e?"ctrlKey":e},pinchOnWheel:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}}),ql=(bl(bl({},Fl),{},{mouseOnly:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}}),function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ml(_t(e=t.call.apply(t,[this].concat(i))),"ingKey","wheeling"),e}return z(n,[{key:"wheel",value:function(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}},{key:"wheelChange",value:function(e){var t=this.state;t._delta=jl(e),pl(t._movement,t._delta),Hl(t),this.compute(e),this.emit()}},{key:"wheelEnd",value:function(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}},{key:"bind",value:function(e){e("wheel","",this.wheel.bind(this))}}]),n}(Nl)),$l=Fl,Gl=(bl(bl({},Fl),{},{mouseOnly:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}}),new Map),Ql=new Map;function Zl(e){Gl.set(e.key,e.engine),Ql.set(e.key,e.resolver)}var Jl={key:"pinch",engine:Yl,resolver:Xl},ec={key:"wheel",engine:ql,resolver:$l};function tc(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var nc={target:function(e){if(e)return function(){return"current"in e?e.current:e}},enabled:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]},window:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vl.isBrowser?window:void 0})),eventOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.passive,n=void 0===t||t,r=e.capture;return{passive:n,capture:void 0!==r&&r}},transform:function(e){return e}},rc=["target","eventOptions","window","enabled","transform"];function ic(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n={},r=0,i=Object.entries(t);r<i.length;r++){var o=l(i[r],2),a=o[0],s=o[1];switch(typeof s){case"function":n[a]=s.call(n,e[a],a,e);break;case"object":n[a]=ic(e[a],s);break;case"boolean":s&&(n[a]=e[a])}}return n}var oc=function(){function e(t,n){j(this,e),ml(this,"_listeners",new Set),this._ctrl=t,this._gestureKey=n}return z(e,[{key:"add",value:function(e,t,n,r,i){var o=this._listeners,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=wl[e];return e+(n&&n[t]||t)}(t,n),s=bl(bl({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),i);e.addEventListener(a,r,s);var u=function t(){e.removeEventListener(a,r,s),o.delete(t)};return o.add(u),u}},{key:"clean",value:function(){this._listeners.forEach((function(e){return e()})),this._listeners.clear()}}]),e}(),ac=function(){function e(){j(this,e),ml(this,"_timeouts",new Map)}return z(e,[{key:"add",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:140;this.remove(e);for(var i=arguments.length,o=new Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];this._timeouts.set(e,(n=window).setTimeout.apply(n,[t,r].concat(o)))}},{key:"remove",value:function(e){var t=this._timeouts.get(e);t&&window.clearTimeout(t)}},{key:"clean",value:function(){this._timeouts.forEach((function(e){window.clearTimeout(e)})),this._timeouts.clear()}}]),e}(),sc=function(){function e(t){j(this,e),ml(this,"gestures",new Set),ml(this,"_targetEventStore",new oc(this)),ml(this,"gestureEventStores",{}),ml(this,"gestureTimeoutStores",{}),ml(this,"handlers",{}),ml(this,"config",{}),ml(this,"pointerIds",new Set),ml(this,"touchIds",new Set),ml(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),function(e,t){t.drag&&uc(e,"drag");t.wheel&&uc(e,"wheel");t.scroll&&uc(e,"scroll");t.move&&uc(e,"move");t.pinch&&uc(e,"pinch");t.hover&&uc(e,"hover")}(this,t)}return z(e,[{key:"setEventIds",value:function(e){return El(e)?(this.touchIds=new Set(Tl(e)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}},{key:"applyHandlers",value:function(e,t){this.handlers=e,this.nativeHandlers=t}},{key:"applyConfig",value:function(e,t){this.config=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e,i=r.target,o=r.eventOptions,a=r.window,s=r.enabled,u=r.transform,l=tc(r,rc);if(n.shared=ic({target:i,eventOptions:o,window:a,enabled:s,transform:u},nc),t){var c=Ql.get(t);n[t]=ic(bl({shared:n.shared},l),c)}else for(var d in l){var f=Ql.get(d);f&&(n[d]=ic(bl({shared:n.shared},l[d]),f))}return n}(e,t,this.config)}},{key:"clean",value:function(){this._targetEventStore.clean();var e,t=J(this.gestures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.gestureEventStores[n].clean(),this.gestureTimeoutStores[n].clean()}}catch(r){t.e(r)}finally{t.f()}}},{key:"effect",value:function(){var e=this;return this.config.shared.target&&this.bind(),function(){return e._targetEventStore.clean()}}},{key:"bind",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i,o=this.config.shared,a={};if(!o.target||(i=o.target())){if(o.enabled){var s,u=J(this.gestures);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=this.config[l],f=lc(a,c.eventOptions,!!i);if(c.enabled)new(Gl.get(l))(this,n,l).bind(f)}}catch(k){u.e(k)}finally{u.f()}var p=lc(a,o.eventOptions,!!i),h=function(t){p(t,"",(function(r){return e.nativeHandlers[t](bl(bl({},e.state.shared),{},{event:r,args:n}))}),void 0,!0)};for(var v in this.nativeHandlers)h(v)}for(var g in a)a[g]=Ll.apply(void 0,d(a[g]));if(!i)return a;for(var m in a){var y=Pl(m),b=y.device,w=y.capture,x=y.passive;this._targetEventStore.add(i,b,"",a[m],{capture:w,passive:x})}}}}]),e}();function uc(e,t){e.gestures.add(t),e.gestureEventStores[t]=new oc(e,t),e.gestureTimeoutStores[t]=new ac}var lc=function(e,t,n){return function(r,i,o){var a,s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=null!==(a=u.capture)&&void 0!==a?a:t.capture,d=null!==(s=u.passive)&&void 0!==s?s:t.passive,f=l?r:Sl(r,i,c);n&&d&&(f+="Passive"),e[f]=e[f]||[],e[f].push(o)}},cc=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function dc(e,t,n,r,i,o){if(e.has(n)&&Gl.has(r)){var a=n+"Start",s=n+"End";i[r]=function(e){var r=void 0;return e.first&&a in t&&t[a](e),n in t&&(r=t[n](e)),e.last&&s in t&&t[s](e),r},o[r]=o[r]||{}}}function fc(e,t){var n=function(e){var t={},n={},r=new Set;for(var i in e)cc.test(i)?(r.add(RegExp.lastMatch),n[i]=e[i]):t[i]=e[i];return[n,t,r]}(e),r=l(n,3),i=r[0],o=r[1],a=r[2],s={};return dc(a,i,"onDrag","drag",s,t),dc(a,i,"onWheel","wheel",s,t),dc(a,i,"onScroll","scroll",s,t),dc(a,i,"onPinch","pinch",s,t),dc(a,i,"onMove","move",s,t),dc(a,i,"onHover","hover",s,t),{handlers:s,config:t,nativeHandlers:o}}function pc(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=t.useMemo((function(){return new sc(e)}),[]);if(o.applyHandlers(e,i),o.applyConfig(n,r),t.useEffect(o.effect.bind(o)),t.useEffect((function(){return o.clean.bind(o)}),[]),void 0===n.target)return o.bind.bind(o)}function hc(e){return e.forEach(Zl),function(e,t){var n=fc(e,t||{}),r=n.handlers,i=n.nativeHandlers;return pc(r,n.config,void 0,i)}}var vc=n(2061),gc=10,mc=/Mac|iPod|iPhone|iPad/.test("undefined"===typeof window?"node":window.navigator.platform);function yc(e){var t=e.deltaY,n=e.deltaX,r=0;if(e.ctrlKey||e.altKey||e.metaKey){var i=Math.sign(e.deltaY),o=t;Math.abs(e.deltaY)>gc&&(o=gc*i),r=o/100}else e.shiftKey&&!mc&&(n=t,t=0);return{x:-n,y:-t,z:-r}}var bc=hc([ec,Jl]),wc=void 0;function xc(e){var n=Ka(),r=t.useMemo((function(){var t=null,r=1,i=1,o=1,a=0,s=new Ya,u=new Ya,l=vc((function(e){if(null===t){var n=Math.abs(a-r),i=Ya.Dist(s,u);"gesture"===e&&n||"touch"===e&&n>16?t="zooming":i>16&&(t="panning")}}),32);return{onWheel:function(e){var r=e.event;if(n.isFocused&&(t=null,i=Date.now(),!(void 0===wc?(wc=i,0):i-wc>120&&i-wc<160?(wc=i,1):(wc=i,0)))){var i;if(n.editingId){var o=n.getShapeById(n.editingId);if(o)if(n.getShapeUtil(o).canScroll(o)){var a=n.getPageBoundsById(n.editingId);if(null!==a&&void 0!==a&&a.containsPoint(n.inputs.currentPagePoint))return}}ou(r);var s=yc(r);if(0!==s.x||0!==s.y){var u={type:"wheel",name:"wheel",delta:s,shiftKey:r.shiftKey,altKey:r.altKey,ctrlKey:r.metaKey||r.ctrlKey};n.dispatch(u)}}},onPinchStart:function(o){var a=e.current;t=null;var l=o.event,c=o.origin,d=o.da;l instanceof WheelEvent||(l.target===a||null!==a&&void 0!==a&&a.contains(l.target))&&(u.x=c[0],u.y=c[1],s.x=c[0],s.y=c[1],r=d[0],i=n.zoomLevel,n.dispatch({type:"pinch",name:"pinch_start",point:{x:c[0],y:c[1],z:n.zoomLevel},delta:{x:0,y:0},shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey}))},onPinchEnd:function(r){var i=e.current,o=r.event,a=r.origin,s=r.offset;if(!(o instanceof WheelEvent)&&(o.target===i||null!==i&&void 0!==i&&i.contains(o.target))){var u=s[0];t=null,requestAnimationFrame((function(){n.dispatch({type:"pinch",name:"pinch_end",point:{x:a[0],y:a[1],z:u},delta:{x:a[0],y:a[1]},shiftKey:o.shiftKey,altKey:o.altKey,ctrlKey:o.metaKey||o.ctrlKey})}))}},onPinch:function(r){var s=e.current,c=r.event,d=r.origin,f=r.offset,p=r.da;if(!(c instanceof WheelEvent)&&(c.target===s||null!==s&&void 0!==s&&s.contains(c.target))){var h=!("touches"in c);a=p[0],(h||a>64)&&(o=f[0]);var v=d[0]-u.x,g=d[1]-u.y;switch(u.x=d[0],u.y=d[1],l(h?"gesture":"touch"),t){case"zooming":n.dispatch({type:"pinch",name:"pinch",point:{x:d[0],y:d[1],z:o},delta:{x:v,y:g},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey});break;case"panning":n.dispatch({type:"pinch",name:"pinch",point:{x:d[0],y:d[1],z:i},delta:{x:v,y:g},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey})}}}}}),[n,e]);bc(r,{target:e,eventOptions:{passive:!1},pinch:{from:function(){return[n.zoomLevel,0]},scaleBounds:function(){return{from:n.zoomLevel,max:8,min:.05}}}})}function kc(e,t,n){var r=e.getShapeById(t);return{shape:r,handle:e.getHandles(r).find((function(e){return e.id===n}))}}var Sc=n(8422);function _c(){var e=Ka(),n=(0,t.useMemo)((function(){return e.store.query.records("instance_presence",(function(){return{userId:{neq:e.user.id}}}))}),[e]),r=function(){var e=arguments[0],n=arguments[1],r=3===arguments.length?void 0:arguments[2],i=3===arguments.length?arguments[2]:arguments[3];return(0,t.useMemo)((function(){return ve("useComputed(".concat(e,")"),n,r)}),i)}("userIds",(function(){return Sc(n.value.map((function(e){return e.userId}))).sort()}),{isEqual:function(e,t){var n;return e.join(",")===(null===(n=t.join)||void 0===n?void 0:n.call(t,","))}},[n]);return _e(r)}function Pc(e){var n=Ka(),r=(0,t.useMemo)((function(){return n.store.query.records("instance_presence",(function(){return{userId:{eq:e}}}))}),[n,e]),i=_e("latestPresence:".concat(e),(function(){return r.value.slice().sort((function(e,t){return t.lastActivityTimestamp-e.lastActivityTimestamp}))[0]}),[]);return null!==i&&void 0!==i?i:null}var Ec=ke((function(){var e=_c();return(0,La.jsx)(La.Fragment,{children:e.map((function(e){return(0,La.jsx)(Cc,{collaboratorId:e},e)}))})})),Cc=ke((function(e){var n=e.collaboratorId,r=Ka(),i=Pc(n),o=function(e){var n,r=(0,t.useRef)(null!==(n=null===e||void 0===e?void 0:e.lastActivityTimestamp)&&void 0!==n?n:-1),i=l((0,t.useState)((function(){return Tc(Date.now()-r.current)})),2),o=i[0],a=i[1];(0,t.useEffect)((function(){var e=setInterval((function(){a(Tc(Date.now()-r.current))}),1200);return function(){return clearInterval(e)}}),[]),e&&(r.current=e.lastActivityTimestamp);return o}(i);if(!i||i.currentPageId!==r.currentPageId)return null;switch(o){case"inactive":var a=r.instanceState,s=a.followingUserId,u=a.highlightedUserIds;if(s!==i.userId&&!u.includes(i.userId))return null;break;case"idle":var c=r.instanceState.highlightedUserIds;if(i.followingUserId===r.user.id&&!i.chatMessage&&!c.includes(i.userId))return null}return(0,La.jsx)(Ic,{latestPresence:i})})),Ic=ke((function(e){var t=e.latestPresence,n=Ka(),r=sl(),i=r.CollaboratorBrush,o=r.CollaboratorScribble,a=r.CollaboratorCursor,s=r.CollaboratorHint,u=r.CollaboratorShapeIndicator,l=n.viewportPageBounds,c=n.zoomLevel,d=t.userId,f=t.chatMessage,p=t.brush,h=t.scribble,v=t.selectedIds,g=t.userName,m=t.cursor,y=t.color,b=!(m.x<l.minX-12/c||m.y<l.minY-16/c||m.x>l.maxX-12/c||m.y>l.maxY-16/c);return(0,La.jsxs)(La.Fragment,{children:[p&&i?(0,La.jsx)(i,{className:"tl-collaborator__brush",brush:p,color:y,opacity:.1},d+"_brush"):null,b&&a?(0,La.jsx)(a,{className:"tl-collaborator__cursor",point:m,color:y,zoom:c,name:"New User"!==g?g:null,chatMessage:f},d+"_cursor"):s?(0,La.jsx)(s,{className:"tl-collaborator__cursor-hint",point:m,color:y,zoom:c,viewport:l},d+"_cursor_hint"):null,h&&o?(0,La.jsx)(o,{className:"tl-collaborator__scribble",scribble:h,color:y,zoom:c,opacity:"laser"===h.color?.5:.1},d+"_scribble"):null,u&&v.map((function(e){return(0,La.jsx)(u,{className:"tl-collaborator__shape-indicator",id:e,color:y,opacity:.5},d+"_"+e)}))]})}));function Tc(e){return e>Ru?"inactive":e>Bu?"idle":"active"}var Mc=ke((function(){var e=Ka(),n=t.useMemo((function(){return{onPointerDown:function(t){if(!t.isKilled){au(t.currentTarget,t);var n=Ce({type:"pointer",target:"selection",name:"pointer_down"},pu(t,e.getContainer()));e.dispatch(n)}},onPointerMove:function(t){if(!t.isKilled){var n=Ce({type:"pointer",target:"selection",name:"pointer_move"},pu(t,e.getContainer()));e.dispatch(n)}},onPointerUp:function(t){if(!t.isKilled){su(t.currentTarget,t);var n=Ce({type:"pointer",target:"selection",name:"pointer_up"},pu(t,e.getContainer()));e.dispatch(n)}},onPointerEnter:function(t){if(!t.isKilled){var n=Ce({type:"pointer",target:"selection",name:"pointer_enter"},pu(t,e.getContainer()));e.dispatch(n)}},onPointerLeave:function(t){if(!t.isKilled){var n=Ce({type:"pointer",target:"selection",name:"pointer_leave"},pu(t,e.getContainer()));e.dispatch(n)}}}}),[e]),r=e.selectionBounds,i=e.selectedIds;if(!r)return null;var o=e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing");if(1===i.length){var a=e.getShapeById(i[0]);if(!a)return null;if(e.getShapeUtil(a).hideSelectionBoundsBg(a))return null}var s=Cs.toCssString(Cs.Compose(Cs.Translate(r.minX,r.minY),Cs.Rotate(e.selectionRotation)));return(0,La.jsx)("div",Ce({className:"tl-selection__bg",draggable:!1,style:{transform:s,width:ms(Math.max(1,r.width)),height:ms(Math.max(1,r.height)),pointerEvents:o?"all":"none",opacity:o?1:0}},n))})),jc=["children","className"];function Ac(e){var t=e.children,n=e.className,r=void 0===n?"":n,i=gt(e,jc);return(0,La.jsx)("div",Ce(Ce({},i),{},{className:"tl-html-container ".concat(r),children:t}))}function Oc(e){var t=Ka();return _e("isEditing",(function(){return t.editingId===e}),[t,e])}var Lc=function(e){return e.split("*").map((function(e){return function(e){if("string"!==typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(e)})).join(".+")},zc=function(e,t){return!!e.find((function(e){var n=new RegExp(Lc(e));return t.match(n)}))};function Dc(e){var t;return null!==(t=function(e){var t,n=new URL(e).host.replace("www.",""),r=J(zo);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(zc(i.hostnames,n)){var o=i.toEmbedUrl(e);if(o)return{definition:i,embedUrl:o,url:e}}}}catch(a){r.e(a)}finally{r.f()}}(e))&&void 0!==t?t:function(e){var t,n=new URL(e).host.replace("www.",""),r=J(zo);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(zc(i.hostnames,n)){var o=i.fromEmbedUrl(e);if(o)return{definition:i,url:o,embedUrl:e}}}}catch(a){r.e(a)}finally{r.f()}}(e)}function Nc(e){try{return Dc(e)}catch(ok){console.error(ok)}}var Rc=function(){function e(t,n,r){j(this,e),D(this,"canSnap",(function(){return!0})),D(this,"canScroll",(function(){return!1})),D(this,"canUnmount",(function(){return!0})),D(this,"canBind",(function(e,t){return!0})),D(this,"canEdit",(function(){return!1})),D(this,"canResize",(function(){return!0})),D(this,"canCrop",(function(){return!1})),D(this,"isClosed",(function(){return!0})),D(this,"hideResizeHandles",(function(){return!1})),D(this,"hideRotateHandle",(function(){return!1})),D(this,"hideSelectionBoundsBg",(function(){return!1})),D(this,"hideSelectionBoundsFg",(function(){return!1})),D(this,"isAspectRatioLocked",(function(){return!1})),D(this,"onBeforeCreate",void 0),D(this,"onBeforeUpdate",void 0),D(this,"onDragShapesOver",void 0),D(this,"onDragShapesOut",void 0),D(this,"onDropShapesOver",void 0),D(this,"onResizeStart",void 0),D(this,"onResize",void 0),D(this,"onResizeEnd",void 0),D(this,"onTranslateStart",void 0),D(this,"onTranslate",void 0),D(this,"onTranslateEnd",void 0),D(this,"onRotateStart",void 0),D(this,"onRotate",void 0),D(this,"onRotateEnd",void 0),D(this,"onHandleChange",void 0),D(this,"onBindingChange",void 0),D(this,"onChildrenChange",void 0),D(this,"onDoubleClickHandle",void 0),D(this,"onDoubleClickEdge",void 0),D(this,"onDoubleClick",void 0),D(this,"onClick",void 0),D(this,"onEditEnd",void 0),this.editor=t,this.type=n,this.styleProps=r}return z(e,[{key:"setStyleInPartial",value:function(e,t,n){var r=this.styleProps.get(e);return r?Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},D({},r,n))}):t}},{key:"providesBackgroundForChildren",value:function(e){return!1}},{key:"getOutlineSegments",value:function(e){return[this.editor.getOutline(e)]}},{key:"getOutline",value:function(e){return this.editor.getBounds(e).corners}},{key:"snapPoints",value:function(e){return this.editor.getBounds(e).snapPoints}},{key:"center",value:function(e){return this.getCenter(e)}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"canReceiveNewChildrenOfType",value:function(e,t){return!1}},{key:"canDropShapes",value:function(e,t){return!1}},{key:"expandSelectionOutlinePx",value:function(e){return 0}},{key:"hitTestPoint",value:function(e,t){return this.editor.getBounds(e).containsPoint(t)}},{key:"hitTestLineSegment",value:function(e,t,n){for(var r=this.editor.getOutline(e),i=0;i<r.length;i++){if(Ws(t,n,r[i],r[(i+1)%r.length]))return!0}return!1}},{key:"getCanvasSvgDefs",value:function(){return[]}}]),e}();function Bc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.newPoint,i=t.handle,o=t.scaleX,a=t.scaleY,s=n.minWidth,u=void 0===s?1:s,l=n.maxWidth,c=void 0===l?1/0:l,d=n.minHeight,f=void 0===d?1:d,p=n.maxHeight,h=void 0===p?1/0:p,v=e.props.w*o,g=e.props.h*a,m=new Ya(0,0);if(v>0){if(v<u){switch(i){case"top_left":case"left":case"bottom_left":m.x=v-u;break;case"top":case"bottom":m.x=(v-u)/2;break;default:m.x=0}v=u}}else if(m.x=v,(v=-v)<u){switch(i){case"top_left":case"left":case"bottom_left":m.x=-v;break;default:m.x=-u}v=u}if(g>0){if(g<f){switch(i){case"top_left":case"top":case"top_right":m.y=g-f;break;case"right":case"left":m.y=(g-f)/2;break;default:m.y=0}g=f}}else if(m.y=g,(g=-g)<f){switch(i){case"top_left":case"top":case"top_right":m.y=-g;break;default:m.y=-f}g=f}var y=m.rot(e.rotation).add(r);return{x:y.x,y:y.y,props:{w:Math.min(c,v),h:Math.min(h,g)}}}D(Rc,"type",void 0);var Fc=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onResize",(function(e,t){return Bc(e,t)})),e}return z(n,[{key:"getBounds",value:function(e){return new ws(0,0,e.props.w,e.props.h)}},{key:"getCenter",value:function(e){return new Ya(e.props.w/2,e.props.h/2)}},{key:"getOutline",value:function(e){return this.editor.getBounds(e).corners}},{key:"hitTestPoint",value:function(e,t){return gs(t,this.editor.getOutline(e))}},{key:"hitTestLineSegment",value:function(e,t,n){for(var r=this.editor.getOutline(e),i=0;i<r.length;i++){if(Ws(t,n,r[i],r[(i+1)%r.length]))return!0}return!1}}]),n}(Rc),Uc=function(e){Et(r,e);var n=Tt(r);function r(){var e;j(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return D(_t(e=n.call.apply(n,[this].concat(i))),"hideSelectionBoundsBg",(function(t){return!e.canResize(t)})),D(_t(e),"hideSelectionBoundsFg",(function(t){return!e.canResize(t)})),D(_t(e),"canEdit",(function(){return!0})),D(_t(e),"canUnmount",(function(e){var t,n;return!(null===(t=Nc(e.props.url))||void 0===t||null===(n=t.definition)||void 0===n||!n.canUnmount)})),D(_t(e),"canResize",(function(e){var t,n;return!(null===(t=Nc(e.props.url))||void 0===t||null===(n=t.definition)||void 0===n||!n.doesResize)})),D(_t(e),"isAspectRatioLocked",(function(e){var t,n=Nc(e.props.url);return null!==(t=null===n||void 0===n?void 0:n.definition.isAspectRatioLocked)&&void 0!==t&&t})),D(_t(e),"onResize",(function(t,n){var r,i,o=e.isAspectRatioLocked(t),a=Nc(t.props.url),s=null!==(r=null===a||void 0===a?void 0:a.definition.minWidth)&&void 0!==r?r:200,u=null!==(i=null===a||void 0===a?void 0:a.definition.minHeight)&&void 0!==i?i:200;if(o){var l=t.props.w/t.props.h;l>1?s*=l:u/=l}return Bc(t,n,{minWidth:s,minHeight:u})})),e}return z(r,[{key:"getDefaultProps",value:function(){return{w:300,h:300,url:""}}},{key:"component",value:function(e){var n,i,o=this,a=e.props,s=a.w,u=a.h,c=a.url,d=Oc(e.id),f=(0,t.useMemo)((function(){return Dc(c)}),[c]),p=_e("is hovering",(function(){var e=o.editor.pageState,t=e.editingId,n=e.hoveredId;if(t&&n!==t){var i=o.editor.getShapeById(t);if(i&&o.editor.isShapeOfType(i,r))return!0}return!1}),[]),h=this.editor.getPageRotation(e),v=d||p;if("github_gist"===(null===f||void 0===f?void 0:f.definition.type)){var g=f.url.split("/").pop();if(!g)throw Error("No gist id!");return(0,La.jsx)(Ac,{className:"tl-embed-container",id:e.id,children:(0,La.jsx)(Kc,{id:g,width:ms(s),height:ms(u),isInteractive:v,pageRotation:h})})}var m,y=(m=Ce(Ce({},Do),null!==(n=null===f||void 0===f?void 0:f.definition.overridePermissions)&&void 0!==n?n:{}),Object.entries(m).filter((function(e){var t=l(e,2);return t[0],t[1]})).map((function(e){return l(e,1)[0]})).join(" "));return(0,La.jsx)(Ac,{className:"tl-embed-container",id:e.id,children:null!==f&&void 0!==f&&f.definition?(0,La.jsx)("iframe",{className:"tl-embed tl-embed-".concat(e.id),sandbox:y,src:f.embedUrl,width:ms(s),height:ms(u),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:v?"auto":"none",zIndex:v?"":"-1",boxShadow:lu(h),borderRadius:null!==(i=null===f||void 0===f?void 0:f.definition.overrideOutlineRadius)&&void 0!==i?i:8,background:null===f||void 0===f?void 0:f.definition.backgroundColor}}):(0,La.jsx)("g",{transform:"translate(".concat((s-38)/2,", ").concat((u-38)/2,")"),children:(0,La.jsx)($u,{})})})}},{key:"indicator",value:function(e){var n,r,i=(0,t.useMemo)((function(){return Nc(e.props.url)}),[e.props.url]);return(0,La.jsx)("rect",{width:ms(e.props.w),height:ms(e.props.h),rx:null!==(n=null===i||void 0===i?void 0:i.definition.overrideOutlineRadius)&&void 0!==n?n:8,ry:null!==(r=null===i||void 0===i?void 0:i.definition.overrideOutlineRadius)&&void 0!==r?r:8})}}]),r}(Fc);function Kc(e){var t=e.id,n=e.file,r=e.isInteractive,i=e.width,o=e.height,a=e.style,s=e.pageRotation;return(0,La.jsx)("iframe",{className:"tl-embed",draggable:!1,width:ms(i),height:ms(o),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:Ce(Ce({},a),{},{pointerEvents:r?"all":"none",zIndex:r?"":"-1",boxShadow:lu(s)}),srcDoc:'\n\t\t\t<html>\n\t\t\t\t<head>\n\t\t\t\t\t<base target="_blank">\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<script src='.concat("https://gist.github.com/".concat(t,".js").concat(n?"?file=".concat(n):""),'><\/script>\n\t\t\t\t\t<style type="text/css">\n\t\t\t\t\t\t* { margin: 0px; }\n\t\t\t\t\t\ttable { height: 100%; background-color: red; }\n\t\t\t\t\t\t.gist { background-color: none; height: 100%;  }\n\t\t\t\t\t\t.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }\n\t\t\t\t\t</style>\n\t\t\t\t</body>\n\t\t\t</html>')})}D(Uc,"type","embed");var Vc=function(){function e(){j(this,e),D(this,"items",new WeakMap)}return z(e,[{key:"get",value:function(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}},{key:"access",value:function(e){return this.items.get(e)}},{key:"set",value:function(e,t){this.items.set(e,t)}},{key:"has",value:function(e){return this.items.has(e)}},{key:"invalidate",value:function(e){this.items.delete(e)}},{key:"bust",value:function(){this.items=new WeakMap}}]),e}();function Wc(e,t){return e.match(/^\s*$/)?t:e}function Hc(e,t,n){var r,i,o=n.padding,a=void 0===o?0:o,s=document.createElementNS("http://www.w3.org/2000/svg","text");if(s.setAttribute("font-size",n.fontSize+"px"),s.setAttribute("font-family",n.fontFamily),s.setAttribute("font-style",n.fontStyle),s.setAttribute("font-weight",n.fontWeight),s.setAttribute("line-height",n.lineHeight*n.fontSize+"px"),s.setAttribute("dominant-baseline","mathematical"),s.setAttribute("alignment-baseline","mathematical"),0===t.length)return s;var u,l=ws.From(t[0].box),c=J(t);try{for(c.s();!(u=c.n()).done;){var d=u.value.box;l.union(d)}}catch(S){c.e(S)}finally{c.f()}var f,p=a+(null!==(r=n.offsetX)&&void 0!==r?r:0),h=(null!==(i=n.offsetY)&&void 0!==i?i:0)+n.fontSize/2+("start"===n.verticalTextAlign?a:"end"===n.verticalTextAlign?n.height-a-l.height:(Math.ceil(n.height)-l.height)/2),v=null,g=J(t);try{for(g.s();!(f=g.n()).done;){var m=f.value,y=m.text,b=m.box;if(null!==v&&b.y>v){var w=document.createElementNS("http://www.w3.org/2000/svg","tspan");w.setAttribute("alignment-baseline","mathematical"),w.setAttribute("x",p+"px"),w.setAttribute("y",b.y+h+"px"),w.textContent="\n",s.appendChild(w)}var x=document.createElementNS("http://www.w3.org/2000/svg","tspan");x.setAttribute("alignment-baseline","mathematical"),x.setAttribute("x",b.x+p+"px"),x.setAttribute("y",b.y+h+"px");var k=y.replace(/\s/g,"\xa0");x.textContent=k,s.appendChild(x),v=b.y}}catch(S){g.e(S)}finally{g.f()}return n.stroke&&n.strokeWidth&&(s.setAttribute("stroke",n.stroke),s.setAttribute("stroke-width",n.strokeWidth+"px")),n.fill&&s.setAttribute("fill",n.fill),s}var Yc={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px",maxWidth:"auto"},Xc={s:2,m:3.5,l:5,xl:10},qc={s:18,m:24,l:36,xl:44},$c={s:18,m:22,l:26,xl:32},Gc={s:18,m:20,l:24,xl:28},Qc={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"};function Zc(e){return{key:"".concat(uo.id,":").concat(e),getElement:function(){var t=Ba(Na().mark((function t(){var n,r,i,o,a,s,u;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Jc(e)){t.next=3;break}return t.abrupt("return",null);case 3:if(r=n.$$_url,i=n.$$_fontface,r&&i){t.next=7;break}return t.abrupt("return",null);case 7:return t.next=9,fetch(r);case 9:return t.next=11,t.sent.blob();case 11:return o=t.sent,t.next=14,new Promise((function(e,t){var n=new FileReader;n.onload=function(){return e(n.result)},n.onerror=t,n.readAsDataURL(o)}));case 14:return a=t.sent,s=i.replace(r,a),(u=document.createElementNS("http://www.w3.org/2000/svg","style")).textContent=s,t.abrupt("return",u);case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}function Jc(e){var t,n=lo[e],r=J(document.fonts);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.includes(i.family))return i}}catch(o){r.e(o)}finally{r.f()}return null}function ed(e,t){return{key:"".concat(uo.id,":").concat(e),getElement:function(){var n=Ba(Na().mark((function n(){var r,i;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("pattern"===e){n.next=2;break}return n.abrupt("return",null);case 2:return r=8/12,(i=document.createElement("div")).innerHTML='\n\t\t\t\t<svg>\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<mask id="hash_pattern_mask">\n\t\t\t\t\t\t\t<rect x="0" y="0" width="8" height="8" fill="white" />\n\t\t\t\t\t\t\t<g\n\t\t\t\t\t\t\t\tstrokeLinecap="round"\n\t\t\t\t\t\t\t\tstroke="black"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<line x1="'.concat(1*r,'" y1="').concat(2,'" x2="').concat(2,'" y2="').concat(1*r,'" />\n\t\t\t\t\t\t\t\t<line x1="').concat(5*r,'" y1="').concat(7*r,'" x2="').concat(7*r,'" y2="').concat(5*r,'" />\n\t\t\t\t\t\t\t\t<line x1="').concat(6,'" y1="').concat(11*r,'" x2="').concat(11*r,'" y2="').concat(6,'" />\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</mask>\n\t\t\t\t\t\t<pattern\n\t\t\t\t\t\t\tid="hash_pattern"\n\t\t\t\t\t\t\twidth="8"\n\t\t\t\t\t\t\theight="8"\n\t\t\t\t\t\t\tpatternUnits="userSpaceOnUse"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<rect x="0" y="0" width="8" height="8" fill="').concat(t.solid,'" mask="url(#hash_pattern_mask)" />\n\t\t\t\t\t\t</pattern>\n\t\t\t\t\t</defs>\n\t\t\t\t</svg>\n\t\t\t'),n.abrupt("return",Array.from(i.querySelectorAll("defs > *")));case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()}}function td(){return{key:"".concat(uo.id,":pattern"),component:ad}}var nd=8,rd=function(e,t,n){return new Promise((function(r,i){var o=nd*t*e,a=document.createElement("canvas");a.width=o,a.height=o;var s=a.getContext("2d");if(s){s.fillStyle=n?"#212529":"#f8f9fa",s.fillRect(0,0,o,o),s.globalCompositeOperation="destination-out",s.lineCap="round",s.lineWidth=1.25*t*e;var u=8/12,l=function(n){return n*t*e};s.beginPath(),s.moveTo(l(1*u),l(2)),s.lineTo(l(2),l(1*u)),s.moveTo(l(5*u),l(7*u)),s.lineTo(l(7*u),l(5*u)),s.moveTo(l(6),l(11*u)),s.lineTo(l(11*u),l(6)),s.stroke(),a.toBlob((function(e){!e||Zs.throwToBlob.value?i():r(e)}))}}))},id=function(e,t){var n=document.createElement("canvas");n.width=e[0],n.height=e[1];var r=n.getContext("2d");return r?(t(r),n.toDataURL()):""},od=function(){for(var e=[],t=1;t<=Math.ceil(Au);t++){var n=id([1,1],(function(e){e.fillStyle=Zi.lightMode.black.semi,e.fillRect(0,0,1,1)})),r=id([1,1],(function(e){e.fillStyle=Zi.darkMode.black.semi,e.fillRect(0,0,1,1)}));e.push({zoom:t,url:n,darkMode:!1}),e.push({zoom:t,url:r,darkMode:!0})}return e};function ad(){var e=Ka(),n=(0,t.useRef)(null),r=function(){var e=Ka().devicePixelRatio,n=l((0,t.useState)(!1),2),r=n[0],i=n[1],o=(0,t.useMemo)((function(){return od()}),[]),a=l((0,t.useState)(o),2),s=a[0],u=a[1];return(0,t.useEffect)((function(){for(var t=[],n=function(n){t.push(rd(e,n,!1).then((function(e){return{zoom:n,url:URL.createObjectURL(e),darkMode:!1}}))),t.push(rd(e,n,!0).then((function(e){return{zoom:n,url:URL.createObjectURL(e),darkMode:!0}})))},r=1;r<=Math.ceil(Au);r++)n(r);var o=!1;return Promise.all(t).then((function(e){o||(u(e),i(!0))})),function(){o=!0,i(!1)}}),[e]),{defs:(0,La.jsx)(La.Fragment,{children:s.map((function(e){var t=e.zoom+(e.darkMode?"_dark":"_light");return(0,La.jsx)("pattern",{id:Ou[t],width:nd,height:nd,patternUnits:"userSpaceOnUse",children:(0,La.jsx)("image",{href:e.url,width:nd,height:nd})},t)}))}),isReady:r}}(),i=r.defs,o=r.isReady;return(0,t.useEffect)((function(){if(o&&e.isSafari){var t=sd(n.current);t&&requestAnimationFrame((function(){t.style.display="none",requestAnimationFrame((function(){t.style.display=""}))}))}}),[e,o]),(0,La.jsx)("g",{ref:n,children:i})}function sd(e){return e.classList.contains("tl-html-layer")?e:e.parentElement?sd(e.parentElement):null}var ud="  ",ld=function(){function e(){j(this,e)}return z(e,null,[{key:"insertTextFirefox",value:function(e,t){e.setRangeText(t,e.selectionStart||0,e.selectionEnd||0,"end"),e.dispatchEvent(new InputEvent("input",{data:t,inputType:"insertText",isComposing:!1}))}},{key:"insert",value:function(t,n){var r=t.ownerDocument,i=r.activeElement;i!==t&&t.focus(),r.execCommand("insertText",!1,n)||e.insertTextFirefox(t,n),i===r.body?t.blur():i instanceof HTMLElement&&i!==t&&i.focus()}},{key:"set",value:function(t,n){t.select(),e.insert(t,n)}},{key:"getSelection",value:function(e){var t=e.selectionStart,n=e.selectionEnd;return e.value.slice(t||void 0,n||void 0)}},{key:"wrapSelection",value:function(t,n,r){var i=t.selectionStart,o=t.selectionEnd,a=e.getSelection(t);e.insert(t,n+a+(null!==r&&void 0!==r?r:n)),t.selectionStart=(i||0)+n.length,t.selectionEnd=(o||0)+n.length}},{key:"replace",value:function(t,n,r){var i=0;t.value.replace(n,(function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];var s=i+o[o.length-2],u=o[0].length;t.selectionStart=s,t.selectionEnd=s+u;var l="string"===typeof r?r:r.apply(void 0,o);return e.insert(t,l),t.selectionStart=s,i+=l.length-u,l}))}},{key:"findLineEnd",value:function(e,t){var n=e.lastIndexOf("\n",t-1)+1;return"\t"!==e.charAt(n)?t:n+1}},{key:"indent",value:function(t){var n,r=t.selectionStart,i=t.selectionEnd,o=t.value,a=o.slice(r,i),s=null===(n=/\n/g.exec(a))||void 0===n?void 0:n.length;if(s&&s>0){var u=o.lastIndexOf("\n",r-1)+1,l=t.value.slice(u,i-1),c=l.replace(/^|\n/g,"$&".concat(ud)),d=c.length-l.length;t.setSelectionRange(u,i-1),e.insert(t,c),t.setSelectionRange(r+1,i+d)}else e.insert(t,ud)}},{key:"unindent",value:function(t){var n=t.selectionStart,r=t.selectionEnd,i=t.value,o=i.lastIndexOf("\n",n-1)+1,a=e.findLineEnd(i,r),s=t.value.slice(o,a),u=s.replace(/(^|\n)(\t| {1,2})/g,"$1"),l=s.length-u.length;t.setSelectionRange(o,a),e.insert(t,u);var c=/\t| {1,2}/.exec(i.slice(o,n)),d=c?c[0].length:0,f=n-d;t.setSelectionRange(n-d,Math.max(f,r-l))}},{key:"indentCE",value:function(e){var t,n,r,i=window.getSelection(),o=e.innerText,a=null!==(t=cd(e))&&void 0!==t?t:0,s=null!==(n=cd(e))&&void 0!==n?n:0,u=o.slice(a,s),l=null===(r=/\n/g.exec(u))||void 0===r?void 0:r.length;if(l&&l>0){var c=o.lastIndexOf("\n",a-1)+1,d=o.slice(c,s-1),f=d.replace(/^|\n/g,"$&".concat(ud)).length-d.length;i&&i.setBaseAndExtent(e,a+1,e,s+f)}else{var p=window.getSelection();e.innerText=o.slice(0,a)+ud+o.slice(a),null===p||void 0===p||p.setBaseAndExtent(e,a+1,e,a+2)}}},{key:"unindentCE",value:function(t){var n,r,i=window.getSelection(),o=t.innerText,a=null!==(n=cd(t))&&void 0!==n?n:0,s=null!==(r=cd(t))&&void 0!==r?r:0,u=o.lastIndexOf("\n",a-1)+1,l=e.findLineEnd(o,s),c=o.slice(u,l),d=c.replace(/(^|\n)(\t| {1,2})/g,"$1"),f=c.length-d.length;if(i){i.setBaseAndExtent(t,u,t,l);var p=/\t| {1,2}/.exec(o.slice(u,a)),h=p?p[0].length:0,v=a-h;i.setBaseAndExtent(t,a-h,t,Math.max(v,s-f))}}},{key:"normalizeText",value:function(t){return t.replace(e.fixNewLines,"\n")}},{key:"normalizeTextForDom",value:function(t){return t.replace(e.fixNewLines,"\n").split("\n").map((function(e){return e||" "})).join("\n")}}]),e}();function cd(e){if("undefined"!==typeof window.getSelection){var t=window.getSelection();if(t){var n=0;if(0!==t.rangeCount){var r=t.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(e),i.setEnd(r.endContainer,r.endOffset),n=i.toString().length}return n}}}function dd(e,n,r){var i=Ka(),o=(0,t.useRef)(null),a=_e("isEditing",(function(){return i.pageState.editingId===e}),[i,e]),s=(0,t.useRef)(!1),u=(0,t.useRef)(),l=_e("is editable hovering",(function(){if("text"===n&&i.isIn("text")&&i.hoveredId===e)return!0;if(i.isIn("select.editing_shape")){var t=i.editingShape;return!!t&&(i.hoveredId===e&&t.type===n&&i.getShapeUtil(t).canEdit(t))}return!1}),[n,e]),c=(0,t.useCallback)((function(){l||requestAnimationFrame((function(){var t=o.current;if(t){var n=i.getShapeById(e);n&&(t.value=n.props.text,t.value.length&&!s.current&&t.select(),s.current=!1)}}))}),[i,e,l]),d=(0,t.useCallback)((function(){var e=u.current;requestAnimationFrame((function(){var t,n=o.current;if(i.isIn("select.editing_shape")&&n)if(e)if(e.length){s.current=!0,n.focus();var r=window.getSelection();r&&e.forEach((function(e){return r.addRange(e)}))}else n.focus();else n.focus();else null===(t=window.getSelection())||void 0===t||t.removeAllRanges(),i.complete()}))}),[i]),f=(0,t.useCallback)((function(e){switch((e.ctrlKey||e.metaKey)&&fu(e),e.key){case"Enter":(e.ctrlKey||e.metaKey)&&i.complete();break;case"Tab":ou(e),e.shiftKey?ld.unindent(e.currentTarget):ld.indent(e.currentTarget)}}),[i]),p=(0,t.useCallback)((function(t){var r=ld.normalizeText(t.currentTarget.value),o=r.replace(/\t/g,ud);if(o!==r){var a=t.currentTarget.selectionStart;t.currentTarget.value=o,t.currentTarget.selectionStart=a+(o.length-r.length),t.currentTarget.selectionEnd=a+(o.length-r.length),r=o}i.updateShapes([{id:e,type:n,props:{text:r}}])}),[i,e,n]),h=0===r.trim().length;return(0,t.useEffect)((function(){if(o.current){var e=function(){var e,t,n=null===(e=(t=window).getSelection)||void 0===e?void 0:e.call(t);if(n&&"None"!==n.type){var r=[];if(n)for(var i=0;i<n.rangeCount;i++){var o;r.push(null===(o=n.getRangeAt)||void 0===o?void 0:o.call(n,i))}u.current=r}};return document.addEventListener("selectionchange",e),function(){document.removeEventListener("selectionchange",e)}}})),{rInput:o,isEditing:a,isEditableFromHover:l,handleFocus:c,handleBlur:d,handleKeyDown:f,handleChange:p,isEmpty:h}}D(ld,"fixNewLines",/\r?\n|\r/g);var fd=new Vc,pd=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"canEdit",(function(){return!0})),D(_t(e),"isAspectRatioLocked",(function(){return!0})),D(_t(e),"onResize",(function(e,t){var n=t.initialBounds,r=t.initialShape,i=t.scaleX,o=t.handle;if("scale_shape"===t.mode||"right"!==o&&"left"!==o)return Ce({id:e.id,type:e.type},function(e,t){var n=t.initialBounds,r=t.scaleX,i=t.scaleY,o=t.newPoint,a=Math.max(.01,Math.min(Math.abs(r),Math.abs(i))),s=new Ya(0,0);r<0&&(s.x=-n.width*a),i<0&&(s.y=-n.height*a);var u=Ya.Add(o,s.rot(e.rotation));return{x:u.x,y:u.y,props:{scale:a*e.props.scale}}}(e,t));var a=n.width,s=a*i,u=new Ya(0,0);s=Math.max(1,Math.abs(s)),"left"===o?(u.x=a-s,i<0&&(u.x+=s)):i<0&&(u.x-=s);var l=u.rot(e.rotation).add(r),c=l.x,d=l.y;return{id:e.id,type:e.type,x:c,y:d,props:{w:s/r.props.scale,autoSize:!1}}})),D(_t(e),"onBeforeCreate",(function(t){if(t.props.autoSize&&!t.props.text.trim()){var n=e.getMinDimensions(t);return Ce(Ce({},t),{},{x:t.x-n.width/2,y:t.y-n.height/2})}})),D(_t(e),"onEditEnd",(function(t){var n=t.id,r=t.type,i=t.props.text,o=t.props.text.trimEnd();0===o.length?e.editor.deleteShapes([t.id]):o!==t.props.text&&e.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])})),D(_t(e),"onBeforeUpdate",(function(t,n){if(n.props.autoSize){var r=t.props.size!==n.props.size||t.props.align!==n.props.align||t.props.font!==n.props.font||1!==t.props.scale&&1===n.props.scale,i=t.props.text!==n.props.text;if(r||i){var o,a=e.getMinDimensions(t),s=hd(e.editor,n.props),u=a.width*t.props.scale,l=a.height*t.props.scale,c=s.width*n.props.scale,d=s.height*n.props.scale;switch(n.props.align){case"middle":o=new Ya((c-u)/2,i?0:(d-l)/2);break;case"end":o=new Ya(c-u,i?0:(d-l)/2);break;default:if(i)break;o=new Ya(0,(d-l)/2)}if(o){o.rot(n.rotation);var f=n.x,p=n.y;return Ce(Ce({},n),{},{x:f-o.x,y:p-o.y,props:Ce(Ce({},n.props),{},{w:c})})}return Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{w:c})})}}})),D(_t(e),"onDoubleClickEdge",(function(e){return e.props.autoSize?1!==e.props.scale?{id:e.id,type:e.type,props:{scale:1}}:void 0:{id:e.id,type:e.type,props:{autoSize:!0}}})),e}return z(n,[{key:"getDefaultProps",value:function(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}},{key:"getMinDimensions",value:function(e){var t=this;return fd.get(e.props,(function(e){return hd(t.editor,e)}))}},{key:"getBounds",value:function(e){var t=e.props.scale,n=this.getMinDimensions(e),r=n.width,i=n.height;return new ws(0,0,r*t,i*t)}},{key:"getOutline",value:function(e){var t=this.editor.getBounds(e);return[new Ya(0,0),new Ya(t.width,0),new Ya(t.width,t.height),new Ya(0,t.height)]}},{key:"component",value:function(e){var t=e.id,n=e.type,r=e.props,i=r.text,o=r.color,a=Ji(this.editor),s=this.getMinDimensions(e),u=s.width,l=s.height,c=dd(t,n,i),d=c.rInput,f=c.isEmpty,p=c.isEditing,h=c.isEditableFromHover,v=c.handleFocus,g=c.handleChange,m=c.handleKeyDown,y=c.handleBlur;return(0,La.jsx)(Ac,{id:e.id,children:(0,La.jsxs)("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":e.props.font,"data-align":e.props.align,"data-hastext":!f,"data-isediting":p||h,"data-textwrap":!0,style:{fontSize:qc[e.props.size],lineHeight:qc[e.props.size]*Yc.lineHeight+"px",transform:"scale(".concat(e.props.scale,")"),transformOrigin:"top left",width:Math.max(1,u),height:Math.max(qc[e.props.size]*Yc.lineHeight,l),color:a[o].solid},children:[(0,La.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:i}),p||h?(0,La.jsx)("textarea",{ref:d,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:p,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:i,onFocus:v,onChange:g,onKeyDown:m,onBlur:y,onTouchEnd:fu,onContextMenu:fu}):null]})})}},{key:"indicator",value:function(e){var t=this.getBounds(e);return(0,La.jsx)("rect",{width:ms(t.width),height:ms(t.height)})}},{key:"toSvg",value:function(e,t){var n,r;t.addExportDef(Zc(e.props.font));var i=Ji(this.editor),o=this.getBounds(e),a=e.props.text,s=o.width/(null!==(n=e.props.scale)&&void 0!==n?n:1),u=o.height/(null!==(r=e.props.scale)&&void 0!==r?r:1),l={fontSize:qc[e.props.size],fontFamily:lo[e.props.font],textAlign:e.props.align,verticalTextAlign:"middle",width:s,height:u,padding:0,lineHeight:Yc.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},c=i[e.props.color].solid,d=document.createElementNS("http://www.w3.org/2000/svg","g"),f=Hc(this.editor,this.editor.textMeasure.measureTextSpans(a,l),Ce(Ce({},l),{},{stroke:i.background,strokeWidth:2,fill:i.background,padding:0})),p=f.cloneNode(!0);return p.setAttribute("fill",c),p.setAttribute("stroke","none"),d.append(f),d.append(p),d}}]),n}(Rc);function hd(e,t){var n=t.font,r=t.text,i=t.autoSize,o=t.size,a=t.w,s=qc[o],u=i?"fit-content":Math.floor(Math.max(16,a))+"px",l=e.textMeasure.measureText(r,Ce(Ce({},Yc),{},{fontFamily:Qc[n],fontSize:s,width:u}));return i&&(l.w+=1),{width:Math.max(16,l.w),height:Math.max(s,l.h)}}D(pd,"type","text");var vd="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",gd="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",md='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function yd(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:16,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:16,s=qa/180*(-n-t),u=Math.sin(s),l=Math.cos(s),c=1*l-1*u,d=1*u+1*l;return"url(\"data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ".concat(i,";'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='").concat(c,"' dy='").concat(d,"' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(").concat(t+n," 16 16)").concat(r?" scale(-1,-1) translate(0, -32)":"","' filter='url(%23shadow)'>")+e.replaceAll('"',"'")+'</g></svg>") '.concat(o," ").concat(a,", pointer")}var bd={none:function(){return"none"},default:function(e,t,n){return yd('<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',e,0,t,n,12,8)},pointer:function(e,t,n){return yd('<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',e,0,t,n,14,10)},cross:function(e,t,n){return yd('<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',e,0,t,n)},move:function(e,t,n){return yd('<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',e,0,t,n)},grab:function(e,t,n){return yd('<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',e,0,t,n)},grabbing:function(e,t,n){return yd("<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",e,0,t,n)},text:function(e,t,n){return yd('<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',e,0,t,n,4,10)},"ew-resize":function(e,t,n){return yd(gd,e,0,t,n)},"ns-resize":function(e,t,n){return yd(gd,e,90,t,n)},"nesw-resize":function(e,t,n){return yd(vd,e,0,t,n)},"nwse-resize":function(e,t,n){return yd(vd,e,90,t,n)},"nwse-rotate":function(e,t,n){return yd(md,e,0,t,n)},"nesw-rotate":function(e,t,n){return yd(md,e,90,t,n)},"senw-rotate":function(e,t,n){return yd(md,e,180,t,n)},"swne-rotate":function(e,t,n){return yd(md,e,270,t,n)},"zoom-in":function(e,t,n){return yd('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',e,0,t,n)},"zoom-out":function(e,t,n){return yd('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',e,0,t,n)}};function wd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"black";return bd[e](function(e){return 180*e/qa}(t),!1,n)}var xd=["default","pointer","cross","move","grab","grabbing","text"];function kd(e){var n=Ka(),r=(0,t.useMemo)((function(){var t,r;return{onPointerDown:function(t){if(!t.isKilled&&0===t.button){var r=iu(t.currentTarget);au(r,t),r.addEventListener("pointerup",(function e(){r.removeEventListener("pointerup",e),su(r,t)})),n.dispatch(Ce({name:"pointer_down",type:"pointer",target:"selection",handle:e},pu(t,n.getContainer()))),t.stopPropagation()}},onPointerMove:function(i){i.isKilled||0===i.button&&(i.clientX===t&&i.clientY===r||(t=i.clientX,r=i.clientY,n.dispatch(Ce({name:"pointer_move",type:"pointer",target:"selection",handle:e},pu(i,n.getContainer())))))},onPointerUp:function(t){t.isKilled||0===t.button&&n.dispatch(Ce({name:"pointer_up",type:"pointer",target:"selection",handle:e},pu(t,n.getContainer())))}}}),[n,e]);return r}function Sd(e){var t=e.size,n=e.width,r=e.height,i=e.hideAlternateHandles,o=ms(t/3),a=o/2;return(0,La.jsxs)("svg",{className:"tl-overlays__item",children:[(0,La.jsx)("polyline",{className:"tl-corner-crop-handle",points:"\n\t\t\t\t\t\t".concat(ms(0-a),",").concat(ms(t)," \n\t\t\t\t\t\t").concat(ms(0-a),",").concat(ms(0-a)," \n\t\t\t\t\t\t").concat(ms(t),",").concat(ms(0-a)),strokeWidth:o,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),(0,La.jsx)("line",{className:Fa("tl-corner-crop-edge-handle",{"tl-hidden":i}),x1:ms(n/2-t),y1:ms(0-a),x2:ms(n/2+t),y2:ms(0-a),strokeWidth:o,"data-testid":"selection.crop.top","aria-label":"top handle"}),(0,La.jsx)("polyline",{className:Fa("tl-corner-crop-handle",{"tl-hidden":i}),points:"\n\t\t\t\t\t\t".concat(ms(n-t),",").concat(ms(0-a)," \n\t\t\t\t\t\t").concat(ms(n+a),",").concat(ms(0-a)," \n\t\t\t\t\t\t").concat(ms(n+a),",").concat(ms(t)),strokeWidth:o,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),(0,La.jsx)("line",{className:Fa("tl-corner-crop-edge-handle",{"tl-hidden":i}),x1:ms(n+a),y1:ms(r/2-t),x2:ms(n+a),y2:ms(r/2+t),strokeWidth:o,"data-testid":"selection.crop.right","aria-label":"right handle"}),(0,La.jsx)("polyline",{className:"tl-corner-crop-handle",points:"\n\t\t\t\t\t\t".concat(ms(n+a),",").concat(ms(r-t)," \n\t\t\t\t\t\t").concat(ms(n+a),",").concat(ms(r+a),"\n\t\t\t\t\t\t").concat(ms(n-t),",").concat(ms(r+a)),strokeWidth:o,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),(0,La.jsx)("line",{className:Fa("tl-corner-crop-edge-handle",{"tl-hidden":i}),x1:ms(n/2-t),y1:ms(r+a),x2:ms(n/2+t),y2:ms(r+a),strokeWidth:o,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),(0,La.jsx)("polyline",{className:Fa("tl-corner-crop-handle",{"tl-hidden":i}),points:"\n\t\t\t\t\t\t".concat(ms(0+t),",").concat(ms(r+a)," \n\t\t\t\t\t\t").concat(ms(0-a),",").concat(ms(r+a),"\n\t\t\t\t\t\t").concat(ms(0-a),",").concat(ms(r-t)),strokeWidth:o,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),(0,La.jsx)("line",{className:Fa("tl-corner-crop-edge-handle",{"tl-hidden":i}),x1:ms(0-a),y1:ms(r/2-t),x2:ms(0-a),y2:ms(r/2+t),strokeWidth:o,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}var _d="undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Pd=ke((function(){var e,n,r=Ka(),i=(0,t.useRef)(null),o=r.isReadOnly,a=kd("top"),s=kd("right"),u=kd("bottom"),l=kd("left"),c=kd("top_left"),d=kd("top_right"),f=kd("bottom_right"),p=kd("bottom_left"),h=!r.isMenuOpen&&"default"===r.cursor.type,v=r.isCoarsePointer,g=r.selectionBounds,m=r.selectedShapes,y=r.onlySelectedShape,b=y&&r.isShapeOrAncestorLocked(y),w=y?r.getShapeUtil(y).expandSelectionOutlinePx(y):0;if(_u(i,null===(e=g)||void 0===e?void 0:e.x,null===(n=g)||void 0===n?void 0:n.y,1,r.selectionRotation,{x:-w,y:-w}),!g)return null;g=g.clone().expandBy(w);var x=r.zoomLevel,k=r.selectionRotation,S=r.isChangingStyle,_=Math.max(1,g.width),P=Math.max(1,g.height),E=8/x,C=_<2*E,I=P<2*E,T=_<4*E,M=P<4*E,j=_<5*E,A=P<5*E,O=v?1.75:1,L=6/x*O,z=(T?L/2:L)*(.75*O),D=(M?L/2:L)*(.75*O),N=(!y||!r.getShapeUtil(y).hideSelectionBoundsFg(y))&&!S,R=N&&r.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle","select.editing_shape")||N&&r.isIn("select.resizing")&&y&&r.isShapeOfType(y,pd);y&&r.isShapeOfType(y,Uc)&&R&&_d&&(R=!1);var B=r.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!S&&!o,F=r.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!S&&!o,U=!v&&!(C||I)&&(F||B)&&(!y||!r.getShapeUtil(y).hideRotateHandle(y))&&!b,K=v&&(!T||!M)&&(F||B)&&(!y||!r.getShapeUtil(y).hideRotateHandle(y))&&!b,V=F&&(!y||r.getShapeUtil(y).canResize(y)&&!r.getShapeUtil(y).hideResizeHandles(y))&&!B&&!b,W=C||I,H=C&&I,Y=j||A,X=V||B,q=!U,$=!F||!K,G=!F||!X,Q=!F||!X||W,Z=!F||!X||W,J=!F||!X||H&&!B,ee=v;ee&&m.every((function(e){return r.getShapeUtil(e).isAspectRatioLocked(e)}))&&(ee=!1);var te=!0;B?te=Y:V&&(te=W||H||ee);var ne=Math.min(24/x,P-3*D),re=F&&v&&y&&r.isShapeOfType(y,pd)&&ne*x>=4;return(0,La.jsxs)("svg",{ref:i,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:[R&&(0,La.jsx)("rect",{className:Fa("tl-selection__fg__outline"),width:ms(_),height:ms(P)}),(0,La.jsx)(Ed,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:L,corner:"top_left_rotate",cursor:h?wd("nwse-rotate",k):void 0,isHidden:q}),(0,La.jsx)(Ed,{"data-testid":"selection.rotate.top-right",cx:_+3*L,cy:0,targetSize:L,corner:"top_right_rotate",cursor:h?wd("nesw-rotate",k):void 0,isHidden:q}),(0,La.jsx)(Ed,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:P+3*L,targetSize:L,corner:"bottom_left_rotate",cursor:h?wd("swne-rotate",k):void 0,isHidden:q}),(0,La.jsx)(Ed,{"data-testid":"selection.rotate.bottom-right",cx:_+3*L,cy:P+3*L,targetSize:L,corner:"bottom_right_rotate",cursor:h?wd("senw-rotate",k):void 0,isHidden:q})," ",(0,La.jsx)(Id,{"data-testid":"selection.rotate.mobile",cx:T?1.5*-L:_/2,cy:T?P/2:1.5*-L,size:E,isHidden:$}),(0,La.jsx)("rect",Ce({className:Fa("tl-transparent",{"tl-hidden":te}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:ms(0-(M?2*D:D)),width:ms(Math.max(1,_)),height:ms(Math.max(1,2*D)),style:h?{cursor:wd("ns-resize",k)}:void 0},a)),(0,La.jsx)("rect",Ce({className:Fa("tl-transparent",{"tl-hidden":te}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:ms(_-(T?0:z)),y:0,height:ms(Math.max(1,P)),width:ms(Math.max(1,2*z)),style:h?{cursor:wd("ew-resize",k)}:void 0},s)),(0,La.jsx)("rect",Ce({className:Fa("tl-transparent",{"tl-hidden":te}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:ms(P-(M?0:D)),width:ms(Math.max(1,_)),height:ms(Math.max(1,2*D)),style:h?{cursor:wd("ns-resize",k)}:void 0},u)),(0,La.jsx)("rect",Ce({className:Fa("tl-transparent",{"tl-hidden":te}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:ms(0-(T?2*z:z)),y:0,height:ms(Math.max(1,P)),width:ms(Math.max(1,2*z)),style:h?{cursor:wd("ew-resize",k)}:void 0},l)),(0,La.jsx)("rect",Ce({className:Fa("tl-transparent",{"tl-hidden":G}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:ms(0-(T?2*z:1.5*z)),y:ms(0-(M?2*D:1.5*D)),width:ms(3*z),height:ms(3*D),style:h?{cursor:wd("nwse-resize",k)}:void 0},c)),(0,La.jsx)("rect",Ce({className:Fa("tl-transparent",{"tl-hidden":Q}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:ms(_-(T?0:1.5*z)),y:ms(0-(M?2*D:1.5*D)),width:ms(3*z),height:ms(3*D),style:h?{cursor:wd("nesw-resize",k)}:void 0},d)),(0,La.jsx)("rect",Ce({className:Fa("tl-transparent",{"tl-hidden":J}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:ms(_-(T?z:1.5*z)),y:ms(P-(M?D:1.5*D)),width:ms(3*z),height:ms(3*D),style:h?{cursor:wd("nwse-resize",k)}:void 0},f)),(0,La.jsx)("rect",Ce({className:Fa("tl-transparent",{"tl-hidden":Z}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:ms(0-(T?3*z:1.5*z)),y:ms(P-(M?0:1.5*D)),width:ms(3*z),height:ms(3*D),style:h?{cursor:wd("nesw-resize",k)}:void 0},p)),V&&(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("rect",{"data-testid":"selection.resize.top-left",className:Fa("tl-corner-handle",{"tl-hidden":G}),"aria-label":"top_left handle",x:ms(0-E/2),y:ms(0-E/2),width:ms(E),height:ms(E)}),(0,La.jsx)("rect",{"data-testid":"selection.resize.top-right",className:Fa("tl-corner-handle",{"tl-hidden":Q}),"aria-label":"top_right handle",x:ms(_-E/2),y:ms(0-E/2),width:ms(E),height:ms(E)}),(0,La.jsx)("rect",{"data-testid":"selection.resize.bottom-right",className:Fa("tl-corner-handle",{"tl-hidden":J}),"aria-label":"bottom_right handle",x:ms(_-E/2),y:ms(P-E/2),width:ms(E),height:ms(E)}),(0,La.jsx)("rect",{"data-testid":"selection.resize.bottom-left",className:Fa("tl-corner-handle",{"tl-hidden":Z}),"aria-label":"bottom_left handle",x:ms(0-E/2),y:ms(P-E/2),width:ms(E),height:ms(E)})]}),re&&(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:ms(0-E/4),y:ms(P/2-ne/2),rx:E/4,width:ms(E/2),height:ms(ne)}),(0,La.jsx)("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:E/4,x:ms(_-E/4),y:ms(P/2-ne/2),width:ms(E/2),height:ms(ne)})]}),B&&(0,La.jsx)(Sd,Ce({},{size:E,width:_,height:P,hideAlternateHandles:Y}))]})})),Ed=function(e){var t=e.cx,n=e.cy,r=e.targetSize,i=e.corner,o=e.cursor,a=e.isHidden,s=e["data-testid"],u=kd(i);return(0,La.jsx)("rect",Ce({className:Fa("tl-transparent","tl-rotate-corner",{"tl-hidden":a}),"data-testid":s,"aria-label":"".concat(i," target"),pointerEvents:"all",x:ms(t-3*r),y:ms(n-3*r),width:ms(Math.max(1,3*r)),height:ms(Math.max(1,3*r)),cursor:o},u))},Cd=Math.sqrt(Math.PI),Id=function(e){var t=e.cx,n=e.cy,r=e.size,i=e.isHidden,o=e["data-testid"],a=kd("mobile_rotate");return(0,La.jsxs)("g",{children:[(0,La.jsx)("circle",Ce({"data-testid":o,pointerEvents:"all",className:Fa("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":i}),cx:t,cy:n},a)),(0,La.jsx)("circle",{className:Fa("tl-mobile-rotate__fg",{"tl-hidden":i}),cx:t,cy:n,r:r/Cd})]})},Td=function(e,t,n){return function(r){if("pointer_move"!==n&&e.pageState.editingId===t&&(r.isKilled=!0),!r.isKilled){switch(n){case"pointer_down":if(0!==r.button&&1!==r.button&&2!==r.button)return;au(r.currentTarget,r);break;case"pointer_up":su(r.currentTarget,r)}var i=e.getShapeById(t);i?e.dispatch(Ce({type:"pointer",target:"shape",shape:i,name:n},pu(r,e.getContainer()))):console.error("Shape not found",t)}}};var Md=ke((function(e){var n=e.id,r=e.index,i=e.backgroundIndex,o=e.opacity,a=e.isCulled,s=Ka(),u=sl().ShapeErrorFallback,l=function(e){var n=Ka();return t.useMemo((function(){var t,r,i=Td(n,e,"pointer_move");return{onPointerDown:Td(n,e,"pointer_down"),onPointerUp:Td(n,e,"pointer_up"),onPointerEnter:Td(n,e,"pointer_enter"),onPointerLeave:Td(n,e,"pointer_leave"),onPointerMove:function(e){if(!e.isKilled&&(e.clientX!==t||e.clientY!==r))return t=e.clientX,r=e.clientY,i(e)},onTouchStart:function(e){e.isKilled=!0,ou(e)},onTouchEnd:function(e){e.isKilled=!0,ou(e)}}}),[n,e])}(n),c=t.useRef(null),d=t.useRef(null),f=t.useCallback((function(e,t){var n,r;null===(n=c.current)||void 0===n||n.style.setProperty(e,t),null===(r=d.current)||void 0===r||r.style.setProperty(e,t)}),[]);Se("set shape container transform position",(function(){var e=s.getShapeById(n),t=s.getPageTransformById(n);if(!e||!t)return null;var r=Cs.toCssString(t);f("transform",r)}),[s,f]),Se("set shape container clip path",(function(){if(!s.getShapeById(n))return null;var e=s.getClipPathById(n);f("clip-path",null!==e&&void 0!==e?e:"none")}),[s,f]),Se("set shape height and width",(function(){var e=s.getShapeById(n);if(!e)return null;var t=s.getBounds(e);f("width",Math.ceil(t.width)+"px"),f("height",Math.ceil(t.height)+"px")}),[s]),t.useLayoutEffect((function(){var e,t;f("opacity",o+""),null===(e=c.current)||void 0===e||e.style.setProperty("z-index",r+""),null===(t=d.current)||void 0===t||t.style.setProperty("z-index",i+"")}),[o,r,i,f]);var p=s.getShapeById(n),h=t.useCallback((function(e){s.annotateError(e,{origin:"react.shape",willCrashApp:!1})}),[s]);if(!p)return null;var v=s.getShapeUtil(p);return(0,La.jsxs)(La.Fragment,{children:[v.backgroundComponent&&(0,La.jsx)("div",{ref:d,className:"tl-shape tl-shape-background","data-shape-type":p.type,draggable:!1,children:!a&&(0,La.jsx)(el,{fallback:u,onError:h,children:(0,La.jsx)(Ad,{shape:p,util:v})})}),(0,La.jsx)("div",{ref:c,className:"tl-shape","data-shape-type":p.type,draggable:!1,onPointerDown:l.onPointerDown,onPointerMove:l.onPointerMove,onPointerUp:l.onPointerUp,onPointerEnter:l.onPointerEnter,onPointerLeave:l.onPointerLeave,children:a&&v.canUnmount(p)?(0,La.jsx)(Od,{shape:p}):(0,La.jsx)(el,{fallback:u,onError:h,children:(0,La.jsx)(jd,{shape:p,util:v})})})]})})),jd=t.memo((function(e){var t=e.shape,n=e.util;return ye("InnerShape:"+n.type,(function(){return n.component(t)}))}),(function(e,t){return e.shape.props===t.shape.props&&e.shape.meta===t.shape.meta})),Ad=t.memo((function(e){var t=e.shape,n=e.util;return ye("InnerShape:"+n.type,(function(){var e;return null===(e=n.backgroundComponent)||void 0===e?void 0:e.call(n,t)}))}),(function(e,t){return e.shape.props===t.shape.props&&e.shape.meta===t.shape.meta})),Od=t.memo((function(e){var t=e.shape,n=Ka().getBounds(t);return(0,La.jsx)("div",{className:"tl-shape__culled",style:{transform:"translate(".concat(n.minX,"px, ").concat(n.minY,"px)"),width:n.width,height:n.height}})}),(function(){return!0})),Ld=ke((function(){var e=Ka(),n=sl(),r=n.Background,i=n.SvgDefs,o=t.useRef(null),a=t.useRef(null);!function(){var e=Ka(),n=wu();(0,t.useLayoutEffect)((function(){var t=vc((function(){e.updateViewportScreenBounds()}),200,{trailing:!0}),r=new ResizeObserver((function(e){e[0].contentRect&&t()}));return n&&r.observe(n),t(),function(){r.disconnect()}}),[e,n])}(),function(){var e=Ka(),n=wu(),r=_e("isFocused",(function(){return e.isFocused}),[e]);(0,t.useEffect)((function(){if(void 0===typeof matchMedia){var t=matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)"));return t.addEventListener("change",n),function(){t.removeEventListener("change",n)}}function n(){e.setDevicePixelRatio(window.devicePixelRatio)}}),[e]),(0,t.useEffect)((function(){if(r){var t=function(t){if(!t.altKey||!e.isIn("zoom")&&e.root.path.value.endsWith(".idle")||ku()||ou(t),!t.isKilled){switch(t.isKilled=!0,t.key){case"=":case"-":case"0":if(t.metaKey||t.ctrlKey)return void ou(t);break;case"Tab":default:if(ku()||e.isMenuOpen)return;break;case",":if(!ku()&&(ou(t),!e.inputs.keys.has("Comma"))){var r=e.inputs.currentScreenPoint,i=r.x,o=r.y,a=r.z,s=e.pageState.hoveredId;e.inputs.keys.add("Comma");var u=Ce({type:"pointer",name:"pointer_down",point:{x:i,y:o,z:a},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode},s?{target:"shape",shape:e.getShapeById(s)}:{target:"canvas"});return void e.dispatch(u)}break;case"Escape":return void(e.inputs.keys.has("Escape")||(e.inputs.keys.add("Escape"),e.cancel(),n.focus()))}var l={type:"keyboard",name:e.inputs.keys.has(t.code)?"key_repeat":"key_down",key:t.key,code:t.code,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey};e.dispatch(l)}},i=function(t){if(!t.isKilled&&(t.isKilled=!0,!ku()&&!e.isMenuOpen)){var n;if(","===t.key&&(null!==(n=document.activeElement)&&void 0!==n&&n.ELEMENT_NODE&&ou(t),e.inputs.keys.has(t.code))){var r=e.inputs.currentScreenPoint,i=r.x,o=r.y,a=r.z,s=e.pageState.hoveredId;e.inputs.keys.delete(t.code);var u=Ce({type:"pointer",name:"pointer_up",point:{x:i,y:o,z:a},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode},s?{target:"shape",shape:e.getShapeById(s)}:{target:"canvas"});return void e.dispatch(u)}var l={type:"keyboard",name:"key_up",key:t.key,code:t.code,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey};e.dispatch(l)}},o=function(e){n.contains(e.target)&&(e.ctrlKey||e.metaKey)&&ou(e)};return n.addEventListener("touchstart",a,{passive:!1}),n.addEventListener("wheel",o,{passive:!1}),document.addEventListener("gesturestart",ou),document.addEventListener("gesturechange",ou),document.addEventListener("gestureend",ou),n.addEventListener("keydown",t),n.addEventListener("keyup",i),window.addEventListener("blur",s),window.addEventListener("focus",u),function(){n.removeEventListener("touchstart",a),n.removeEventListener("wheel",o),document.removeEventListener("gesturestart",ou),document.removeEventListener("gesturechange",ou),document.removeEventListener("gestureend",ou),n.removeEventListener("keydown",t),n.removeEventListener("keyup",i),window.removeEventListener("blur",s),window.removeEventListener("focus",u)}}function a(t){if(n.contains(t.target)){var r,i,o=t.touches[0].pageX,a=t.touches[0].radiusX||0;if(o-a<10||o+a>e.viewportScreenBounds.width-10)"BUTTON"===(null===(r=t.target)||void 0===r?void 0:r.tagName)&&(null===(i=t.target)||void 0===i||i.click()),ou(t)}}function s(){e.complete()}function u(){e.updateViewportScreenBounds()}}),[e,n,r])}(),function(){var e=Ka();(0,t.useEffect)((function(){if(window.matchMedia){var t=window.matchMedia("(pointer: coarse)"),n=function(){e.isCoarsePointer=t.matches};return n(),t.addEventListener("change",n),function(){return t.removeEventListener("change",n)}}}),[e])}(),xc(o),function(e){var n=Ka();(0,t.useEffect)((function(){var t=e.current;if(t){var r=function(e){if(e instanceof PointerEvent&&"pen"===e.pointerType){var t;e.isKilled=!0;var r=e.target;if(ul.includes(null===(t=r.tagName)||void 0===t?void 0:t.toLocaleLowerCase())||n.isIn("select.editing_shape"))return;ou(e)}};return t.addEventListener("touchstart",r),t.addEventListener("touchend",r),function(){t.removeEventListener("touchstart",r),t.addEventListener("touchend",r)}}}),[n,e])}(o),Se("position layers",(function(){var t=a.current;if(t){var n=e.camera,r=n.x,i=n.y,o=n.z,s=o>=1?Ue(o,[1,8],[.125,.5],!0):Ue(o,[.1,1],[-2,.125],!0);t.style.setProperty("transform","scale(".concat(ms(o),") translate(").concat(ms(r+s),"px,").concat(ms(i+s),"px)"))}}),[e]);var s=function(){var e=Ka(),n=(0,t.useMemo)((function(){var t,n;function r(){return r=Ba(Na().mark((function t(n){var r,i,o,a;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ou(n),null!==(r=n.dataTransfer)&&void 0!==r&&null!==(i=r.files)&&void 0!==i&&i.length){t.next=3;break}return t.abrupt("return");case 3:return o=Array.from(n.dataTransfer.files),a=e.getContainer().getBoundingClientRect(),t.next=7,e.putExternalContent({type:"files",files:o,point:e.screenToPage(n.clientX-a.x,n.clientY-a.y),ignoreParent:!1});case 7:case"end":return t.stop()}}),t)}))),r.apply(this,arguments)}return{onPointerDown:function(t){t.isKilled||0!==t.button&&1!==t.button&&5!==t.button||(au(t.currentTarget,t),e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_down"},pu(t,e.getContainer()))))},onPointerMove:function(r){r.isKilled||r.clientX===t&&r.clientY===n||(t=r.clientX,n=r.clientY,e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_move"},pu(r,e.getContainer()))))},onPointerUp:function(r){r.isKilled||0!==r.button&&1!==r.button&&2!==r.button&&5!==r.button||(t=r.clientX,n=r.clientY,su(r.currentTarget,r),e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_up"},pu(r,e.getContainer()))))},onPointerEnter:function(t){t.isKilled||e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_enter"},pu(t,e.getContainer())))},onPointerLeave:function(t){t.isKilled||e.dispatch(Ce({type:"pointer",target:"canvas",name:"pointer_leave"},pu(t,e.getContainer())))},onDragOver:function(e){ou(e)},onDrop:function(e){return r.apply(this,arguments)},onTouchStart:function(e){e.isKilled=!0,document.body.click(),ou(e)},onTouchEnd:function(e){e.isKilled=!0,"A"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&ou(e)}}}),[e]);return n}(),u=_e("shapeSvgDefs",(function(){var t,n=new Map,r=J(Ye(e.shapeUtils));try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!i)return;var o,a=J(i.getCanvasSvgDefs());try{for(a.s();!(o=a.n()).done;){var s=o.value,u=s.key,l=s.component;n.has(u)||n.set(u,(0,La.jsx)(l,{},u))}}catch(c){a.e(c)}finally{a.f()}}}catch(c){r.e(c)}finally{r.f()}return d(n.values())}),[e]);return t.useEffect((function(){var e;null===(e=o.current)||void 0===e||e.focus()}),[]),(0,La.jsxs)("div",Ce(Ce({ref:o,draggable:!1,className:"tl-canvas","data-testid":"canvas"},s),{},{children:[r&&(0,La.jsx)(r,{}),(0,La.jsx)(zd,{}),(0,La.jsx)(Qd,{}),(0,La.jsxs)("div",{ref:a,className:"tl-html-layer",draggable:!1,children:[(0,La.jsx)("svg",{className:"tl-svg-context",children:(0,La.jsxs)("defs",{children:[u,Yd&&(0,La.jsx)(Yd,{}),(0,La.jsx)(Xd,{}),(0,La.jsx)(qd,{}),(0,La.jsx)($d,{}),i&&(0,La.jsx)(i,{})]})}),(0,La.jsx)(Mc,{}),(0,La.jsx)("div",{className:"tl-shapes",children:(0,La.jsx)(Kd,{})}),(0,La.jsxs)("div",{className:"tl-overlays",children:[(0,La.jsx)(Fd,{}),(0,La.jsx)(Nd,{}),(0,La.jsx)(Dd,{}),(0,La.jsx)(Rd,{}),(0,La.jsx)(Vd,{}),(0,La.jsx)(Wd,{}),(0,La.jsx)(Hd,{}),(0,La.jsx)(Bd,{}),(0,La.jsx)(Pd,{}),(0,La.jsx)(Ec,{})]})]})]}))})),zd=ke((function(){var e=Ka(),t=sl().Grid,n=e.camera,r=n.x,i=n.y,o=n.z,a=e.isGridMode;return t&&a?(0,La.jsx)(t,{x:r,y:i,z:o,size:e.gridSize}):null})),Dd=ke((function(){var e=Ka(),t=e.scribble,n=e.zoomLevel,r=sl().Scribble;return r&&t?(0,La.jsx)(r,{className:"tl-user-scribble",scribble:t,zoom:n}):null})),Nd=ke((function(){var e=Ka(),t=e.brush,n=sl().Brush;return n&&t&&e.isIn("select.brushing")?(0,La.jsx)(n,{className:"tl-user-brush",brush:t}):null})),Rd=ke((function(){var e=Ka(),t=e.zoomBrush,n=sl().ZoomBrush;return n&&t&&e.isIn("zoom")?(0,La.jsx)(n,{className:"tl-user-brush",brush:t}):null})),Bd=ke((function(){var e=Ka(),t=e.snaps.lines,n=e.zoomLevel,r=sl().SnapLine;return r&&t.length>0?(0,La.jsx)(La.Fragment,{children:t.map((function(e){return(0,La.jsx)(r,{className:"tl-user-snapline",line:e,zoom:n},e.id)}))}):null})),Fd=ke((function(){var e=Ka(),t=e.zoomLevel,n=e.isChangingStyle,r=e.onlySelectedShape,i=e.isInAny("select.idle","select.pointing_handle")&&!n&&!e.isReadOnly;if(!r||!i)return null;var o=e.getHandles(r);if(!o)return null;var a=e.getPageTransform(r);if(!a)return null;for(var s=[],u=0,l=o[u];u<o.length;l=o[++u]){if("vertex"!==l.type){var c=o[u-1],d=o[u+1];if(c&&d&&Math.hypot(c.y-d.y,c.x-d.x)<48/t)continue}s.push(l)}return s.sort((function(e){return"vertex"===e.type?1:-1})),(0,La.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:(0,La.jsx)("g",{transform:Cs.toCssString(a),children:s.map((function(e){return(0,La.jsx)(Ud,{shapeId:r.id,handle:e},e.id)}))})})})),Ud=function(e){var n=e.shapeId,r=e.handle,i=function(e,n){var r=Ka();return t.useMemo((function(){var t,i;return{onPointerDown:function(t){if(!t.isKilled){au(iu(t.currentTarget),t);var i=kc(r,e,n),o=i.shape,a=i.handle;a&&r.dispatch(Ce({type:"pointer",target:"handle",handle:a,shape:o,name:"pointer_down"},pu(t,r.getContainer())))}},onPointerMove:function(o){if(!o.isKilled&&(o.clientX!==t||o.clientY!==i)){t=o.clientX,i=o.clientY;var a=kc(r,e,n),s=a.shape,u=a.handle;u&&r.dispatch(Ce({type:"pointer",target:"handle",handle:u,shape:s,name:"pointer_move"},pu(o,r.getContainer())))}},onPointerUp:function(t){if(!t.isKilled){su(iu(t.currentTarget),t);var i=kc(r,e,n),o=i.shape,a=i.handle;a&&r.dispatch(Ce({type:"pointer",target:"handle",handle:a,shape:o,name:"pointer_up"},pu(t,r.getContainer())))}},onPointerEnter:function(t){if(!t.isKilled){var i=kc(r,e,n),o=i.shape,a=i.handle;a&&r.dispatch(Ce({type:"pointer",target:"handle",handle:a,shape:o,name:"pointer_enter"},pu(t,r.getContainer())))}},onPointerLeave:function(t){if(!t.isKilled){var i=kc(r,e,n),o=i.shape,a=i.handle;a&&r.dispatch(Ce({type:"pointer",target:"handle",handle:a,shape:o,name:"pointer_leave"},pu(t,r.getContainer())))}}}}),[r,e,n])}(n,r.id),o=sl().Handle;return o?(0,La.jsx)("g",Ce(Ce({"aria-label":"handle",transform:"translate(".concat(r.x,", ").concat(r.y,")")},i),{},{children:(0,La.jsx)(o,{shapeId:n,handle:r})})):null},Kd=ke((function(){var e=Ka().renderingShapes;return Zs.debugSvg.value?(0,La.jsx)(La.Fragment,{children:e.map((function(e){return(0,La.jsxs)(t.Fragment,{children:[(0,La.jsx)(Md,Ce({},e)),(0,La.jsx)(Gd,{id:e.id})]},e.id+"_fragment")}))}):(0,La.jsx)(La.Fragment,{children:e.map((function(e){return(0,La.jsx)(Md,Ce({},e),e.id+"_shape")}))})})),Vd=ke((function(){var e=Ka();return e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!e.isChangingStyle?(0,La.jsx)(La.Fragment,{children:e.selectedIds.map((function(e){return(0,La.jsx)(il,{className:"tl-user-indicator__selected",id:e},e+"_indicator")}))}):null})),Wd=function(){var e=Ka(),t=_e("hovered id and should display",(function(){return e.isInAny("select.idle","select.editing_shape")?e.pageState.hoveredId:null}),[e]);return t?(0,La.jsx)(il,{className:"tl-user-indicator__hovered",id:t}):null},Hd=ke((function(){var e=Ie(Ka().hintingIds);return e.length?(0,La.jsx)(La.Fragment,{children:e.map((function(e){return(0,La.jsx)(il,{className:"tl-user-indicator__hint",id:e},e+"_hinting")}))}):null}));function Yd(){return(0,La.jsxs)("g",{id:"cursor",children:[(0,La.jsxs)("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[(0,La.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,La.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,La.jsxs)("g",{fill:"white",transform:"translate(-12,-12)",children:[(0,La.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,La.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,La.jsxs)("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[(0,La.jsx)("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),(0,La.jsx)("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function Xd(){return(0,La.jsx)("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function qd(){return(0,La.jsx)("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:(0,La.jsx)("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function $d(){return(0,La.jsxs)("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[(0,La.jsx)("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),(0,La.jsx)("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}var Gd=ke((function(e){var n=e.id,r=Ka(),i=r.getShapeById(n),o=l(t.useState(""),2),a=o[0],s=o[1],u=(null===i||void 0===i?void 0:i.parentId)===r.currentPageId;return t.useEffect((function(){if(u){var e=null,t=me("shape to svg",Ba(Na().mark((function t(){var i,o,a;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Math.random(),e=i,o=r.getPageBoundsById(n),t.next=5,r.getSvg([n],{padding:0});case 5:(a=t.sent)&&o&&e===i&&(a.style.setProperty("overflow","visible"),a.setAttribute("preserveAspectRatio","xMidYMin slice"),a.style.setProperty("transform","translate(".concat(o.x,"px, ").concat(o.y+o.h+12,"px)")),a.style.setProperty("border","1px solid black"),s(null===a||void 0===a?void 0:a.outerHTML));case 7:case"end":return t.stop()}}),t)}))));return function(){e=null,t()}}}),[r,n,u]),u?(0,La.jsx)("div",{style:{paddingTop:12,position:"absolute"},children:(0,La.jsx)("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:a}})}):null})),Qd=ke((function(){var e=Zs.logMessages.value;return(0,La.jsx)("div",{className:"debug__ui-logger",children:e.map((function(e,t){var n="string"===typeof e?e:JSON.stringify(e);return(0,La.jsx)("div",{className:"debug__ui-logger__line",children:n},t)}))})}));function Zd(){}var Jd=function(e){var n=e.error,r=e.editor,i=(0,t.useRef)(null),o=l((0,t.useState)(!1),2),a=o[0],s=o[1],u=l((0,t.useState)(!1),2),c=u[0],d=u[1],f=l((0,t.useState)(!1),2),p=f[0],h=f[1],v=n instanceof Error?n.message:String(n),g=n instanceof Error?n.stack:null,m=_e("isDarkMode",(function(){try{if(r)return r.isDarkMode}catch(e){}return null}),[r]),y=l((0,t.useState)(null),2),b=y[0],w=y[1];(0,t.useLayoutEffect)((function(){var e;null!==m&&w(m);for(var t=null===(e=i.current)||void 0===e?void 0:e.parentElement,n=!1;t;){if(t.classList.contains("tl-theme__dark")||t.classList.contains("tl-theme__light")){n=!0;break}t=t.parentElement}w(n?null:window.matchMedia("(prefers-color-scheme: dark)").matches)}),[m]),(0,t.useEffect)((function(){if(c){var e=setTimeout((function(){d(!1)}),2e3);return function(){return clearTimeout(e)}}}),[c]);var x=function(){var e=Ba(Na().mark((function e(){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Wa();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=new URL("https://github.com/tldraw/tldraw/issues/new");return k.searchParams.set("title",v),k.searchParams.set("labels","bug"),k.searchParams.set("body","Hey, I ran into an error while using tldraw:\n\n```js\n".concat(null!==g&&void 0!==g?g:v,"\n```\n\nMy browser: ").concat(navigator.userAgent)),(0,La.jsxs)("div",{ref:i,className:Fa("tl-container tl-error-boundary",null===b?"":b?"tl-theme__dark":"tl-theme__light"),children:[(0,La.jsx)("div",{className:"tl-error-boundary__overlay"}),r&&(0,La.jsx)(Ju,{onError:Zd,fallback:function(){return null},children:(0,La.jsx)(Ua.Provider,{value:r,children:(0,La.jsx)("div",{className:"tl-overlay tl-error-boundary__canvas",children:(0,La.jsx)(Ld,{})})})}),(0,La.jsx)("div",{className:Fa("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":a&&!p}),children:p?(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("h2",{children:"Are you sure?"}),(0,La.jsx)("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),(0,La.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,La.jsx)("button",{onClick:function(){return h(!1)},children:"Cancel"}),(0,La.jsx)("button",{className:"tl-error-boundary__reset",onClick:x,children:"Reset data"})]})]}):(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("h2",{children:"Something's gone wrong."}),(0,La.jsxs)("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",(0,La.jsx)("a",{href:k.toString(),children:"create a GitHub issue"})," or"," ",(0,La.jsx)("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),a&&(0,La.jsxs)("div",{className:"tl-error-boundary__content__error",children:[(0,La.jsx)("pre",{children:(0,La.jsx)("code",{children:null!==g&&void 0!==g?g:v})}),(0,La.jsx)("button",{onClick:function(){var e=document.createElement("textarea");e.value=null!==g&&void 0!==g?g:v,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove(),d(!0)},children:c?"Copied!":"Copy"})]}),(0,La.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,La.jsx)("button",{onClick:function(){return s(!a)},children:a?"Hide details":"Show details"}),(0,La.jsxs)("div",{className:"tl-error-boundary__content__actions__group",children:[(0,La.jsx)("button",{className:"tl-error-boundary__reset",onClick:function(){return h(!0)},children:"Reset data"}),(0,La.jsx)("button",{className:"tl-error-boundary__refresh",onClick:function(){Va.refreshPage()},children:"Refresh Page"})]})]})]})})]})};function ef(){return ot()}var tf,nf=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function rf(e){return nf.test(e)}var of=["animationSpeed"],af=["isSnapMode"],sf="TLDRAW_USER_DATA_v3",uf=nn({id:Vt,name:Vt,locale:Vt,color:Vt,isDarkMode:Gt,animationSpeed:Wt,isSnapMode:Gt}),lf=2,cf=yt({currentVersion:lf,migrators:(tf={},D(tf,1,{up:function(e){return Ce(Ce({},e),{},{animationSpeed:1})},down:function(e){e.animationSpeed;return gt(e,of)}}),D(tf,lf,{up:function(e){return Ce(Ce({},e),{},{isSnapMode:!1})},down:function(e){e.isSnapMode;return gt(e,af)}}),tf)}),df=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function ff(){return{id:ef(),locale:"undefined"!==typeof window?ja():"en",name:"New User",color:df[Math.floor(Math.random()*df.length)],isDarkMode:!1,animationSpeed:1,isSnapMode:!1}}function pf(e){var t;if(null===e||"object"!==typeof e)return ff();if(!("version"in e)||!("user"in e)||"number"!==typeof e.version)return ff();var n=xt({value:e.user,fromVersion:e.version,toVersion:null!==(t=cf.currentVersion)&&void 0!==t?t:0,migrations:cf});if("error"===n.type)return ff();try{uf.validate(n.value)}catch(ok){return ff()}return n.value}var hf=ue("globalUserData",function(){var e,t,n;return pf("undefined"===typeof window?null:null!==(e=JSON.parse((null===(t=window)||void 0===t||null===(n=t.localStorage)||void 0===n?void 0:n.getItem(sf))||"null"))&&void 0!==e?e:null)}());function vf(e){uf.validate(e),hf.set(e),"undefined"!==typeof window&&window.localStorage&&window.localStorage.setItem(sf,JSON.stringify({version:cf.currentVersion,user:hf.value})),null===mf||void 0===mf||mf.postMessage({type:bf,origin:yf,data:{user:hf.value,version:cf.currentVersion}})}var gf="undefined"!==typeof process&&!1,mf="undefined"===typeof BroadcastChannel||gf?null:new BroadcastChannel("tldraw-user-sync");null===mf||void 0===mf||mf.addEventListener("message",(function(e){var t=e.data;(null===t||void 0===t?void 0:t.type)===bf&&(null===t||void 0===t?void 0:t.origin)!==yf&&hf.set(pf(t.data))}));var yf=ef(),bf="tldraw-user-preferences-change";function wf(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{derivePresenceState:null!==(e=r.derivePresenceState)&&void 0!==e?e:function(){return ve("presence",(function(){return null}))},userPreferences:null!==(t=r.userPreferences)&&void 0!==t?t:ve("userPreferences",(function(){return hf.value})),setUserPreferences:null!==(n=r.setUserPreferences)&&void 0!==n?n:vf}}var xf=n(548);function kf(e,t){return Le(e===t.util.type,'Shape type "'.concat(e,'" does not match util type "').concat(t.util.type,'"')),Ce({type:e},t)}var Sf={wheel:"onWheel",pointer_enter:"onPointerEnter",pointer_leave:"onPointerLeave",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"},_f=function(){function e(t,n){var r=this;j(this,e),D(this,"path",void 0),D(this,"id",void 0),D(this,"current",void 0),D(this,"type",void 0),D(this,"shapeType",void 0),D(this,"initial",void 0),D(this,"children",void 0),D(this,"parent",void 0),D(this,"isActive",!1),D(this,"onWheel",void 0),D(this,"onPointerEnter",void 0),D(this,"onPointerLeave",void 0),D(this,"onPointerDown",void 0),D(this,"onPointerMove",void 0),D(this,"onPointerUp",void 0),D(this,"onDoubleClick",void 0),D(this,"onTripleClick",void 0),D(this,"onQuadrupleClick",void 0),D(this,"onRightClick",void 0),D(this,"onMiddleClick",void 0),D(this,"onKeyDown",void 0),D(this,"onKeyUp",void 0),D(this,"onKeyRepeat",void 0),D(this,"onCancel",void 0),D(this,"onComplete",void 0),D(this,"onInterrupt",void 0),D(this,"onEnter",void 0),D(this,"onExit",void 0),this.editor=t;var i=this.constructor,o=i.id,a=i.children,s=i.initial;this.id=o,this.current=ue("toolState"+this.id,void 0),this.path=ve("toolPath"+this.id,(function(){var e=r.current.value;return r.id+(e?".".concat(e.path.value):"")})),this.parent=null!==n&&void 0!==n?n:{},this.parent?a&&s?(this.type="branch",this.initial=s,this.children=Object.fromEntries(a().map((function(e){return[e.id,new e(r.editor,r)]}))),this.current.set(this.children[this.initial])):this.type="leaf":(this.type="root",a&&s&&(this.initial=s,this.children=Object.fromEntries(a().map((function(e){return[e.id,new e(r.editor,r)]}))),this.current.set(this.children[this.initial])))}return z(e,[{key:"transition",value:function(e,t){for(var n=e.split("."),r=this,i=0;i<n.length;i++){var o,a=n[i],s=r.current.value,u=null===(o=r.children)||void 0===o?void 0:o[a];if(!u)throw Error("".concat(r.id," - no child state exists with the id ").concat(a,"."));if((null===s||void 0===s?void 0:s.id)!==u.id&&(null===s||void 0===s||s.exit(t,a),r.current.set(u),u.enter(t,(null===s||void 0===s?void 0:s.id)||"initial"),!u.isActive))break;r=u}return this}},{key:"handleEvent",value:function(e){var t,n=Sf[e.name],r=this.current.value;null===(t=this[n])||void 0===t||t.call(this,e),this.current.value===r&&this.isActive&&(null===r||void 0===r||r.handleEvent(e))}},{key:"enter",value:function(e,t){var n;if(this.isActive=!0,null===(n=this.onEnter)||void 0===n||n.call(this,e,t),this.children&&this.initial&&this.isActive){var r=this.children[this.initial];this.current.set(r),r.enter(e,t)}}},{key:"exit",value:function(e,t){var n,r;(this.isActive=!1,null===(n=this.onExit)||void 0===n||n.call(this,e,t),this.isActive)||(null===(r=this.current.value)||void 0===r||r.exit(e,t))}}]),e}();D(_f,"id",void 0),D(_f,"initial",void 0),D(_f,"children",void 0);var Pf=["children","className"];function Ef(e){var t=e.children,n=e.className,r=void 0===n?"":n,i=gt(e,Pf);return(0,La.jsx)("svg",Ce(Ce({},i),{},{className:"tl-svg-container ".concat(r),children:t}))}function Cf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.closed,i=void 0!==r&&r,o=n.snap,a=void 0===o?1:o,s=n.start,u=void 0===s?"outset":s,l=n.end,c=void 0===l?"outset":l,d=n.lengthRatio,f=void 0===d?2:d,p=n.style,h=void 0===p?"dashed":p,v=0,g=0,m=1,y=0,b=0;switch(h){case"dashed":m=1,v=Math.min(t*f,e/4);break;case"dotted":v=t/(m=100);break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return i||("outset"===u?(e+=v/2,b+=v/2):"skip"===u&&(e-=v,b-=v),"outset"===c?e+=v/2:"skip"===c&&(e-=v)),g=Math.floor(e/v/(2*m)),(g-=g%a)<3&&"dashed"===h?e/t<5?(v=e,g=1,y=0):(v=.333*e,y=.333*e):(v=e/(g=Math.max(g,3))/(2*m),i?(b=v/2,y=(e-g*v)/g):y=(e-g*v)/Math.max(1,g-1)),{strokeDasharray:[v,y].join(" "),strokeDashoffset:b.toString()}}function If(){return Ji(Ka())}var Tf=t.memo((function(e){var t=e.d,n=e.color,r=e.fill,i=If();switch(r){case"none":return(0,La.jsx)("path",{className:"tl-hitarea-stroke",fill:"none",d:t});case"solid":return(0,La.jsx)("path",{className:"tl-hitarea-fill-solid",fill:i[n].semi,d:t});case"semi":return(0,La.jsx)("path",{className:"tl-hitarea-fill-solid",fill:i.solid,d:t});case"pattern":return(0,La.jsx)(Mf,{color:n,fill:r,d:t})}})),Mf=function(e){var t=e.d,n=e.color,r=Ka(),i=If(),o=_e("zoomLevel",(function(){return r.zoomLevel}),[r]),a=_e("isDarkMode",(function(){return r.isDarkMode}),[r]),s=Math.ceil(o),u=r.zoomLevel<=.18;return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("path",{className:"tl-hitarea-fill-solid",fill:i[n].pattern,d:t}),(0,La.jsx)("path",{fill:u?i[n].semi:"url(#".concat(Ou[s+(a?"_dark":"_light")],")"),d:t})]})};function jf(e){var t=e.d,n=e.color,r=e.fill,i=e.theme;if("none"!==r){if("pattern"===r){var o=document.createElementNS("http://www.w3.org/2000/svg","g"),a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",t),a.setAttribute("fill",i[n].pattern);var s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",t),s.setAttribute("fill","url(#hash_pattern)"),o.appendChild(a),o.appendChild(s),o}var u=document.createElementNS("http://www.w3.org/2000/svg","path");switch(u.setAttribute("d",t),r){case"semi":u.setAttribute("fill",i.solid);break;case"solid":u.setAttribute("fill",i[n].semi)}return u}}function Af(e,t){if(t){var n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.appendChild(t),n.appendChild(e),n}return e}function Of(e,t,n){var r,i="end"===t?e.end.point:e.start.point,o="end"===t?e.start.point:e.end.point,a=e.isStraight?Ya.Dist(o,i):Math.abs(e.bodyArc.length),s=Math.max(Math.min(a/5,3*n),n);if(e.isStraight)r=Ya.Nudge(i,o,s);else{var u=function(e,t,n,r){var i=n.x-e.x,o=n.y-e.y,a=Math.sqrt(i*i+o*o),s=(a*a-r*r+t*t)/(2*a),u=Math.sqrt(t*t-s*s);return i/=a,o/=a,[new Ya(e.x+i*s-o*u,e.y+o*s+i*u),new Ya(e.x+i*s+o*u,e.y+o*s-i*u)]}(i,s,e.handleArc.center,e.handleArc.radius);r="end"===t?e.handleArc.sweepFlag?u[0]:u[1]:e.handleArc.sweepFlag?u[1]:u[0]}return{point:i,int:r}}function Lf(e,t,n){var r="end"===t?e.end.arrowhead:e.start.arrowhead;if("none"!==r){var i=Of(e,t,n);if(i){switch(r){case"bar":return function(e){var t=e.int,n=e.point,r=Ya.Sub(t,n).div(2),i=Ya.Add(n,Ya.Rot(r,$a)),o=Ya.Sub(n,Ya.Rot(r,$a));return"M ".concat(i.x," ").concat(i.y," L ").concat(o.x," ").concat(o.y)}(i);case"square":return function(e){var t=e.int,n=e.point,r=Ya.Lrp(n,t,.85),i=Ya.Sub(r,n).div(2),o=Ya.Add(n,Ya.Rot(i,$a)),a=Ya.Sub(n,Ya.Rot(i,$a)),s=Ya.Add(r,Ya.Rot(i,$a)),u=Ya.Sub(r,Ya.Rot(i,$a));return"M ".concat(o.x," ").concat(o.y," L ").concat(s.x," ").concat(s.y," L ").concat(u.x," ").concat(u.y," L ").concat(a.x," ").concat(a.y," Z")}(i);case"diamond":return function(e){var t=e.point,n=e.int,r=Ya.Lrp(t,n,.75),i=Ya.RotWith(r,t,qa/4),o=Ya.RotWith(r,t,-qa/4),a=Ya.Lrp(i,o,.5);return a.add(Ya.Sub(a,t)),"M ".concat(a.x," ").concat(a.y," L ").concat(i.x," ").concat(i.y," ").concat(t.x," ").concat(t.y," L ").concat(o.x," ").concat(o.y," Z")}(i);case"dot":return function(e){var t=e.point,n=e.int,r=Ya.Lrp(t,n,.45),i=Ya.Dist(r,t);return"M ".concat(r.x-i,",").concat(r.y,"\n  a ").concat(i,",").concat(i," 0 1,0 ").concat(2*i,",0\n  a ").concat(i,",").concat(i," 0 1,0 -").concat(2*i,",0 ")}(i);case"inverted":return function(e){var t=e.point,n=e.int,r=Ya.Sub(n,t).div(2),i=Ya.Add(t,Ya.Rot(r,$a)),o=Ya.Sub(t,Ya.Rot(r,$a));return"M ".concat(i.x," ").concat(i.y," L ").concat(n.x," ").concat(n.y," L ").concat(o.x," ").concat(o.y," Z")}(i);case"arrow":return function(e){var t=e.point,n=e.int,r=Ya.RotWith(n,t,qa/6),i=Ya.RotWith(n,t,-qa/6);return"M ".concat(r.x," ").concat(r.y," L ").concat(t.x," ").concat(t.y," L ").concat(i.x," ").concat(i.y)}(i);case"triangle":return function(e){var t=e.point,n=e.int,r=Ya.RotWith(n,t,qa/6),i=Ya.RotWith(n,t,-qa/6);return"M ".concat(r.x," ").concat(r.y," L ").concat(t.x," ").concat(t.y," L ").concat(i.x," ").concat(i.y," Z")}(i)}return""}}}function zf(e){return Math.abs(e.props.bend)<8}function Df(e,t){if("point"!==t.type){var n=e.getShapeById(t.boundShapeId),r=e.getShapeUtil(n);return{shape:n,transform:e.getPageTransform(n),isClosed:r.isClosed(n),isExact:t.isExact,didIntersect:!1,outline:e.getOutline(n)}}}function Nf(e,t,n){if("point"===n.type)return Ya.From(n);var r=e.getShapeById(n.boundShapeId);if(r){var i=e.getBounds(r),o=i.point,a=i.size,s=Ya.Add(o,Ya.MulV(n.normalizedAnchor,a)),u=Cs.applyToPoint(e.getPageTransform(r),s);return Cs.applyToPoint(Cs.Inverse(t),u)}return new Ya(0,0)}function Rf(e,t){var n=e.getPageTransform(t);return{start:Nf(e,n,t.props.start),end:Nf(e,n,t.props.end)}}var Bf=48,Ff=10;function Uf(e,t){var n=t.props,r=n.start,i=n.end,o=n.arrowheadStart,a=n.arrowheadEnd,s=Rf(e,t),u=s.start.clone(),l=s.end.clone(),c=Ya.Med(u,l),d=Ya.Sub(l,u).uni(),f=Df(e,r),p=Df(e,i),h=e.getPageTransform(t);Kf(l,s.start,h,p),Kf(u,s.end,h,f);var v=Bf,g=f&&p&&f.shape===p.shape;!f||!p||g||f.isExact||p.isExact||(p.didIntersect&&!f.didIntersect?f.isClosed&&u.setTo(Ya.Nudge(l,u,v)):p.didIntersect||p.isClosed&&l.setTo(Ya.Nudge(u,l,v)));var m=Ya.Sub(l,u).uni(),y=!Ya.Equals(m,d);if(!g){if(f&&"none"!==o&&!f.isExact){var b=Ff+Xc[t.props.size]/2+("size"in f.shape.props?Xc[f.shape.props.size]/2:0);v-=b,u.nudge(l,b*(y?-1:1))}if(p&&"none"!==a&&!p.isExact){var w=Ff+Xc[t.props.size]/2+("size"in p.shape.props?Xc[p.shape.props.size]/2:0);v-=w,l.nudge(u,w*(y?-1:1))}}f&&p&&(y?l.setTo(Ya.Add(u,m.mul(-v))):Ya.Dist(u,l)<Bf/2&&l.setTo(Ya.Add(u,m.mul(Bf/2)))),y?c.setTo(Ya.Med(s.start,s.end)):c.setTo(Ya.Med(u,l));var x=Ya.Dist(u,l);return{isStraight:!0,start:{handle:s.start,point:u,arrowhead:t.props.arrowheadStart},end:{handle:s.end,point:l,arrowhead:t.props.arrowheadEnd},middle:c,isValid:x>0,length:x}}function Kf(e,t,n,r){if(void 0!==r&&!r.isExact){var i,o,a=Cs.applyToPoint(n,t),s=Cs.applyToPoint(n,e),u=Cs.applyToPoint(Cs.Inverse(r.transform),a),l=Cs.applyToPoint(Cs.Inverse(r.transform),s),c=r.isClosed,d=(c?Fs:Bs)(u,l,r.outline);if(null!==d)i=null!==(o=d.sort((function(e,t){return Ya.Dist(e,u)-Ya.Dist(t,u)}))[0])&&void 0!==o?o:c?void 0:l;if(void 0!==i){var f=Cs.applyToPoint(r.transform,i),p=Cs.applyToPoint(Cs.Inverse(n),f);e.setTo(p),r.didIntersect=!0}}}function Vf(e){return Hf(e.start.handle,e.end.handle)}function Wf(e){return Hf(e.start.point,e.end.point)}function Hf(e,t){return"M".concat(e.x,",").concat(e.y,"L").concat(t.x,",").concat(t.y)}function Yf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t.props,i=r.arrowheadEnd,o=r.arrowheadStart,a=t.props.bend+n;if(Math.abs(a)>Math.abs(10*t.props.bend))return Uf(e,t);var s=Rf(e,t),u=Ya.Med(s.start,s.end),l=Ya.Sub(s.end,s.start).uni(),c=Ya.Add(u,l.per().mul(-a)),d=Df(e,t.props.start),f=Df(e,t.props.end),p=s.start.clone(),h=s.end.clone(),v=c.clone(),g=$f(p,h,v);if(0===g.length||0===g.size||!bs(g.length)||!bs(g.size))return Uf(e,t);var m=e.getPageTransform(t);if(d&&!d.isExact){var y,b=Cs.applyToPoint(m,p),w=Cs.applyToPoint(m,h),x=Cs.applyToPoint(m,g.center),k=Cs.Inverse(d.transform),S=Cs.applyToPoint(k,b),_=Cs.applyToPoint(k,w),P=Cs.applyToPoint(k,x),E=d.isClosed,C=(E?Us:Ks)(P,g.radius,e.getOutline(d.shape));if(C){var I;C=C.filter((function(e){return+Ya.Clockwise(S,e,_)===g.sweepFlag}));var T=os(Ya.Angle(g.center,c),Ya.Angle(g.center,s.start),.5);C.sort((function(e,t){return Math.abs(is(T,P.angle(e)))-Math.abs(is(T,P.angle(t)))})),y=null!==(I=C[0])&&void 0!==I?I:E?void 0:S}else y=E?void 0:S;if(y&&(p.setTo(e.getPointInShapeSpace(t,Cs.applyToPoint(d.transform,y))),d.didIntersect=!0,"none"!==o)){var M=Ff+Xc[t.props.size]/2+("size"in d.shape.props?Xc[d.shape.props.size]/2:0);p.setTo(ds(g.center.x,g.center.y,g.radius,os(Ya.Angle(g.center,p),Ya.Angle(g.center,c),M/Math.abs(cs(g.center,g.radius,p,c)))))}}if(f&&!f.isExact){var j,A,O=Cs.applyToPoint(m,p),L=Cs.applyToPoint(m,h),z=Cs.applyToPoint(m,g.center),D=Cs.Inverse(f.transform),N=Cs.applyToPoint(D,O),R=Cs.applyToPoint(D,L),B=Cs.applyToPoint(D,z),F=f.isClosed,U=F?Us:Ks,K=os(Ya.Angle(g.center,c),Ya.Angle(g.center,s.end),.5),V=U(B,g.radius,e.getOutline(f.shape));if(V)(V=V.filter((function(e){return+Ya.Clockwise(N,e,R)===g.sweepFlag}))).sort((function(e,t){return Math.abs(is(K,B.angle(e)))-Math.abs(is(K,B.angle(t)))})),j=null!==(A=V[0])&&void 0!==A?A:F?void 0:R;else j=F?void 0:R;if(j&&(h.setTo(e.getPointInShapeSpace(t,Cs.applyToPoint(f.transform,j))),f.didIntersect=!0,"none"!==i)){var W=Ff+Xc[t.props.size]/2+("size"in f.shape.props?Xc[f.shape.props.size]/2:0);Ya.Dist(p,h)<Bf&&(W*=-2),h.setTo(ds(g.center.x,g.center.y,g.radius,os(Ya.Angle(g.center,h),Ya.Angle(g.center,c),W/Math.abs(cs(g.center,g.radius,h,c)))))}}if(Math.abs(cs(g.center,g.radius,p,h))<Bf/2&&(p.setTo(s.start),h.setTo(s.end)),d&&f&&d.shape!==f.shape&&!d.isExact&&!f.isExact){var H=Ya.Angle(g.center,p),Y=Ya.Angle(g.center,h),X=g.sweepFlag?Bf:-Bf,q=cs(g.center,g.radius,h,p),$=g.center,G=$.x,Q=$.y,Z=g.radius;d&&!d.didIntersect&&p.setTo(ds(G,Q,Z,os(H,Y,X/q))),f&&!f.didIntersect&&h.setTo(ds(G,Q,Z,os(H,Y,-X/q)))}var J=os(Ya.Angle(g.center,p),Ya.Angle(g.center,h),.5),ee=ds(g.center.x,g.center.y,g.radius,J);+Ya.Clockwise(p,ee,h)!==g.sweepFlag&&(J+=qa,ee=ds(g.center.x,g.center.y,g.radius,J)),v.setTo(ee);var te=$f(p,h,v);return{isStraight:!1,start:{point:p,handle:s.start,arrowhead:t.props.arrowheadStart},end:{point:h,handle:s.end,arrowhead:t.props.arrowheadEnd},middle:v,handleArc:g,bodyArc:te,isValid:0!==te.length&&isFinite(te.center.x)&&isFinite(te.center.y)}}function Xf(e){var t=e.start,n=e.end,r=e.handleArc,i=r.radius,o=r.largeArcFlag,a=r.sweepFlag;return"M".concat(t.handle.x,",").concat(t.handle.y," A").concat(i," ").concat(i," 0 ").concat(o," ").concat(a," ").concat(n.handle.x,",").concat(n.handle.y)}function qf(e){var t=e.start,n=e.end,r=e.bodyArc,i=r.radius,o=r.largeArcFlag,a=r.sweepFlag;return"M".concat(t.point.x,",").concat(t.point.y," A").concat(i," ").concat(i," 0 ").concat(o," ").concat(a," ").concat(n.point.x,",").concat(n.point.y)}function $f(e,t,n){var r=-2*(e.x*(t.y-n.y)-e.y*(t.x-n.x)+t.x*n.y-n.x*t.y),i={x:((e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-e.y))/r,y:((e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x)+(n.x*n.x+n.y*n.y)*(e.x-t.x))/r},o=Ya.Dist(i,e),a=+Ya.Clockwise(e,n,t),s=Math.hypot(e.y-t.y,e.x-t.x),u=Math.hypot(t.y-n.y,t.x-n.x),l=Math.hypot(n.y-e.y,n.x-e.x),c=2*Math.acos((u*u+l*l-s*s)/(2*u*l)),d=(Ga-c)*(a?1:-1);return{center:i,radius:o,size:d,length:d*o,largeArcFlag:+(qa>c),sweepFlag:a}}var Gf=t.memo((function(e){var t=e.id,n=e.text,r=e.size,i=e.font,o=e.position,a=e.width,s=e.labelColor,u=dd(t,"arrow",n),l=u.rInput,c=u.isEditing,d=u.handleFocus,f=u.handleBlur,p=u.handleKeyDown,h=u.handleChange,v=u.isEmpty;return!c&&v?null:(0,La.jsx)("div",{className:"tl-arrow-label","data-font":i,"data-align":"center","data-hastext":!v,"data-isediting":c,style:{textAlign:"center",fontSize:Gc[r],lineHeight:Gc[r]*Yc.lineHeight+"px",transform:"translate(".concat(o.x,"px, ").concat(o.y,"px)"),color:s},children:(0,La.jsxs)("div",{className:"tl-arrow-label__inner",children:[(0,La.jsx)("p",{style:{width:a||"9px"},children:n?ld.normalizeTextForDom(n):" "}),c&&(0,La.jsx)("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:d,onChange:h,onKeyDown:p,onBlur:f,onContextMenu:fu})]})})})),Qf=Object.defineProperty,Zf=Object.getOwnPropertyDescriptor,Jf=function(e,t,n,r){for(var i,o=r>1?void 0:r?Zf(t,n):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r?i(t,n,o):i(o))||o);return r&&o&&Qf(t,n,o),o},ep=0,tp=function(e){Et(r,e);var n=Tt(r);function r(){var e;j(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return D(_t(e=n.call.apply(n,[this].concat(i))),"canEdit",(function(){return!0})),D(_t(e),"canBind",(function(){return!1})),D(_t(e),"isClosed",(function(){return!1})),D(_t(e),"canSnap",(function(){return!0})),D(_t(e),"hideResizeHandles",(function(){return!0})),D(_t(e),"hideRotateHandle",(function(){return!0})),D(_t(e),"hideSelectionBoundsFg",(function(){return!0})),D(_t(e),"hideSelectionBoundsBg",(function(){return!0})),D(_t(e),"onHandleChange",(function(t,n){var r=n.handle,i=n.isPrecise,o=We(t);switch(r.id){case"start":case"end":var a=e.editor.getPageTransformById(o.id),s=Cs.applyToPoint(a,r);if(e.editor.inputs.ctrlKey)o.props[r.id]={type:"point",x:r.x,y:r.y};else{var u=Me(e.editor.sortedShapesArray.filter((function(n){if(n.id!==t.id){var r=e.editor.getShapeUtil(n);if(r.canBind(n)){var i=e.editor.getPageMaskById(n.id);if(!i||gs(s,i)){var o=e.editor.getPointInShapeSpace(n,s);return r.isClosed(n)?gs(o,e.editor.getOutline(n)):r.hitTestPoint(n,o)}}}})));if(u){var l=e.editor.getBounds(u),c=e.editor.getPointInShapeSpace(u,s),d=o.props[r.id],f="binding"===t.props.start.type&&t.props.start.boundShapeId,p="binding"===t.props.end.type&&t.props.end.boundShapeId,h=i||(f||p)&&f===p||!e.editor.getShapeUtil(u).isClosed(o);("point"===d.type||"binding"===d.type&&u.id!==d.boundShapeId)&&(h=e.editor.inputs.pointerVelocity.len()<.5),h&&(h=Ya.Dist(c,l.center)>Math.max(4,Math.min(.15*Math.min(l.width,l.height),16))/e.editor.zoomLevel),o.props[r.id]={type:"binding",boundShapeId:u.id,normalizedAnchor:h?{x:(c.x-l.minX)/l.width,y:(c.y-l.minY)/l.height}:{x:.5,y:.5},isExact:e.editor.inputs.altKey}}else o.props[r.id]={type:"point",x:r.x,y:r.y}}break;case"middle":var v=Rf(e.editor,o),g=v.start,m=v.end,y=Ya.Sub(m,g),b=Ya.Per(y),w=Ya.Med(m,g),x=Ya.Sub(w,b),k=Ya.Add(w,b),S=Ya.NearestPointOnLineSegment(x,k,r,!1),_=Ya.Dist(S,w);Ya.Clockwise(S,m,w)&&(_*=-1),o.props.bend=_}return o})),D(_t(e),"onTranslateStart",(function(t){var n="binding"===t.props.start.type?t.props.start.boundShapeId:null,r="binding"===t.props.end.type?t.props.end.boundShapeId:null;if(!(n&&e.editor.isWithinSelection(n)||r&&e.editor.isWithinSelection(r))){n=null,r=null;var i=Rf(e.editor,t),o=i.start,a=i.end;return{id:t.id,type:t.type,props:Ce(Ce({},t.props),{},{start:{type:"point",x:o.x,y:o.y},end:{type:"point",x:a.x,y:a.y}})}}})),D(_t(e),"onResize",(function(t,n){var r=n.scaleX,i=n.scaleY,o=Rf(e.editor,t),a=We(t.props),s=a.start,u=a.end,l=t.props.bend;"point"===s.type&&(s.x=o.start.x*r,s.y=o.start.y*i),"point"===u.type&&(u.x=o.end.x*r,u.y=o.end.y*i);var c=Math.abs(r),d=Math.abs(i);return r<0&&i>=0?(0!==l&&(l*=-1,l*=Math.max(c,d)),"binding"===s.type&&(s.normalizedAnchor.x=1-s.normalizedAnchor.x),"binding"===u.type&&(u.normalizedAnchor.x=1-u.normalizedAnchor.x)):r>=0&&i<0?(0!==l&&(l*=-1,l*=Math.max(c,d)),"binding"===s.type&&(s.normalizedAnchor.y=1-s.normalizedAnchor.y),"binding"===u.type&&(u.normalizedAnchor.y=1-u.normalizedAnchor.y)):r>=0&&i>=0?0!==l&&(l*=Math.max(c,d)):r<0&&i<0&&(0!==l&&(l*=Math.max(c,d)),"binding"===s.type&&(s.normalizedAnchor.x=1-s.normalizedAnchor.x,s.normalizedAnchor.y=1-s.normalizedAnchor.y),"binding"===u.type&&(u.normalizedAnchor.x=1-u.normalizedAnchor.x,u.normalizedAnchor.y=1-u.normalizedAnchor.y)),{props:{start:s,end:u,bend:l}}})),D(_t(e),"onDoubleClickHandle",(function(e,t){switch(t.id){case"start":return{id:e.id,type:e.type,props:Ce(Ce({},e.props),{},{arrowheadStart:"none"===e.props.arrowheadStart?"arrow":"none"})};case"end":return{id:e.id,type:e.type,props:Ce(Ce({},e.props),{},{arrowheadEnd:"none"===e.props.arrowheadEnd?"arrow":"none"})}}})),D(_t(e),"onEditEnd",(function(t){var n=t.id,r=t.type,i=t.props.text;i.trimEnd()!==t.props.text&&e.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])})),e}return z(r,[{key:"getDefaultProps",value:function(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:0,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"getBounds",value:function(e){return ws.FromPoints(this.getOutlineWithoutLabel(e))}},{key:"getOutlineWithoutLabel",value:function(e){var t=this.getArrowInfo(e);if(!t)return[];if(t.isStraight)return t.isValid?[Ya.From(t.start.point),Ya.From(t.end.point)]:[new Ya(0,0),new Ya(1,1)];if(!t.isValid)return[new Ya(0,0),new Ya(1,1)];var n=Math.max(5,Math.ceil(Math.abs(t.bodyArc.length)/16));if(n<=0&&!isFinite(n))return[new Ya(0,0),new Ya(1,1)];for(var r=Array(n),i=Ya.Angle(t.bodyArc.center,t.start.point),o=Ya.Angle(t.bodyArc.center,t.end.point),a=t.bodyArc.sweepFlag?o:i,s=t.bodyArc.sweepFlag?i:o,u=t.bodyArc.largeArcFlag?-(Ga-is(a,s)):is(a,s),l=Math.max(1,t.bodyArc.radius),c=0;c<n;c++){var d=a+u*(c/(n-1)),f=ds(t.bodyArc.center.x,t.bodyArc.center.y,l,d);r[c]=f}return r}},{key:"getOutline",value:function(e){var t=this.getOutlineWithoutLabel(e),n=this.getLabelBounds(e);if(!n)return t;for(var r=n.sides,i=[0,1,2,3],o=t[0],a=!1,s=[o],u=function(){var e=t[l];if(!a){var n=je(i.filter((function(t){return Ws(r[t][0],r[t][1],o,e)})),(function(e){return Ya.DistanceToLineSegment(r[e][0],r[e][1],o)}));if(void 0!==n){var u=Ya.NearestPointOnLineSegment(r[n][0],r[n][1],o);s.push(u);for(var c=0;c<4;c++){var d=(n+c)%4;s.push(r[d][1])}s.push(u),a=!0}}s.push(e),o=e},l=1;l<t.length;l++)u();return s}},{key:"snapPoints",value:function(e){return V}},{key:"infoCache",get:function(){var e=this;return this.editor.store.createComputedCache("arrow infoCache",(function(t){return zf(t)?Uf(e.editor,t):Yf(e.editor,t)}))}},{key:"getArrowInfo",value:function(e){return this.infoCache.get(e.id)}},{key:"getHandles",value:function(e){var t=this.infoCache.get(e.id);return[{id:"start",type:"vertex",index:"a0",x:t.start.handle.x,y:t.start.handle.y,canBind:!0},{id:"middle",type:"vertex",index:"a2",x:t.middle.x,y:t.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:t.end.handle.x,y:t.end.handle.y,canBind:!0}]}},{key:"hitTestPoint",value:function(e,t){for(var n=this.editor.getOutline(e),r=this.editor.zoomLevel,i=Xc[e.props.size]/r,o=0;o<n.length-1;o++){var a=n[o],s=n[o+1];if(Ya.DistanceToLineSegment(a,s,t)<i)return!0}return!1}},{key:"hitTestLineSegment",value:function(e,t,n){for(var r=this.editor.getOutline(e),i=0;i<r.length-1;i++){if(Ws(t,n,r[i],r[i+1]))return!0}return!1}},{key:"component",value:function(e){var n,r=this,i=If(),o=this.editor.onlySelectedShape,a=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.isReadOnly,s=this.getArrowInfo(e),u=this.editor.getBounds(e),l=this.getLabelBounds(e),c=t.useMemo((function(){return r.editor.isSafari?ep+=1:0}),[e]);if(null===s||void 0===s||!s.isValid)return null;var d=Xc[e.props.size],f=s.start.arrowhead&&Lf(s,"start",d),p=s.end.arrowhead&&Lf(s,"end",d),h=s.isStraight?Wf(s):qf(s),v=null;if(o===e&&a){var g=Cf(s.isStraight?Ya.Dist(s.start.handle,s.end.handle):Math.abs(s.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5}),m=g.strokeDasharray,y=g.strokeDashoffset;v="binding"===e.props.start.type||"binding"===e.props.end.type?(0,La.jsx)("path",{className:"tl-arrow-hint",d:s.isStraight?Vf(s):Xf(s),strokeDasharray:m,strokeDashoffset:y,strokeWidth:2,markerStart:"binding"===e.props.start.type?e.props.start.isExact?"":ip(e.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:"binding"===e.props.end.type?e.props.end.isExact?"":ip(e.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}var b=Cf(s.isStraight?s.length:Math.abs(s.bodyArc.length),d,{style:e.props.dash}),w=b.strokeDasharray,x=b.strokeDashoffset,k=!("none"===s.start.arrowhead||"arrow"===s.start.arrowhead),S=!("none"===s.end.arrowhead||"arrow"===s.end.arrowhead),_=k||S||l,P=(e.id+"_clip_"+c).replace(":","_");return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)(Ef,{id:e.id,style:{minWidth:50,minHeight:50},children:[_&&(0,La.jsx)("defs",{children:(0,La.jsxs)("mask",{id:P,children:[(0,La.jsx)("rect",{x:ms(-100+u.minX),y:ms(-100+u.minY),width:ms(u.width+200),height:ms(u.height+200),fill:"white"}),l&&(0,La.jsx)("rect",{x:ms(l.x),y:ms(l.y),width:ms(l.w),height:ms(l.h),fill:"black",rx:4,ry:4}),f&&k&&(0,La.jsx)("path",{d:f,fill:"arrow"===s.start.arrowhead?"none":"black",stroke:"none"}),p&&S&&(0,La.jsx)("path",{d:p,fill:"arrow"===s.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,La.jsxs)("g",{fill:"none",stroke:i[e.props.color].solid,strokeWidth:d,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[v,(0,La.jsxs)("g",Ce(Ce({},_?{mask:"url(#".concat(P,")")}:void 0),{},{children:[_&&(0,La.jsx)("rect",{x:ms(u.minX-100),y:ms(u.minY-100),width:ms(u.width+200),height:ms(u.height+200),opacity:0}),(0,La.jsx)("path",{d:h,strokeDasharray:w,strokeDashoffset:x})]})),f&&k&&"none"!==e.props.fill&&(0,La.jsx)(Tf,{d:f,color:e.props.color,fill:e.props.fill}),p&&S&&"none"!==e.props.fill&&(0,La.jsx)(Tf,{d:p,color:e.props.color,fill:e.props.fill}),f&&(0,La.jsx)("path",{d:f}),p&&(0,La.jsx)("path",{d:p})]}),(0,La.jsx)("path",{d:h,className:"tl-hitarea-stroke"})]}),(0,La.jsx)(Gf,{id:e.id,text:e.props.text,font:e.props.font,size:e.props.size,position:s.middle,width:null!==(n=null===l||void 0===l?void 0:l.w)&&void 0!==n?n:0,labelColor:e.props.labelColor})]})}},{key:"indicator",value:function(e){var t=Rf(this.editor,e),n=t.start,r=t.end,i=this.getArrowInfo(e),o=this.editor.getBounds(e),a=this.getLabelBounds(e);if(!i)return null;if(Ya.Equals(n,r))return null;var s=Xc[e.props.size],u=i.start.arrowhead&&Lf(i,"start",s),l=i.end.arrowhead&&Lf(i,"end",s),c=i.isStraight?Wf(i):qf(i),d=u&&"arrow"!==i.start.arrowhead||l&&"arrow"!==i.end.arrowhead||null!==a,f=(e.id+"_clip").replace(":","_");return(0,La.jsxs)("g",{children:[d&&(0,La.jsx)("defs",{children:(0,La.jsxs)("mask",{id:f,children:[(0,La.jsx)("rect",{x:o.minX-100,y:o.minY-100,width:o.w+200,height:o.h+200,fill:"white"}),a&&(0,La.jsx)("rect",{x:a.x,y:a.y,width:a.w,height:a.h,fill:"black",rx:4,ry:4}),u&&(0,La.jsx)("path",{d:u,fill:"arrow"===i.start.arrowhead?"none":"black",stroke:"none"}),l&&(0,La.jsx)("path",{d:l,fill:"arrow"===i.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,La.jsxs)("g",Ce(Ce({},d?{mask:"url(#".concat(f,")")}:void 0),{},{children:[d&&(0,La.jsx)("rect",{x:o.minX-100,y:o.minY-100,width:o.width+200,height:o.height+200,opacity:0}),(0,La.jsx)("path",{d:c})]})),u&&(0,La.jsx)("path",{d:u}),l&&(0,La.jsx)("path",{d:l}),a&&(0,La.jsx)("rect",{x:a.x,y:a.y,width:a.w,height:a.h,rx:4,ry:4})]})}},{key:"labelBoundsCache",get:function(){var e=this;return this.editor.store.createComputedCache("labelBoundsCache",(function(t){var n=e.getArrowInfo(t),r=e.editor.getBounds(t),i=t.props,o=i.text,a=i.font,s=i.size;if(!n)return null;if(!o.trim())return null;var u=e.editor.textMeasure.measureText(o,Ce(Ce({},Yc),{},{fontFamily:Qc[a],fontSize:Gc[s],width:"fit-content"})),l=u.w,c=l,d=u.h;if(r.width>r.height){c=Math.max(Math.min(l,64),Math.min(r.width-64,l));var f=e.editor.textMeasure.measureText(o,Ce(Ce({},Yc),{},{fontFamily:Qc[a],fontSize:Gc[s],width:c+"px"}));c=f.w,d=f.h}if(c>16*Gc[s]){c=16*Gc[s];var p=e.editor.textMeasure.measureText(o,Ce(Ce({},Yc),{},{fontFamily:Qc[a],fontSize:Gc[s],width:c+"px"}));c=p.w,d=p.h}return new ws(n.middle.x-(c+8)/2,n.middle.y-(d+8)/2,c+8,d+8)}))}},{key:"getLabelBounds",value:function(e){return this.labelBoundsCache.get(e.id)||null}},{key:"toSvg",value:function(e,t){var n=Ji(this.editor);t.addExportDef(ed(e.props.fill,n));var r=n[e.props.color].solid,i=this.getArrowInfo(e),o=Xc[e.props.size],a=document.createElementNS("http://www.w3.org/2000/svg","g");if(!i)return a;var s=i.start.arrowhead&&Lf(i,"start",o),u=i.end.arrowhead&&Lf(i,"end",o),l=this.editor.getBounds(e),c=this.getLabelBounds(e),d=(e.id+"_clip").replace(":","_");if(s||u||c){var f=document.createElementNS("http://www.w3.org/2000/svg","defs"),p=document.createElementNS("http://www.w3.org/2000/svg","mask");p.id=d;var h=document.createElementNS("http://www.w3.org/2000/svg","rect");if(h.setAttribute("x",l.minX-100+""),h.setAttribute("y",l.minY-100+""),h.setAttribute("width",l.width+200+""),h.setAttribute("height",l.height+200+""),h.setAttribute("fill","white"),p.appendChild(h),s&&p.appendChild(np(s,i.start.arrowhead)),u&&p.appendChild(np(u,i.end.arrowhead)),c){var v=document.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("x",c.x+""),v.setAttribute("y",c.y+""),v.setAttribute("width",c.w+""),v.setAttribute("height",c.h+""),v.setAttribute("fill","black"),p.appendChild(v)}f.appendChild(p),a.appendChild(f)}var g=document.createElementNS("http://www.w3.org/2000/svg","g");g.setAttribute("mask","url(#".concat(d,")")),a.appendChild(g);var m=document.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("x","-100"),m.setAttribute("y","-100"),m.setAttribute("width",l.width+200+""),m.setAttribute("height",l.height+200+""),m.setAttribute("fill","transparent"),m.setAttribute("stroke","none"),g.appendChild(m);var y=function(e,t,n){var r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",e),r.setAttribute("fill","none"),r.setAttribute("stroke",t),r.setAttribute("stroke-width",n+""),r}(i.isStraight?Wf(i):qf(i),r,o),b=Cf(i.isStraight?i.length:Math.abs(i.bodyArc.length),o,{style:e.props.dash}),w=b.strokeDasharray,x=b.strokeDashoffset;if(y.setAttribute("stroke-dasharray",w),y.setAttribute("stroke-dashoffset",x),g.appendChild(y),s&&a.appendChild(rp(s,e.props.color,o,"arrow"===e.props.arrowheadStart?"none":e.props.fill,n)),u&&a.appendChild(rp(u,e.props.color,o,"arrow"===e.props.arrowheadEnd?"none":e.props.fill,n)),c){t.addExportDef(Zc(e.props.font));var k={fontSize:Gc[e.props.size],lineHeight:Yc.lineHeight,fontFamily:lo[e.props.font],padding:0,textAlign:"middle",width:c.w-8,verticalTextAlign:"middle",height:c.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},S=Hc(this.editor,this.editor.textMeasure.measureTextSpans(e.props.text,k),k);S.setAttribute("fill",n[e.props.labelColor].solid),Array.from(S.children).forEach((function(e){var t=parseFloat(e.getAttribute("x")||"0"),n=parseFloat(e.getAttribute("y")||"0");e.setAttribute("x",t+4+c.x+"px"),e.setAttribute("y",n+c.y+"px")}));var _=S.cloneNode(!0);_.setAttribute("stroke-width","2"),_.setAttribute("fill",n.background),_.setAttribute("stroke",n.background),a.appendChild(_),a.appendChild(S)}return a}},{key:"getCanvasSvgDefs",value:function(){return[td()]}}]),r}(Rc);function np(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n.setAttribute("fill","arrow"===t?"none":"black"),n.setAttribute("stroke","none"),n}function rp(e,t,n,r,i){var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d",e),o.setAttribute("fill","none"),o.setAttribute("stroke",i[t].solid),o.setAttribute("stroke-width",n+"");var a=jf({d:e,fill:r,color:t,theme:i});if(a){var s=document.createElementNS("http://www.w3.org/2000/svg","g");return s.appendChild(a),s.appendChild(o),s}return o}function ip(e){return.5!==e.x||.5!==e.y}D(tp,"type","arrow"),Jf([ve],tp.prototype,"infoCache",1),Jf([ve],tp.prototype,"labelBoundsCache",1);var op=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),D(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),D(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return z(n)}(_f);D(op,"id","idle");var ap=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shape",void 0),D(_t(e),"preciseTimeout",-1),D(_t(e),"didTimeout",!1),D(_t(e),"onEnter",(function(){var t=e.editor.inputs.currentPagePoint;e.didTimeout=!1,e.editor.mark("creating");var n=Vi();e.editor.createShapes([{id:n,type:"arrow",x:t.x,y:t.y}]);var r=e.editor.getShapeUtil(tp),i=e.editor.getShapeById(n);if(i){var o=e.editor.getHandles(i);if(o){var a,s=e.editor.getPointInShapeSpace(i,t),u=null===(a=r.onHandleChange)||void 0===a?void 0:a.call(r,i,{handle:Ce(Ce({},o[0]),{},{x:s.x,y:s.y}),isPrecise:!0});if(u){var l,c=null===(l=u.props)||void 0===l?void 0:l.start;"binding"===(null===c||void 0===c?void 0:c.type)&&e.editor.setHintingIds([c.boundShapeId]),e.editor.updateShapes([u],!0)}}e.editor.select(n),e.shape=e.editor.getShapeById(n),e.startPreciseTimeout()}})),D(_t(e),"onExit",(function(){e.clearPreciseTimeout()})),D(_t(e),"onPointerMove",(function(){if(e.shape&&e.editor.inputs.isDragging){var t=e.editor.getHandles(e.shape);if(!t)throw e.editor.bailToMark("creating"),Error("No handles found");if(!e.didTimeout){var n=e.editor.getShapeUtil(tp),r=e.editor.getShapeById(e.shape.id);if(!r)return;if(t){var i,o=e.editor.getPointInShapeSpace(r,e.editor.inputs.originPagePoint),a=o.x,s=o.y,u=null===(i=n.onHandleChange)||void 0===i?void 0:i.call(n,r,{handle:Ce(Ce({},t[0]),{},{x:a,y:s}),isPrecise:!1});u&&e.editor.updateShapes([u],!0)}}e.editor.setSelectedTool("select.dragging_handle",{shape:e.shape,handle:t.find((function(e){return"end"===e.id})),isCreating:!0,onInteractionEnd:"arrow"})}})),D(_t(e),"onPointerUp",(function(){e.cancel()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.cancel()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"startPreciseTimeout",value:function(){var e=this;this.preciseTimeout=window.setTimeout((function(){e.isActive&&e.shape&&(e.didTimeout=!0)}),300)}},{key:"clearPreciseTimeout",value:function(){clearTimeout(this.preciseTimeout)}},{key:"cancel",value:function(){this.editor.bailToMark("creating"),this.editor.setHintingIds([]),this.parent.transition("idle",{})}}]),n}(_f);D(ap,"id","pointing");var sp=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",tp),e}return z(n)}(_f);D(sp,"id","arrow"),D(sp,"initial","idle"),D(sp,"children",(function(){return[op,ap]}));var up=kf("arrow",{util:tp,props:mo,migrations:bo,tool:sp}),lp="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function cp(e){var t=e.url,n=e.zoomLevel;return(0,La.jsx)("a",{className:Fa("tl-hyperlink-button",{"tl-hyperlink-button__hidden":n<.32}),href:t,target:"_blank",rel:"noopener noreferrer",onPointerDown:fu,onPointerUp:fu,title:t,draggable:!1,children:(0,La.jsx)("div",{className:"tl-hyperlink-button__icon",style:{mask:'url("'.concat(lp,'") center 100% / 100% no-repeat'),WebkitMask:'url("'.concat(lp,'") center 100% / 100% no-repeat')}})})}var dp=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"canResize",(function(){return!1})),D(_t(e),"hideSelectionBoundsBg",(function(){return!0})),D(_t(e),"hideSelectionBoundsFg",(function(){return!0})),D(_t(e),"onBeforeCreate",(function(t){pp(e.editor,t)})),D(_t(e),"onBeforeUpdate",(function(t,n){if(t.props.url!==n.props.url){if(!rf(n.props.url))return Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{url:t.props.url})});pp(e.editor,n)}})),e}return z(n,[{key:"getDefaultProps",value:function(){return{url:"",w:300,h:320,assetId:null}}},{key:"component",value:function(e){var t=e.props.assetId?this.editor.getAssetById(e.props.assetId):null,n=this.editor.getPageRotation(e),r=fp(e);return(0,La.jsx)(Ac,{children:(0,La.jsxs)("div",{className:"tl-bookmark__container tl-hitarea-stroke",style:{boxShadow:lu(n)},children:[(0,La.jsxs)("div",{className:"tl-bookmark__image_container",children:[null!==t&&void 0!==t&&t.props.image?(0,La.jsx)("img",{className:"tl-bookmark__image",draggable:!1,src:null===t||void 0===t?void 0:t.props.image,alt:(null===t||void 0===t?void 0:t.props.title)||""}):(0,La.jsx)("div",{className:"tl-bookmark__placeholder"}),(0,La.jsx)(cp,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]}),(0,La.jsxs)("div",{className:"tl-bookmark__copy_container",children:[(null===t||void 0===t?void 0:t.props.title)&&(0,La.jsx)("h2",{className:"tl-bookmark__heading",children:du((null===t||void 0===t?void 0:t.props.title)||"",54)}),(null===t||void 0===t?void 0:t.props.description)&&(0,La.jsx)("p",{className:"tl-bookmark__description",children:du((null===t||void 0===t?void 0:t.props.description)||"",128)}),(0,La.jsx)("a",{className:"tl-bookmark__link",href:e.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:fu,onPointerUp:fu,onClick:fu,children:du(r,45)})]})]})})}},{key:"indicator",value:function(e){return(0,La.jsx)("rect",{width:ms(e.props.w),height:ms(e.props.h),rx:"8",ry:"8"})}}]),n}(Fc);D(dp,"type","bookmark");var fp=function(e){try{var t=new URL(e.props.url),n=t.pathname.replace(/\/*$/,"");return"".concat(t.hostname).concat(n)}catch(ok){return e.props.url}};function pp(e,t){var n=t.props.url,r=Mi.createId(Be(n));e.getAssetById(r)?t.props.assetId!==r&&e.updateShapes([{id:t.id,type:t.type,props:{assetId:r}}]):(e.updateShapes([{id:t.id,type:t.type,props:{assetId:null}}]),hp(e,t))}var hp=De(function(){var e=Ba(Na().mark((function e(t,n){var r,i;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props.url,e.next=3,t.externalContentManager.createAssetFromUrl(t,r);case 3:if(i=e.sent){e.next=6;break}return e.abrupt("return");case 6:t.batch((function(){t.createAssets([i]),t.updateShapes([{id:n.id,type:n.type,props:{assetId:i.id}}])}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),500),vp=kf("bookmark",{util:dp,props:xo,migrations:So});function gp(){var e=Ka();return _e("zoom",(function(){return e.zoomLevel<.35}),[e])}var mp=function(e){return.65*e+.35*Za(e*qa/2)},yp=function(e){return{size:1+e,thinning:0,streamline:.62+(1+e)/8*.06,smoothing:.62,simulatePressure:!1,easing:Ha.linear}};function bp(e){var t=e.strokeWidth,n=e.showAsComplete,r=e.isPen;return{size:1+t,thinning:.1,streamline:.5,smoothing:.5,simulatePressure:!r,easing:r?mp:Ha.easeOutSine,last:n}}function wp(e,t,n,r){return Ce(Ce({},r?yp(t):"draw"===e.dash?e.isPen?function(e){return{size:1+1.2*e,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:mp}}(t):function(e){return{size:1+e,thinning:.5,streamline:.62+(1+e)/8*.06,smoothing:.62,easing:Ha.easeOutSine,simulatePressure:!0}}(t):yp(t)),{},{last:e.isComplete||n})}function xp(e){var t,n=[],r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if("free"===i.type||i.points.length<2)n.push.apply(n,d(i.points.map(Ya.Cast)));else{var o=Math.max(4,Math.floor(Ya.Dist(i.points[0],i.points[1])/16));n.push.apply(n,d(Ya.PointsBetween(i.points[0],i.points[1],o)))}}}catch(a){r.e(a)}finally{r.f()}return n}function kp(e,t){return{draw:"none",solid:"none",dotted:"0.1 ".concat(2*t),dashed:"".concat(2*t," ").concat(2*t)}[e.props.dash]}var Sp=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"hideResizeHandles",(function(e){return Pp(e)})),D(_t(e),"hideRotateHandle",(function(e){return Pp(e)})),D(_t(e),"hideSelectionBoundsBg",(function(e){return Pp(e)})),D(_t(e),"hideSelectionBoundsFg",(function(e){return Pp(e)})),D(_t(e),"isClosed",(function(e){return e.props.isClosed})),D(_t(e),"onResize",(function(e,t){var n,r=t.scaleX,i=t.scaleY,o=[],a=J(e.props.segments);try{for(a.s();!(n=a.n()).done;){var s=n.value;o.push(Ce(Ce({},s),{},{points:s.points.map((function(e){var t=e.x,n=e.y,o=e.z;return{x:ys(r*t),y:ys(i*n),z:o}}))}))}}catch(u){a.e(u)}finally{a.f()}return{props:{segments:o}}})),e}return z(n,[{key:"getDefaultProps",value:function(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}},{key:"getBounds",value:function(e){return ws.FromPoints(this.editor.getOutline(e))}},{key:"getOutline",value:function(e){return xp(e.props.segments)}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"hitTestPoint",value:function(e,t){var n=this.editor.getOutline(e),r=this.editor.zoomLevel,i=Xc[e.props.size]/r;if(1===e.props.segments.length&&e.props.segments[0].points.length<4&&e.props.segments[0].points.some((function(e){return Ya.Dist(t,e)<1.5*i})))return!0;if(this.isClosed(e))return gs(t,n);if(this.editor.getBounds(e).containsPoint(t))for(var o=0;o<n.length;o++){var a=n[o],s=n[(o+1)%n.length];if(Ya.DistanceToLineSegment(a,s,t)<i)return!0}return!1}},{key:"hitTestLineSegment",value:function(e,t,n){var r=this.editor.getOutline(e);if(1===e.props.segments.length&&e.props.segments[0].points.length<4){var i=this.editor.zoomLevel,o=Xc[e.props.size]/i;if(e.props.segments[0].points.some((function(e){return Ya.DistanceToLineSegment(t,n,e)<1.5*o})))return!0}if(this.isClosed(e))for(var a=0;a<r.length;a++){var s=r[a],u=r[(a+1)%r.length];if(Ws(t,n,s,u))return!0}else for(var l=0;l<r.length-1;l++){var c=r[l],d=r[l+1];if(Ws(t,n,c,d))return!0}return!1}},{key:"component",value:function(e){var t,n=If(),r=gp(),i=Xc[e.props.size],o=xp(e.props.segments),a=e.props.isComplete||"straight"===(null===(t=Me(e.props.segments))||void 0===t?void 0:t.type),s=i;r||e.props.isPen||"draw"!==e.props.dash||1!==o.length||(s+=Fe(e.id)()*(i/6));var u=wp(e.props,s,a,r),l=Os(o,u),c=l.length>1?mu(l,e.props.isClosed):_p(o[0],s);if(!r&&"draw"===e.props.dash||l.length<2){Ds(l,u);var d=Ms(l,u);return(0,La.jsxs)(Ef,{id:e.id,children:[(0,La.jsx)(Tf,{fill:e.props.isClosed?e.props.fill:"none",color:e.props.color,d:c}),(0,La.jsx)("path",{d:gu(d,!0),strokeLinecap:"round",fill:n[e.props.color].solid})]})}return(0,La.jsxs)(Ef,{id:e.id,children:[(0,La.jsx)(Tf,{color:e.props.color,fill:e.props.isClosed?e.props.fill:"none",d:c}),(0,La.jsx)("path",{d:c,strokeLinecap:"round",fill:"none",stroke:n[e.props.color].solid,strokeWidth:i,strokeDasharray:kp(e,i),strokeDashoffset:"0"})]})}},{key:"indicator",value:function(e){var t,n=gp(),r=Xc[e.props.size],i=xp(e.props.segments),o=r;n||e.props.isPen||"draw"!==e.props.dash||1!==i.length||(o+=Fe(e.id)()*(r/6));var a=e.props.isComplete||"straight"===(null===(t=Me(e.props.segments))||void 0===t?void 0:t.type),s=Os(i,wp(e.props,o,a,!0)),u=s.length>1?mu(s,e.props.isClosed):_p(i[0],o);return(0,La.jsx)("path",{d:u})}},{key:"toSvg",value:function(e,t){var n,r=Ji(this.editor);t.addExportDef(ed(e.props.fill,r));var i=e.props.color,o=Xc[e.props.size],a=xp(e.props.segments),s=e.props.isComplete||"straight"===(null===(n=Me(e.props.segments))||void 0===n?void 0:n.type),u=o;e.props.isPen||"draw"!==e.props.dash||1!==a.length||(u+=Fe(e.id)()*(o/6));var l,c=wp(e.props,u,s,!1),d=Os(a,c),f=d.length>1?mu(d,e.props.isClosed):_p(a[0],u);if("draw"===e.props.dash||d.length<2){Ds(d,c);var p=Ms(d,c),h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",gu(p,!0)),h.setAttribute("fill",r[i].solid),h.setAttribute("stroke-linecap","round"),l=h}else{var v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d",f),v.setAttribute("stroke",r[i].solid),v.setAttribute("fill","none"),v.setAttribute("stroke-linecap","round"),v.setAttribute("stroke-width",o.toString()),v.setAttribute("stroke-dasharray",kp(e,o)),v.setAttribute("stroke-dashoffset","0"),l=v}var g=jf({fill:e.props.isClosed?e.props.fill:"none",d:f,color:e.props.color,theme:r});if(g){var m=document.createElementNS("http://www.w3.org/2000/svg","g");return m.appendChild(g),m.appendChild(l),m}return l}},{key:"getCanvasSvgDefs",value:function(){return[td()]}},{key:"expandSelectionOutlinePx",value:function(e){var t="draw"===e.props.dash?1.6:1;return Xc[e.props.size]*t/2}}]),n}(Rc);function _p(e,t){var n=.5*(t+1);return"M ".concat(e.x," ").concat(e.y," m -").concat(n,", 0 a ").concat(n,",").concat(n," 0 1,0 ").concat(2*n,",0 a ").concat(n,",").concat(n," 0 1,0 -").concat(2*n,",0")}function Pp(e){return 1===e.props.segments.length&&e.props.segments[0].points.length<2}D(Sp,"type","draw");var Ep=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"hideResizeHandles",(function(e){return jp(e)})),D(_t(e),"hideRotateHandle",(function(e){return jp(e)})),D(_t(e),"hideSelectionBoundsBg",(function(e){return jp(e)})),D(_t(e),"hideSelectionBoundsFg",(function(e){return jp(e)})),D(_t(e),"onResize",(function(e,t){var n,r=t.scaleX,i=t.scaleY,o=[],a=J(e.props.segments);try{for(a.s();!(n=a.n()).done;){var s=n.value;o.push(Ce(Ce({},s),{},{points:s.points.map((function(e){var t=e.x,n=e.y,o=e.z;return{x:r*t,y:i*n,z:o}}))}))}}catch(u){a.e(u)}finally{a.f()}return{props:{segments:o}}})),e}return z(n,[{key:"getDefaultProps",value:function(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}},{key:"getBounds",value:function(e){return ws.FromPoints(this.editor.getOutline(e))}},{key:"getOutline",value:function(e){return xp(e.props.segments)}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"hitTestPoint",value:function(e,t){var n=this.editor.getOutline(e),r=this.editor.zoomLevel,i=Mp(e)/r;if(1===e.props.segments.length&&e.props.segments[0].points.length<4&&e.props.segments[0].points.some((function(e){return Ya.Dist(t,e)<1.5*i})))return!0;if(this.editor.getBounds(e).containsPoint(t))for(var o=0;o<n.length;o++){var a=n[o],s=n[(o+1)%n.length];if(Ya.DistanceToLineSegment(a,s,t)<i)return!0}return!1}},{key:"hitTestLineSegment",value:function(e,t,n){var r=this.editor.getOutline(e);if(1===e.props.segments.length&&e.props.segments[0].points.length<4){var i=this.editor.zoomLevel,o=Mp(e)/i;if(e.props.segments[0].points.some((function(e){return Ya.DistanceToLineSegment(t,n,e)<1.5*o})))return!0}for(var a=0;a<r.length-1;a++){var s=r[a],u=r[a+1];if(Ws(t,n,s,u))return!0}return!1}},{key:"component",value:function(e){return(0,La.jsx)(Ip,{strokeWidth:Mp(e),shape:e,opacity:.35})}},{key:"backgroundComponent",value:function(e){return(0,La.jsx)(Ip,{strokeWidth:Mp(e),shape:e,opacity:.82})}},{key:"indicator",value:function(e){var t,n=gp(),r=Mp(e),i=xp(e.props.segments),o=r;n||e.props.isPen||1!==i.length||(o+=Fe(e.id)()*(r/6));var a,s=Os(i,bp({strokeWidth:r,showAsComplete:e.props.isComplete||"straight"===(null===(t=Me(e.props.segments))||void 0===t?void 0:t.type),isPen:e.props.isPen}));return a=s.length<2?function(e,t){var n=t/2;return"M ".concat(e.x," ").concat(e.y," m -").concat(n,", 0 a ").concat(n,",").concat(n," 0 1,0 ").concat(2*n,",0 a ").concat(n,",").concat(n," 0 1,0 -").concat(2*n,",0")}(i[0],o):mu(s,!1),(0,La.jsx)("path",{d:a})}},{key:"expandSelectionOutlinePx",value:function(e){return Mp(e)/2}},{key:"toSvg",value:function(e){var t=Ji(this.editor);return Tp(Mp(e),e,.35,t)}},{key:"toBackgroundSvg",value:function(e){var t=Ji(this.editor);return Tp(Mp(e),e,.82,t)}}]),n}(Rc);function Cp(e,t,n){var r,i=xp(e.props.segments),o=e.props.isComplete||"straight"===(null===(r=Me(e.props.segments))||void 0===r?void 0:r.type),a=t;n||e.props.isPen||1!==i.length||(a+=Fe(e.id)()*(t/6));var s=Os(i,bp({strokeWidth:a,showAsComplete:o,isPen:e.props.isPen})),u=s.length>1?mu(s,!1):function(e){var t=.1;return"M ".concat(e.x," ").concat(e.y," m -").concat(t,", 0 a ").concat(t,",").concat(t," 0 1,0 ").concat(.2,",0 a ").concat(t,",").concat(t," 0 1,0 -").concat(.2,",0")}(i[0]);return{solidStrokePath:u,sw:a}}function Ip(e){var n=e.strokeWidth,r=e.shape,i=e.opacity,o=If(),a=Cp(r,n,gp()),s=a.solidStrokePath,u=a.sw,c=function(){var e=l((0,t.useState)(!1),2),n=e[0],r=e[1];return(0,t.useEffect)((function(){var e=CSS.supports("color","color(display-p3 1 1 1)"),t=matchMedia("(color-gamut: p3)");r(e&&t.matches);var n=function(){return r(e&&t.matches)};return t.addEventListener("change",n),function(){return t.removeEventListener("change",n)}}),[]),_e(Zs.forceSrgb)||!n?"srgb":"p3"}(),d=o[r.props.color].highlight[c];return(0,La.jsx)(Ef,{id:r.id,style:{opacity:i},children:(0,La.jsx)("path",{d:s,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:d,strokeWidth:u})})}function Tp(e,t,n,r){var i=Cp(t,e,!1),o=i.solidStrokePath,a=i.sw,s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",o),s.setAttribute("fill","none"),s.setAttribute("stroke",r[t.props.color].highlight.srgb),s.setAttribute("stroke-width","".concat(a)),s.setAttribute("opacity","".concat(n)),s}function Mp(e){return 1.12*qc[e.props.size]}function jp(e){return 1===e.props.segments.length&&e.props.segments[0].points.length<2}D(Ep,"type","highlight");var Ap=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"initialShape",void 0),D(_t(e),"shapeType","highlight"===e.parent.id?Ep:Sp),D(_t(e),"util",e.editor.getShapeUtil(e.shapeType)),D(_t(e),"isPen",!1),D(_t(e),"segmentMode","free"),D(_t(e),"didJustShiftClickToExtendPreviousShapeLine",!1),D(_t(e),"pagePointWhereCurrentSegmentChanged",{}),D(_t(e),"pagePointWhereNextSegmentChanged",null),D(_t(e),"lastRecordedPoint",{}),D(_t(e),"mergeNextPoint",!1),D(_t(e),"currentLineLength",0),D(_t(e),"canDraw",!1),D(_t(e),"onEnter",(function(t){e.info=t,e.canDraw=!e.editor.isMenuOpen,e.lastRecordedPoint=e.editor.inputs.currentPagePoint.clone(),e.canDraw&&e.startShape()})),D(_t(e),"onPointerMove",(function(){var t=_t(e).editor.inputs;e.isPen!==t.isPen&&e.cancel(),!e.canDraw&&t.isDragging&&(e.startShape(),e.canDraw=!0),e.canDraw&&(t.isPen?Ya.Dist(t.currentPagePoint,e.lastRecordedPoint)>=1/e.editor.zoomLevel?(e.lastRecordedPoint=t.currentPagePoint.clone(),e.mergeNextPoint=!1):e.mergeNextPoint=!0:e.mergeNextPoint=!1,e.updateShapes())})),D(_t(e),"onKeyDown",(function(t){if("Shift"===t.key)switch(e.segmentMode){case"free":e.segmentMode="starting_straight",e.pagePointWhereNextSegmentChanged=e.editor.inputs.currentPagePoint.clone();break;case"starting_free":e.segmentMode="starting_straight"}e.updateShapes()})),D(_t(e),"onKeyUp",(function(t){if("Shift"===t.key)switch(e.editor.snaps.clear(),e.segmentMode){case"straight":e.segmentMode="starting_free",e.pagePointWhereNextSegmentChanged=e.editor.inputs.currentPagePoint.clone();break;case"starting_straight":e.pagePointWhereNextSegmentChanged=null,e.segmentMode="free"}e.updateShapes()})),D(_t(e),"onExit",(function(){e.editor.snaps.clear(),e.pagePointWhereCurrentSegmentChanged=e.editor.inputs.currentPagePoint.clone()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onInterrupt",(function(){e.editor.inputs.isDragging||(e.editor.bail(),e.cancel())})),e}return z(n,[{key:"canClose",value:function(){return"highlight"!==this.shapeType.type}},{key:"getIsClosed",value:function(e,t){if(!this.canClose())return!1;var n=Xc[t],r=e[0].points[0],i=e[e.length-1],o=i.points[i.points.length-1];return r!==o&&this.currentLineLength>4*n&&Ya.Dist(r,o)<2*n}},{key:"startShape",value:function(){var e=this.editor.inputs,t=e.originPagePoint,n=e.isPen;this.editor.mark("draw create start"),this.isPen=n;var r=this.isPen?1.25*this.info.point.z:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=t.clone(),this.initialShape){var i=this.editor.getShapeById(this.initialShape.id);if(i&&"straight"===this.segmentMode){this.didJustShiftClickToExtendPreviousShapeLine=!0;var o=Me(i.props.segments);if(!o)throw Error("Expected a previous segment!");var a=Me(o.points);if(!a)throw Error("Expected a previous point!");var s=this.editor.getPointInShapeSpace(i,t).toFixed(),u=s.x,l=s.y,c=this.isPen?1.25*this.info.point.z:.5,f={type:this.segmentMode,points:[{x:a.x,y:a.y,z:+c.toFixed(2)},{x:u,y:l,z:+c.toFixed(2)}]},p=Cs.applyToPoint(this.editor.getPageTransformById(i.id),a);this.pagePointWhereCurrentSegmentChanged=p,this.pagePointWhereNextSegmentChanged=null;var h=[].concat(d(i.props.segments),[f]);this.currentLineLength=this.getLineLength(h);var v={id:i.id,type:this.shapeType.type,props:{segments:h}};return this.canClose()&&(v.props.isClosed=this.getIsClosed(h,i.props.size)),void this.editor.updateShapes([v])}}this.pagePointWhereCurrentSegmentChanged=t.clone();var g=Vi();this.editor.createShapes([{id:g,type:this.shapeType.type,x:t.x,y:t.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+r.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShapeById(g)}},{key:"updateShapes",value:function(){var e=this.editor.inputs,t=this.initialShape;if(t){var n=t.id,r=t.props.size,i=this.editor.getShapeById(n);if(i){var o=i.props.segments,a=this.editor.getPointInShapeSpace(i,e.currentPagePoint).toFixed(),s=a.x,u=a.y,l=a.z,c={x:s,y:u,z:this.isPen?+(1.25*l).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":var f=this.pagePointWhereNextSegmentChanged;if(null===f)throw Error("We should have a point where the segment changed");if(Ya.Dist(f,e.currentPagePoint)>4){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";var p=Me(o);if(!p)throw Error("Expected a previous segment!");var h,v=Me(p.points);if(!v)throw Error("Expected a previous last point!");var g=this.editor.getPointInShapeSpace(i,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if("straight"===p.type){this.currentLineLength+=Ya.Dist(v,g),h={type:"straight",points:[Ce({},v),g]};var m=this.editor.getPageTransform(i);this.pagePointWhereCurrentSegmentChanged=Cs.applyToPoint(m,v)}else h={type:"straight",points:[g,c]};var y={id:n,type:this.shapeType.type,props:{segments:[].concat(d(o),[h])}};this.canClose()&&(y.props.isClosed=this.getIsClosed(o,r)),this.editor.updateShapes([y],!0)}break;case"starting_free":var b=this.pagePointWhereNextSegmentChanged;if(null===b)throw Error("We should have a point where the segment changed");if(Ya.Dist(b,e.currentPagePoint)>4){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";var w=o.slice(),x=Me(w[w.length-1].points);if(!x)throw Error("No previous point!");var k={type:"free",points:d(Ya.PointsBetween(x,c,6).map((function(e){return e.toFixed().toJson()})))},S=[].concat(d(w),[k]);this.currentLineLength=this.getLineLength(S);var _={id:n,type:this.shapeType.type,props:{segments:S}};this.canClose()&&(_.props.isClosed=this.getIsClosed(S,r)),this.editor.updateShapes([_],!0)}break;case"straight":var P,E=o.slice(),C=E[E.length-1],I=this.pagePointWhereCurrentSegmentChanged,T=this.editor.inputs,M=T.currentPagePoint,j=T.ctrlKey;if(!I)throw Error("We should have a point where the segment changed");var A=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(A=!j,this.didJustShiftClickToExtendPreviousShapeLine=!1):A=!j;var O=this.editor.getPointInShapeSpace(i,M).toFixed().toJson(),L=!1,z=void 0;if((this.editor.isSnapMode?!j:j)&&E.length>2){for(var D=void 0,N=8/this.editor.zoomLevel,R=0,B=o.length-2;R<B;R++){var F=o[R];if(!F)break;if("free"!==F.type){var U=F.points[0],K=Me(F.points);if(U&&K){var V=Ya.NearestPointOnLineSegment(U,K,O),W=Ya.Dist(V,O);if(W<N){D=V.toFixed().toJson(),N=W,z=F;break}}}}D&&(L=!0,O=D)}if(L&&z){var H=this.editor.getPageTransform(i),Y=z.points[0],X=Me(z.points);if(!X)throw Error("Expected a last point!");var q=Cs.applyToPoint(H,Y),$=Cs.applyToPoint(H,X),G=Cs.applyToPoint(H,O);this.editor.snaps.setLines([{id:ef(),type:"points",points:[q,G,$]}])}else{if(this.editor.snaps.clear(),A){var Q=Ya.Angle(I,M),Z=us(Q,24)-Q;P=Ya.RotWith(M,I,Z)}else P=M;O=this.editor.getPointInShapeSpace(i,P).toFixed().toJson()}this.currentLineLength+=Ya.Dist(C.points[0],O),E[E.length-1]=Ce(Ce({},C),{},{type:"straight",points:[C.points[0],O]});var J={id:n,type:this.shapeType.type,props:{segments:E}};this.canClose()&&(J.props.isClosed=this.getIsClosed(o,r)),this.editor.updateShapes([J],!0);break;case"free":var ee=o.slice(),te=ee[ee.length-1],ne=d(te.points);if(ne.length&&this.mergeNextPoint){var re=ne[ne.length-1].z;ne[ne.length-1]={x:c.x,y:c.y,z:re?Math.max(re,c.z):c.z}}else this.currentLineLength+=Ya.Dist(ne[ne.length-1],c),ne.push(c);ee[ee.length-1]=Ce(Ce({},te),{},{points:ne}),this.currentLineLength=this.getLineLength(ee);var ie={id:n,type:this.shapeType.type,props:{segments:ee}};if(this.canClose()&&(ie.props.isClosed=this.getIsClosed(ee,r)),this.editor.updateShapes([ie],!0),ne.length>500){this.editor.updateShapes([{id:n,type:this.shapeType.type,props:{isComplete:!0}}]);var oe=this.editor.inputs.currentPagePoint,ae=Vi();this.editor.createShapes([{id:ae,type:this.shapeType.type,x:ys(oe.x),y:ys(oe.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(1.25*l).toFixed():.5}]}]}}]),this.initialShape=it(this.editor.getShapeById(ae)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}}}}}},{key:"getLineLength",value:function(e){var t,n=0,r=J(e);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,o=0;o<i.points.length-1;o++){var a=i.points[o],s=i.points[o+1];n+=Ya.Sub(s,a).len2()}}catch(u){r.e(u)}finally{r.f()}return Math.sqrt(n)}},{key:"complete",value:function(){if(this.canDraw){var e=this.initialShape;e&&(this.editor.updateShapes([{id:e.id,type:e.type,props:{isComplete:!0}}]),this.parent.transition("idle",{}))}else this.cancel()}},{key:"cancel",value:function(){this.parent.transition("idle",this.info)}}]),n}(_f);D(Ap,"id","drawing");var Op=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("drawing",t)})),D(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),D(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return z(n)}(_f);D(Op,"id","idle");var Lp=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Sp),D(_t(e),"onExit",(function(){e.children.drawing.initialShape=void 0})),e}return z(n)}(_f);D(Lp,"id","draw"),D(Lp,"initial","idle"),D(Lp,"children",(function(){return[Op,Ap]}));var zp=kf("draw",{util:Sp,props:Eo,migrations:Io,tool:Lp}),Dp=kf("embed",{util:Uc,props:No,migrations:Uo}),Np=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),D(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),D(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return z(n)}(_f);D(Np,"id","idle");var Rp=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"markId","creating"),D(_t(e),"wasFocusedOnEnter",!1),D(_t(e),"onEnter",(function(){var t=e.editor.isMenuOpen;e.wasFocusedOnEnter=!t})),D(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){var n=e.editor.inputs.originPagePoint,r=e.parent.shapeType.type,i=Vi();e.editor.mark(e.markId),e.editor.createShapes([{id:i,type:r,x:n.x,y:n.y,props:{w:1,h:1}}],!0),e.editor.setSelectedTool("select.resizing",Ce(Ce({},t),{},{target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:e.parent.id}))}})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"complete",value:function(){var e=this.editor.inputs.originPagePoint;if(this.wasFocusedOnEnter){this.editor.mark(this.markId);var t=this.parent.shapeType.type,n=Vi();this.editor.mark(this.markId),this.editor.createShapes([{id:n,type:t,x:e.x,y:e.y}]);var r=this.editor.getShapeById(n),i=this.editor.getShapeUtil(r).getDefaultProps(),o=i.w,a=i.h,s=this.editor.getDeltaInParentSpace(r,new Ya(o/2,a/2));this.editor.updateShapes([{id:n,type:t,x:r.x-s.x,y:r.y-s.y}]),this.editor.setSelectedIds([n]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select.idle")}}},{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(_f);D(Rp,"id","pointing");var Bp=function(e){Et(n,e);var t=Tt(n);function n(){return j(this,n),t.apply(this,arguments)}return z(n)}(_f);function Fp(e){var t=e.bounds,n=e.zoomLevel,r=e.className;return(0,La.jsx)("g",{className:r,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:t.sides.map((function(e,t){var r=Cf(e[0].dist(e[1]),1/n,{style:"dashed",lengthRatio:4}),i=r.strokeDasharray,o=r.strokeDashoffset;return(0,La.jsx)("line",{x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,strokeDasharray:i,strokeDashoffset:o},t)}))})}D(Bp,"id","box"),D(Bp,"initial","idle"),D(Bp,"children",(function(){return[Np,Rp]}));var Up=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"type","group"),D(_t(e),"hideSelectionBoundsBg",(function(){return!1})),D(_t(e),"hideSelectionBoundsFg",(function(){return!0})),D(_t(e),"canBind",(function(){return!1})),D(_t(e),"onChildrenChange",(function(t){var n=e.editor.getSortedChildIds(t.id);return 0===n.length?(e.editor.pageState.focusLayerId===t.id&&e.editor.popFocusLayer(),void e.editor.deleteShapes([t.id])):1===n.length?(e.editor.pageState.focusLayerId===t.id&&e.editor.popFocusLayer(),e.editor.reparentShapesById(n,t.parentId),void e.editor.deleteShapes([t.id])):void 0})),e}return z(n,[{key:"getDefaultProps",value:function(){return{}}},{key:"getBounds",value:function(e){var t=this,n=this.editor.getSortedChildIds(e.id);if(0===n.length)return new ws;var r=n.flatMap((function(e){var n=t.editor.getShapeById(e);return t.editor.getOutlineById(e).map((function(e){return Cs.applyToPoint(t.editor.getTransform(n),e)}))}));return ws.FromPoints(r)}},{key:"getCenter",value:function(e){return this.editor.getBounds(e).center}},{key:"getOutline",value:function(e){return this.editor.getBounds(e).corners}},{key:"component",value:function(e){var t=this,r=this.editor,i=r.erasingIdsSet,o=r.pageState,a=o.hintingIds,s=o.focusLayerId,u=r.zoomLevel,l=i.has(e.id),c=a.length>0&&a.some((function(r){return r!==e.id&&t.editor.isShapeOfType(t.editor.getShapeById(r),n)}));if(!l&&(e.id!==s||c))return null;var d=this.editor.getBounds(e);return(0,La.jsx)(Ef,{id:e.id,children:(0,La.jsx)(Fp,{className:"tl-group",bounds:d,zoomLevel:u})})}},{key:"indicator",value:function(e){var t=this.editor.camera.z,n=this.editor.getBounds(e);return(0,La.jsx)(Fp,{className:"",bounds:n,zoomLevel:t})}}]),n}(Rc);D(Up,"type","group");var Kp=(0,t.forwardRef)((function(e,n){var r=e.id,i=e.name,o=e.isEditing,a=Ka(),s=(0,t.useCallback)((function(e){"Enter"===e.key&&(e.stopPropagation(),e.currentTarget.blur(),a.setEditingId(null))}),[a]),u=(0,t.useCallback)((function(e){var t=a.getShapeById(r);if(t){var n=t.props.name,i=e.currentTarget.value.trim();n!==i&&a.updateShapes([{id:r,type:"frame",props:{name:i}}],!0)}}),[r,a]),l=(0,t.useCallback)((function(e){var t=a.getShapeById(r);if(t){var n=t.props.name,i=e.currentTarget.value;n!==i&&a.updateShapes([{id:r,type:"frame",props:{name:i}}],!0)}}),[r,a]);return(0,La.jsxs)("div",{className:"tl-frame-label ".concat(o?"tl-frame-label__editing":""),children:[(0,La.jsx)("input",{className:"tl-frame-name-input",ref:n,style:{display:o?void 0:"none"},value:i,autoFocus:!0,onKeyDown:s,onBlur:u,onChange:l}),Wc(i,"Frame")+String.fromCharCode(8203)]})})),Vp=function(e){var n=e.id,r=e.name,i=e.width,o=e.height,a=rs(Ka().getPageRotationById(n)),s=Oc(n),u=(0,t.useRef)(null);(0,t.useEffect)((function(){var e=u.current;e&&s&&(e.focus(),e.select(),requestAnimationFrame((function(){document.activeElement!==e&&(e.focus(),e.select())})))}),[u,s]);var l,c=((a+Math.PI/4)*(2/Math.PI)+4)%4,d=["top","left","bottom","right"][Math.floor(c)];switch(d){case"top":l="";break;case"right":l="translate(".concat(ms(i),"px, 0px) rotate(90deg)");break;case"bottom":l="translate(".concat(ms(i),"px, ").concat(ms(o),"px) rotate(180deg)");break;case"left":l="translate(0px, ".concat(ms(o),"px) rotate(270deg)")}return(0,La.jsx)("div",{className:"tl-frame-heading",style:{overflow:s?"visible":"hidden",maxWidth:"calc(var(--tl-zoom) * ".concat("top"===d||"bottom"===d?Math.ceil(i):Math.ceil(o),"px + var(--space-5))"),bottom:Math.ceil(o),transform:"".concat(l," scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))")},children:(0,La.jsx)("div",{className:"tl-frame-heading-hit-area",children:(0,La.jsx)(Kp,{ref:u,id:n,name:r,isEditing:s})})})},Wp=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"canBind",(function(){return!0})),D(_t(e),"canEdit",(function(){return!0})),D(_t(e),"canReceiveNewChildrenOfType",(function(e,t){return!e.isLocked})),D(_t(e),"canDropShapes",(function(e,t){return!e.isLocked})),D(_t(e),"onDragShapesOver",(function(t,n){return n.every((function(e){return e.parentId===t.id}))?{shouldHint:!1}:(e.editor.reparentShapesById(n.map((function(e){return e.id})),t.id),{shouldHint:!0})})),D(_t(e),"onDragShapesOut",(function(t,n){var r=e.editor.getShapeById(t.parentId);r&&e.editor.isShapeOfType(r,Up)?e.editor.reparentShapesById(n.map((function(e){return e.id})),r.id):e.editor.reparentShapesById(n.map((function(e){return e.id})),e.editor.currentPageId)})),D(_t(e),"onResizeEnd",(function(t){var n,r=e.editor.getPageBounds(t),i=[],o=J(e.editor.getSortedChildIds(t.id));try{for(o.s();!(n=o.n()).done;){var a=n.value,s=e.editor.getPageBoundsById(a);r.includes(s)||i.push(a)}}catch(u){o.e(u)}finally{o.f()}i.length>0&&e.editor.reparentShapesById(i,e.editor.currentPageId)})),e}return z(n,[{key:"getDefaultProps",value:function(){return{w:320,h:180,name:""}}},{key:"component",value:function(e){var t=this.editor.getBounds(e),n=If();return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)(Ef,{children:[(0,La.jsx)("rect",{className:"tl-hitarea-stroke",width:t.width,height:t.height}),(0,La.jsx)("rect",{className:"tl-frame__body",width:t.width,height:t.height,fill:n.solid,stroke:n.text})]}),(0,La.jsx)(Vp,{id:e.id,name:e.props.name,width:t.width,height:t.height})]})}},{key:"toSvg",value:function(e){var t=Ji(this.editor),n=document.createElementNS("http://www.w3.org/2000/svg","g"),r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("width",e.props.w.toString()),r.setAttribute("height",e.props.h.toString()),r.setAttribute("fill",t.solid),r.setAttribute("stroke",t.black.solid),r.setAttribute("stroke-width","1"),r.setAttribute("rx","1"),r.setAttribute("ry","1"),n.appendChild(r);var i,o=((rs(this.editor.getPageRotationById(e.id))+Math.PI/4)*(2/Math.PI)+4)%4;switch(["top","left","bottom","right"][Math.floor(o)]){case"top":default:i="";break;case"right":i="translate(".concat(ms(e.props.w),"px, 0px) rotate(90deg)");break;case"bottom":i="translate(".concat(ms(e.props.w),"px, ").concat(ms(e.props.h),"px) rotate(180deg)");break;case"left":i="translate(0px, ".concat(ms(e.props.h),"px) rotate(270deg)")}var a={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:e.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},s=this.editor.textMeasure.measureTextSpans(Wc(e.props.name,"Frame")+String.fromCharCode(8203),a),u=s[0],l=Me(s),c=l.box.w+l.box.x-u.box.x,d=Hc(this.editor,s,Ce({offsetY:-a.height-2},a));d.style.setProperty("transform",i);var f=document.createElementNS("http://www.w3.org/2000/svg","rect");return f.setAttribute("x","-8px"),f.setAttribute("y",-a.height-4+"px"),f.setAttribute("width",c+16+"px"),f.setAttribute("height","".concat(a.height,"px")),f.setAttribute("rx","4px"),f.setAttribute("ry","4px"),f.setAttribute("fill",t.background),n.appendChild(f),n.appendChild(d),n}},{key:"indicator",value:function(e){var t=this.editor.getBounds(e);return(0,La.jsx)("rect",{width:ms(t.width),height:ms(t.height),className:"tl-frame-indicator"})}},{key:"providesBackgroundForChildren",value:function(){return!0}}]),n}(Fc);D(Wp,"type","frame");var Hp=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Wp),e}return z(n)}(Bp);D(Hp,"id","frame"),D(Hp,"initial","idle");var Yp=kf("frame",{util:Wp,props:Ko,migrations:Vo,tool:Hp});function Xp(e){var t=e.bounds,n=e.editor,r=e.font,i=e.shape,o={fontSize:$c[i.props.size],fontFamily:r,textAlign:i.props.align,verticalTextAlign:i.props.verticalAlign,width:Math.ceil(t.width),height:Math.ceil(t.height),padding:16,lineHeight:Yc.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},a=n.textMeasure.measureTextSpans(i.props.text,o),s=function(e,t,n,r){if(("start-legacy"===e||"end-legacy"===e)&&0!==n.length){var i,o=ws.From(n[0].box),a=J(n);try{for(a.s();!(i=a.n()).done;){var s=i.value.box;o.union(s)}}catch(u){a.e(u)}finally{a.f()}if("start-legacy"===e)return(r-2*t-o.width)/2;if("end-legacy"===e)return-(r-2*t-o.width)/2}}(i.props.align,16,a,t.width);return s&&(o.offsetX=s),Hc(0,a,o)}var qp=t.memo((function(e){var t=e.id,n=e.type,r=e.text,i=e.size,o=e.labelColor,a=e.font,s=e.align,u=e.verticalAlign,l=e.wrap,c=dd(t,n,r),d=c.rInput,f=c.isEmpty,p=c.isEditing,h=c.isEditableFromHover,v=c.handleFocus,g=c.handleChange,m=c.handleKeyDown,y=c.handleBlur,b=p||h,w=ld.normalizeTextForDom(r),x=w.trim().length>0,k=function(e){return"start-legacy"===e||"middle-legacy"===e||"end-legacy"===e}(s),S=If();return(0,La.jsx)("div",{className:"tl-text-label","data-font":a,"data-align":s,"data-hastext":!f,"data-isediting":p,"data-textwrap":!!l,style:x||b?{justifyContent:"middle"===s||k?"center":s,alignItems:"middle"===u?"center":u}:void 0,children:(0,La.jsxs)("div",{className:"tl-text-label__inner",style:{fontSize:$c[i],lineHeight:$c[i]*Yc.lineHeight+"px",minHeight:f?$c[i]*Yc.lineHeight+32:0,minWidth:f?33:0,color:S[o].solid},children:[(0,La.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:w}),b?(0,La.jsx)("textarea",{ref:d,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:p,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:r,onFocus:v,onChange:g,onKeyDown:m,onBlur:y,onContextMenu:fu}):null]})})})),$p=t.memo((function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.dash,o=e.color,a=e.fill,s=If(),u=t/2,l=n/2,c=Math.max(0,u-r/2),d=Math.max(0,l-r/2),f=ns(c,d),p=Cf(f<64?2*f:f,r,{style:i,snap:4,closed:!0}),h=p.strokeDasharray,v=p.strokeDashoffset,g="M".concat(u-c,",").concat(l,"a").concat(c,",").concat(d,",0,1,1,").concat(2*c,",0a").concat(c,",").concat(d,",0,1,1,-").concat(2*c,",0");return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Tf,{d:g,color:o,fill:a}),(0,La.jsx)("path",{d:g,strokeWidth:r,width:ms(t),height:ms(n),fill:"none",stroke:s[o].solid,strokeDasharray:h,strokeDashoffset:v,pointerEvents:"all"})]})}));function Gp(e,t){if(t>e){var n=e/2;return"\n    M0,".concat(n,"\n    a").concat(n,",").concat(n,",0,1,1,").concat(2*n,",0\n    L").concat(e,",").concat(t-n,"\n    a").concat(n,",").concat(n,",0,1,1,-").concat(2*n,",0\n    Z")}var r=t/2;return"\n    M".concat(r,",0\n    L").concat(e-r,",0\n    a").concat(r,",").concat(r,",0,1,1,0,").concat(2*r,"\n    L").concat(r,",").concat(t,"\n    a").concat(r,",").concat(r,",0,1,1,0,").concat(2*-r,"\n    Z")}function Qp(e,t){if(e>t){var n=t/2;return ns(n,n)+2*(e-2*n)}var r=e/2;return ns(r,r)+2*(t-2*r)}var Zp=t.memo((function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.dash,o=e.color,a=e.fill,s=If(),u=Gp(t,n),l=Qp(t,n),c=Cf(l<64?2*l:l,r,{style:i,snap:4,start:"outset",end:"outset",closed:!0}),d=c.strokeDasharray,f=c.strokeDashoffset;return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Tf,{d:u,color:o,fill:a}),(0,La.jsx)("path",{d:u,strokeWidth:r,width:ms(t),height:ms(n),fill:"none",stroke:s[o].solid,strokeDasharray:d,strokeDashoffset:f,pointerEvents:"all"})]})}));function Jp(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.dash,o=e.color,a=e.theme,s=e.fill,u=Gp(t,n),l=Qp(t,n),c=Cf(l<64?2*l:l,r,{style:i,snap:4,closed:!0}),d=c.strokeDasharray,f=c.strokeDashoffset,p=document.createElementNS("http://www.w3.org/2000/svg","path");return p.setAttribute("d",u),p.setAttribute("stroke-width",r.toString()),p.setAttribute("width",t.toString()),p.setAttribute("height",n.toString()),p.setAttribute("fill","none"),p.setAttribute("stroke",a[o].solid),p.setAttribute("stroke-dasharray",d),p.setAttribute("stroke-dashoffset",f),Af(p,jf({d:u,fill:s,color:o,theme:a}))}var eh=t.memo((function(e){var t=e.dash,n=e.fill,r=e.color,i=e.strokeWidth,o=e.outline,a=e.lines,s=If(),u="M"+o[0]+"L"+o.slice(1)+"Z";return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Tf,{d:u,fill:n,color:r}),a&&a.map((function(e,t){return(0,La.jsx)("path",{className:"tl-hitarea-stroke",fill:"none",d:"M".concat(e[0].x,",").concat(e[0].y,"L").concat(e[1].x,",").concat(e[1].y)},"line_bg_".concat(t))})),(0,La.jsxs)("g",{strokeWidth:i,stroke:s[r].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(o.length)).map((function(e,n){var r=o[n],a=o[(n+1)%o.length],s=Cf(Ya.Dist(r,a),i,{style:t,start:"outset",end:"outset"}),u=s.strokeDasharray,l=s.strokeDashoffset;return(0,La.jsx)("line",{x1:r.x,y1:r.y,x2:a.x,y2:a.y,strokeDasharray:u,strokeDashoffset:l},n)})),a&&a.map((function(e,n){var o=l(e,2),a=o[0],u=o[1],c=Cf(Ya.Dist(a,u),i,{style:t,start:"skip",end:"outset",snap:"dotted"===t?4:void 0}),d=c.strokeDasharray,f=c.strokeDashoffset;return(0,La.jsx)("path",{d:"M".concat(a.x,",").concat(a.y,"L").concat(u.x,",").concat(u.y),stroke:s[r].solid,strokeWidth:i,fill:"none",strokeDasharray:d,strokeDashoffset:f},"line_fg_".concat(n))}))]})]})}));t.memo((function(e){var t=e.id,n=e.w,r=e.h,i=e.strokeWidth,o=e.fill,a=e.color,s=If(),u=ih(t,n,r,i),l=rh(t,n,r,i);return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Tf,{d:u,color:a,fill:o}),(0,La.jsx)("path",{d:l,fill:s[a].solid,strokeWidth:0,pointerEvents:"all"})]})}));function th(e){return{size:1+e,thinning:.25,end:{taper:e},start:{taper:e},streamline:0,smoothing:1,simulatePressure:!1}}function nh(e,t,n,r){for(var i=Fe(e),o=t/2,a=n/2,s=ns(o,a),u=[],l=Ga*i(),c=Ga+$a/2+Math.abs(i())*$a,d=Math.max(16,s/10),f=0;f<d;f++){var p=f/(d-1),h=l+p*c,v=Math.cos(h),g=Math.sin(h);u.push(new Ya(o*v+.5*t+.05*i(),a*g+n/2+.05*i(),Math.min(1,.5+Math.abs(.5-(i()>0?Ha.easeInOutSine(p):Ha.easeInExpo(p)))/2)))}return Os(u,th(r))}function rh(e,t,n,r){var i=th(r);return gu(Ms(Ds(nh(e,t,n,r),i),i))}function ih(e,t,n,r){return mu(nh(e,t,n,r))}var oh=t.memo((function(e){var t=e.id,n=e.outline,r=e.lines,i=e.fill,o=e.color,a=e.strokeWidth,s=If(),u=qs($s(t,n,a/3,2*a,2));if(r){var c,d=J(r);try{for(d.s();!(c=d.n()).done;){var f=l(c.value,2),p=f[0],h=f[1];u+="M".concat(p.x,",").concat(p.y,"L").concat(h.x,",").concat(h.y)}}catch(g){d.e(g)}finally{d.f()}}var v=qs($s(t,n,0,2*a,1));return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Tf,{d:v,fill:i,color:o}),(0,La.jsx)("path",{d:u,stroke:s[o].solid,strokeWidth:a,fill:"none"})]})}));var ah=t.memo((function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.fill,o=e.color,a=If(),s=t/2,u=n/2,l=Math.max(0,s),c=Math.max(0,u),d="M".concat(s-l,",").concat(u,"a").concat(l,",").concat(c,",0,1,1,").concat(2*l,",0a").concat(l,",").concat(c,",0,1,1,-").concat(2*l,",0");return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Tf,{d:d,color:o,fill:i}),(0,La.jsx)("path",{d:d,stroke:a[o].solid,strokeWidth:r,fill:"none"})]})}));var sh=t.memo((function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.fill,o=e.color,a=If(),s=uh(t,n);return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Tf,{d:s,color:o,fill:i}),(0,La.jsx)("path",{d:s,stroke:a[o].solid,strokeWidth:r,fill:"none"})]})}));function uh(e,t){var n;if(t>e){var r=e/2;n="\n    M0,".concat(r,"\n    a").concat(r,",").concat(r,",0,1,1,").concat(2*r,",0\n    L").concat(e,",").concat(t-r,"\n    a").concat(r,",").concat(r,",0,1,1,-").concat(2*r,",0\n    Z")}else{var i=t/2;n="\n    M".concat(i,",0\n    L").concat(e-i,",0\n    a").concat(i,",").concat(i,",0,1,1,0,").concat(2*i,"\n    L").concat(i,",").concat(t,"\n    a").concat(i,",").concat(i,",0,1,1,0,").concat(2*-i,"\n    Z")}return n}var lh=t.memo((function(e){var t=e.outline,n=e.lines,r=e.fill,i=e.color,o=e.strokeWidth,a=If(),s="M"+t[0]+"L"+t.slice(1)+"Z";if(n){var u,c=J(n);try{for(c.s();!(u=c.n()).done;){var d=l(u.value,2),f=d[0],p=d[1];s+="M".concat(f.x,",").concat(f.y,"L").concat(p.x,",").concat(p.y)}}catch(h){c.e(h)}finally{c.f()}}return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Tf,{d:s,fill:r,color:i}),(0,La.jsx)("path",{d:s,stroke:a[i].solid,strokeWidth:o,fill:"none"})]})}));var ch=51,dh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"canEdit",(function(){return!0})),D(_t(e),"onEditEnd",(function(t){var n=t.id,r=t.type,i=t.props.text;i.trimEnd()!==t.props.text&&e.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])})),D(_t(e),"onResize",(function(t,n){var r=n.initialBounds,i=n.handle,o=n.newPoint,a=n.scaleX,s=n.scaleY,u=r.width*a,l=r.height*s,c=0,d=0;if(t.props.text.trim()){var f=Math.max(Math.abs(u),ch),p=Math.max(Math.abs(l),ch);f<ch&&p===ch&&(f=ch),f===ch&&p<ch&&(p=ch);var h=fh(e.editor,Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},{w:f,h:p})})),v=Math.max(Math.abs(u),h.w)*Math.sign(u),g=Math.max(Math.abs(l),h.h)*Math.sign(l);c=Math.abs(v)-Math.abs(u),d=Math.abs(g)-Math.abs(l),u=v,l=g}var m=new Ya(0,0);a<0&&(m.x+=u),"left"!==i&&"top_left"!==i&&"bottom_left"!==i||(m.x+=a<0?c:-c),s<0&&(m.y+=l),"top"!==i&&"top_left"!==i&&"top_right"!==i||(m.y+=s<0?d:-d);var y=m.rot(t.rotation).add(o);return{x:y.x,y:y.y,props:{w:Math.max(Math.abs(u),1),h:Math.max(Math.abs(l),1),growY:0}}})),D(_t(e),"onBeforeCreate",(function(t){if(!t.props.text)return t.props.growY?Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},{growY:0})}):void 0;var n=t.props.h,r=fh(e.editor,t).h,i=null;return r>n?i=r-n:t.props.growY&&(i=0),null!==i?Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},{growY:i})}):void 0})),D(_t(e),"onBeforeUpdate",(function(t,n){var r=t.props.text.trimEnd(),i=n.props.text.trimEnd();if(r!==i||t.props.font!==n.props.font||t.props.size!==n.props.size){if(r&&!i)return Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{growY:0})});var o=t.props.w,a=t.props.h,s=fh(e.editor,n),u=s.w,l=s.h;if(!r&&i&&1===i.length){var c=Math.max(o,u),d=Math.max(a,l);return t.props.w<ch&&t.props.h<ch&&(c=Math.max(c,ch),d=Math.max(d,ch),c=Math.max(c,d),d=Math.max(c,d)),Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{w:c,h:d,growY:0})})}var f=null;return l>a?f=l-a:t.props.growY&&(f=0),null!==f?Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{growY:f,w:Math.max(n.props.w,u)})}):u>t.props.w?Ce(Ce({},n),{},{props:Ce(Ce({},n.props),{},{w:u})}):void 0}})),D(_t(e),"onDoubleClick",(function(t){if(e.editor.inputs.altKey)switch(t.props.geo){case"rectangle":return Ce(Ce({},t),{},{props:{geo:"check-box"}});case"check-box":return Ce(Ce({},t),{},{props:{geo:"rectangle"}})}})),e}return z(n,[{key:"getDefaultProps",value:function(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}},{key:"hitTestLineSegment",value:function(e,t,n){for(var r=this.editor.getOutline(e),i=0;i<r.length;i++){if(Ws(t,n,r[i],r[(i+1)%r.length]))return!0}var o=ph(e.props,0);if(void 0!==o){var a,s=J(o);try{for(s.s();!(a=s.n()).done;){var u=l(a.value,2);if(Ws(t,n,u[0],u[1]))return!0}}catch(c){s.e(c)}finally{s.f()}}return!1}},{key:"hitTestPoint",value:function(e,t){var n=this.editor.getOutline(e);if("none"===e.props.fill){for(var r=this.editor.zoomLevel,i=Xc[e.props.size]/r,o=0;o<n.length;o++){var a=n[o],s=n[(o+1)%n.length];if(Ya.DistanceToLineSegment(a,s,t)<i)return!0}var u=ph(e.props,1);if(void 0!==u){var c,d=J(u);try{for(d.s();!(c=d.n()).done;){var f=l(c.value,2),p=f[0],h=f[1];if(Ya.DistanceToLineSegment(p,h,t)<i)return!0}}catch(v){d.e(v)}finally{d.f()}}return!1}return gs(t,n)}},{key:"getBounds",value:function(e){return new ws(0,0,e.props.w,e.props.h+e.props.growY)}},{key:"getCenter",value:function(e){return new Ya(e.props.w/2,(e.props.h+e.props.growY)/2)}},{key:"getOutline",value:function(e){var t=Math.max(1,e.props.w),n=Math.max(1,e.props.h+e.props.growY),r=t/2,i=n/2;switch(e.props.geo){case"triangle":return[new Ya(r,0),new Ya(t,n),new Ya(0,n)];case"diamond":return[new Ya(r,0),new Ya(t,i),new Ya(r,n),new Ya(0,i)];case"pentagon":return fs(t,n,5);case"hexagon":return fs(t,n,6);case"octagon":return fs(t,n,8);case"ellipse":var o=Math.pow(r-i,2)/Math.pow(r+i,2),a=qa*(r+i)*(1+3*o/(10+Math.sqrt(4-3*o))),s=Math.max(4,Math.ceil(a/10));s=4*Math.ceil(s/4);for(var u=Ga/s,l=Math.cos(u),c=Math.sin(u),d=0,f=1,p=1,h=Array(s),v=0;v<s;v++)h[v]=new Ya(r+r*f,i+i*d),p=l*f-c*d,d=c*f+l*d,f=p;return h;case"oval":var g=10,m=Array(20);if(n>t)for(var y=0;y<g;y++){var b=qa*y/8-qa,w=qa*y/8;m[y]=new Ya(r+r*Math.cos(b),r+r*Math.sin(b)),m[y+g]=new Ya(r+r*Math.cos(w),n-r+r*Math.sin(w))}else for(var x=0;x<g;x++){var k=qa*x/8-$a,S=$a+qa*-x/8;m[x]=new Ya(t-i+i*Math.cos(k),n-i+i*Math.sin(k)),m[x+g]=new Ya(i-i*Math.cos(S),n-i+i*Math.sin(S))}return m;case"star":var _=Ga/5/2,P=2*Math.floor(5/4),E=10-P,C=2*Math.floor(2.5),I=Math.cos(P*_-$a)*t/2,T=Math.cos(E*_-$a)*t/2,M=Math.sin(0*_-$a)*n/2,j=Math.sin(C*_-$a)*n/2,A=t-Math.abs(I-T),O=n-Math.abs(j-M),L=(t-(t/2+T-(t/2-I)))/2,z=(n-(n/2+M-(n/2-j)))/2,D=(t+A)/2,N=(n+O)/2,R=1*D/2,B=1*N/2;return Array.from(Array(10)).map((function(e,t){var n=t*_-$a;return new Ya(L+(t%2?R:D)*Math.cos(n),z+(t%2?B:N)*Math.sin(n))}));case"rhombus":var F=Math.min(.38*t,.38*n);return[new Ya(F,0),new Ya(t,0),new Ya(t-F,n),new Ya(0,n)];case"rhombus-2":var U=Math.min(.38*t,.38*n);return[new Ya(0,0),new Ya(t-U,0),new Ya(t,n),new Ya(U,n)];case"trapezoid":var K=Math.min(.38*t,.38*n);return[new Ya(K,0),new Ya(t-K,0),new Ya(t,n),new Ya(0,n)];case"arrow-right":var V=.38*Math.min(t,n),W=.16*n;return[new Ya(0,W),new Ya(t-V,W),new Ya(t-V,0),new Ya(t,n/2),new Ya(t-V,n),new Ya(t-V,n-W),new Ya(0,n-W)];case"arrow-left":var H=.38*Math.min(t,n),Y=.16*n;return[new Ya(H,0),new Ya(H,Y),new Ya(t,Y),new Ya(t,n-Y),new Ya(H,n-Y),new Ya(H,n),new Ya(0,n/2)];case"arrow-up":var X=.16*t,q=.38*Math.min(t,n);return[new Ya(t/2,0),new Ya(t,q),new Ya(t-X,q),new Ya(t-X,n),new Ya(X,n),new Ya(X,q),new Ya(0,q)];case"arrow-down":var $=.16*t,G=.38*Math.min(t,n);return[new Ya($,0),new Ya(t-$,0),new Ya(t-$,n-G),new Ya(t,n-G),new Ya(t/2,n),new Ya(0,n-G),new Ya($,n-G)];case"check-box":case"x-box":case"rectangle":return[new Ya(0,0),new Ya(t,0),new Ya(t,n),new Ya(0,n)]}}},{key:"component",value:function(e){var t=this,n=e.id,r=e.type,i=e.props,o=gp(),a=Xc[i.size],s=i.w,u=i.color,l=i.labelColor,c=i.fill,d=i.dash,f=i.growY,p=i.font,h=i.align,v=i.verticalAlign,g=i.size,m=i.text;return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Ef,{id:n,children:function(){var r=i.h+f;switch(i.geo){case"ellipse":if("solid"===d||"draw"===d&&o)return(0,La.jsx)(ah,{strokeWidth:a,w:s,h:r,color:u,fill:c});if("dashed"===d||"dotted"===d)return(0,La.jsx)($p,{id:n,strokeWidth:a,w:s,h:r,dash:"dashed"===d?d:"s"===g&&o?"dashed":d,color:u,fill:c});if("draw"===d)return(0,La.jsx)(ah,{strokeWidth:a,w:s,h:r,color:u,fill:c});break;case"oval":if("solid"===d||"draw"===d&&o)return(0,La.jsx)(sh,{strokeWidth:a,w:s,h:r,color:u,fill:c});if("dashed"===d||"dotted"===d)return(0,La.jsx)(Zp,{id:n,strokeWidth:a,w:s,h:r,dash:"dashed"===d?d:"s"===g&&o?"dashed":d,color:u,fill:c});if("draw"===d)return(0,La.jsx)(sh,{strokeWidth:a,w:s,h:r,color:u,fill:c});break;default:var l=t.editor.getOutline(e),p=ph(e.props,a);if("solid"===d||"draw"===d&&o)return(0,La.jsx)(lh,{fill:c,color:u,strokeWidth:a,outline:l,lines:p});if("dashed"===d||"dotted"===d)return(0,La.jsx)(eh,{dash:"dashed"===d?d:"s"===g&&o?"dashed":d,fill:c,color:u,strokeWidth:a,outline:l,lines:p});if("draw"===d)return(0,La.jsx)(oh,{id:n,fill:c,color:u,strokeWidth:a,outline:l,lines:p})}}()}),(0,La.jsx)(qp,{id:n,type:r,font:p,fill:c,size:g,align:h,verticalAlign:v,text:m,labelColor:l,wrap:!0}),e.props.url&&(0,La.jsx)(cp,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}},{key:"indicator",value:function(e){var t=e.id,n=e.props,r=n.w,i=n.h,o=n.growY,a=n.size,s=gp(),u=Xc[a];switch(n.geo){case"ellipse":return"draw"!==n.dash||s?(0,La.jsx)("ellipse",{cx:r/2,cy:(i+o)/2,rx:r/2,ry:(i+o)/2}):(0,La.jsx)("path",{d:ih(t,r,i+o,u)});case"oval":return(0,La.jsx)("path",{d:uh(r,i+o)});default:var c,d=this.editor.getOutline(e);if("draw"!==n.dash||s)c="M"+d[0]+"L"+d.slice(1)+"Z";else c=qs($s(t,d,0,2*u,1));var f=ph(e.props,u);if(f){var p,h=J(f);try{for(h.s();!(p=h.n()).done;){var v=l(p.value,2),g=v[0],m=v[1];c+="M".concat(g.x,",").concat(g.y,"L").concat(m.x,",").concat(m.y)}}catch(y){h.e(y)}finally{h.f()}}return(0,La.jsx)("path",{d:c})}}},{key:"toSvg",value:function(e,t){var n,r=e.id,i=e.props,o=Xc[i.size],a=Ji(this.editor);switch(t.addExportDef(ed(e.props.fill,a)),i.geo){case"ellipse":switch(i.dash){case"draw":n=function(e){var t=e.id,n=e.w,r=e.h,i=e.strokeWidth,o=e.fill,a=e.color,s=e.theme,u=document.createElementNS("http://www.w3.org/2000/svg","path");return u.setAttribute("d",rh(t,n,r,i)),u.setAttribute("fill",s[a].solid),Af(u,jf({d:ih(t,n,r,i),fill:o,color:a,theme:s}))}({id:r,w:i.w,h:i.h,color:i.color,fill:i.fill,strokeWidth:o,theme:a});break;case"solid":n=function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.fill,o=e.color,a=e.theme,s=t/2,u=n/2,l=Math.max(0,s),c=Math.max(0,u),d="M".concat(s-l,",").concat(u,"a").concat(l,",").concat(c,",0,1,1,").concat(2*l,",0a").concat(l,",").concat(c,",0,1,1,-").concat(2*l,",0"),f=document.createElementNS("http://www.w3.org/2000/svg","path");return f.setAttribute("d",d),f.setAttribute("stroke-width",r.toString()),f.setAttribute("width",t.toString()),f.setAttribute("height",n.toString()),f.setAttribute("fill","none"),f.setAttribute("stroke",a[o].solid),Af(f,jf({d:d,fill:i,color:o,theme:a}))}({strokeWidth:o,w:i.w,h:i.h,color:i.color,fill:i.fill,theme:a});break;default:n=function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.dash,o=e.color,a=e.theme,s=e.fill,u=t/2,l=n/2,c=Math.max(0,u-r/2),d=Math.max(0,l-r/2),f=ns(c,d),p=Cf(f<64?2*f:f,r,{style:i,snap:4,closed:!0}),h=p.strokeDasharray,v=p.strokeDashoffset,g="M".concat(u-c,",").concat(l,"a").concat(c,",").concat(d,",0,1,1,").concat(2*c,",0a").concat(c,",").concat(d,",0,1,1,-").concat(2*c,",0"),m=document.createElementNS("http://www.w3.org/2000/svg","path");return m.setAttribute("d",g),m.setAttribute("stroke-width",r.toString()),m.setAttribute("width",t.toString()),m.setAttribute("height",n.toString()),m.setAttribute("fill","none"),m.setAttribute("stroke",a[o].solid),m.setAttribute("stroke-dasharray",h),m.setAttribute("stroke-dashoffset",v),Af(m,jf({d:g,fill:s,color:o,theme:a}))}({id:r,strokeWidth:o,w:i.w,h:i.h,dash:i.dash,color:i.color,fill:i.fill,theme:a})}break;case"oval":switch(i.dash){case"draw":default:n=Jp({id:r,strokeWidth:o,w:i.w,h:i.h,dash:i.dash,color:i.color,fill:i.fill,theme:a});break;case"solid":n=function(e){var t=e.w,n=e.h,r=e.strokeWidth,i=e.fill,o=e.color,a=e.theme,s=uh(t,n),u=document.createElementNS("http://www.w3.org/2000/svg","path");return u.setAttribute("d",s),u.setAttribute("stroke-width",r.toString()),u.setAttribute("width",t.toString()),u.setAttribute("height",n.toString()),u.setAttribute("fill","none"),u.setAttribute("stroke",a[o].solid),Af(u,jf({d:s,fill:i,color:o,theme:a}))}({strokeWidth:o,w:i.w,h:i.h,color:i.color,fill:i.fill,theme:a})}break;default:var s=this.editor.getOutline(e),u=ph(e.props,o);switch(i.dash){case"draw":n=function(e){var t=e.id,n=e.outline,r=e.lines,i=e.fill,o=e.color,a=e.theme,s=e.strokeWidth,u=qs($s(t,n,s/3,2*s,2));if(r){var c,d=J(r);try{for(d.s();!(c=d.n()).done;){var f=l(c.value,2),p=f[0],h=f[1];u+="M".concat(p.x,",").concat(p.y,"L").concat(h.x,",").concat(h.y)}}catch(m){d.e(m)}finally{d.f()}}var v=qs($s(t,n,0,2*s,1)),g=document.createElementNS("http://www.w3.org/2000/svg","path");return g.setAttribute("d",u),g.setAttribute("fill","none"),g.setAttribute("stroke",a[o].solid),g.setAttribute("stroke-width",s.toString()),Af(g,jf({d:v,fill:i,color:o,theme:a}))}({id:r,fill:i.fill,color:i.color,strokeWidth:o,outline:s,lines:u,theme:a});break;case"solid":n=function(e){var t=e.outline,n=e.lines,r=e.fill,i=e.color,o=e.strokeWidth,a=e.theme,s="M"+t[0]+"L"+t.slice(1)+"Z",u=s,c=s;if(n){var d,f=J(n);try{for(f.s();!(d=f.n()).done;){var p=l(d.value,2),h=p[0],v=p[1];c+="M".concat(h.x,",").concat(h.y,"L").concat(v.x,",").concat(v.y)}}catch(m){f.e(m)}finally{f.f()}}var g=document.createElementNS("http://www.w3.org/2000/svg","path");return g.setAttribute("d",c),g.setAttribute("stroke-width",o.toString()),g.setAttribute("stroke",a[i].solid),g.setAttribute("fill","none"),Af(g,jf({d:u,fill:r,color:i,theme:a}))}({fill:i.fill,color:i.color,strokeWidth:o,outline:s,lines:u,theme:a});break;default:n=function(e){var t=e.dash,n=e.fill,r=e.color,i=e.theme,o=e.strokeWidth,a=e.outline,s=e.lines,u=document.createElementNS("http://www.w3.org/2000/svg","g");if(u.setAttribute("stroke-width",o.toString()),u.setAttribute("stroke",i[r].solid),u.setAttribute("fill","none"),Array.from(Array(a.length)).forEach((function(e,n){var r=a[n],i=a[(n+1)%a.length],s=Cf(Ya.Dist(r,i),o,{style:t}),l=s.strokeDasharray,c=s.strokeDashoffset,d=document.createElementNS("http://www.w3.org/2000/svg","line");d.setAttribute("x1",r.x.toString()),d.setAttribute("y1",r.y.toString()),d.setAttribute("x2",i.x.toString()),d.setAttribute("y2",i.y.toString()),d.setAttribute("stroke-dasharray",l.toString()),d.setAttribute("stroke-dashoffset",c.toString()),u.appendChild(d)})),s){var c,d=J(s);try{for(d.s();!(c=d.n()).done;){var f=l(c.value,2),p=f[0],h=f[1],v=Cf(Ya.Dist(p,h),o,{style:t,start:"skip",end:"skip",snap:"dotted"===t?4:2}),g=v.strokeDasharray,m=v.strokeDashoffset,y=document.createElementNS("http://www.w3.org/2000/svg","line");y.setAttribute("x1",p.x.toString()),y.setAttribute("y1",p.y.toString()),y.setAttribute("x2",h.x.toString()),y.setAttribute("y2",h.y.toString()),y.setAttribute("stroke-dasharray",g.toString()),y.setAttribute("stroke-dashoffset",m.toString()),u.appendChild(y)}}catch(w){d.e(w)}finally{d.f()}}var b=jf({d:"M"+a[0]+"L"+a.slice(1)+"Z",fill:n,color:r,theme:i});return Af(u,b)}({dash:i.dash,fill:i.fill,color:i.color,strokeWidth:o,outline:s,lines:u,theme:a})}}if(i.text){var c=this.editor.getBounds(e);t.addExportDef(Zc(e.props.font));var d=Xp({editor:this.editor,shape:e,font:lo[e.props.font],bounds:c}),f=d.cloneNode(!0);f.setAttribute("fill",a[e.props.labelColor].solid),f.setAttribute("stroke","none");var p=d.cloneNode(!0);p.setAttribute("stroke-width","2"),p.setAttribute("fill",a.background),p.setAttribute("stroke",a.background);var h=document.createElementNS("http://www.w3.org/2000/svg","g");if(h.append(p),h.append(f),"g"===n.nodeName)return n.appendChild(h),n;var v=document.createElementNS("http://www.w3.org/2000/svg","g");return v.appendChild(n),v.appendChild(h),v}return n}},{key:"getCanvasSvgDefs",value:function(){return[td()]}}]),n}(Fc);function fh(e,t){var n=t.props.text.trimEnd();if(!n)return{w:0,h:0};var r=e.textMeasure.measureText("w",Ce(Ce({},Yc),{},{fontFamily:Qc[t.props.font],fontSize:$c[t.props.size],width:"fit-content",maxWidth:"100px"})),i=e.textMeasure.measureText(n,Ce(Ce({},Yc),{},{fontFamily:Qc[t.props.font],fontSize:$c[t.props.size],width:"fit-content",minWidth:r.w+"px",maxWidth:Math.max(0,Math.ceil(r.w+{s:2,m:3.5,l:5,xl:10}[t.props.size]),Math.ceil(t.props.w-32))+"px"}));return{w:i.w+32,h:i.h+32}}function ph(e,t){switch(e.geo){case"x-box":return function(e,t,n,r){var i="draw"===r?.62:0;if("dashed"===r)return[[new Ya(0,0),new Ya(e/2,t/2)],[new Ya(e,t),new Ya(e/2,t/2)],[new Ya(0,t),new Ya(e/2,t/2)],[new Ya(e,0),new Ya(e/2,t/2)]];return[[new Ya(n*i,n*i),new Ya(e-n*i,t-n*i)],[new Ya(n*i,t-n*i),new Ya(e-n*i,n*i)]]}(e.w,e.h,t,e.dash);case"check-box":return function(e,t){var n=.82*Math.min(e,t),r=(e-n)/2,i=(t-n)/2;return[[new Ya(r+.25*n,i+.52*n),new Ya(r+.45*n,i+.82*n)],[new Ya(r+.45*n,i+.82*n),new Ya(r+.82*n,i+.22*n)]]}(e.w,e.h);default:return}}D(dh,"type","geo");var hh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),D(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),D(_t(e),"onKeyUp",(function(t){if("Enter"===t.key){var n=e.editor.onlySelectedShape;n&&e.editor.isShapeOfType(n,dh)&&(e.editor.mark("editing shape"),e.editor.setEditingId(n.id),e.editor.setSelectedTool("select.editing_shape",Ce(Ce({},t),{},{target:"shape",shape:n})))}})),D(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return z(n)}(_f);D(hh,"id","idle");var vh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){var n=e.editor.inputs.originPagePoint,r=Vi();e.editor.mark("creating"),e.editor.createShapes([{id:r,type:"geo",x:n.x,y:n.y,props:{w:1,h:1,geo:e.editor.getStyleForNextShape($o)}}]),e.editor.select(r),e.editor.setSelectedTool("select.resizing",Ce(Ce({},t),{},{target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"}))}})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"complete",value:function(){var e=this.editor.inputs.originPagePoint,t=Vi();this.editor.mark("creating"),this.editor.createShapes([{id:t,type:"geo",x:e.x,y:e.y,props:{geo:this.editor.getStyleForNextShape($o),w:1,h:1}}]);var n=this.editor.getShapeById(t);if(n){var r="star"===n.props.geo?function(e,t,n){var r=Ga/e/2,i=2*Math.floor(e/4),o=2*e-i,a=2*Math.floor(e/2),s=Math.cos(i*r-$a)*t/2,u=Math.cos(o*r-$a)*t/2,l=Math.sin(0*r-$a)*n/2,c=Math.sin(a*r-$a)*n/2;return new ws(0,0,s-u,c-l)}(5,200,200):new ws(0,0,200,200),i=this.editor.getDeltaInParentSpace(n,r.center);this.editor.select(t),this.editor.updateShapes([{id:n.id,type:"geo",x:n.x-i.x,y:n.y-i.y,props:{geo:this.editor.getStyleForNextShape($o),w:r.width,h:r.height}}]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select",{})}}},{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(_f);D(vh,"id","pointing");var gh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",dh),e}return z(n)}(_f);D(gh,"id","geo"),D(gh,"initial","idle"),D(gh,"children",(function(){return[hh,vh]}));var mh=kf("geo",{util:dh,props:Go,migrations:na,tool:gh}),yh=kf("group",{util:Up,props:{},migrations:ra}),bh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Ep),D(_t(e),"onExit",(function(){e.children.drawing.initialShape=void 0})),e}return z(n)}(_f);D(bh,"id","highlight"),D(bh,"initial","idle"),D(bh,"children",(function(){return[Op,Ap]}));var wh=kf("highlight",{util:Ep,props:ia,migrations:oa,tool:bh});function xh(e){var t=Ka();return _e("isCropping",(function(){return t.croppingId===e}),[t,e])}var kh=function(){var e=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new Image;r.onload=function(){return e(r)},r.onerror=function(){return n(new Error("Failed to load image"))},r.crossOrigin="anonymous",r.src=t})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Sh=function(){var e=Ba(Na().mark((function e(t){var n,r,i;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kh(t);case 2:if(n=e.sent,(r=document.createElement("canvas")).width=n.width,r.height=n.height,i=r.getContext("2d")){e.next=9;break}return e.abrupt("return");case 9:return i.drawImage(n,0,0),e.abrupt("return",r.toDataURL());case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function _h(e){return Ph.apply(this,arguments)}function Ph(){return(Ph=Ba(Na().mark((function e(t){var n,r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.blob();case 5:return r=e.sent,e.abrupt("return",new Promise((function(e,t){var n=new FileReader;n.onloadend=function(){return e(n.result)},n.onerror=t,n.readAsDataURL(r)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Eh=function(e){Et(r,e);var n=Tt(r);function r(){var e;j(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return D(_t(e=n.call.apply(n,[this].concat(i))),"isAspectRatioLocked",(function(){return!0})),D(_t(e),"canCrop",(function(){return!0})),D(_t(e),"onDoubleClick",(function(t){var n=t.props.assetId?e.editor.getAssetById(t.props.assetId):void 0;n&&(n.props.src&&"mimeType"in n.props&&"image/gif"===n.props.mimeType&&e.editor.updateShapes([{type:"image",id:t.id,props:{playing:!t.props.playing}}]))})),D(_t(e),"onDoubleClickEdge",(function(t){var n=t.props;if(n&&e.editor.croppingId===t.id){var r=We(n.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},i=1/(r.bottomRight.x-r.topLeft.x)*t.props.w,o=1/(r.bottomRight.y-r.topLeft.y)*t.props.h,a=new Ya(r.topLeft.x*i,r.topLeft.y*o).rot(t.rotation),s={id:t.id,type:t.type,x:t.x-a.x,y:t.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:i,h:o}};e.editor.updateShapes([s])}})),e}return z(r,[{key:"getDefaultProps",value:function(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}},{key:"component",value:function(e){var n,r,i=this,o=Ch(e),a=xh(e.id),s=cu(),u=l((0,t.useState)(""),2),c=u[0],d=u[1],f=e.props,p=f.w,h=f.h,v=e.props.assetId?this.editor.getAssetById(e.props.assetId):void 0;if("bookmark"===(null===v||void 0===v?void 0:v.type))throw Error("Bookmark assets can't be rendered as images");var g=_e("onlySelectedShape",(function(){var t;return e.id===(null===(t=i.editor.onlySelectedShape)||void 0===t?void 0:t.id)}),[this.editor])&&a&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),m=s&&((null===v||void 0===v||null===(n=v.props.mimeType)||void 0===n?void 0:n.includes("video"))||(null===v||void 0===v||null===(r=v.props.mimeType)||void 0===r?void 0:r.includes("gif")));return(0,t.useEffect)((function(){if(null!==v&&void 0!==v&&v.props.src&&"mimeType"in v.props&&"image/gif"===(null===v||void 0===v?void 0:v.props.mimeType)){var e=!1,t=function(){var t=Ba(Na().mark((function t(){var n;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Sh(v.props.src);case 2:if(n=t.sent,!e){t.next=5;break}return t.abrupt("return");case 5:n&&d(n);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!0}}}),[s,null===v||void 0===v?void 0:v.props]),(0,La.jsxs)(La.Fragment,{children:[(null===v||void 0===v?void 0:v.props.src)&&g&&(0,La.jsx)("div",{style:o,children:(0,La.jsx)("div",{className:"tl-image tl-image-".concat(e.id,"-crop"),style:{opacity:.1,backgroundImage:"url(".concat(!e.props.playing||m?c:v.props.src,")")},draggable:!1})}),(0,La.jsx)(Ac,{id:e.id,style:{overflow:"hidden"},children:(0,La.jsxs)("div",{className:"tl-image-container",style:o,children:[null!==v&&void 0!==v&&v.props.src?(0,La.jsx)("div",{className:"tl-image tl-image-".concat(e.id),style:{backgroundImage:"url(".concat(!e.props.playing||m?c:v.props.src,")")},draggable:!1}):(0,La.jsx)("g",{transform:"translate(".concat((p-38)/2,", ").concat((h-38)/2,")"),children:(0,La.jsx)($u,{})}),(null===v||void 0===v?void 0:v.props.isAnimated)&&!e.props.playing&&(0,La.jsx)("div",{className:"tl-image__tg",children:"GIF"})]})}),"url"in e.props&&e.props.url&&(0,La.jsx)(cp,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}},{key:"indicator",value:function(e){return xh(e.id)?null:(0,La.jsx)("rect",{width:ms(e.props.w),height:ms(e.props.h)})}},{key:"toSvg",value:function(){var e=Ba(Na().mark((function e(t){var n,r,i,o,a,s,u,l,c,d,f;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.createElementNS("http://www.w3.org/2000/svg","g"),r=t.props.assetId?this.editor.getAssetById(t.props.assetId):null,!(i=(null===r||void 0===r?void 0:r.props.src)||"")||!i.startsWith("http")){e.next=10;break}return e.next=6,_h(i);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0="";case 9:i=e.t0;case 10:return(o=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttributeNS("http://www.w3.org/1999/xlink","href",i),a=Ch(t),s=t.props.crop,a&&s?(u=a.transform,l=a.width,c=a.height,d=[new Ya(s.topLeft.x*l,s.topLeft.y*c),new Ya(s.bottomRight.x*l,s.topLeft.y*c),new Ya(s.bottomRight.x*l,s.bottomRight.y*c),new Ya(s.topLeft.x*l,s.bottomRight.y*c)],(f=document.createElementNS("http://www.w3.org/2000/svg","g")).style.clipPath="polygon(".concat(d.map((function(e){return"".concat(e.x,"px ").concat(e.y,"px")})).join(","),")"),o.setAttribute("width",l.toString()),o.setAttribute("height",c.toString()),o.style.transform=u,f.appendChild(o),n.appendChild(f)):(o.setAttribute("width",t.props.w.toString()),o.setAttribute("height",t.props.h.toString()),n.appendChild(o)),e.abrupt("return",n);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Fc);function Ch(e){var t=e.props.crop,n=null===t||void 0===t?void 0:t.topLeft;if(n){var r=1/(t.bottomRight.x-t.topLeft.x)*e.props.w,i=1/(t.bottomRight.y-t.topLeft.y)*e.props.h,o=-n.x*r,a=-n.y*i;return{transform:"translate(".concat(o,"px, ").concat(a,"px)"),width:r,height:i}}}D(Eh,"type","image");var Ih=kf("image",{util:Eh,props:la,migrations:da});function Th(e){for(var t=e.segments,n=[],r=0,i=t.length;r<i;r++){var o=t[r].lut,a=o.length-1;r>0?n.push(Ya.Lrp(o[0],o[1],.25)):n.push(o[0]);for(var s=1;s<a;s++)n.push(o[s]);r<i-1?n.push(Ya.Lrp(o[a-1],o[a],.75)):n.push(o[a])}return n}function Mh(e){return{size:e,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function jh(e,t,n){return Os(Th(t),Mh(n))}function Ah(e,t,n){var r=function(e,t,n){var r=Mh(n);return Ms(Ds(jh(0,t,n),r),r)}(0,t,n);return gu(r)}function Oh(e,t,n,r){switch(e.props.dash){case"draw":return function(e){e.shape;var t=e.strokeWidth,n=e.spline,r=e.color,i=Ah(0,n,t),o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width","0"),o.setAttribute("stroke","none"),o.setAttribute("fill",r),o.setAttribute("d",i),o}({shape:e,strokeWidth:r,spline:t,color:n});case"solid":return function(e){var t=e.strokeWidth,n=e.spline,r=e.color,i=n.path,o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width",t.toString()),o.setAttribute("stroke",r),o.setAttribute("fill","none"),o.setAttribute("d",i),o}({strokeWidth:r,spline:t,color:n});default:return function(e){var t=e.dash,n=e.strokeWidth,r=e.spline,i=e.color,o=r.segments,a=document.createElementNS("http://www.w3.org/2000/svg","g");return a.setAttribute("stroke",i),a.setAttribute("stroke-width",n.toString()),o.forEach((function(e,r){var i=document.createElementNS("http://www.w3.org/2000/svg","path"),s=Cf(e.length,n,{style:t,start:r>0?"outset":"none",end:r<o.length-1?"outset":"none"}),u=s.strokeDasharray,l=s.strokeDashoffset;i.setAttribute("stroke-dasharray",u.toString()),i.setAttribute("stroke-dashoffset",l.toString()),i.setAttribute("d",e.path),i.setAttribute("fill","none"),a.appendChild(i)})),a}({strokeWidth:r,spline:t,dash:e.props.dash,color:n})}}var Lh=new Vc,zh=new Vc,Dh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"hideResizeHandles",(function(){return!0})),D(_t(e),"hideRotateHandle",(function(){return!0})),D(_t(e),"hideSelectionBoundsBg",(function(){return!0})),D(_t(e),"hideSelectionBoundsFg",(function(){return!0})),D(_t(e),"isClosed",(function(){return!1})),D(_t(e),"onResize",(function(e,t){var n=t.scaleX,r=t.scaleY,i=We(e.props.handles);return Object.values(e.props.handles).forEach((function(e){var t=e.id,o=e.x,a=e.y;i[t].x=o*n,i[t].y=a*r})),{props:{handles:i}}})),D(_t(e),"onHandleChange",(function(e,t){var n=t.handle,r=We(e);switch(n.id){case"start":case"end":r.props.handles[n.id]=Ce(Ce({},r.props.handles[n.id]),{},{x:n.x,y:n.y});break;default:var i="handle:"+n.index,o=e.props.handles[i];r.props.handles[i]=o?Ce(Ce({},o),{},{x:n.x,y:n.y}):{id:i,type:"vertex",canBind:!1,index:n.index,x:n.x,y:n.y}}return r})),e}return z(n,[{key:"getDefaultProps",value:function(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,index:"a2",x:0,y:0}}}}},{key:"getBounds",value:function(e){return Nh(e).bounds}},{key:"getHandles",value:function(e){return zh.get(e.props,(function(){for(var t=e.props.handles,n=Nh(e),r=Object.values(t).sort(M),i=r.slice(),o=0;o<n.segments.length;o++){var a=n.segments[o].midPoint,s=C(r[o].index,r[o+1].index);i.push({id:"mid-".concat(o),type:"create",index:s,x:a.x,y:a.y})}return i.sort(M)}))}},{key:"getOutline",value:function(e){return Th(Nh(e))}},{key:"getOutlineSegments",value:function(e){var t=Nh(e);return"cubic"===e.props.spline?t.segments.map((function(e){return e.lut})):t.segments.map((function(e){return[e.getPoint(0),e.getPoint(1)]}))}},{key:"hitTestPoint",value:function(e,t){var n=this.editor.zoomLevel,r=Xc[e.props.size]/n;return function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=t.length,i=1;i<r;i++){var o=t[i-1],a=t[i];if(Ya.DistanceToLineSegment(o,a,e)<n)return!0}return!1}(t,this.editor.getOutline(e),r)}},{key:"hitTestLineSegment",value:function(e,t,n){return null!==Bs(t,n,this.editor.getOutline(e))}},{key:"component",value:function(e){var t=If(),n=gp(),r=Nh(e),i=Xc[e.props.size],o=e.props,a=o.dash,s=o.color;if("line"===e.props.spline){if("solid"===a){var u=r.points,c="M"+u[0]+"L"+u.slice(1);return(0,La.jsxs)(Ef,{id:e.id,children:[(0,La.jsx)(Tf,{d:c,fill:"none",color:s}),(0,La.jsx)("path",{d:c,stroke:t[s].solid,strokeWidth:i,fill:"none"})]})}if("dashed"===a||"dotted"===a){var d=r.points,f="M"+d[0]+"L"+d.slice(1);return(0,La.jsxs)(Ef,{id:e.id,children:[(0,La.jsx)(Tf,{d:f,fill:"none",color:s}),(0,La.jsx)("g",{stroke:t[s].solid,strokeWidth:i,children:r.segments.map((function(e,t){var n=Cf(e.length,i,{style:a,start:t>0?"outset":"none",end:t<r.segments.length-1?"outset":"none"}),o=n.strokeDasharray,s=n.strokeDashoffset;return(0,La.jsx)("path",{strokeDasharray:o,strokeDashoffset:s,d:e.path,fill:"none"},t)}))})]})}if("draw"===a){var p=r.points,h=l(Gs(e.id,p,i),2),v=h[0],g=h[1];return(0,La.jsxs)(Ef,{id:e.id,children:[(0,La.jsx)(Tf,{d:v,fill:"none",color:s}),(0,La.jsx)("path",{d:g,stroke:t[s].solid,strokeWidth:i,fill:"none"})]})}}if("cubic"===e.props.spline){var m=r.path;if("solid"===a||"draw"===a&&n)return(0,La.jsxs)(Ef,{id:e.id,children:[(0,La.jsx)(Tf,{d:m,fill:"none",color:s}),(0,La.jsx)("path",{strokeWidth:i,stroke:t[s].solid,fill:"none",d:m})]});if("dashed"===a||"dotted"===a)return(0,La.jsxs)(Ef,{id:e.id,children:[(0,La.jsx)(Tf,{d:m,fill:"none",color:s}),(0,La.jsx)("g",{stroke:t[s].solid,strokeWidth:i,children:r.segments.map((function(e,t){var n=Cf(e.length,i,{style:a,start:t>0?"outset":"none",end:t<r.segments.length-1?"outset":"none"}),o=n.strokeDasharray,s=n.strokeDashoffset;return(0,La.jsx)("path",{strokeDasharray:o,strokeDashoffset:s,d:e.path,fill:"none"},t)}))})]});if("draw"===a)return(0,La.jsxs)(Ef,{id:e.id,children:[(0,La.jsx)(Tf,{d:m,fill:"none",color:s}),(0,La.jsx)("path",{d:Ah(0,r,i),strokeWidth:1,stroke:t[s].solid,fill:t[s].solid})]})}}},{key:"indicator",value:function(e){var t,n=Xc[e.props.size],r=Nh(e),i=e.props.dash;if("line"===e.props.spline){var o=r.points;if("solid"===i||"dotted"===i||"dashed"===i)t="M"+o[0]+"L"+o.slice(1);else t=l(Gs(e.id,o,n),1)[0]}else t=function(e,t,n){return"draw"===e.props.dash?mu(jh(0,t,n)):t.path}(e,r,n);return(0,La.jsx)("path",{d:t})}},{key:"toSvg",value:function(e){var t=Ji(this.editor)[e.props.color].solid;return Oh(e,Nh(e),t,Xc[e.props.size])}}]),n}(Rc);function Nh(e){return Lh.get(e.props,(function(){var t=e.props,n=t.spline,r=t.handles,i=Object.values(r).sort(M).map(Ya.From);switch(n){case"cubic":return new Ps(i,2===i.length?2:1.2,20);case"line":return new Is(i)}}))}D(Dh,"type","line");var Rh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeId",""),D(_t(e),"onEnter",(function(t){e.shapeId=t.shapeId,e.editor.setCursor({type:"cross"})})),D(_t(e),"onPointerDown",(function(){e.parent.transition("pointing",{shapeId:e.shapeId})})),D(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return z(n)}(_f);D(Rh,"id","idle");var Bh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shape",{}),D(_t(e),"markPointId",""),D(_t(e),"onEnter",(function(t){var n=e.editor.inputs,r=n.currentPagePoint;e.markPointId=e.editor.mark("creating");var i=!1;if(t.shapeId){var o=e.editor.getShapeById(t.shapeId);o&&(i=!0,e.shape=o)}if(n.shiftKey&&i){var a=e.editor.getHandles(e.shape);if(!a)return;var s,u,l,c=a.filter((function(e){return"vertex"===e.type})).sort(M),d=c[c.length-1],f=Cs.applyToPoint(e.editor.getParentTransform(e.shape),new Ya(e.shape.x,e.shape.y));2===c.length&&1===c[1].x&&1===c[1].y?(s=c[1].index,u=c[1].id,l=Ce(Ce({},c[1]),{},{x:r.x-f.x,y:r.y-f.y})):(u="handle:"+(s=I(d.index)),l={x:r.x-f.x,y:r.y-f.y,index:s,canBind:!1,type:"vertex",id:u});var p=it(e.shape.props.handles);p[l.id]=l,e.editor.updateShapes([{id:e.shape.id,type:e.shape.type,props:{handles:p}}])}else{var h=Vi();e.editor.createShapes([{id:h,type:"line",x:r.x,y:r.y}]),e.editor.select(h),e.shape=e.editor.getShapeById(h)}})),D(_t(e),"onPointerMove",(function(){if(e.shape&&e.editor.inputs.isDragging){var t=e.editor.getHandles(e.shape);if(!t)throw e.editor.bailToMark("creating"),Error("No handles found");e.editor.setSelectedTool("select.dragging_handle",{shape:e.shape,isCreating:!0,handle:Me(t),onInteractionEnd:"line"})}})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onInterrupt",(function(){e.parent.transition("idle",{}),e.editor.bailToMark("creating"),e.editor.snaps.clear()})),e}return z(n,[{key:"complete",value:function(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}},{key:"cancel",value:function(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}}]),n}(_f);D(Bh,"id","pointing");var Fh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Dh),e}return z(n)}(_f);D(Fh,"id","line"),D(Fh,"initial","idle"),D(Fh,"children",(function(){return[Rh,Bh]}));var Uh=kf("line",{util:Dh,props:ha,migrations:va,tool:Fh}),Kh=200,Vh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"canEdit",(function(){return!0})),D(_t(e),"hideResizeHandles",(function(){return!0})),D(_t(e),"hideSelectionBoundsBg",(function(){return!0})),D(_t(e),"hideSelectionBoundsFg",(function(){return!0})),D(_t(e),"onBeforeCreate",(function(t){return Wh(e.editor,t,t.props.growY)})),D(_t(e),"onBeforeUpdate",(function(t,n){if(t.props.text!==n.props.text||t.props.font!==n.props.font||t.props.size!==n.props.size)return Wh(e.editor,n,t.props.growY)})),D(_t(e),"onEditEnd",(function(t){var n=t.id,r=t.type,i=t.props.text;i.trimEnd()!==t.props.text&&e.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])})),e}return z(n,[{key:"getDefaultProps",value:function(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}},{key:"getHeight",value:function(e){return Kh+e.props.growY}},{key:"getBounds",value:function(e){var t=this.getHeight(e);return new ws(0,0,Kh,t)}},{key:"getOutline",value:function(e){return this.editor.getBounds(e).corners}},{key:"getCenter",value:function(e){return new Ya(100,this.getHeight(e)/2)}},{key:"component",value:function(e){var t=e.id,n=e.type,r=e.props,i=r.color,o=r.font,a=r.size,s=r.align,u=r.text,l=r.verticalAlign,c=If(),d="black"===i?"yellow":i;return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("div",{style:{position:"absolute",width:Kh,height:this.getHeight(e)},children:(0,La.jsxs)("div",{className:"tl-note__container tl-hitarea-fill",style:{color:c[d].solid,backgroundColor:c[d].solid},children:[(0,La.jsx)("div",{className:"tl-note__scrim"}),(0,La.jsx)(qp,{id:t,type:n,font:o,size:a,align:s,verticalAlign:l,text:u,labelColor:"black",wrap:!0})]})}),"url"in e.props&&e.props.url&&(0,La.jsx)(cp,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}},{key:"indicator",value:function(e){return(0,La.jsx)("rect",{rx:"7",width:ms(Kh),height:ms(this.getHeight(e))})}},{key:"toSvg",value:function(e,t){t.addExportDef(Zc(e.props.font));var n=Ji(this.editor),r=this.getBounds(e),i=document.createElementNS("http://www.w3.org/2000/svg","g"),o="black"===e.props.color?"yellow":e.props.color,a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("rx","10"),a.setAttribute("width",Kh.toString()),a.setAttribute("height",r.height.toString()),a.setAttribute("fill",n[o].solid),a.setAttribute("stroke",n[o].solid),a.setAttribute("stroke-width","1"),i.appendChild(a);var s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("rx","10"),s.setAttribute("width",Kh.toString()),s.setAttribute("height",r.height.toString()),s.setAttribute("fill",n.background),s.setAttribute("opacity",".28"),i.appendChild(s);var u=Xp({editor:this.editor,shape:e,font:lo[e.props.font],bounds:r});return u.setAttribute("fill",n.text),u.setAttribute("stroke","none"),i.appendChild(u),i}}]),n}(Rc);function Wh(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.textMeasure.measureText(t.props.text,Ce(Ce({},Yc),{},{fontFamily:Qc[t.props.font],fontSize:$c[t.props.size],width:"166px"})).h+34,i=null;if(r>Kh?i=r-Kh:n&&(i=0),null!==i)return Ce(Ce({},t),{},{props:Ce(Ce({},t.props),{},{growY:i})})}D(Vh,"type","note");var Hh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),D(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),D(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return z(n)}(_f);D(Hh,"id","idle");var Yh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"dragged",!1),D(_t(e),"info",{}),D(_t(e),"wasFocusedOnEnter",!1),D(_t(e),"markPointId","creating"),D(_t(e),"onEnter",(function(){e.wasFocusedOnEnter=!e.editor.isMenuOpen})),D(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){e.editor.mark(e.markPointId);var n=e.createShape();if(!n)return;e.editor.setSelectedTool("select.translating",Ce(Ce({},t),{},{target:"shape",shape:n,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"}))}})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),e}return z(n,[{key:"complete",value:function(){if(this.wasFocusedOnEnter){this.editor.mark(this.markPointId);var e=this.createShape();if(this.editor.instanceState.isToolLocked)this.parent.transition("idle",{});else{if(!e)return;this.editor.setEditingId(e.id),this.editor.setSelectedTool("select.editing_shape",Ce(Ce({},this.info),{},{target:"shape",shape:e}))}}}},{key:"cancel",value:function(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",this.info)}},{key:"createShape",value:function(){var e=this.editor.inputs.originPagePoint,t=Vi();this.editor.createShapes([{id:t,type:"note",x:e.x,y:e.y}],!0);var n=this.editor.getShapeById(t),r=this.editor.getBounds(n);return this.editor.updateShapes([{id:t,type:"note",x:n.x-r.width/2,y:n.y-r.height/2}]),this.editor.getShapeById(t)}}]),n}(_f);D(Yh,"id","pointing");var Xh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",Vh),e}return z(n)}(_f);D(Xh,"id","note"),D(Xh,"initial","idle"),D(Xh,"children",(function(){return[Hh,Yh]}));var qh=kf("note",{util:Vh,props:ya,migrations:ka,tool:Xh}),$h=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerEnter",(function(t){switch(t.target){case"canvas":break;case"shape":var n=e.editor,r=n.selectedIds,i=n.focusLayerId,o=e.editor.getOutermostSelectableShape(t.shape,(function(e){return!r.includes(e.id)}));o.id!==i&&e.editor.isShapeOfType(o,pd)&&e.editor.setHoveredId(o.id)}})),D(_t(e),"onPointerLeave",(function(t){if("shape"===t.target)e.editor.setHoveredId(null)})),D(_t(e),"onPointerDown",(function(t){var n=e.editor.hoveredId;if(n){var r=e.editor.getShapeById(n);if(e.editor.isShapeOfType(r,pd))return void requestAnimationFrame((function(){e.editor.setSelectedIds([r.id]),e.editor.setEditingId(r.id),e.editor.setSelectedTool("select.editing_shape",Ce(Ce({},t),{},{target:"shape",shape:r}))}))}e.parent.transition("pointing",t)})),D(_t(e),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),D(_t(e),"onKeyDown",(function(t){if("Enter"===t.key){var n=e.editor.selectedShapes[0];n&&e.editor.isShapeOfType(n,dh)&&(e.editor.setSelectedTool("select"),e.editor.setEditingId(n.id),e.editor.root.current.value.transition("editing_shape",Ce(Ce({},t),{},{target:"shape",shape:n})))}})),D(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return z(n)}(_f);D($h,"id","idle");var Gh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shape",void 0),D(_t(e),"onExit",(function(){e.editor.setHintingIds([])})),D(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){var n=e.editor.inputs.originPagePoint,r=Vi();if(e.editor.mark("creating"),e.editor.createShapes([{id:r,type:"text",x:n.x,y:n.y,props:{text:"",autoSize:!1,w:20}}]),e.editor.select(r),e.shape=e.editor.getShapeById(r),!e.shape)return;e.editor.setSelectedTool("select.resizing",Ce(Ce({},t),{},{target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"}))}})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.cancel()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"complete",value:function(){var e;this.editor.mark("creating text shape");var t=Vi(),n=this.editor.inputs.currentPagePoint,r=n.x,i=n.y;this.editor.createShapes([{id:t,type:"text",x:r,y:i,props:{text:"",autoSize:!0}}],!0),this.editor.setEditingId(t),this.editor.setSelectedTool("select"),null===(e=this.editor.root.current.value)||void 0===e||e.transition("editing_shape",{})}},{key:"cancel",value:function(){this.parent.transition("idle",{}),this.editor.bailToMark("creating")}}]),n}(_f);D(Gh,"id","pointing");var Qh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeType",pd),e}return z(n)}(_f);D(Qh,"id","text"),D(Qh,"initial","idle"),D(Qh,"children",(function(){return[$h,Gh]}));var Zh=kf("text",{util:pd,props:Sa,migrations:Pa,tool:Qh}),Jh=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"canEdit",(function(){return!0})),D(_t(e),"isAspectRatioLocked",(function(){return!0})),e}return z(n,[{key:"getDefaultProps",value:function(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}},{key:"component",value:function(e){return(0,La.jsx)(tv,{shape:e,videoUtil:this})}},{key:"indicator",value:function(e){return(0,La.jsx)("rect",{width:ms(e.props.w),height:ms(e.props.h)})}},{key:"toSvg",value:function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g"),n=document.createElementNS("http://www.w3.org/2000/svg","image");return n.setAttributeNS("http://www.w3.org/1999/xlink","href",function(e){var t=e.split(":")[1],n=document.querySelector(".tl-video-shape-".concat(t));if(n){var r=document.createElement("canvas");return r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0),r.toDataURL("image/png")}throw new Error("Video with id "+t+" not found")}(e.id)),n.setAttribute("width",e.props.w.toString()),n.setAttribute("height",e.props.h.toString()),t.appendChild(n),t}}]),n}(Fc);D(Jh,"type","video");var ev,tv=ke((function(e){var n=e.shape,r=e.videoUtil,i=r.editor.getBounds(n).w*r.editor.zoomLevel>=110,o=n.props.assetId?r.editor.getAssetById(n.props.assetId):null,a=n.props,s=a.w,u=a.h,c=a.time,d=a.playing,f=Oc(n.id),p=cu(),h=t.useRef(null),v=t.useCallback((function(e){var t=e.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!0,time:t.currentTime}}])}),[n.id,r.editor]),g=t.useCallback((function(e){var t=e.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!1,time:t.currentTime}}])}),[n.id,r.editor]),m=t.useCallback((function(e){var t=e.currentTarget;f&&r.editor.updateShapes([{type:"video",id:n.id,props:{time:t.currentTime}}])}),[f,n.id,r.editor]),y=l(t.useState(!1),2),b=y[0],w=y[1],x=t.useCallback((function(e){var t=e.currentTarget;c!==t.currentTime&&(t.currentTime=c),d||t.pause(),w(!0)}),[d,c]);return t.useEffect((function(){var e=h.current;e&&b&&!f&&c!==e.currentTime&&(e.currentTime=c)}),[f,b,c]),t.useEffect((function(){if(p){var e=h.current;e.pause(),e.currentTime=0}}),[h,p]),(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Ac,{id:n.id,children:(0,La.jsx)("div",{className:"tl-counter-scaled",children:null!==o&&void 0!==o&&o.props.src?(0,La.jsx)("video",{ref:h,className:"tl-video tl-video-shape-".concat(n.id.split(":")[1]," tl-hitarea-stroke"),width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:f&&i,onPlay:v,onPause:g,onTimeUpdate:m,onLoadedData:x,hidden:!b,children:(0,La.jsx)("source",{src:o.props.src})}):(0,La.jsx)("g",{transform:"translate(".concat((s-38)/2,", ").concat((u-38)/2,")"),children:(0,La.jsx)($u,{})})})}),"url"in n.props&&n.props.url&&(0,La.jsx)(cp,{url:n.props.url,zoomLevel:r.editor.zoomLevel})]})})),nv=kf("video",{util:Jh,props:Ca,migrations:Ta}),rv=[yh,Dp,vp,Ih,Zh],iv=[zp,mh,Uh,qh,Yp,up,wh,nv],ov=new Set(rv.map((function(e){return e.type})));function av(e){var t,n=[].concat(rv),r=new Set,i=J(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(ov.has(o.type))throw new Error('Shape type "'.concat(o.type,'" is a core shapes type and cannot be overridden'));if(r.has(o.type))throw new Error('Shape type "'.concat(o.type,'" is defined more than once'));n.push(o),r.add(o.type)}}catch(a){i.e(a)}finally{i.f()}return n}function sv(e,t){if(!t)return!1;switch(e.type){case"mixed":return"mixed"===t.type;case"shared":return"shared"===t.type&&e.value===t.value;default:throw Oe(e)}}ev=Symbol.iterator;var uv=function(e){Et(n,e);var t=Tt(n);function n(){return j(this,n),t.apply(this,arguments)}return z(n,[{key:"set",value:function(e,t){this.map.set(e,t)}},{key:"applyValue",value:function(e,t){var n=this.get(e);if(n)switch(n.type){case"mixed":return;case"shared":return void(n.value!==t&&this.set(e,{type:"mixed"}));default:Oe(n,"type")}else this.set(e,{type:"shared",value:t})}}]),n}(function(){function e(t){j(this,e),D(this,"map",void 0),this.map=new Map(t)}return z(e,[{key:"get",value:function(e){return this.map.get(e)}},{key:"getAsKnownValue",value:function(e){var t=this.get(e);if(t&&"mixed"!==t.type)return t.value}},{key:"size",get:function(){return this.map.size}},{key:"equals",value:function(e){if(this.size!==e.size)return!1;var t,n=new Set,r=J(this);try{for(r.s();!(t=r.n()).done;){var i=l(t.value,2),o=i[0];if(!sv(i[1],e.get(o)))return!1;n.add(o)}}catch(f){r.e(f)}finally{r.f()}var a,s=J(e);try{for(s.s();!(a=s.n()).done;){var u=l(a.value,2),c=u[0],d=u[1];if(!n.has(c)&&!sv(d,this.get(c)))return!1}}catch(f){s.e(f)}finally{s.f()}return!0}},{key:"keys",value:function(){return this.map.keys()}},{key:"values",value:function(){return this.map.values()}},{key:"entries",value:function(){return this.map.entries()}},{key:ev,value:function(){return this.map[Symbol.iterator]()}}]),e}());function lv(e,t){for(var n=0;e[t+n];)n+=e[t+n]+1;return n+1}function cv(e){var t,n,r=new Uint8Array(e),i=0,o=0;if(!function(e){return"GIF"===new TextDecoder("ascii").decode(e.slice(0,3))}(e))return!1;for(t=128&r[10],n=7&r[10],i+=6,i+=7,i+=t?3*Math.pow(2,n+1):0;o<2&&i<r.length;)switch(r[i]){case 44:o+=1,t=128&r[i+9],n=7&r[i+9],i+=10,i+=t?3*Math.pow(2,n+1):0,i+=lv(r,i+1)+1;break;case 33:i+=2,i+=lv(r,i);break;default:i=r.length}return o>1}var dv=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!==typeof Int32Array&&(dv=new Int32Array(dv));var fv=function(e,t){for(var n=0===t?0:-1^~~t,r=0;r<e.length;r++)n=dv[255&(n^e[r])]^n>>>8;return-1^n};function pv(e,t){return 137===e.getUint8(t+0)&&80===e.getUint8(t+1)&&78===e.getUint8(t+2)&&71===e.getUint8(t+3)&&13===e.getUint8(t+4)&&10===e.getUint8(t+5)&&26===e.getUint8(t+6)&&10===e.getUint8(t+7)}function hv(e,t){return[String.fromCharCode(e.getUint8(t)),String.fromCharCode(e.getUint8(t+1)),String.fromCharCode(e.getUint8(t+2)),String.fromCharCode(e.getUint8(t+3))].join("")}var vv=4,gv=4;function mv(e,t){return{ppux:e.getUint32(t),ppuy:e.getUint32(t+4),unit:e.getUint8(t+4)}}function yv(e,t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={};if(!pv(e,t))throw new Error("Not a PNG");for(t+=8;t<=e.buffer.byteLength;){var r=t,i=e.getInt32(t),o=hv(e,t+=4);if("IDAT"===o&&n[o])t+=i+vv+gv;else{if("IEND"===o)break;n[o]={start:r,dataOffset:t+4,size:i},t+=i+vv+gv}}return n}(e);return n[t]}function bv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=46,i=0,o=yv(e,"pHYs");o&&(r=o.start,i=o.size);var a=yv(e,"IDAT");a&&(r=a.start,i=0);var s=new ArrayBuffer(21),u=new DataView(s);u.setUint32(0,9),u.setUint8(4,"p".charCodeAt(0)),u.setUint8(5,"H".charCodeAt(0)),u.setUint8(6,"Y".charCodeAt(0)),u.setUint8(7,"s".charCodeAt(0));var l=2835.5;u.setInt32(8,l*t),u.setInt32(12,l*t),u.setInt8(16,1);var c=new Uint8Array(s.slice(4,17));u.setInt32(17,fv(c));var d=e.buffer.slice(0,r),f=e.buffer.slice(r+i);return new Blob([d,s,f],n)}var wv=["image/jpeg","image/png","image/gif","image/svg+xml"],xv=["video/mp4","video/quicktime"],kv=wv.concat(xv).join(", "),Sv=function(e){return wv.includes(e)};function _v(e){return Pv.apply(this,arguments)}function Pv(){return Pv=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var r=document.createElement("video");r.onloadeddata=function(){return e({w:r.videoWidth,h:r.videoHeight})},r.onerror=function(e){console.error(e),n(new Error("Could not get video size"))},r.crossOrigin="anonymous",r.src=t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Pv.apply(this,arguments)}function Ev(e){return Cv.apply(this,arguments)}function Cv(){return(Cv=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t).then((function(e){return e.arrayBuffer()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Iv(e){return Tv.apply(this,arguments)}function Tv(){return(Tv=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var r=new Image;r.onload=Ba(Na().mark((function n(){var i,o,a,s,u;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ev(t);case 3:if(i=n.sent,!pv(o=new DataView(i),0)){n.next=13;break}if(!(a=yv(o,"pHYs"))){n.next=13;break}if(0!==(s=mv(o,a.dataOffset)).unit||s.ppux!==s.ppuy){n.next=13;break}return u=Math.round(s.ppux/2834.5),e({w:r.width/u,h:r.height/u}),n.abrupt("return");case 13:e({w:r.width,h:r.height}),n.next=20;break;case 16:n.prev=16,n.t0=n.catch(0),console.error(n.t0),e({w:r.width,h:r.height});case 20:case"end":return n.stop()}}),n,null,[[0,16]])}))),r.onerror=function(e){console.error(e),n(new Error("Could not get image size"))},r.crossOrigin="anonymous",r.src=t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mv(e,t,n){return jv.apply(this,arguments)}function jv(){return(jv=Ba(Na().mark((function e(t,n,r){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var i=new Image;i.onload=function(){var t=document.createElement("canvas"),o=t.getContext("2d");if(o){t.width=2*n,t.height=2*r,o.drawImage(i,0,0,t.width,t.height);var a=t.toDataURL();e(a)}},i.crossOrigin="anonymous",i.src=t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Av(e){return Ov.apply(this,arguments)}function Ov(){return(Ov=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("image/gif"!==t.type){e.next=4;break}return e.next=3,new Promise((function(e,n){var r=new FileReader;r.onerror=function(){return n(r.error)},r.onload=function(){e({isAnimated:!!r.result&&cv(r.result)})},r.readAsArrayBuffer(t)}));case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",{isAnimated:!Sv(t.type)});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Lv(e,t){var n=e.w/t.w,r=e.h/t.h;return n<=1&&r<=1?e:n>r?{w:e.w/n,h:e.h/n}:{w:e.w/r,h:e.h/r}}function zv(e,t,n){return fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){return new File([e],t,{type:n})}))}function Dv(e){var t=e.editor,n=t.selectionRotation,r=t.selectionPageCenter,i=t.inputs.originPagePoint,o=t.selectedShapes;return r?{selectionPageCenter:r,initialCursorAngle:r.angle(i),initialSelectionRotation:n,shapeSnapshots:o.map((function(e){return{shape:it(e),initialPagePoint:t.getPagePointById(e.id)}}))}:null}function Nv(e){var t=e.delta,n=e.editor,r=e.snapshot,i=e.stage,o=r.selectionPageCenter,a=r.shapeSnapshots;n.updateShapes(a.map((function(e){var r=e.shape,i=e.initialPagePoint,a=Ki(r.parentId)?n.getPageTransformById(r.parentId):Cs.Identity(),s=Ya.RotWith(i,o,t),u=Cs.applyToPoint(Cs.Inverse(a),s),l=rs(r.rotation+t);return{id:r.id,type:r.type,x:u.x,y:u.y,rotation:l}})));var s=[];a.forEach((function(e){var t,r=e.shape,o=n.getShapeById(r.id);if(o){var a=n.getShapeUtil(r);if("start"===i||"one-off"===i){var u,l=null===(u=a.onRotateStart)||void 0===u?void 0:u.call(a,r);l&&s.push(l)}var c=null===(t=a.onRotate)||void 0===t?void 0:t.call(a,r,o);if(c&&s.push(c),"end"===i||"one-off"===i){var d,f=null===(d=a.onRotateEnd)||void 0===d?void 0:d.call(a,r,o);f&&s.push(f)}}})),s.length>0&&n.updateShapes(s)}var Rv,Bv,Fv=function(e,t,n){for(;!Nn(n.parentId);){var r=e.get(n.parentId);if(!r)return!1;n=r}return n.parentId===t},Uv=function(){function e(t){var n=this;j(this,e),D(this,"_clickId",""),D(this,"_clickTimeout",void 0),D(this,"_clickScreenPoint",void 0),D(this,"_previousScreenPoint",void 0),D(this,"_getClickTimeout",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ef();n._clickId=t,clearTimeout(n._clickTimeout),n._clickTimeout=setTimeout((function(){if(n._clickState===e&&n._clickId===t){switch(n._clickState){case"pendingTriple":n.editor.dispatch(Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"double_click",phase:"settle"}));break;case"pendingQuadruple":n.editor.dispatch(Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"triple_click",phase:"settle"}));break;case"pendingOverflow":n.editor.dispatch(Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"quadruple_click",phase:"settle"}))}n._clickState="idle"}}),"idle"===e||"pendingDouble"===e?450:200)})),D(this,"_clickState","idle"),D(this,"lastPointerInfo",{}),D(this,"transformPointerDownEvent",(function(e){if(!n._clickState)return e;switch(n._clickScreenPoint=Ya.From(e.point),n._previousScreenPoint&&n._previousScreenPoint.dist(n._clickScreenPoint)>40&&(n._clickState="idle"),n._previousScreenPoint=n._clickScreenPoint,n.lastPointerInfo=e,n._clickState){case"idle":return n._clickState="pendingDouble",n._clickTimeout=n._getClickTimeout(n._clickState),e;case"pendingDouble":return n._clickState="pendingTriple",n._clickTimeout=n._getClickTimeout(n._clickState),Ce(Ce({},e),{},{type:"click",name:"double_click",phase:"down"});case"pendingTriple":return n._clickState="pendingQuadruple",n._clickTimeout=n._getClickTimeout(n._clickState),Ce(Ce({},e),{},{type:"click",name:"triple_click",phase:"down"});case"pendingQuadruple":return n._clickState="pendingOverflow",n._clickTimeout=n._getClickTimeout(n._clickState),Ce(Ce({},e),{},{type:"click",name:"quadruple_click",phase:"down"});case"pendingOverflow":return n._clickState="overflow",n._clickTimeout=n._getClickTimeout(n._clickState),e;default:return n._clickTimeout=n._getClickTimeout(n._clickState),e}})),D(this,"transformPointerUpEvent",(function(e){if(!n._clickState)return e;switch(n._clickScreenPoint=Ya.From(e.point),n._clickState){case"pendingTriple":return Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"double_click",phase:"up"});case"pendingQuadruple":return Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"triple_click",phase:"up"});case"pendingOverflow":return Ce(Ce({},n.lastPointerInfo),{},{type:"click",name:"quadruple_click",phase:"up"});default:return e}})),D(this,"cancelDoubleClickTimeout",(function(){n._clickTimeout=clearTimeout(n._clickTimeout),n._clickState="idle"})),D(this,"handleMove",(function(){"idle"!==n._clickState&&n._clickScreenPoint&&n._clickScreenPoint.dist(n.editor.inputs.currentScreenPoint)>(n.editor.isCoarsePointer?6:4)&&n.cancelDoubleClickTimeout()})),this.editor=t}return z(e,[{key:"clickState",get:function(){return this._clickState}}]),e}(),Kv=function(){function e(t){var n=this;j(this,e),D(this,"handleContent",function(){var e=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="text"===e.t0?3:"files"===e.t0?6:"embed"===e.t0?9:"svg-text"===e.t0?12:"url"===e.t0?15:18;break;case 3:return e.next=5,n.handleText(n.editor,t);case 5:case 8:case 11:case 14:case 17:return e.abrupt("return",e.sent);case 6:return e.next=8,n.handleFiles(n.editor,t);case 9:return e.next=11,n.handleEmbed(n.editor,t);case 12:return e.next=14,n.handleSvgText(n.editor,t);case 15:return e.next=17,n.handleUrl(n.editor,t);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),D(this,"handleUrl",function(){var e=Ba(Na().mark((function e(t,r){var i,o,a,s,u,l,c;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.point,o=r.url,!(a=Nc(o))){e.next=4;break}return e.abrupt("return",n.handleEmbed(t,{type:"embed",url:a.url,point:i,embed:a.definition}));case 4:if(s=null!==i&&void 0!==i?i:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,u=Mi.createId(Be(o)),l=t.getAssetById(u),c=!1,l){e.next=13;break}return c=!0,e.next=12,n.createAssetFromUrl(t,o);case 12:l=e.sent;case 13:t.batch((function(){c&&t.createAssets([l]),n.createShapesForAssets(t,[l],s)}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.editor=t}return z(e,[{key:"handleSvgText",value:function(){var e=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.point,i=n.text,o=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,a=(new DOMParser).parseFromString(i,"image/svg+xml").querySelector("svg")){e.next=5;break}throw new Error("No <svg/> element present");case 5:return s=parseFloat(a.getAttribute("width")||"0"),u=parseFloat(a.getAttribute("height")||"0"),s&&u||(document.body.appendChild(a),l=a.getBoundingClientRect(),document.body.removeChild(a),s=l.width,u=l.height),e.next=10,this.createAssetFromFile(t,new File([i],"asset.svg",{type:"image/svg+xml"}));case 10:c=e.sent,this.createShapesForAssets(t,[c],o);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleEmbed",value:function(){var e=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.point,i=n.url,o=n.embed,a=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,s=o.width,u=o.height,l={id:Vi(),type:"embed",x:a.x-(s||450)/2,y:a.y-(u||450)/2,props:{w:s,h:u,url:i}},t.createShapes([l],!0);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleFiles",value:function(){var e=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u=this;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.point,i=n.files,o=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,a=new Ya(o.x,o.y),s=[],e.next=6,Promise.all(i.map(function(){var e=Ba(Na().mark((function e(n,r){var i;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.type){e.next=2;break}throw new Error("No mime type");case 2:if(wv.concat(xv).includes(n.type)){e.next=5;break}return console.warn("".concat(n.name," not loaded - Extension not allowed.")),e.abrupt("return",null);case 5:return e.prev=5,e.next=8,u.createAssetFromFile(t,n);case 8:if(i=e.sent){e.next=11;break}throw Error("Could not create an asset");case 11:s[r]=i,e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(5),console.error(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t,n){return e.apply(this,arguments)}}()));case 6:this.createShapesForAssets(t,Te(s),a);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleText",value:function(){var e=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.point,i=n.text,o=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter,a=t.getShapeUtil(pd).getDefaultProps(),s=Yv(Hv(Wv(i))),d="middle",f=s.split("\n").length>1,p=Vv.test(s),f&&(d=f?p?"end":"start":"middle"),h=t.textMeasure.measureText(s,Ce(Ce({},Yc),{},{fontFamily:Qc[a.font],fontSize:qc[a.size],width:"fit-content"})),v=Math.min(f?.9*t.viewportPageBounds.width:920,Math.max(200,.9*t.viewportPageBounds.width)),h.w>v?(g=t.textMeasure.measureText(s,Ce(Ce({},Yc),{},{fontFamily:Qc[a.font],fontSize:qc[a.size],width:v+"px"})),u=g.w,l=g.h,c=!1,d=p?"end":"start"):(u=h.w,l=h.h,c=!0),o.y-l/2<t.viewportPageBounds.minY+40&&(o.y=t.viewportPageBounds.minY+40+l/2),t.createShapes([{id:Vi(),type:"text",x:o.x-u/2,y:o.y-l/2,props:{text:s,align:d,autoSize:c,w:u}}]);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createShapesForAssets",value:function(){var e=Ba(Na().mark((function e(t,n,r){var i,o,a,s,u;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.length){e.next=2;break}return e.abrupt("return");case 2:i=Ya.From(r),o=[],a=J(n),e.prev=5,a.s();case 7:if((s=a.n()).done){e.next=22;break}u=s.value,e.t0=u.type,e.next="bookmark"===e.t0?12:"image"===e.t0?15:"video"===e.t0?18:20;break;case 12:return o.push({id:Vi(),type:"bookmark",x:i.x-150,y:i.y-160,opacity:1,props:{assetId:u.id,url:u.props.src}}),i.x+=300,e.abrupt("break",20);case 15:return o.push({id:Vi(),type:"image",x:i.x-u.props.w/2,y:i.y-u.props.h/2,opacity:1,props:{assetId:u.id,w:u.props.w,h:u.props.h}}),i.x+=u.props.w,e.abrupt("break",20);case 18:o.push({id:Vi(),type:"video",x:i.x-u.props.w/2,y:i.y-u.props.h/2,opacity:1,props:{assetId:u.id,w:u.props.w,h:u.props.h}}),i.x+=u.props.w;case 20:e.next=7;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(5),a.e(e.t1);case 27:return e.prev=27,a.f(),e.finish(27);case 30:t.batch((function(){var e=n.filter((function(e){return!t.getAssetById(e.id)}));e.length&&t.createAssets(e),t.createShapes(o,!0);var i=t.viewportPageBounds,a=t.selectedPageBounds;if(a){var s=a.center.sub(r);t.updateShapes(o.map((function(e){return{id:e.id,type:e.type,x:e.x-s.x,y:e.y-s.y}})))}(a=t.selectedPageBounds)&&!i.contains(a)&&t.zoomToSelection()}));case 31:case"end":return e.stop()}}),e,null,[[5,24,27,30]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createAssetFromFile",value:function(){var e=Ba(Na().mark((function e(t,n){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var r=new FileReader;r.onerror=function(){return t(r.error)},r.onload=Ba(Na().mark((function t(){var i,o,a,s,u,l,c,d;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.result,o=Sv(n.type),a=o?Iv:_v,"video/quicktime"===n.type&&i.includes("video/quicktime")&&(i=i.replace("video/quicktime","video/mp4")),t.next=6,a(i);case 6:if(s=t.sent,(u=Lv(s,{w:1e3,h:1e3}))===s||"image/jpeg"!==n.type&&"image/png"!==n.type){t.next=12;break}return t.next=11,Mv(i,u.w,u.h);case 11:i=t.sent;case 12:return l=Mi.createId(Be(i)),t.next=15,Av(n);case 15:c=t.sent,d={id:l,type:o?"image":"video",typeName:"asset",props:{name:n.name,src:i,w:u.w,h:u.h,mimeType:n.type,isAnimated:c.isAnimated},meta:{}},e(d);case 18:case"end":return t.stop()}}),t)}))),r.readAsDataURL(n)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createAssetFromUrl",value:function(){var e=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n,{method:"GET",mode:"no-cors"});case 3:return c=e.sent,e.next=6,c.text();case 6:d=e.sent,f=(new DOMParser).parseFromString(d,"text/html"),r={image:null!==(i=null===(o=f.head.querySelector('meta[property="og:image"]'))||void 0===o?void 0:o.getAttribute("content"))&&void 0!==i?i:"",title:null!==(a=null===(s=f.head.querySelector('meta[property="og:title"]'))||void 0===s?void 0:s.getAttribute("content"))&&void 0!==a?a:du(n,32),description:null!==(u=null===(l=f.head.querySelector('meta[property="og:description"]'))||void 0===l?void 0:l.getAttribute("content"))&&void 0!==u?u:""},e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),r={image:"",title:du(n,32),description:""};case 15:return e.abrupt("return",{id:Mi.createId(Be(n)),typeName:"asset",type:"bookmark",props:{src:n,description:r.description,image:r.image,title:r.title},meta:{}});case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),Vv=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function Wv(e){return e.replace(/\t/g,ud)}function Hv(e){for(var t=e.split("\n");0===t[0].trim().length;)t.shift();var n,r=1/0,i=J(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.trim().length>0){var a=o.length-o.trimStart().length;r=Math.min(r,a)}}}catch(s){i.e(s)}finally{i.f()}return t.map((function(e){return e.slice(r)})).join("\n")}function Yv(e){return e.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function Xv(e){if(e){for(var t=qv;e.length;)t=t.push(e.pop());return t}return qv}Rv=Symbol.iterator;var qv=new(function(){function e(){j(this,e),D(this,"length",0),D(this,"head",null),D(this,"tail",this)}return z(e,[{key:"push",value:function(e){return new $v(e,this)}},{key:"toArray",value:function(){return V}},{key:Rv,value:function(){return{next:function(){return{value:void 0,done:!0}}}}}]),e}());Bv=Symbol.iterator;var $v=function(){function e(t,n){j(this,e),D(this,"length",void 0),this.head=t,this.tail=n,this.length=n.length+1}return z(e,[{key:"push",value:function(t){return new e(t,this)}},{key:"toArray",value:function(){return Array.from(this)}},{key:Bv,value:function(){var e=this;return{next:function(){if(e.length){var t=e.head;return e=e.tail,{value:t,done:!1}}return{value:void 0,done:!0}}}}}]),e}(),Gv=function(){function e(t,n,r){var i=this;j(this,e),D(this,"_undos",ue("HistoryManager.undos",Xv())),D(this,"_redos",ue("HistoryManager.redos",Xv())),D(this,"_batchDepth",0),D(this,"_commands",{}),D(this,"createCommand",(function(e,t,n){if(i._commands[e])throw new Error("Duplicate command: ".concat(e));i._commands[e]=n;return function r(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];if(!i._batchDepth)return i.batch((function(){return r.apply(void 0,a)})),i.ctx;var u=t.apply(void 0,a);if(!u)return i.ctx;var l=u.data,c=u.ephemeral,d=u.squashing,f=u.preservesRedoStack;if(i.ignoringUpdates((function(e,t){return n.do(l),{undos:e,redos:t}})),!c){var p=i._undos.value.head;d&&p&&"command"===p.type&&p.name===e&&p.preservesRedoStack===f?i._undos.update((function(e){return e.tail.push(Ce(Ce({},p),{},{id:ef(),data:n.squash(p.data,l)}))})):i._undos.update((function(t){return t.push({type:"command",name:e,data:l,id:ef(),preservesRedoStack:f})})),u.preservesRedoStack||i._redos.set(Xv()),i.ctx.emit("change-history",{reason:"push"})}return i.ctx}})),D(this,"batch",(function(e){try{i._batchDepth++,1===i._batchDepth?ae((function(){var t,n,r=null===(t=i._undos.value.head)||void 0===t?void 0:t.id;e(),r!==(null===(n=i._undos.value.head)||void 0===n?void 0:n.id)&&i.onBatchComplete()})):e()}catch(t){throw i.annotateError(t),t}finally{i._batchDepth--}return i})),D(this,"ignoringUpdates",(function(e){var t=i._undos.value,n=i._redos.value;i._undos.set(Xv()),i._redos.set(Xv());try{var r=ae((function(){return e(t,n)}));t=r.undos,n=r.redos}finally{i._undos.set(t),i._redos.set(n)}})),D(this,"_undo",(function(e){var t=e.pushToRedoStack,n=e.toMark,r=void 0===n?void 0:n;return i.ignoringUpdates((function(e,n){if(0===e.length)return{undos:e,redos:n};for(;"STOP"===(null===(o=e.head)||void 0===o?void 0:o.type);){var o,a=e.head;if(e=e.tail,t&&(n=n.push(a)),a.id===r)return i.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:r}),{undos:e,redos:n}}if(0===e.length)return i.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:r}),{undos:e,redos:n};for(;e.head;){var s=e.head;if(e=e.tail,t&&(n=n.push(s)),"STOP"===s.type){if(s.onUndo&&(!r||s.id===r))return i.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:r}),{undos:e,redos:n}}else i._commands[s.name].undo(s.data)}return i.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:r}),{undos:e,redos:n}})),i})),D(this,"undo",(function(){return i._undo({pushToRedoStack:!0}),i})),D(this,"redo",(function(){return i.ignoringUpdates((function(e,t){if(0===t.length)return{undos:e,redos:t};for(;"STOP"===(null===(n=t.head)||void 0===n?void 0:n.type);){var n;e=e.push(t.head),t=t.tail}if(0===t.length)return i.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:t};for(;t.head;){var r=t.head;if(e=e.push(t.head),t=t.tail,"STOP"===r.type){if(r.onRedo)break}else{var o=i._commands[r.name];o.redo?o.redo(r.data):o.do(r.data)}}return i.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:t}})),i})),D(this,"bail",(function(){return i._undo({pushToRedoStack:!1}),i})),D(this,"bailToMark",(function(e){return i._undo({pushToRedoStack:!1,toMark:e}),i})),D(this,"mark",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ef(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=i._undos.value.head;return r&&"STOP"===r.type&&r.id===e&&r.onUndo===t&&r.onRedo===n?r.id:(i._undos.update((function(r){return r.push({type:"STOP",id:e,onUndo:t,onRedo:n})})),i.ctx.emit("mark-history",{id:e}),e)})),this.ctx=t,this.onBatchComplete=n,this.annotateError=r}return z(e,[{key:"numUndos",get:function(){return this._undos.value.length}},{key:"numRedos",get:function(){return this._redos.value.length}},{key:"clear",value:function(){this._undos.set(Xv()),this._redos.set(Xv())}}]),e}(),Qv=Object.defineProperty,Zv=Object.getOwnPropertyDescriptor,Jv=function(e,t,n,r){for(var i,o=r>1?void 0:r?Zv(t,n):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r?i(t,n,o):i(o))||o);return r&&o&&Qv(t,n,o),o},eg=function(e){return Math.round(e*Math.pow(10,8))/Math.pow(10,8)};function tg(e,t,n,r,i,o){if(o>20)return[];var a=e.filter((function(e){return("forward"===r?e.startNode.id===t:e.endNode.id===t)&&eg(e.length)===eg(n)&&hs(e.breadthIntersection[0],e.breadthIntersection[1],i[0],i[1])}));if(0===a.length)return[];var s,u=new Set,l=J(a);try{for(l.s();!(s=l.n()).done;){var c=s.value,f="forward"===r?c.endNode.id:c.startNode.id;u.has(f)||(u.add(f),a.push.apply(a,d(tg(e,f,n,r,hs(c.breadthIntersection[0],c.breadthIntersection[1],i[0],i[1]),o+1))))}}catch(p){l.e(p)}finally{l.f()}return a}var ng=function(){function e(t){j(this,e),D(this,"_snapLines",ue("snapLines",void 0)),this.editor=t}return z(e,[{key:"lines",get:function(){var e;return null!==(e=this._snapLines.value)&&void 0!==e?e:V}},{key:"clear",value:function(){this.lines.length&&this._snapLines.set(void 0)}},{key:"setLines",value:function(e){this._snapLines.set(e)}},{key:"snapPointsCache",get:function(){var e=this;return this.editor.store.createComputedCache("snapPoints",(function(t){var n=e.editor.getPageTransformById(t.id);if(n)return e.editor.getShapeUtil(t).snapPoints(t).map((function(e,r){var i=Cs.applyToPoint(n,e);return{x:i.x,y:i.y,id:"".concat(t.id,":").concat(r)}}))}))}},{key:"snapThreshold",get:function(){return 8/this.editor.zoomLevel}},{key:"snappableShapes",get:function(){var e,t=this.editor,n=t.selectedIds,r=t.renderingBounds,i=[];return function e(o){var a,s=J(t.getSortedChildIds(o));try{for(s.s();!(a=s.n()).done;){var u=a.value;if(!n.includes(u)){var l=t.getShapeById(u);if(l){var c=t.getShapeUtil(l);if(c.canSnap(l)){var d=t.getPageBoundsById(u);d&&r.includes(d)&&(t.isShapeOfType(l,Up)?e(u):i.push({id:u,pageBounds:d,isClosed:c.isClosed(l)}))}}}}}catch(f){s.e(f)}finally{s.f()}}(null!==(e=this.currentCommonAncestor)&&void 0!==e?e:t.currentPageId),i}},{key:"currentCommonAncestor",get:function(){return this.editor.findCommonAncestor(this.editor.selectedShapes)}},{key:"snappablePoints",get:function(){var e=this.snappableShapes,t=this.snapPointsCache,n=[];return e.forEach((function(e){var r=t.get(e.id);r&&n.push.apply(n,d(r))})),n}},{key:"visibleGaps",get:function(){for(var e,t,n=[],r=[],i=this.snappableShapes.sort((function(e,t){return e.pageBounds.minX-t.pageBounds.minX})),o=0;o<i.length;o++){e=i[o];for(var a=o+1;a<i.length;a++)t=i[a],e.pageBounds.maxX<t.pageBounds.minX&&ps(e.pageBounds.minY,e.pageBounds.maxY,t.pageBounds.minY,t.pageBounds.maxY)&&n.push({startNode:e,endNode:t,startEdge:[new Ya(e.pageBounds.maxX,e.pageBounds.minY),new Ya(e.pageBounds.maxX,e.pageBounds.maxY)],endEdge:[new Ya(t.pageBounds.minX,t.pageBounds.minY),new Ya(t.pageBounds.minX,t.pageBounds.maxY)],length:t.pageBounds.minX-e.pageBounds.maxX,breadthIntersection:hs(e.pageBounds.minY,e.pageBounds.maxY,t.pageBounds.minY,t.pageBounds.maxY)})}for(var s=i.sort((function(e,t){return e.pageBounds.minY-t.pageBounds.minY})),u=0;u<s.length;u++){e=s[u];for(var l=u+1;l<s.length;l++)t=s[l],e.pageBounds.maxY<t.pageBounds.minY&&ps(e.pageBounds.minX,e.pageBounds.maxX,t.pageBounds.minX,t.pageBounds.maxX)&&r.push({startNode:e,endNode:t,startEdge:[new Ya(e.pageBounds.minX,e.pageBounds.maxY),new Ya(e.pageBounds.maxX,e.pageBounds.maxY)],endEdge:[new Ya(t.pageBounds.minX,t.pageBounds.minY),new Ya(t.pageBounds.maxX,t.pageBounds.minY)],length:t.pageBounds.minY-e.pageBounds.maxY,breadthIntersection:hs(e.pageBounds.minX,e.pageBounds.maxX,t.pageBounds.minX,t.pageBounds.maxX)})}return{horizontal:n,vertical:r}}},{key:"snapTranslate",value:function(e){var t,n,r,i,o=e.lockedAxis,a=e.initialSelectionPageBounds,s=e.initialSelectionSnapPoints,u=e.dragDelta,l=this.snappablePoints,c=this.snapThreshold,f=a.clone().translate(u),p=s.map((function(e,t){var n=e.x,r=e.y;return{id:"selection:"+t,x:n+u.x,y:r+u.y}})),h=l,v=[],g=[],m=new Ya(c,c);this.collectPointSnaps({minOffset:m,nearestSnapsX:v,nearestSnapsY:g,otherNodeSnapPoints:h,selectionSnapPoints:p}),this.collectGapSnaps({selectionPageBounds:f,nearestSnapsX:v,nearestSnapsY:g,minOffset:m});var y=new Ya("x"===o?0:null!==(t=null===(n=v[0])||void 0===n?void 0:n.nudge)&&void 0!==t?t:0,"y"===o?0:null!==(r=null===(i=g[0])||void 0===i?void 0:i.nudge)&&void 0!==r?r:0);m.x=0,m.y=0,v.length=0,g.length=0,p.forEach((function(e){e.x+=y.x,e.y+=y.y})),f.translate(y),this.collectPointSnaps({minOffset:m,nearestSnapsX:v,nearestSnapsY:g,otherNodeSnapPoints:h,selectionSnapPoints:p}),this.collectGapSnaps({selectionPageBounds:f,nearestSnapsX:v,nearestSnapsY:g,minOffset:m});var b=this.getPointSnapLines({nearestSnapsX:v,nearestSnapsY:g}),w=this.getGapSnapLines({selectionPageBounds:f,nearestSnapsX:v,nearestSnapsY:g});return this._snapLines.set([].concat(d(w),d(b))),{nudge:y}}},{key:"outlinesInPageSpace",get:function(){var e=this;return this.snappableShapes.map((function(t){var n=t.id,r=t.isClosed,i=We(e.editor.getOutlineById(n));r&&i.push(i[0]);var o=e.editor.getPageTransformById(n);if(!o)throw Error("No page transform");return Cs.applyToPoints(o,i)}))}},{key:"getSnappingHandleDelta",value:function(e){var t,n,r,i,o,a=e.handlePoint,s=e.additionalSegments,u=this.outlinesInPageSpace,l=this.snapThreshold,c=null,f=J([].concat(d(u),d(s)));try{for(f.s();!(o=f.n()).done;)for(var p=o.value,h=0;h<p.length-1;h++)t=p[h],n=p[h+1],r=Ya.NearestPointOnLineSegment(t,n,a),i=Ya.Dist(a,r),isNaN(i)||i<l&&(l=i,c=r)}catch(v){f.e(v)}finally{f.f()}return c?(this._snapLines.set([{id:ef(),type:"points",points:[c]}]),Ya.Sub(c,a)):null}},{key:"snapResize",value:function(e){var t,n,r,i,o=e.initialSelectionPageBounds,a=e.dragDelta,s=e.handle,u=e.isAspectRatioLocked,l=e.isResizingFromCenter,c=this.snapThreshold,f=ws.Resize(o,s,l?2*a.x:a.x,l?2*a.y:a.y,u),p=f.box,h=f.scaleX,v=f.scaleY,g=s;h<0&&(g=function(e){switch(e){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return e}}(g)),v<0&&(g=function(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return e}}(g)),l&&(p.center=o.center);var m="top"===g||"bottom"===g,y="left"===g||"right"===g,b=rg(g,p),w=this.snappablePoints,x=[],k=[],S=new Ya(c,c);this.collectPointSnaps({minOffset:S,nearestSnapsX:x,nearestSnapsY:k,otherNodeSnapPoints:w,selectionSnapPoints:b});var _,P=new Ya(m?0:null!==(t=null===(n=x[0])||void 0===n?void 0:n.nudge)&&void 0!==t?t:0,y?0:null!==(r=null===(i=k[0])||void 0===i?void 0:i.nudge)&&void 0!==r?r:0);if(u&&("top_left"===(_=g)||"top_right"===_||"bottom_right"===_||"bottom_left"===_)&&0!==P.len()){var E=x.length&&k.length?Math.abs(P.x)<Math.abs(P.y)?"x":"y":x.length?"x":"y",C=o.aspectRatio;"x"===E?(k.length=0,P.y=P.x/C,"bottom_left"!==g&&"top_right"!==g||(P.y=-P.y)):(x.length=0,P.x=P.y*C,"bottom_left"!==g&&"top_right"!==g||(P.x=-P.x))}var I=Ya.Add(a,P),T=ws.Resize(o,s,l?2*I.x:I.x,l?2*I.y:I.y,u).box;l&&(T.center=o.center);var M=rg("any",T);x.length=0,k.length=0,S.x=0,S.y=0,this.collectPointSnaps({minOffset:S,nearestSnapsX:x,nearestSnapsY:k,otherNodeSnapPoints:w,selectionSnapPoints:M});var j=this.getPointSnapLines({nearestSnapsX:x,nearestSnapsY:k});return this._snapLines.set(d(j)),{nudge:P}}},{key:"collectPointSnaps",value:function(e){var t,n=e.selectionSnapPoints,r=e.otherNodeSnapPoints,i=e.minOffset,o=e.nearestSnapsX,a=e.nearestSnapsY,s=J(n);try{for(s.s();!(t=s.n()).done;){var u,l=t.value,c=J(r);try{for(c.s();!(u=c.n()).done;){var d=u.value,f=Ya.Sub(l,d),p=Math.abs(f.x),h=Math.abs(f.y);eg(p)<=eg(i.x)&&(eg(p)<eg(i.x)&&(o.length=0),o.push({type:"points",points:{thisPoint:l,otherPoint:d},nudge:d.x-l.x}),i.x=p),eg(h)<=eg(i.y)&&(eg(h)<eg(i.y)&&(a.length=0),a.push({type:"points",points:{thisPoint:l,otherPoint:d},nudge:d.y-l.y}),i.y=h)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){s.e(v)}finally{s.f()}}},{key:"collectGapSnaps",value:function(e){var t,n=e.selectionPageBounds,r=e.minOffset,i=e.nearestSnapsX,o=e.nearestSnapsY,a=this.visibleGaps,s=a.horizontal,u=a.vertical,l=J(s);try{for(l.s();!(t=l.n()).done;){var c=t.value;if(ps(c.breadthIntersection[0],c.breadthIntersection[1],n.minY,n.maxY)){var d=c.startEdge[0].x+c.length/2-n.center.x;if(c.length>n.width&&eg(Math.abs(d))<=eg(r.x)){eg(Math.abs(d))<eg(r.x)&&(i.length=0),r.x=Math.abs(d);var f={type:"gap_center",gap:c,nudge:d},p=i.find((function(e){return"gap_center"===e.type})),h=p&&hs(c.breadthIntersection[0],c.breadthIntersection[1],p.gap.breadthIntersection[0],p.gap.breadthIntersection[1]);p&&p.gap.length>c.length&&h?i[i.indexOf(p)]=f:p&&h||i.push(f)}var v=c.startNode.pageBounds.minX-c.length-n.maxX;eg(Math.abs(v))<=eg(r.x)&&(eg(Math.abs(v))<eg(r.x)&&(i.length=0),r.x=Math.abs(v),i.push({type:"gap_duplicate",gap:c,protrusionDirection:"left",nudge:v}));var g=c.endNode.pageBounds.maxX+c.length-n.minX;eg(Math.abs(g))<=eg(r.x)&&(eg(Math.abs(g))<eg(r.x)&&(i.length=0),r.x=Math.abs(g),i.push({type:"gap_duplicate",gap:c,protrusionDirection:"right",nudge:g}))}}}catch(E){l.e(E)}finally{l.f()}var m,y=J(u);try{for(y.s();!(m=y.n()).done;){var b=m.value;if(ps(b.breadthIntersection[0],b.breadthIntersection[1],n.minX,n.maxX)){var w=b.startEdge[0].y+b.length/2-n.center.y;if(b.length>n.height&&eg(Math.abs(w))<=eg(r.y)){eg(Math.abs(w))<eg(r.y)&&(o.length=0),r.y=Math.abs(w);var x={type:"gap_center",gap:b,nudge:w},k=o.find((function(e){return"gap_center"===e.type})),S=k&&ps(k.gap.breadthIntersection[0],k.gap.breadthIntersection[1],b.breadthIntersection[0],b.breadthIntersection[1]);k&&k.gap.length>b.length&&S?o[o.indexOf(k)]=x:k&&S||o.push(x)}else{var _=b.startNode.pageBounds.minY-b.length-n.maxY;eg(Math.abs(_))<=eg(r.y)&&(eg(Math.abs(_))<eg(r.y)&&(o.length=0),r.y=Math.abs(_),o.push({type:"gap_duplicate",gap:b,protrusionDirection:"top",nudge:_}));var P=b.endNode.pageBounds.maxY+b.length-n.minY;eg(Math.abs(P))<=eg(r.y)&&(eg(Math.abs(P))<eg(r.y)&&(o.length=0),r.y=Math.abs(P),o.push({type:"gap_duplicate",gap:b,protrusionDirection:"bottom",nudge:P}))}}}}catch(E){y.e(E)}finally{y.f()}}},{key:"getPointSnapLines",value:function(e){var t=e.nearestSnapsX,n=e.nearestSnapsY,r={},i={};if(t.length>0){var o,a=J(t);try{for(a.s();!(o=a.n()).done;){var s=o.value;if("points"===s.type){var u=eg(s.points.otherPoint.x);r[u]||(r[u]=[]),r[u].push(s.points)}}}catch(p){a.e(p)}finally{a.f()}}if(n.length>0){var l,c=J(n);try{for(c.s();!(l=c.n()).done;){var d=l.value;if("points"===d.type){var f=eg(d.points.otherPoint.y);i[f]||(i[f]=[]),i[f].push(d.points)}}}catch(p){c.e(p)}finally{c.f()}}return Object.values(r).concat(Object.values(i)).map((function(e){return{id:ef(),type:"points",points:Ie(e.map((function(e){return Ya.From(e.otherPoint)})).concat(e.map((function(e){return Ya.From(e.thisPoint)}))),(function(e,t){return e.equals(t)}))}}))}},{key:"getGapSnapLines",value:function(e){var t=e.selectionPageBounds,n=e.nearestSnapsX,r=e.nearestSnapsY,i=this.visibleGaps,o=i.vertical,a=i.horizontal,s={top:t.sides[0],right:t.sides[1],bottom:[t.corners[3],t.corners[2]],left:[t.corners[0],t.corners[3]]},u=[];if(n.length>0){var l,c=J(n);try{var f=function(){var e=l.value;if("points"===e.type)return"continue";var n=e.gap,r=n.breadthIntersection,i=n.startEdge,o=n.startNode,c=n.endNode,f=n.length,p=n.endEdge;switch(e.type){case"gap_center":var h=(f-t.width)/2,v=hs(r[0],r[1],t.minY,t.maxY);u.push({type:"gaps",direction:"horizontal",id:ef(),gaps:[].concat(d(tg(a,o.id,h,"backward",v,0)),[{startEdge:i,endEdge:s.left},{startEdge:s.right,endEdge:p}],d(tg(a,c.id,h,"forward",v,0)))});break;case"gap_duplicate":var g=hs(r[0],r[1],t.minY,t.maxY);u.push({type:"gaps",direction:"horizontal",id:ef(),gaps:"left"===e.protrusionDirection?[{startEdge:s.right,endEdge:i.map((function(e){return e.clone().addXY(-o.pageBounds.width,0)}))},{startEdge:i,endEdge:p}].concat(d(tg(a,c.id,f,"forward",g,0))):[].concat(d(tg(a,o.id,f,"backward",g,0)),[{startEdge:i,endEdge:p},{startEdge:p.map((function(t){return t.clone().addXY(e.gap.endNode.pageBounds.width,0)})),endEdge:s.left}])})}};for(c.s();!(l=c.n()).done;)f()}catch(g){c.e(g)}finally{c.f()}}if(r.length>0){var p,h=J(r);try{var v=function(){var e=p.value;if("points"===e.type)return"continue";var n=e.gap,r=n.breadthIntersection,i=n.startEdge,a=n.startNode,l=n.endNode,c=n.length,f=n.endEdge;switch(e.type){case"gap_center":var h=(c-t.height)/2,v=hs(r[0],r[1],t.minX,t.maxX);u.push({type:"gaps",direction:"vertical",id:ef(),gaps:[].concat(d(tg(o,a.id,h,"backward",v,0)),[{startEdge:i,endEdge:s.top},{startEdge:s.bottom,endEdge:f}],d(tg(o,e.gap.endNode.id,h,"forward",v,0)))});break;case"gap_duplicate":var g=hs(r[0],r[1],t.minX,t.maxX);u.push({type:"gaps",direction:"vertical",id:ef(),gaps:"top"===e.protrusionDirection?[{startEdge:s.bottom,endEdge:i.map((function(e){return e.clone().addXY(0,-a.pageBounds.height)}))},{startEdge:i,endEdge:f}].concat(d(tg(o,l.id,c,"forward",g,0))):[].concat(d(tg(o,a.id,c,"backward",g,0)),[{startEdge:i,endEdge:f},{startEdge:f.map((function(e){return e.clone().addXY(0,l.pageBounds.height)})),endEdge:s.top}])})}};for(h.s();!(p=h.n()).done;)v()}catch(g){h.e(g)}finally{h.f()}}return function(e){e.sort((function(e,t){return t.gaps.length-e.gaps.length}));for(var t=e.length-1;t>0;t--)for(var n=e[t],r=function(){var r=e[i];if(r.direction===n.direction&&n.gaps.every((function(e){return r.gaps.some((function(t){return eg(e.startEdge[0].x)===eg(t.startEdge[0].x)&&eg(e.startEdge[0].y)===eg(t.startEdge[0].y)&&eg(e.startEdge[1].x)===eg(t.startEdge[1].x)&&eg(e.startEdge[1].y)===eg(t.startEdge[1].y)}))&&r.gaps.some((function(t){return eg(e.endEdge[0].x)===eg(t.endEdge[0].x)&&eg(e.endEdge[0].y)===eg(t.endEdge[0].y)&&eg(e.endEdge[1].x)===eg(t.endEdge[1].x)&&eg(e.endEdge[1].y)===eg(t.endEdge[1].y)}))})))return e.splice(t,1),"break"},i=t-1;i>=0&&"break"!==r();i--);}(u),u}}]),e}();function rg(e,t){var n=t.minX,r=t.maxX,i=t.minY,o=t.maxY,a=[];switch(e){case"top":case"left":case"top_left":case"any":a.push({id:"top_left",handle:"top_left",x:n,y:i})}switch(e){case"top":case"right":case"top_right":case"any":a.push({id:"top_right",handle:"top_right",x:r,y:i})}switch(e){case"bottom":case"right":case"bottom_right":case"any":a.push({id:"bottom_right",handle:"bottom_right",x:r,y:o})}switch(e){case"bottom":case"left":case"bottom_left":case"any":a.push({id:"bottom_left",handle:"bottom_left",x:n,y:o})}return a}Jv([ve],ng.prototype,"snapPointsCache",1),Jv([ve],ng.prototype,"snapThreshold",1),Jv([ve],ng.prototype,"snappableShapes",1),Jv([ve],ng.prototype,"currentCommonAncestor",1),Jv([ve],ng.prototype,"snappablePoints",1),Jv([ve],ng.prototype,"visibleGaps",1),Jv([ve],ng.prototype,"outlinesInPageSpace",1);var ig={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},og=/\s/,ag=function(){function e(t){var n=this;j(this,e),D(this,"measureText",(function(e,t){var r,i=n.getTextElement();i.setAttribute("dir","ltr"),i.style.setProperty("font-family",t.fontFamily),i.style.setProperty("font-style",t.fontStyle),i.style.setProperty("font-weight",t.fontWeight),i.style.setProperty("font-size",t.fontSize+"px"),i.style.setProperty("line-height",t.lineHeight*t.fontSize+"px"),i.style.setProperty("width",t.width),i.style.setProperty("min-width",null!==(r=t.minWidth)&&void 0!==r?r:null),i.style.setProperty("max-width",t.maxWidth),i.style.setProperty("padding",t.padding),i.textContent=ld.normalizeTextForDom(e);var o=i.getBoundingClientRect();return{x:0,y:0,w:o.width,h:o.height}})),this.editor=t}return z(e,[{key:"getTextElement",value:function(){var e=document.querySelector(".tl-text-measure");null===e||void 0===e||e.remove();var t=document.createElement("div");return this.editor.getContainer().appendChild(t),t.id="__textMeasure_".concat(ef()),t.classList.add("tl-text"),t.classList.add("tl-text-measure"),t.tabIndex=-1,t}},{key:"measureElementTextNodeSpans",value:function(e){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).shouldTruncateToFirstLine,r=void 0!==n&&n,i=[],o=e.getBoundingClientRect(),a=-o.left,s=-o.top,u=new Range,l=e.childNodes[0],c=0,d=null,f=null,p=0,h=!1,v=J(e.childNodes);try{for(v.s();!(t=v.n()).done;){var g,m=t.value;if(m.nodeType===Node.TEXT_NODE){var y,b=J(null!==(g=m.textContent)&&void 0!==g?g:"");try{for(b.s();!(y=b.n()).done;){var w=y.value;u.setStart(l,c),u.setEnd(l,c+w.length);var x=u.getClientRects(),k=x[x.length-1],S=k.top+s,_=k.left+a,P=k.right+a,E=og.test(w);if(E===f&&S===p&&d)d.box.w=P-d.box.x,d.text+=w;else{if(d){if(r&&S!==p){h=!0;break}i.push(d)}d={box:{x:_,y:S,w:k.width,h:k.height},text:w}}f=E,p=S,c+=w.length}}catch(C){b.e(C)}finally{b.f()}}}}catch(C){v.e(C)}finally{v.f()}return d&&i.push(d),{spans:i,didTruncate:h}}},{key:"measureTextSpans",value:function(e,t){var n="truncate-ellipsis"===t.overflow||"truncate-clip"===t.overflow,r=this.getTextElement(),i=Math.ceil(t.width-2*t.padding);r.style.setProperty("width","".concat(i,"px")),r.style.setProperty("height","min-content"),r.style.setProperty("dir","ltr"),r.style.setProperty("font-size","".concat(t.fontSize,"px")),r.style.setProperty("font-family",t.fontFamily),r.style.setProperty("font-weight",t.fontWeight),r.style.setProperty("line-height","".concat(t.lineHeight*t.fontSize,"px")),r.style.setProperty("text-align",ig[t.textAlign]),n&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all")),r.textContent=e;var o=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:n}),a=o.spans,s=o.didTruncate;if("truncate-ellipsis"===t.overflow&&s){r.textContent="\u2026";var u=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width","".concat(i-u,"px")),r.textContent=e;var l=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,c=l[l.length-1];return l.push({text:"\u2026",box:{x:Math.min(c.box.x+c.box.w,t.width-t.padding-u),y:c.box.y,w:u,h:c.box.h}}),l}return r.remove(),a}}]),e}(),sg=z((function e(t){var n=this;j(this,e),D(this,"raf",void 0),D(this,"isPaused",!0),D(this,"last",0),D(this,"t",0),D(this,"start",(function(){n.isPaused=!1,cancelAnimationFrame(n.raf),n.raf=requestAnimationFrame(n.tick),n.last=Date.now()})),D(this,"tick",(function(){if(!n.isPaused){var e=Date.now(),t=e-n.last;n.last=e,n.t+=t,n.editor.emit("frame",t),n.t<16||(n.t-=16,n.updatePointerVelocity(t),n.editor.emit("tick",t)),n.raf=requestAnimationFrame(n.tick)}})),D(this,"dispose",(function(){n.isPaused=!0,cancelAnimationFrame(n.raf)})),D(this,"prevPoint",new Ya),D(this,"updatePointerVelocity",(function(e){var t=n.prevPoint,r=n.editor.inputs,i=r.currentScreenPoint,o=r.pointerVelocity;if(0!==e){var a=Ya.Sub(i,t);n.prevPoint=i.clone();var s=a.len(),u=s?a.div(s):new Ya(0,0),l=o.clone().lrp(u.mul(s/e),.5);Math.abs(l.x)<.01&&(l.x=0),Math.abs(l.y)<.01&&(l.y=0),o.equals(l)||(n.editor.inputs.pointerVelocity=l)}})),this.editor=t,this.editor.disposables.add(this.dispose),this.start()})),ug=function(){function e(t){var n=this;j(this,e),D(this,"updateUserPreferences",(function(e){n.user.setUserPreferences(Ce(Ce({},n.user.userPreferences.value),e))})),this.user=t}return z(e,[{key:"userPreferences",get:function(){return this.user.userPreferences}},{key:"isDarkMode",get:function(){return this.user.userPreferences.value.isDarkMode}},{key:"animationSpeed",get:function(){return this.user.userPreferences.value.animationSpeed}},{key:"id",get:function(){return this.user.userPreferences.value.id}},{key:"name",get:function(){return this.user.userPreferences.value.name}},{key:"locale",get:function(){return this.user.userPreferences.value.locale}},{key:"color",get:function(){return this.user.userPreferences.value.color}},{key:"isSnapMode",get:function(){return this.user.userPreferences.value.isSnapMode}}]),e}(),lg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"brush",new ws),D(_t(e),"initialSelectedIds",[]),D(_t(e),"excludedShapeIds",new Set),D(_t(e),"initialStartShape",null),D(_t(e),"onEnter",(function(t){var n=e.editor.inputs,r=n.altKey,i=n.currentPagePoint;r?e.parent.transition("scribble_brushing",t):(e.excludedShapeIds=new Set(e.editor.shapesArray.filter((function(t){return e.editor.isShapeOfType(t,Up)||e.editor.isShapeOrAncestorLocked(t)})).map((function(e){return e.id}))),e.info=t,e.initialSelectedIds=e.editor.selectedIds.slice(),e.initialStartShape=e.editor.getShapesAtPoint(i)[0],e.onPointerMove())})),D(_t(e),"onExit",(function(){e.initialSelectedIds=[],e.editor.setBrush(null)})),D(_t(e),"onPointerMove",(function(){e.hitTestShapes()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onCancel",(function(t){e.editor.setSelectedIds(e.initialSelectedIds,!0),e.parent.transition("idle",t)})),D(_t(e),"onKeyDown",(function(t){e.editor.inputs.altKey?e.parent.transition("scribble_brushing",t):e.hitTestShapes()})),D(_t(e),"onKeyUp",(function(){e.hitTestShapes()})),D(_t(e),"onInterrupt",(function(){e.editor.setBrush(null)})),e}return z(n,[{key:"complete",value:function(){this.parent.transition("idle",{})}},{key:"hitTestShapes",value:function(){var e=this.editor,t=e.currentPageId,n=e.shapesArray,r=e.inputs,i=r.originPagePoint,o=r.currentPagePoint,a=r.shiftKey,s=r.ctrlKey;this.brush.setTo(ws.FromPoints([i,o]));var u,l,c,d,f,p,h,v=new Set(a?this.initialSelectedIds:[]),g=this.brush.corners,m=this.excludedShapeIds;e:for(var y=0,b=n.length;y<b;y++)if(c=n[y],!m.has(c.id)&&!v.has(c.id)&&(f=this.editor.getPageBounds(c)))if(this.brush.contains(f))this.handleHit(c,o,t,v,g);else if(!s&&!this.editor.isShapeOfType(c,Wp)&&this.brush.collides(f)){if(d=this.editor.getShapeUtil(c),!(p=this.editor.getPageTransform(c)))continue e;h=Cs.applyToPoints(Cs.Inverse(p),g);t:for(var w=0;w<h.length;w++)if(u=h[w],l=h[(w+1)%h.length],d.hitTestLineSegment(c,u,l)){this.handleHit(c,o,t,v,g);break t}}this.editor.setBrush(Ce({},this.brush.toJson())),this.editor.setSelectedIds(Array.from(v),!0)}},{key:"handleHit",value:function(e,t,n,r,i){if(e.parentId!==n){var o=this.editor.getOutermostSelectableShape(e),a=this.editor.getPageMaskById(o.id);a&&null!==function(e,t){for(var n,r,i=0,o=e.length;i<o;i++){n=e[i],r=e[(i+1)%o];for(var a=0,s=t.length;a<s;a++)if(Ws(n,r,t[a],t[(a+1)%s]))return!0}return!1}(a,i)&&!gs(t,a)||r.add(o.id)}else r.add(e.id)}}]),n}(_f);function cg(e,t,n){if(!t)throw Error("Needs to translate a cropped shape!");var r=t.props.crop;if(r){var i=e.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;"x"===i?n.x=0:"y"===i&&(n.y=0),n.rot(-t.rotation);var o=1/(r.bottomRight.x-r.topLeft.x)*t.props.w,a=1/(r.bottomRight.y-r.topLeft.y)*t.props.h,s=r.bottomRight.y-r.topLeft.y,u=r.bottomRight.x-r.topLeft.x,l=We(r);return l.topLeft.x=Math.min(1-u,Math.max(0,l.topLeft.x-n.x/o)),l.topLeft.y=Math.min(1-s,Math.max(0,l.topLeft.y-n.y/a)),l.bottomRight.x=l.topLeft.x+u,l.bottomRight.y=l.topLeft.y+s,{id:t.id,type:t.type,props:{crop:l}}}}D(lg,"id","brushing");var dg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.setCursor({type:"default"});var t=e.editor.onlySelectedShape;e.editor.on("change-history",e.cleanupCroppingState),e.editor.mark("crop"),t&&e.editor.setCroppingId(t.id)})),D(_t(e),"onExit",(function(){e.editor.setCursor({type:"default"}),e.editor.off("change-history",e.cleanupCroppingState)})),D(_t(e),"onCancel",(function(){e.editor.setCroppingId(null),e.editor.setSelectedTool("select.idle",{})})),D(_t(e),"onPointerDown",(function(t){if(!e.editor.isMenuOpen){if(t.ctrlKey)return e.editor.setCroppingId(null),void e.editor.setSelectedTool("select.brushing",t);switch(t.target){case"canvas":e.cancel();break;case"shape":if(t.shape.id===e.editor.croppingId)return void e.editor.setSelectedTool("select.crop.pointing_crop",t);var n;null!==(n=e.editor.getShapeUtil(t.shape))&&void 0!==n&&n.canCrop(t.shape)?(e.editor.setCroppingId(t.shape.id),e.editor.setSelectedIds([t.shape.id]),e.editor.setSelectedTool("select.crop.pointing_crop",t)):e.cancel();break;case"selection":switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":e.editor.setSelectedTool("select.pointing_rotate_handle",Ce(Ce({},t),{},{onInteractionEnd:"select.crop"}));break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":e.editor.setSelectedTool("select.pointing_crop_handle",Ce(Ce({},t),{},{onInteractionEnd:"select.crop"}));break;default:e.cancel()}}}})),D(_t(e),"onDoubleClick",(function(t){if("up"===t.phase&&e.editor.croppingId){var n=e.editor.getShapeById(e.editor.croppingId);if(n){var r,i=e.editor.getShapeUtil(n);if(i)if("selection"===t.target)null===(r=i.onDoubleClickEdge)||void 0===r||r.call(i,n)}}})),D(_t(e),"onKeyDown",(function(){e.nudgeCroppingImage(!1)})),D(_t(e),"onKeyRepeat",(function(){e.nudgeCroppingImage(!0)})),D(_t(e),"onKeyUp",(function(t){if("Enter"===t.code)e.editor.setCroppingId(null),e.editor.setSelectedTool("select.idle",{})})),D(_t(e),"cleanupCroppingState",(function(){e.editor.croppingId||e.editor.setSelectedTool("select.idle",{})})),e}return z(n,[{key:"cancel",value:function(){this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{})}},{key:"nudgeCroppingImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.editor.inputs.keys,n=t.has("ShiftLeft"),r=new Ya(0,0);if(t.has("ArrowLeft")&&(r.x+=1),t.has("ArrowRight")&&(r.x-=1),t.has("ArrowUp")&&(r.y+=1),t.has("ArrowDown")&&(r.y-=1),!r.equals(new Ya(0,0))){n&&r.mul(10);var i=this.editor.getShapeById(this.editor.croppingId);if(i){var o=cg(this.editor,i,r);o&&(e||this.editor.mark("translate crop"),this.editor.updateShapes([o]))}}}}]),n}(_f);D(dg,"id","idle");var fg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onCancel",(function(){e.editor.setSelectedTool("select.crop.idle",{})})),D(_t(e),"onPointerMove",(function(t){e.editor.inputs.isDragging&&e.editor.setSelectedTool("select.crop.translating_crop",t)})),D(_t(e),"onPointerUp",(function(t){e.editor.setSelectedTool("select.crop.idle",t)})),e}return z(n)}(_f);D(fg,"id","pointing_crop");var pg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"markId","translating crop"),D(_t(e),"snapshot",{}),D(_t(e),"onEnter",(function(t){e.info=t,e.snapshot=e.createSnapshot(),e.editor.mark(e.markId),e.editor.setCursor({type:"move"}),e.updateShapes()})),D(_t(e),"onExit",(function(){e.editor.setCursor({type:"default"})})),D(_t(e),"onPointerMove",(function(){e.updateShapes()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onKeyDown",(function(t){switch(t.key){case"Alt":case"Shift":return void e.updateShapes()}})),D(_t(e),"onKeyUp",(function(t){switch(t.key){case"Enter":return void e.complete();case"Alt":case"Shift":e.updateShapes()}})),e}return z(n,[{key:"complete",value:function(){this.updateShapes(),this.editor.setSelectedTool("select.crop.idle",this.info)}},{key:"cancel",value:function(){this.editor.bailToMark(this.markId),this.editor.setSelectedTool("select.crop.idle",this.info)}},{key:"createSnapshot",value:function(){return{shape:this.editor.onlySelectedShape}}},{key:"updateShapes",value:function(){var e=this.snapshot.shape;if(e){var t=this.editor.inputs,n=t.originPagePoint,r=t.currentPagePoint.clone().sub(n),i=cg(this.editor,e,r);i&&this.editor.updateShapes([i],!0)}}}]),n}(_f);D(pg,"id","translating_crop");var hg=function(e){Et(n,e);var t=Tt(n);function n(){return j(this,n),t.apply(this,arguments)}return z(n)}(_f);D(hg,"id","crop"),D(hg,"initial","idle"),D(hg,"children",(function(){return[dg,pg,fg]}));var vg={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"},gg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"onEnter",(function(t){e.info=t,e.updateCursor()})),D(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("resizing",e.info)})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.cancel()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"updateCursor",value:function(){var e=this.editor.selectedShapes,t=vg[this.info.handle];this.editor.setCursor({type:t,rotation:1===e.length?e[0].rotation:0})}},{key:"complete",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}]),n}(_f);D(gg,"id","pointing_resize_handle");var mg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"markId",""),D(_t(e),"snapshot",{}),D(_t(e),"onEnter",(function(t){e.info=t,e.markId=e.editor.mark("cropping"),e.snapshot=e.createSnapshot(),e.updateShapes()})),D(_t(e),"onPointerMove",(function(){e.updateShapes()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"getDefaultCrop",(function(){return{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}})),e}return z(n,[{key:"updateCursor",value:function(){var e=this.editor.selectedShapes[0];if(e){var t=vg[this.info.handle];this.editor.setCursor({type:t,rotation:e.rotation})}}},{key:"updateShapes",value:function(){var e,t=this.snapshot,n=t.shape,r=t.cursorHandleOffset;if(n&&this.editor.getShapeUtil(Eh)){var i=n.props,o=this.editor.inputs.currentPagePoint.clone().sub(r),a=this.editor.inputs.originPagePoint.clone().sub(r),s=o.clone().sub(a).rot(-n.rotation),u=null!==(e=i.crop)&&void 0!==e?e:this.getDefaultCrop(),l=We(u),c=new Ya(n.x,n.y),d=new Ya(0,0),f=1/(u.bottomRight.x-u.topLeft.x)*i.w,p=1/(u.bottomRight.y-u.topLeft.y)*i.h,h=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":if(p<8)break;h=!0,l.topLeft.y=l.topLeft.y+s.y/p,p*(l.bottomRight.y-l.topLeft.y)<8?(l.topLeft.y=l.bottomRight.y-8/p,d.y=(l.topLeft.y-u.topLeft.y)*p):l.topLeft.y<=0?(l.topLeft.y=0,d.y=(l.topLeft.y-u.topLeft.y)*p):d.y=s.y;break;case"bottom":case"bottom_left":case"bottom_right":if(p<8)break;h=!0,l.bottomRight.y=Math.min(1,l.bottomRight.y+s.y/p),p*(l.bottomRight.y-l.topLeft.y)<8&&(l.bottomRight.y=l.topLeft.y+8/p)}switch(this.info.handle){case"left":case"top_left":case"bottom_left":if(f<8)break;h=!0,l.topLeft.x=l.topLeft.x+s.x/f,f*(l.bottomRight.x-l.topLeft.x)<8?(l.topLeft.x=l.bottomRight.x-8/f,d.x=(l.topLeft.x-u.topLeft.x)*f):l.topLeft.x<=0?(l.topLeft.x=0,d.x=(l.topLeft.x-u.topLeft.x)*f):d.x=s.x;break;case"right":case"top_right":case"bottom_right":if(f<8)break;h=!0,l.bottomRight.x=Math.min(1,l.bottomRight.x+s.x/f),f*(l.bottomRight.x-l.topLeft.x)<8&&(l.bottomRight.x=l.topLeft.x+8/f)}if(h){c.add(d.rot(n.rotation));var v={id:n.id,type:n.type,x:c.x,y:c.y,props:{crop:l,w:(l.bottomRight.x-l.topLeft.x)*f,h:(l.bottomRight.y-l.topLeft.y)*p}};this.editor.updateShapes([v],!0),this.updateCursor()}}}},{key:"complete",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}},{key:"cancel",value:function(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}},{key:"createSnapshot",value:function(){var e=this.editor,t=e.selectionRotation,n=e.inputs.originPagePoint,r=this.editor.onlySelectedShape,i=this.editor.selectionBounds,o=Ya.RotWith(i.getHandlePoint(this.info.handle),i.point,t);return{shape:r,cursorHandleOffset:Ya.Sub(n,o)}}}]),n}(_f);D(mg,"id","cropping");var yg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"shapeId",""),D(_t(e),"initialHandle",{}),D(_t(e),"initialAdjacentHandle",null),D(_t(e),"markId",""),D(_t(e),"initialPageTransform",void 0),D(_t(e),"initialPageRotation",void 0),D(_t(e),"info",{}),D(_t(e),"isPrecise",!1),D(_t(e),"isPreciseId",null),D(_t(e),"pointingId",null),D(_t(e),"onEnter",(function(t){var n=t.shape,r=t.isCreating,i=t.handle;e.info=t,e.shapeId=n.id,e.markId=r?"creating":e.editor.mark("dragging handle"),e.initialHandle=We(i),e.initialPageTransform=e.editor.getPageTransform(n),e.initialPageRotation=e.editor.getPageRotation(n),e.editor.setCursor({type:r?"cross":"grabbing",rotation:0});var o=e.editor.getHandles(n).sort(M),a=o.findIndex((function(e){return e.id===t.handle.id}));e.initialAdjacentHandle=null;for(var s=a+1;s<o.length;s++){var u=o[s];if("vertex"===u.type&&"middle"!==u.id&&u.id!==t.handle.id){e.initialAdjacentHandle=u;break}}if(!e.initialAdjacentHandle)for(var l=o.length-1;l>=0;l--){var c=o[l];if("vertex"===c.type&&"middle"!==c.id&&c.id!==t.handle.id){e.initialAdjacentHandle=c;break}}var d=n.props[t.handle.id];e.isPrecise=!1,"binding"===(null===d||void 0===d?void 0:d.type)&&(e.editor.setHintingIds([d.boundShapeId]),e.isPrecise=!Ya.Equals(d.normalizedAnchor,{x:.5,y:.5}),e.isPrecise?e.isPreciseId=d.boundShapeId:e.resetExactTimeout()),e.update()})),D(_t(e),"exactTimeout",-1),D(_t(e),"onPointerMove",(function(){e.update()})),D(_t(e),"onKeyDown",(function(){e.update()})),D(_t(e),"onKeyUp",(function(){e.update()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onExit",(function(){e.editor.setHintingIds([]),e.editor.snaps.clear(),e.editor.setCursor({type:"default"})})),e}return z(n,[{key:"resetExactTimeout",value:function(){var e=this;-1!==this.exactTimeout&&this.clearExactTimeout(),this.exactTimeout=setTimeout((function(){e.isActive&&!e.isPrecise&&(e.isPrecise=!0,e.isPreciseId=e.pointingId,e.update()),e.exactTimeout=-1}),750)}},{key:"clearExactTimeout",value:function(){-1!==this.exactTimeout&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}},{key:"complete",value:function(){this.editor.snaps.clear();var e=this.info.onInteractionEnd;this.editor.instanceState.isToolLocked&&e?this.editor.setSelectedTool(e,{shapeId:this.shapeId}):this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();var e=this.info.onInteractionEnd;e?this.editor.setSelectedTool(e,{shapeId:this.shapeId}):this.parent.transition("idle",{})}},{key:"update",value:function(){var e,t=this.editor,n=this.shapeId,r=this.initialHandle,i=this.initialPageRotation,o=this.initialAdjacentHandle,a=t.isSnapMode,s=t.hintingIds,u=t.snaps,l=t.inputs,c=l.currentPagePoint,d=l.originPagePoint,f=l.shiftKey,p=l.ctrlKey,h=l.altKey,v=l.pointerVelocity,g=t.getShapeById(n);if(g){var m=t.getShapeUtil(g),y=c.clone().sub(d).rot(-i).add(r);if(f&&o&&"middle"!==r.id){var b=Ya.Angle(o,y),w=us(b,24)-b;y=Ya.RotWith(y,o,w)}if(t.snaps.clear(),a?!p:p){var x=t.getPageTransformById(g.id);if(!x)throw Error("Expected a page transform");var k=m.getOutlineSegments(g).map((function(e){return Cs.applyToPoints(x,e)})),S=t.getHandles(g).filter((function(e){return"vertex"===e.type})).sort(M).findIndex((function(e){var t=e.index;return r.index===t}));k.splice(S-1,2);var _=u.getSnappingHandleDelta({additionalSegments:k,handlePoint:Cs.applyToPoint(x,y)});_&&y.add(t.getDeltaInShapeSpace(g,_))}var P=null===(e=m.onHandleChange)||void 0===e?void 0:e.call(m,g,{handle:Ce(Ce({},r),{},{x:y.x,y:y.y}),isPrecise:this.isPrecise||h}),E=Ce(Ce({},g),P);if(r.canBind){var C=E.props[r.id];"binding"===(null===C||void 0===C?void 0:C.type)?s[0]!==C.boundShapeId&&(t.setHintingIds([C.boundShapeId]),this.pointingId=C.boundShapeId,this.isPrecise=v.len()<.5||h,this.isPreciseId=this.isPrecise?C.boundShapeId:null,this.resetExactTimeout()):s.length>0&&(t.setHintingIds([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}P&&t.updateShapes([E],!0)}}}]),n}(_f);D(yg,"id","dragging_handle");var bg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerEnter",(function(t){if("shape"===t.target){var n=e.editor,r=n.selectedIds,i=n.focusLayerId,o=e.editor.getOutermostSelectableShape(t.shape,(function(e){return!r.includes(e.id)}));o.id!==i&&e.editor.setHoveredId(o.id)}})),D(_t(e),"onPointerLeave",(function(t){if("shape"===t.target)e.editor.setHoveredId(null)})),D(_t(e),"onExit",(function(){var t;if(e.editor.pageState.editingId){var n=e.editor.pageState.editingId;if(n){e.editor.setEditingId(null);var r=e.editor.getShapeById(n),i=e.editor.getShapeUtil(r);null===(t=i.onEditEnd)||void 0===t||t.call(i,r)}}})),D(_t(e),"onPointerDown",(function(t){var n,r;if("shape"===t.target){var i=t.shape,o=e.editor.pageState.editingId;if(o){if(i.id===o)return;var a=e.editor.getShapeById(o);if(a){var s,u,l=e.editor.getShapeUtil(a);null===(s=l.onEditEnd)||void 0===s||s.call(l,a);var c=e.editor.getShapeUtil(i);if(i.type===a.type&&null!==(u=c.canEdit)&&void 0!==u&&u.call(c,i)&&!e.editor.isShapeOrAncestorLocked(i))return e.editor.setEditingId(i.id),e.editor.setHoveredId(i.id),void e.editor.setSelectedIds([i.id])}}}e.parent.transition("idle",t),null===(n=e.parent.current.value)||void 0===n||null===(r=n.onPointerDown)||void 0===r||r.call(n,t)})),D(_t(e),"onComplete",(function(t){e.parent.transition("idle",t)})),D(_t(e),"onCancel",(function(t){e.parent.transition("idle",t)})),e}return z(n)}(_f);D(bg,"id","editing_shape");var wg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1),D(_t(e),"onPointerEnter",(function(t){switch(t.target){case"canvas":break;case"shape":var n=e.editor,r=n.selectedIds,i=n.focusLayerId,o=e.editor.getOutermostSelectableShape(t.shape,(function(e){return!r.includes(e.id)}));if(o.id!==i&&e.editor.setHoveredId(o.id),Zs.debugCursors.value){if("geo"!==o.type)break;var a=o.props.text;try{e.editor.setCursor({type:a})}catch(ok){console.error("Cursor type not recognized: '".concat(a,"'")),e.editor.setCursor({type:"default"})}}}})),D(_t(e),"onPointerLeave",(function(t){if("shape"===t.target)e.editor.setHoveredId(null)})),D(_t(e),"onPointerDown",(function(t){if(!e.editor.isMenuOpen){var n=e.shouldEnterCropMode(t,!0);if(t.ctrlKey&&!n)return"shape"===t.target&&e.isDarwin&&e.editor.inputs.keys.has("ControlLeft")&&!e.editor.isShapeOrAncestorLocked(t.shape)?void e.parent.transition("pointing_shape",t):void e.parent.transition("brushing",t);switch(t.target){case"canvas":e.parent.transition("pointing_canvas",t);break;case"shape":if(e.editor.isShapeOrAncestorLocked(t.shape))break;e.parent.transition("pointing_shape",t);break;case"handle":if(e.editor.isReadOnly)break;e.editor.inputs.altKey?e.parent.transition("pointing_shape",t):e.parent.transition("pointing_handle",t);break;case"selection":switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":e.parent.transition("pointing_rotate_handle",t);break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":n?e.parent.transition("pointing_crop_handle",t):e.parent.transition("pointing_resize_handle",t);break;default:e.parent.transition("pointing_selection",t)}}}})),D(_t(e),"onDoubleClick",(function(t){if("up"===t.phase)switch(t.target){case"canvas":if(e.editor.isReadOnly)break;e.handleDoubleClickOnCanvas(t);break;case"selection":if(e.editor.isReadOnly)break;var n=e.editor.onlySelectedShape;if(n){var r=e.editor.getShapeUtil(n);if("right"===t.handle||"left"===t.handle||"top"===t.handle||"bottom"===t.handle){var i,o=null===(i=r.onDoubleClickEdge)||void 0===i?void 0:i.call(r,n);if(o)return e.editor.mark("double click edge"),void e.editor.updateShapes([o])}if(r.canCrop(n)&&!e.editor.isShapeOrAncestorLocked(n))return void e.parent.transition("crop",t);e.shouldStartEditingShape(n)&&e.startEditingShape(n,t)}break;case"shape":var a=t.shape,s=e.editor.getShapeUtil(a);if("video"!==a.type&&"embed"!==a.type&&e.editor.isReadOnly)break;if(s.onDoubleClick){var u,l,c=null===(u=s.onDoubleClick)||void 0===u?void 0:u.call(s,a);if(c)return void e.editor.updateShapes([c]);if(s.canCrop(a)&&!e.editor.isShapeOrAncestorLocked(a))return e.editor.mark("select and crop"),e.editor.select(null===(l=t.shape)||void 0===l?void 0:l.id),void e.parent.transition("crop",t)}e.shouldStartEditingShape(a)?e.startEditingShape(a,t):e.handleDoubleClickOnCanvas(t);break;case"handle":var d;if(e.editor.isReadOnly)break;var f=t.shape,p=t.handle,h=e.editor.getShapeUtil(f),v=null===(d=h.onDoubleClickHandle)||void 0===d?void 0:d.call(h,f,p);v?e.editor.updateShapes([v]):e.shouldStartEditingShape(f)&&e.startEditingShape(f,t)}})),D(_t(e),"onRightClick",(function(t){switch(t.target){case"canvas":e.editor.selectNone();break;case"shape":var n=e.editor.pageState.selectedIds,r=t.shape,i=e.editor.getOutermostSelectableShape(r,(function(t){return!e.editor.isSelected(t.id)}));n.includes(i.id)||(e.editor.mark("selecting shape"),e.editor.setSelectedIds([i.id]))}})),D(_t(e),"onEnter",(function(){e.editor.setHoveredId(null),e.editor.setCursor({type:"default"})})),D(_t(e),"onCancel",(function(){e.editor.focusLayerId!==e.editor.currentPageId&&e.editor.selectedIds.length>0?e.editor.popFocusLayer():(e.editor.mark("clearing selection"),e.editor.selectNone())})),D(_t(e),"onKeyDown",(function(t){switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":e.nudgeSelectedShapes(!1)}})),D(_t(e),"onKeyRepeat",(function(t){switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":e.nudgeSelectedShapes(!0)}})),D(_t(e),"onKeyUp",(function(t){if(e.editor.isReadOnly){if("Enter"===t.code)if(e.shouldStartEditingShape()&&e.editor.onlySelectedShape)return void e.startEditingShape(e.editor.onlySelectedShape,Ce(Ce({},t),{},{target:"shape",shape:e.editor.onlySelectedShape}))}else if("Enter"===t.code){var n=e.editor.selectedShapes;if(n.every((function(t){return e.editor.isShapeOfType(t,Up)})))return void e.editor.setSelectedIds(n.flatMap((function(t){return e.editor.getSortedChildIds(t.id)})));if(e.shouldStartEditingShape()&&e.editor.onlySelectedShape)return void e.startEditingShape(e.editor.onlySelectedShape,Ce(Ce({},t),{},{target:"shape",shape:e.editor.onlySelectedShape}));e.shouldEnterCropMode(t,!1)&&e.parent.transition("crop",t)}})),e}return z(n,[{key:"shouldStartEditingShape",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editor.onlySelectedShape;return!!e&&((!this.editor.isShapeOrAncestorLocked(e)||"embed"===e.type)&&this.editor.getShapeUtil(e).canEdit(e))}},{key:"shouldEnterCropMode",value:function(e,t){var n=this.editor.onlySelectedShape;if(!n)return!1;if(this.editor.isShapeOrAncestorLocked(n))return!1;var r=this.editor.getShapeUtil(n);return t?r.canCrop(n)&&e.ctrlKey:r.canCrop(n)}},{key:"startEditingShape",value:function(e,t){this.editor.isShapeOrAncestorLocked(e)&&"embed"!==e.type||(this.editor.mark("editing shape"),this.editor.setEditingId(e.id),this.parent.transition("editing_shape",t))}},{key:"handleDoubleClickOnCanvas",value:function(e){this.editor.mark("creating text shape");var t=Vi(),n=this.editor.inputs.currentPagePoint,r=n.x,i=n.y;this.editor.createShapes([{id:t,type:"text",x:r,y:i,props:{text:"",autoSize:!0}}]);var o=this.editor.getShapeById(t);if(o){var a=this.editor.getBounds(o);this.editor.updateShapes([{id:t,type:"text",x:o.x-a.width/2,y:o.y-a.height/2}]),this.editor.setEditingId(t),this.editor.select(t),this.parent.transition("editing_shape",e)}}},{key:"nudgeSelectedShapes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.editor.inputs.keys,n=t.has("ShiftLeft"),r=new Ya(0,0);t.has("ArrowLeft")&&(r.x-=1),t.has("ArrowRight")&&(r.x+=1),t.has("ArrowUp")&&(r.y-=1),t.has("ArrowDown")&&(r.y+=1),r.equals(new Ya(0,0))||(e||this.editor.mark("nudge shapes"),this.editor.nudgeShapes(this.editor.selectedIds,r,n))}}]),n}(_f);D(wg,"id","idle");var xg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.inputs.shiftKey||e.editor.selectedIds.length>0&&(e.editor.mark("selecting none"),e.editor.selectNone())})),D(_t(e),"onPointerMove",(function(t){e.editor.inputs.isDragging&&e.parent.transition("brushing",t)})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onInterrupt",(function(){e.parent.transition("idle",{})})),e}return z(n,[{key:"_clickWasInsideFocusedGroup",value:function(){var e=this.editor,t=e.focusLayerId,n=e.inputs;if(!Ki(t))return!1;var r=this.editor.getShapeById(t);if(!r)return!1;var i=this.editor.getPointInShapeSpace(r,n.currentPagePoint);return this.editor.getShapeUtil(r).hitTestPoint(r,i)}},{key:"complete",value:function(){this.editor.inputs.shiftKey||(this.editor.selectNone(),this._clickWasInsideFocusedGroup()||this.editor.setFocusLayer(null)),this.parent.transition("idle",{})}}]),n}(_f);D(xg,"id","pointing_canvas");var kg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"onEnter",(function(t){e.info=t;var n=e.editor.selectedShapes[0];n&&(e.updateCursor(n),e.editor.setCroppingId(n.id))})),D(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("cropping",Ce(Ce({},e.info),{},{onInteractionEnd:e.info.onInteractionEnd}))})),D(_t(e),"onPointerUp",(function(){e.info.onInteractionEnd?e.editor.setSelectedTool(e.info.onInteractionEnd,e.info):(e.editor.setCroppingId(null),e.parent.transition("idle",{}))})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.cancel()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"updateCursor",value:function(e){var t=vg[this.info.handle];this.editor.setCursor({type:t,rotation:e.rotation})}},{key:"cancel",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}}]),n}(_f);D(kg,"id","pointing_crop_handle");var Sg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"onEnter",(function(t){e.info=t;var n=t.shape.props[t.handle.id];"binding"===(null===n||void 0===n?void 0:n.type)&&e.editor.setHintingIds([n.boundShapeId]),e.editor.setCursor({type:"grabbing"})})),D(_t(e),"onExit",(function(){e.editor.setHintingIds([]),e.editor.setCursor({type:"default"})})),D(_t(e),"onPointerUp",(function(){e.parent.transition("idle",e.info)})),D(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("dragging_handle",e.info)})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.cancel()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(_f);D(Sg,"id","pointing_handle");var _g=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"onEnter",(function(t){e.info=t,e.updateCursor()})),D(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("rotating",e.info)})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.cancel()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"updateCursor",value:function(){var e=this.editor.selectionRotation;this.editor.setCursor({type:vg[this.info.handle],rotation:e})}},{key:"complete",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}]),n}(_f);D(_g,"id","pointing_rotate_handle");var Pg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"onEnter",(function(t){e.info=t})),D(_t(e),"onPointerUp",(function(t){e.editor.selectNone(),e.parent.transition("idle",t)})),D(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){if(e.editor.isReadOnly)return;e.parent.transition("translating",t)}})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.cancel()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(_f);D(Pg,"id","pointing_selection");var Eg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"eventTargetShape",{}),D(_t(e),"selectingShape",{}),D(_t(e),"didSelectOnEnter",!1),D(_t(e),"onEnter",(function(t){var n;if(e.eventTargetShape=t.shape,e.selectingShape=e.editor.getOutermostSelectableShape(t.shape),e.editor.getShapeUtil(t.shape).onClick||e.selectingShape.id===e.editor.focusLayerId)e.didSelectOnEnter=!1;else{var r=e.editor.isWithinSelection(e.selectingShape.id),i=e.editor.selectedIds.length>1&&(null===(n=e.editor.selectionBounds)||void 0===n?void 0:n.containsPoint(e.editor.inputs.currentPagePoint));if(e.didSelectOnEnter=!r&&e.selectingShape.id!==e.editor.focusLayerId&&!i,e.didSelectOnEnter){var o=e.editor,a=o.inputs,s=o.selectedIds,u=e.editor.getParentShape(t.shape);u&&e.editor.isShapeOfType(u,Up)&&e.editor.cancelDoubleClick(),a.shiftKey&&!a.altKey?s.includes(e.selectingShape.id)||(e.editor.mark("shift selecting shape"),e.editor.setSelectedIds([].concat(d(s),[e.selectingShape.id]))):(e.editor.mark("selecting shape"),e.editor.setSelectedIds([e.selectingShape.id]))}}})),D(_t(e),"onPointerUp",(function(t){var n=t.shape;if(n){var r=e.editor.getShapeUtil(n);if(r.onClick){var i,o=null===(i=r.onClick)||void 0===i?void 0:i.call(r,n);if(o)return e.editor.updateShapes([o]),void e.parent.transition("idle",t)}}if(e.didSelectOnEnter||e.selectingShape.id===e.editor.focusLayerId)e.selectingShape.id===e.editor.focusLayerId&&(e.editor.selectedIds.length>0?e.editor.setSelectedIds([]):e.editor.popFocusLayer());else{e.editor.mark("selecting shape (pointer up)");var a=e.editor.getOutermostSelectableShape(e.eventTargetShape,(function(t){return!e.editor.isSelected(t.id)}));if(e.editor.selectedIds.includes(a.id))e.editor.setSelectedIds(e.editor.inputs.shiftKey?e.editor.selectedIds.filter((function(t){return t!==e.selectingShape.id})):[e.selectingShape.id]);else if(e.editor.inputs.shiftKey){var s=e.editor.getAncestors(a);e.editor.setSelectedIds([].concat(d(e.editor.selectedIds.filter((function(e){return!s.find((function(t){return t.id===e}))}))),[a.id]))}else e.editor.setSelectedIds([a.id])}e.parent.transition("idle",t)})),D(_t(e),"onPointerMove",(function(t){if(e.editor.inputs.isDragging){if(e.editor.isReadOnly)return;e.parent.transition("translating",t)}})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.cancel()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(_f);D(Eg,"id","pointing_shape");var Cg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"markId",""),D(_t(e),"creationCursorOffset",{x:0,y:0}),D(_t(e),"editAfterComplete",!1),D(_t(e),"snapshot",{}),D(_t(e),"onEnter",(function(t){var n=t.isCreating,r=void 0!==n&&n,i=t.editAfterComplete,o=void 0!==i&&i,a=t.creationCursorOffset,s=void 0===a?{x:0,y:0}:a;e.info=t,e.editAfterComplete=o,e.creationCursorOffset=s,t.isCreating&&e.editor.setCursor({type:"cross",rotation:0}),e.snapshot=e._createSnapshot(),e.markId=r?"creating":e.editor.mark("starting resizing"),e.handleResizeStart(),e.updateShapes()})),D(_t(e),"onPointerMove",(function(){e.updateShapes()})),D(_t(e),"onKeyDown",(function(){e.updateShapes()})),D(_t(e),"onKeyUp",(function(){e.updateShapes()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onExit",(function(){e.editor.snaps.clear()})),D(_t(e),"_createSnapshot",(function(){var t=e.editor,n=t.selectedIds,r=t.selectionRotation,i=t.inputs.originPagePoint,o=e.editor.selectionBounds,a=Ya.RotWith(o.getHandlePoint(e.info.handle),o.point,r),s=Ya.Sub(i,a),u=new Map;n.forEach((function(t){var r=e.editor.getShapeById(t);if(r){if(u.set(r.id,e._createShapeSnapshot(r)),e.editor.isShapeOfType(r,Wp)&&1===n.length)return;e.editor.visitDescendants(r.id,(function(t){var n=e.editor.getShapeById(t);if(n&&(u.set(n.id,e._createShapeSnapshot(n)),e.editor.isShapeOfType(n,Wp)))return!1}))}}));var l=!d(u.values()).some((function(e){return!ls(e.pageRotation,r)||e.isAspectRatioLocked}));return{shapeSnapshots:u,selectionBounds:o,cursorHandleOffset:s,selectionRotation:r,selectedIds:n,canShapesDeform:l,initialSelectionPageBounds:e.editor.selectedPageBounds}})),D(_t(e),"_createShapeSnapshot",(function(t){var n=e.editor.getPageTransform(t),r=e.editor.getShapeUtil(t);return{shape:t,bounds:e.editor.getBounds(t),pageTransform:n,pageRotation:Cs.Decompose(n).rotation,isAspectRatioLocked:r.isAspectRatioLocked(t)}})),e}return z(n,[{key:"cancel",value:function(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}},{key:"complete",value:function(){if(this.handleResizeEnd(),this.editAfterComplete&&this.editor.onlySelectedShape)return this.editor.setEditingId(this.editor.onlySelectedShape.id),this.editor.setSelectedTool("select"),void this.editor.root.current.value.transition("editing_shape",{});this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}},{key:"handleResizeStart",value:function(){var e=this,t=this.snapshot.shapeSnapshots,n=[];t.forEach((function(t){var r,i=t.shape,o=e.editor.getShapeUtil(i),a=null===(r=o.onResizeStart)||void 0===r?void 0:r.call(o,i);a&&n.push(a)})),n.length>0&&this.editor.updateShapes(n)}},{key:"handleResizeEnd",value:function(){var e=this,t=this.snapshot.shapeSnapshots,n=[];t.forEach((function(t){var r,i=t.shape,o=e.editor.getShapeById(i.id),a=e.editor.getShapeUtil(i),s=null===(r=a.onResizeEnd)||void 0===r?void 0:r.call(a,i,o);s&&n.push(s)})),n.length>0&&this.editor.updateShapes(n)}},{key:"updateShapes",value:function(){var e=this.editor.inputs,t=e.altKey,n=e.shiftKey,r=this.snapshot,i=r.shapeSnapshots,o=r.selectionBounds,a=r.cursorHandleOffset,s=r.selectedIds,u=r.selectionRotation,l=r.canShapesDeform,c=n||!l,d=this.editor.inputs.ctrlKey,f=this.editor.inputs.currentPagePoint.clone().sub(a).sub(this.creationCursorOffset),p=this.editor.inputs.originPagePoint.clone().sub(a);this.editor.isGridMode&&!d&&f.snapToGrid(this.editor.gridSize);var h=this.info.handle,v=Tg(h,Math.PI);if(this.editor.snaps.clear(),(this.editor.isSnapMode?!d:d)&&u%$a===0){var g=this.editor.snaps.snapResize({dragDelta:Ya.Sub(f,p),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:Tg(h,u),isAspectRatioLocked:c,isResizingFromCenter:t}).nudge;f.add(g)}var m=Ya.RotWith(t?o.center:o.getHandlePoint(v),o.point,u),y=Ya.Sub(f,m).rot(-u),b=Ya.Sub(p,m).rot(-u),w=Ya.DivV(y,b);Number.isFinite(w.x)||(w.x=1),Number.isFinite(w.y)||(w.y=1);var x="top"===h||"bottom"===h,k="left"===h||"right"===h;c?k?w.y=Math.abs(w.x):x?w.x=Math.abs(w.y):Math.abs(w.x)>Math.abs(w.y)?w.y=Math.abs(w.x)*(w.y<0?-1:1):w.x=Math.abs(w.y)*(w.x<0?-1:1):(x&&(w.x=1),k&&(w.y=1)),this.info.isCreating||this.updateCursor({dragHandle:h,isFlippedX:w.x<0,isFlippedY:w.y<0,rotation:u});var S,_=J(i.keys());try{for(_.s();!(S=_.n()).done;){var P=S.value,E=i.get(P);this.editor.resizeShape(P,w,{initialBounds:E.bounds,dragHandle:h,initialPageTransform:E.pageTransform,initialShape:E.shape,mode:1===s.length&&P===s[0]?"resize_bounds":"scale_shape",scaleOrigin:m,scaleAxisRotation:u})}}catch(C){_.e(C)}finally{_.f()}}},{key:"updateCursor",value:function(e){var t=e.dragHandle,n=e.isFlippedX,r=e.isFlippedY,i=e.rotation,o=Ce({},this.editor.cursor);switch(t){case"top_left":case"bottom_right":o.type="nwse-resize",n!==r&&(o.type="nesw-resize");break;case"top_right":case"bottom_left":o.type="nesw-resize",n!==r&&(o.type="nwse-resize")}o.rotation=i,this.editor.setCursor(o)}}]),n}(_f);D(Cg,"id","resizing");var Ig=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function Tg(e,t){t%=Ga;var n=Math.round(t/(qa/4)),r=Ig.indexOf(e);return Ig[(r+n)%Ig.length]}var Mg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"snapshot",{}),D(_t(e),"info",{}),D(_t(e),"markId",""),D(_t(e),"onEnter",(function(t){e.info=t,e.markId=e.editor.mark("rotate start");var n=Dv({editor:e.editor});if(!n)return e.parent.transition("idle",e.info);e.snapshot=n,e.handleStart()})),D(_t(e),"onExit",(function(){e.editor.setCursor({type:"none"}),e.snapshot={}})),D(_t(e),"onPointerMove",(function(){e.update()})),D(_t(e),"onKeyDown",(function(){e.update()})),D(_t(e),"onKeyUp",(function(){e.update()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"update",(function(){var t=e._getRotationFromPointerPosition({snapToNearestDegree:!1});Nv({editor:e.editor,delta:t,snapshot:e.snapshot,stage:"update"}),e.editor.setCursor({type:vg[e.info.handle],rotation:t+e.snapshot.initialSelectionRotation})})),D(_t(e),"cancel",(function(){e.editor.bailToMark(e.markId),e.info.onInteractionEnd?e.editor.setSelectedTool(e.info.onInteractionEnd,e.info):e.parent.transition("idle",e.info)})),D(_t(e),"complete",(function(){Nv({editor:e.editor,delta:e._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:e.snapshot,stage:"end"}),e.info.onInteractionEnd?e.editor.setSelectedTool(e.info.onInteractionEnd,e.info):e.parent.transition("idle",e.info)})),e}return z(n,[{key:"handleStart",value:function(){var e=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Nv({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.setCursor({type:vg[this.info.handle],rotation:e+this.snapshot.initialSelectionRotation})}},{key:"_getRotationFromPointerPosition",value:function(e){var t=e.snapToNearestDegree,n=this.editor,r=n.selectionPageCenter,i=n.inputs,o=i.shiftKey,a=i.currentPagePoint,s=this.snapshot,u=s.initialCursorAngle,l=s.initialSelectionRotation;if(!r)return l;var c=l+(r.angle(a)-u);if(o)c=us(c,24);else if(t&&(c=Math.round(c/Qa)*Qa,this.editor.isCoarsePointer)){var d=us(c,4),f=as(c,d);Math.abs(f)<function(e){return e*qa/180}(5)&&(c=d)}return c-l}}]),n}(_f);D(Mg,"id","rotating");var jg=function(){function e(t){var n=this;j(this,e),D(this,"state",void 0),D(this,"points",void 0),D(this,"size",void 0),D(this,"color",void 0),D(this,"opacity",void 0),D(this,"delay",void 0),D(this,"timeoutMs",0),D(this,"delayRemaining",0),D(this,"onUpdate",void 0),D(this,"onComplete",void 0),D(this,"prev",null),D(this,"next",null),D(this,"resume",(function(){n.state="active"})),D(this,"pause",(function(){n.state="starting"})),D(this,"stop",(function(){n.delayRemaining=Math.min(n.delayRemaining,200),n.state="stopping"})),D(this,"addPoint",(function(e,t){var r=n.prev,i={x:e,y:t,z:.5};r&&Ya.Dist(r,i)<1||(n.next=i)})),D(this,"tick",(function(e){n.timeoutMs+=e,n.delayRemaining>0&&(n.delayRemaining=Math.max(0,n.delayRemaining-e)),n.timeoutMs>=16&&(n.timeoutMs=0);var t=n.timeoutMs,r=n.state,i=n.prev,o=n.next,a=n.points;switch(r){case"active":o&&o!==i?(n.prev=o,a.push(o),0===n.delayRemaining&&a.length>8&&a.shift(),n.updateScribble()):0===t&&(a.length>1?(a.shift(),n.updateScribble()):n.delayRemaining=n.delay);break;case"stopping":if(0===n.delayRemaining&&0===t){if(1===a.length)return n.state="paused",void n.onComplete();n.size*=.9,a.shift(),n.updateScribble()}}}));var r=t.size,i=void 0===r?20:r,o=t.color,a=void 0===o?"accent":o,s=t.opacity,u=void 0===s?.8:s,l=t.delay,c=void 0===l?0:l,d=t.onComplete,f=t.onUpdate;this.onUpdate=f,this.onComplete=d,this.size=i,this.color=a,this.delay=c,this.opacity=u,this.points=[],this.state="starting",this.prev=null,this.next=null,this.delayRemaining=this.delay,this.resume()}return z(e,[{key:"getScribble",value:function(){return{state:this.state,size:this.size,color:this.color,opacity:this.opacity,delay:this.delay,points:d(this.points)}}},{key:"updateScribble",value:function(){this.onUpdate(this.getScribble())}}]),e}(),Ag=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"hits",new Set),D(_t(e),"size",0),D(_t(e),"scribble",{}),D(_t(e),"initialSelectedIds",new Set),D(_t(e),"newlySelectedIds",new Set),D(_t(e),"onEnter",(function(){e.initialSelectedIds=new Set(e.editor.inputs.shiftKey?e.editor.selectedIds:[]),e.newlySelectedIds=new Set,e.size=0,e.hits.clear(),e.startScribble(),e.updateBrushSelection(),requestAnimationFrame((function(){e.editor.setBrush(null)}))})),D(_t(e),"onExit",(function(){e.editor.setErasingIds([]),e.scribble.stop()})),D(_t(e),"onPointerMove",(function(){e.updateBrushSelection()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onKeyDown",(function(){e.updateBrushSelection()})),D(_t(e),"onKeyUp",(function(){e.editor.inputs.altKey?e.updateBrushSelection():e.parent.transition("brushing",{})})),D(_t(e),"startScribble",(function(){var t;e.scribble.tick&&e.editor.off("tick",null===(t=e.scribble)||void 0===t?void 0:t.tick);e.scribble=new jg({onUpdate:e.onScribbleUpdate,onComplete:e.onScribbleComplete,color:"selection-stroke",opacity:.32,size:12}),e.editor.on("tick",e.scribble.tick)})),D(_t(e),"pushPointToScribble",(function(){var t=e.editor.inputs.currentPagePoint,n=t.x,r=t.y;e.scribble.addPoint(n,r)})),D(_t(e),"onScribbleUpdate",(function(t){e.editor.setScribble(t)})),D(_t(e),"onScribbleComplete",(function(){e.editor.off("tick",e.scribble.tick),e.editor.setScribble(null)})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),e}return z(n,[{key:"updateBrushSelection",value:function(){var e=this.editor,t=e.shapesArray,n=e.inputs,r=n.originPagePoint,i=n.previousPagePoint,o=n.currentPagePoint;this.pushPointToScribble();for(var a,s,u=t,l=0,c=u.length;l<c;l++)if(a=u[l],s=this.editor.getShapeUtil(a),!(this.editor.isShapeOfType(a,Up)||this.newlySelectedIds.has(a.id)||this.editor.isShapeOfType(a,Wp)&&s.hitTestPoint(a,this.editor.getPointInShapeSpace(a,r))||this.editor.isShapeOrAncestorLocked(a))&&s.hitTestLineSegment(a,this.editor.getPointInShapeSpace(a,i),this.editor.getPointInShapeSpace(a,o))){var f=this.editor.getOutermostSelectableShape(a),p=this.editor.getPageMaskById(f.id);if(p)if(null!==Bs(i,o,p))if(!gs(o,p))continue;this.newlySelectedIds.add(f.id)}this.editor.setSelectedIds(d(new Set([].concat(d(this.newlySelectedIds),d(this.initialSelectedIds)))),!0)}},{key:"complete",value:function(){this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.editor.setSelectedIds(d(this.initialSelectedIds),!0),this.parent.transition("idle",{})}}]),n}(_f);D(Ag,"id","scribble_brushing");var Og=function(){function e(t){var n=this;j(this,e),D(this,"prevDroppingShapeId",null),D(this,"currDroppingShapeId",null),D(this,"droppingNodeTimer",null),D(this,"dispose",(function(){n.clear()})),this.editor=t,t.disposables.add(this.dispose)}return z(e,[{key:"updateDroppingNode",value:function(e,t){if(null===this.droppingNodeTimer){var n,r,i=this.editor.inputs.currentPagePoint;this.currDroppingShapeId=null!==(n=null===(r=this.editor.getDroppingShape(i,e))||void 0===r?void 0:r.id)&&void 0!==n?n:null,this.setDragTimer(e,1e3,t)}else this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(e,100,t))}},{key:"setDragTimer",value:function(e,t,n){var r=this;this.droppingNodeTimer=setTimeout((function(){r.editor.batch((function(){r.handleDrag(e,n)})),r.droppingNodeTimer=null}),t)}},{key:"handleDrag",value:function(e,t){var n,r,i=this,o=this.editor.inputs.currentPagePoint;e=Te(e.map((function(e){return i.editor.getShapeById(e.id)})));var a=null!==(n=null===(r=this.editor.getDroppingShape(o,e))||void 0===r?void 0:r.id)&&void 0!==n?n:null;a!==this.currDroppingShapeId&&(this.prevDroppingShapeId=this.currDroppingShapeId,this.currDroppingShapeId=a);var s=this.prevDroppingShapeId;if(a!==s){var u,l,c=s&&this.editor.getShapeById(s),d=a&&this.editor.getShapeById(a);if(this.prevDroppingShapeId=this.currDroppingShapeId,c)null===(u=(l=this.editor.getShapeUtil(c)).onDragShapesOut)||void 0===u||u.call(l,c,e);if(d){var f,p,h=null===(f=(p=this.editor.getShapeUtil(d)).onDragShapesOver)||void 0===f?void 0:f.call(p,d,e);h&&h.shouldHint&&this.editor.setHintingIds([d.id])}else this.editor.setHintingIds([]);null===t||void 0===t||t()}}},{key:"dropShapes",value:function(e){var t=this.currDroppingShapeId;if(this.handleDrag(e),t){var n,r,i=this.editor.getShapeById(t);if(!i)return;null===(n=(r=this.editor.getShapeUtil(i)).onDropShapesOver)||void 0===n||n.call(r,i,e)}}},{key:"clear",value:function(){this.prevDroppingShapeId=null,this.currDroppingShapeId=null,null!==this.droppingNodeTimer&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingIds([])}}]),e}(),Lg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"selectionSnapshot",{}),D(_t(e),"snapshot",{}),D(_t(e),"markId",""),D(_t(e),"isCloning",!1),D(_t(e),"isCreating",!1),D(_t(e),"editAfterComplete",!1),D(_t(e),"dragAndDropManager",new Og(e.editor)),D(_t(e),"onEnter",(function(t){var n=t.isCreating,r=void 0!==n&&n,i=t.editAfterComplete,o=void 0!==i&&i;e.info=t,e.isCreating=r,e.editAfterComplete=o,e.markId=r?"creating":e.editor.mark("translating"),e.handleEnter(t),e.editor.on("tick",e.updateParent)})),D(_t(e),"updateParent",(function(){var t=_t(e).snapshot;e.dragAndDropManager.updateDroppingNode(t.movingShapes,e.updateParentTransforms)})),D(_t(e),"onExit",(function(){e.editor.off("tick",e.updateParent),e.selectionSnapshot={},e.snapshot={},e.editor.snaps.clear(),e.editor.setCursor({type:"default"}),e.dragAndDropManager.clear()})),D(_t(e),"onPointerMove",(function(){e.updateShapes()})),D(_t(e),"onKeyDown",(function(){!e.editor.inputs.altKey||e.isCloning?e.updateShapes():e.startCloning()})),D(_t(e),"onKeyUp",(function(){e.editor.inputs.altKey||!e.isCloning?e.updateShapes():e.stopCloning()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"updateParentTransforms",(function(){var t=_t(e),n=t.editor,r=t.snapshot.shapeSnapshots,i=[];r.forEach((function(e){var t=n.getShapeById(e.shape.id);if(!t)return null;i.push(t);var r=Nn(t.parentId)?null:Cs.Inverse(n.getPageTransformById(t.parentId));e.parentTransform=r}))})),e}return z(n,[{key:"reset",value:function(){this.editor.bailToMark(this.markId)}},{key:"startCloning",value:function(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId=this.editor.mark("translating"),this.editor.duplicateShapes(),this.snapshot=zg(this.editor),this.handleStart(),this.updateShapes())}},{key:"stopCloning",value:function(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId=this.editor.mark("translating"),this.updateShapes()}},{key:"complete",value:function(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd)this.editor.setSelectedTool(this.info.onInteractionEnd);else if(this.editAfterComplete){var e=this.editor.onlySelectedShape;e&&(this.editor.setEditingId(e.id),this.editor.setSelectedTool("select"),this.editor.root.current.value.transition("editing_shape",{}))}else this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.reset(),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}},{key:"handleEnter",value:function(e){this.isCloning=!1,this.info=e,this.editor.setCursor({type:"move"}),this.selectionSnapshot=zg(this.editor),this.isCreating||!this.editor.inputs.altKey?(this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()):this.startCloning()}},{key:"handleStart",value:function(){var e=this,t=this.snapshot.movingShapes,n=[];t.forEach((function(t){var r,i=e.editor.getShapeUtil(t),o=null===(r=i.onTranslateStart)||void 0===r?void 0:r.call(i,t);o&&n.push(o)})),n.length>0&&this.editor.updateShapes(n)}},{key:"handleEnd",value:function(){var e=this,t=this.snapshot.movingShapes,n=[];t.forEach((function(t){var r,i=e.editor.getShapeById(t.id),o=e.editor.getShapeUtil(t),a=null===(r=o.onTranslateEnd)||void 0===r?void 0:r.call(o,t,i);a&&n.push(a)})),n.length>0&&this.editor.updateShapes(n)}},{key:"handleChange",value:function(){var e=this,t=this.snapshot.movingShapes,n=[];t.forEach((function(t){var r,i=e.editor.getShapeById(t.id),o=e.editor.getShapeUtil(t),a=null===(r=o.onTranslate)||void 0===r?void 0:r.call(o,t,i);a&&n.push(a)})),n.length>0&&this.editor.updateShapes(n)}},{key:"updateShapes",value:function(){var e=this.snapshot;this.dragAndDropManager.updateDroppingNode(e.movingShapes,this.updateParentTransforms),function(e){var t=e.editor,n=e.shapeSnapshots,r=e.averagePagePoint,i=e.initialSelectionPageBounds,o=e.initialSelectionSnapPoints,a=t.inputs,s=t.isGridMode,u=t.gridSize,l=Ya.Sub(a.currentPagePoint,a.originPagePoint),c=t.inputs.shiftKey?Math.abs(l.x)<Math.abs(l.y)?"x":"y":null;"x"===c?l.x=0:"y"===c&&(l.y=0);if(t.snaps.clear(),(t.isSnapMode?!a.ctrlKey:a.ctrlKey)&&t.inputs.pointerVelocity.len()<.5){var d=t.snaps.snapTranslate({dragDelta:l,initialSelectionPageBounds:i,lockedAxis:c,initialSelectionSnapPoints:o}).nudge;l.add(d)}var f=Ya.Add(r,l);s&&!a.ctrlKey&&f.snapToGrid(u);var p=Ya.Sub(f,r);t.updateShapes(Te(n.map((function(e){var t=e.shape,n=e.pagePoint,r=e.parentTransform,i=Ya.Add(n,p),o=r?Cs.applyToPoint(r,i):i;return{id:t.id,type:t.type,x:o.x,y:o.y}}))),!0)}({editor:this.editor,shapeSnapshots:e.shapeSnapshots,averagePagePoint:e.averagePagePoint,initialSelectionPageBounds:e.initialPageBounds,initialSelectionSnapPoints:e.initialSnapPoints}),this.handleChange()}}]),n}(_f);function zg(e){var t=[],n=[],r=Te(e.selectedIds.map((function(r){var i=e.getShapeById(r);if(!i)return null;t.push(i);var o=e.getPagePointById(r);return o?(n.push(o),{shape:i,pagePoint:o,parentTransform:Dn.isId(i.parentId)?null:Cs.Inverse(e.getPageTransformById(i.parentId))}):null})));return{averagePagePoint:Ya.Average(n),movingShapes:t,shapeSnapshots:r,initialPageBounds:e.selectedPageBounds,initialSnapPoints:1===e.selectedIds.length?e.snaps.snapPointsCache.get(e.selectedIds[0]):e.selectedPageBounds?e.selectedPageBounds.snapPoints.map((function(e,t){return{id:"selection:"+t,x:e.x,y:e.y}})):[]}}D(Lg,"id","translating");var Dg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onExit",(function(){e.editor.pageState.editingId&&e.editor.setEditingId(null)})),e}return z(n)}(_f);D(Dg,"id","select"),D(Dg,"initial","idle"),D(Dg,"children",(function(){return[hg,mg,wg,xg,Eg,Lg,lg,Ag,kg,Pg,gg,bg,Cg,Mg,_g,Sg,yg]}));var Ng=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"onEnter",(function(t){e.info=t})),D(_t(e),"onPointerDown",(function(){e.parent.transition("pointing",e.info)})),e}return z(n)}(_f);D(Ng,"id","idle");var Rg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"onEnter",(function(t){e.info=t})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onPointerMove",(function(){e.editor.inputs.isDragging&&e.parent.transition("zoom_brushing",e.info)})),D(_t(e),"onCancel",(function(){e.cancel()})),e}return z(n,[{key:"complete",value:function(){var e=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(e,{duration:220}):this.editor.zoomIn(e,{duration:220}),this.parent.transition("idle",this.info)}},{key:"cancel",value:function(){this.parent.transition("idle",this.info)}}]),n}(_f);D(Rg,"id","pointing");var Bg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"zoomBrush",new ws),D(_t(e),"onEnter",(function(t){e.info=t,e.update()})),D(_t(e),"onExit",(function(){e.editor.setZoomBrush(null)})),D(_t(e),"onPointerMove",(function(){e.update()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),e}return z(n,[{key:"update",value:function(){var e=this.editor.inputs,t=e.originPagePoint,n=e.currentPagePoint;this.zoomBrush.setTo(ws.FromPoints([t,n])),this.editor.setZoomBrush(this.zoomBrush.toJson())}},{key:"cancel",value:function(){this.parent.transition("idle",this.info)}},{key:"complete",value:function(){var e=this.zoomBrush,t=8/this.editor.zoomLevel;if(e.width<t&&e.height<t){var n=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(n,{duration:220}):this.editor.zoomIn(n,{duration:220})}else{var r=this.editor.inputs.altKey?this.editor.zoomLevel/2:void 0;this.editor.zoomToBounds(e.x,e.y,e.width,e.height,r,{duration:220})}this.parent.transition("idle",this.info)}}]),n}(_f);D(Bg,"id","zoom_brushing");var Fg=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"onEnter",(function(t){e.info=t,e.updateCursor()})),D(_t(e),"onExit",(function(){e.editor.setZoomBrush(null),e.editor.setCursor({type:"default"})})),D(_t(e),"onKeyDown",(function(){e.updateCursor()})),D(_t(e),"onKeyUp",(function(t){e.updateCursor(),"KeyZ"===t.code&&e.complete()})),D(_t(e),"onInterrupt",(function(){e.complete()})),e}return z(n,[{key:"updateCursor",value:function(){this.editor.inputs.altKey?this.editor.setCursor({type:"zoom-out"}):this.editor.setCursor({type:"zoom-in"})}},{key:"complete",value:function(){this.info.onInteractionEnd&&"select"!==this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("select",{})}}]),n}(_f);D(Fg,"id","zoom"),D(Fg,"initial","idle"),D(Fg,"children",(function(){return[Ng,Bg,Rg]}));var Ug=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onKeyDown",(function(t){if("KeyZ"===t.code)if(!t.shiftKey&&!t.ctrlKey){var n,r=e.current.value;r&&"idle"===(null===(n=r.current.value)||void 0===n?void 0:n.id)&&e.editor.setSelectedTool("zoom",Ce(Ce({},t),{},{onInteractionEnd:r.id}))}})),e}return z(n)}(_f);D(Ug,"id","root"),D(Ug,"initial","select"),D(Ug,"children",(function(){return[Dg,Fg]}));var Kg,Vg,Wg=Object.defineProperty,Hg=Object.getOwnPropertyDescriptor,Yg=function(e,t,n,r){for(var i,o=r>1?void 0:r?Hg(t,n):t,a=e.length-1;a>=0;a--)(i=e[a])&&(o=(r?i(t,n,o):i(o))||o);return r&&o&&Wg(t,n,o),o},Xg=function(e){Et(n,e);var t=Tt(n);function n(e){var r,i=e.store,o=e.user,a=e.shapes,s=e.tools,u=e.getContainer;j(this,n),D(_t(r=t.call(this)),"store",void 0),D(_t(r),"root",void 0),D(_t(r),"disposables",new Set),D(_t(r),"_tickManager",new sg(_t(r))),D(_t(r),"_updateDepth",0),D(_t(r),"snaps",new ng(_t(r))),D(_t(r),"user",void 0),D(_t(r),"textMeasure",void 0),D(_t(r),"isSafari",void 0),D(_t(r),"isIos",void 0),D(_t(r),"isChromeForIos",void 0),D(_t(r),"getContainer",void 0),D(_t(r),"history",new Gv(_t(r),(function(){return r._complete()}),(function(e){r.annotateError(e,{origin:"history.batch",willCrashApp:!0}),r.crash(e)}))),D(_t(r),"shapeUtils",void 0),D(_t(r),"_invalidParents",new Set),D(_t(r),"_crashingError",null),D(_t(r),"_canMoveCamera",ue("can move camera",!0)),D(_t(r),"_isFocused",ue("_isFocused",!1)),D(_t(r),"_dpr",ue("devicePixelRatio","undefined"===typeof window?1:window.devicePixelRatio)),D(_t(r),"_isCoarsePointer",ue("isCoarsePointer",!1)),D(_t(r),"_openMenus",ue("open-menus",[])),D(_t(r),"_isChangingStyle",ue("isChangingStyle",!1)),D(_t(r),"_isChangingStyleTimeout",-1),D(_t(r),"_isPenMode",ue("isPenMode",!1)),D(_t(r),"_isReadOnly",ue("isReadOnly",!1)),D(_t(r),"_updateInstanceState",r.history.createCommand("updateTabState",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=r.instanceState;return{data:{prev:i,next:Ce(Ce({},i),e)},squashing:n,ephemeral:t}}),{do:function(e){var t=e.next;r.store.put([t])},undo:function(e){var t=e.prev;r.store.put([t])},squash:function(e,t){return{prev:e.prev,next:t.next}}})),D(_t(r),"_setInstancePageState",r.history.createCommand("setInstancePageState",(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{data:{prev:r.store.get(null!==(t=e.id)&&void 0!==t?t:r.pageState.id),partial:e},ephemeral:n}}),{do:function(e){var t=e.prev,n=e.partial;r.store.update(t.id,(function(e){return Ce(Ce({},e),n)}))},undo:function(e){var t=e.prev;r.store.update(t.id,(function(){return t}))}})),D(_t(r),"_setSelectedIds",r.history.createCommand("setSelectedIds",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=r.pageState.selectedIds,i=new Set(r.pageState.selectedIds);return e.length===i.size&&e.every((function(e){return i.has(e)}))?null:{data:{ids:e,prevSelectedIds:n},squashing:t,preservesRedoStack:!0}}),{do:function(e){var t=e.ids;r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:t})}))},undo:function(e){var t=e.prevSelectedIds;r.store.update(r.pageState.id,(function(){return Ce(Ce({},r.pageState),{},{selectedIds:t})}))},squash:function(e,t){return{ids:t.ids,prevSelectedIds:e.prevSelectedIds}}})),D(_t(r),"_setFocusLayer",r.history.createCommand("setFocusLayer",(function(e){if(null!==e||r.canUndo)return{data:{prev:r.pageState.focusLayerId,next:e},preservesRedoStack:!0,squashing:!0}}),{do:function(e){var t=e.next;r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{focusLayerId:t})}))},undo:function(e){var t=e.prev;r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{focusLayerId:t})}))},squash:function(e,t){return{prev:e.prev,next:t.next}}})),D(_t(r),"_willSetInitialBounds",!0),D(_t(r),"_viewportAnimation",null),D(_t(r),"_cameraState",ue("camera state","idle")),D(_t(r),"_cameraStateTimeoutRemaining",0),D(_t(r),"_lastUpdateRenderingBoundsTimestamp",Date.now()),D(_t(r),"_decayCameraStateTimeout",(function(e){r._cameraStateTimeoutRemaining-=e,r._cameraStateTimeoutRemaining<=0&&(r.off("tick",r._decayCameraStateTimeout),r._cameraState.set("idle"),r.updateRenderingBounds())})),D(_t(r),"_tickCameraState",(function(){r._cameraStateTimeoutRemaining=64;var e=Date.now();"idle"===r._cameraState.__unsafe__getWithoutCapture()?(r._lastUpdateRenderingBoundsTimestamp=e,r._cameraState.set("moving"),r.on("tick",r._decayCameraStateTimeout)):e-r._lastUpdateRenderingBoundsTimestamp>620&&r.updateRenderingBounds()})),D(_t(r),"_renderingBounds",ue("rendering viewport",new ws)),D(_t(r),"_renderingBoundsExpanded",ue("rendering viewport expanded",new ws)),D(_t(r),"_currentPageShapeIds",void 0),D(_t(r),"_setCurrentPageId",r.history.createCommand("setCurrentPage",(function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).stopFollowing,n=void 0===t||t;if(r.store.has(e))return n&&r.instanceState.followingUserId&&r.stopFollowingUser(),{data:{toId:e,fromId:r.currentPageId},squashing:!0,preservesRedoStack:!0};console.error("Tried to set the current page id to a page that doesn't exist.")}),{do:function(e){var t=e.toId;if(r.store.has(t)){if(!r.getPageStateByPageId(t)){var n=kn.create({id:kn.createId(t)});r.store.put([n,Lr.create({id:Lr.createId(t),pageId:t})])}r.store.put([Ce(Ce({},r.instanceState),{},{currentPageId:t})]),r.updateRenderingBounds()}},undo:function(e){var t=e.fromId;r.store.has(t)&&(r.store.put([Ce(Ce({},r.instanceState),{},{currentPageId:t})]),r.updateRenderingBounds())},squash:function(e,t){var n=e.fromId;return{toId:t.toId,fromId:n}}})),D(_t(r),"_updatePage",r.history.createCommand("updatePage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r.isReadOnly)return null;var n=r.getPageById(e.id);return n?{data:{prev:n,partial:e},squashing:t}:null}),{do:function(e){var t=e.partial;r.store.update(t.id,(function(e){return Ce(Ce({},e),t)}))},undo:function(e){var t=e.prev,n=e.partial;r.store.update(n.id,(function(){return t}))},squash:function(e,t){return{prev:Ce(Ce({},e.prev),t.prev),partial:t.partial}}})),D(_t(r),"_createPage",r.history.createCommand("createPage",(function(e){var t,n,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dn.createId(),a=arguments.length>2?arguments[2]:void 0;if(r.isReadOnly)return null;if(r.pages.length>=40)return null;var s=r.pages,u=null!==(t=null!==a&&void 0!==a?a:null===(n=s[s.length-1])||void 0===n?void 0:n.index)&&void 0!==t?t:"a1",l=null===(i=s[s.findIndex((function(e){return e.index===u}))+1])||void 0===i?void 0:i.index;e=function(e,t){for(var n=e,r=new Set(t);r.has(n);){var i;n=null!==(i=/^.*(\d+)$/.exec(n))&&void 0!==i&&i[1]?n.replace(/(\d+)(?=\D?)$/,(function(e){return(+e+1).toString()})):"".concat(n," 1")}return n}(e,s.map((function(e){return e.name})));var c=Dn.create({id:o,name:e,index:l&&u!==l?C(u,l):I(u),meta:{}}),d=kn.create({id:kn.createId(c.id)}),f=Lr.create({id:Lr.createId(c.id),pageId:c.id});return{data:{prevSelectedPageId:r.currentPageId,newPage:c,newTabPageState:f,newCamera:d}}}),{do:function(e){var t=e.newPage,n=e.newTabPageState,i=e.newCamera;r.store.put([t,i,n,Ce(Ce({},r.instanceState),{},{currentPageId:t.id})]),r.updateRenderingBounds()},undo:function(e){var t=e.newPage,n=e.prevSelectedPageId,i=e.newTabPageState,o=e.newCamera;1!==r.pages.length&&(r.store.remove([i.id,t.id,o.id]),r.store.has(n)&&r.currentPageId!==n&&r.store.put([Ce(Ce({},r.instanceState),{},{currentPageId:n})]),r.updateRenderingBounds())}})),D(_t(r),"_deletePage",r.history.createCommand("delete_page",(function(e){if(r.isReadOnly)return null;var t=_t(r).pages;if(1===t.length)return null;var n=r.getPageById(e),i=r._pageStates.value.filter((function(t){return t.pageId===e}));if(!n)return null;if(e===r.currentPageId){var o,a=t.findIndex((function(t){return t.id===e})),s=null!==(o=t[a-1])&&void 0!==o?o:t[a+1];r.setCurrentPageId(s.id)}return{data:{id:e,deletedPage:n,deletedPageStates:i}}}),{do:function(e){var t=e.deletedPage,n=e.deletedPageStates,i=_t(r).pages;if(1!==i.length){if(t.id===r.currentPageId){var o,a=i.findIndex((function(e){return e.id===t.id})),s=null!==(o=i[a-1])&&void 0!==o?o:i[a+1];r.setCurrentPageId(s.id)}r.store.remove(n.map((function(e){return e.id}))),r.store.remove([t.id]),r.updateRenderingBounds()}},undo:function(e){var t=e.deletedPage,n=e.deletedPageStates;r.store.put([t]),r.store.put(n),r.updateRenderingBounds()}})),D(_t(r),"_createAssets",r.history.createCommand("createAssets",(function(e){return r.isReadOnly||e.length<=0?null:{data:{assets:e}}}),{do:function(e){var t=e.assets;r.store.put(t)},undo:function(e){var t=e.assets;r.store.remove(t.map((function(e){return e.id})))}})),D(_t(r),"_deleteAssets",r.history.createCommand("deleteAssets",(function(e){if(!r.isReadOnly&&!(e.length<=0)){var t=Te(e.map((function(e){return r.store.get(e)})));return{data:{ids:e,prev:t}}}}),{do:function(e){var t=e.ids;r.store.remove(t)},undo:function(e){var t=e.prev;r.store.put(t)}})),D(_t(r),"_updateAssets",r.history.createCommand("updateAssets",(function(e){if(!r.isReadOnly&&!(e.length<=0)){return{data:{snapshots:{},assets:e}}}}),{do:function(e){var t=e.assets,n=e.snapshots;r.store.put(t.map((function(e){var t=r.store.get(e.id);return n[e.id]=t,Ce(Ce({},t),e)})))},undo:function(e){var t=e.snapshots;r.store.put(Object.values(t))}})),D(_t(r),"_parentIdsToChildIds",void 0),D(_t(r),"_childIdsCache",new Vc),D(_t(r),"_createShapes",r.history.createCommand("createShapes",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r.isReadOnly)return null;if(e.length<=0)return null;var n=_t(r),i=n.currentPageShapeIds,o=n.selectedIds,a=t?o:void 0,s=e.length+i.size>Iu;s&&qg(_t(r));var u=s?e.slice(0,Iu-i.size):e;return 0===u.length?null:{data:{currentPageId:r.currentPageId,createdIds:e.map((function(e){return e.id})),prevSelectedIds:a,partials:u,select:t}}}),{do:function(e){var t=e.createdIds,n=e.partials,i=e.select,o=_t(r).focusLayerId;n=n.map((function(e){if(!e.parentId||!r.store.get(e.parentId)&&!n.find((function(t){return t.id===e.parentId}))){var t,i;e=Ce({},e);var a=r.getParentIdForNewShapeAtPoint({x:null!==(t=e.x)&&void 0!==t?t:0,y:null!==(i=e.y)&&void 0!==i?i:0},e.type);if(e.parentId=a,Ki(a)){var s,u,l,c=r.getPointInShapeSpace(r.getShapeById(a),{x:null!==(s=e.x)&&void 0!==s?s:0,y:null!==(u=e.y)&&void 0!==u?u:0});e.x=c.x,e.y=c.y,e.rotation=-r.getPageRotationById(a)+(null!==(l=e.rotation)&&void 0!==l?l:0)}return e.parentId===e.id&&(e.parentId=o),e}return e}));var a,s=new Map,u=[],c=J(n);try{for(c.s();!(a=c.n()).done;){var d,f,p,h,v=a.value,g=r.getShapeUtil(v),m=v.index;if(!m){var y,b=null!==(y=v.parentId)&&void 0!==y?y:o;s.has(b)||s.set(b,r.getHighestIndexForParent(b)),m=s.get(b),s.set(b,I(m))}var w,x=g.getDefaultProps(),k=J(g.styleProps);try{for(k.s();!(w=k.n()).done;){var S=l(w.value,2),_=S[0];x[S[1]]=r.getStyleForNextShape(_)}}catch(C){k.e(C)}finally{k.f()}var P=r.store.schema.types.shape.create(Ce(Ce({},v),{},{index:m,opacity:null!==(d=v.opacity)&&void 0!==d?d:r.instanceState.opacityForNextShape,parentId:null!==(f=v.parentId)&&void 0!==f?f:o,props:"props"in v?Ce(Ce({},x),v.props):x}));if(void 0===P.index)throw Error("no index!");var E=null===(p=(h=r.getShapeUtil(P)).onBeforeCreate)||void 0===p?void 0:p.call(h,P);E&&(P=E),u.push(P)}}catch(C){c.e(C)}finally{c.f()}u.forEach((function(e){e.meta=r.getInitialMetaForShape(e)})),r.store.put(u),i&&r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:t})}))},undo:function(e){var t=e.createdIds,n=e.prevSelectedIds;r.store.remove(t),n&&r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:n})}))}})),D(_t(r),"animatingShapes",new Map),D(_t(r),"_updateShapes",r.history.createCommand("updateShapes",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r.isReadOnly)return null;var n=Te(e),i=Object.fromEntries(Te(n.map((function(e){var t=e.id;return r.getShapeById(t)}))).map((function(e){return[e.id,e]})));if(n.length<=0)return null;var o=Te(n.map((function(e){var t,n=i[e.id];if(!n)return null;for(var r=null,o=0,a=Object.entries(e);o<a.length;o++){var s=l(a[o],2),u=s[0],c=s[1];if(void 0!==c)switch(u){case"id":case"type":continue;default:if(c!==n[u])if(r||(r=Ce({},n)),"props"===u){for(var d=Ce({},n.props),f=0,p=Object.entries(c);f<p.length;f++){var h=l(p[f],2),v=h[0],g=h[1];void 0!==g&&(d[v]=g)}r.props=d}else if("meta"===u){for(var m=Ce({},n.meta),y=0,b=Object.entries(c);y<b.length;y++){var w=l(b[y],2),x=w[0],k=w[1];void 0!==k&&(m[x]=k)}r.meta=m}else r[u]=c}}return null!==(t=r)&&void 0!==t?t:n}))),a=Object.fromEntries(o.map((function(e){return[e.id,e]})));return{data:{snapshots:i,updates:a},squashing:t}}),{do:function(e){for(var t=e.updates,n=Object.values(t),i=0;i<n.length;i++){var o,a,s=n[i],u=r.store.get(s.id);if(u){var l=null===(o=(a=r.getShapeUtil(s)).onBeforeUpdate)||void 0===o?void 0:o.call(a,u,s);l&&(n[i]=l)}}r.store.put(n)},undo:function(e){var t=e.snapshots;r.store.put(Object.values(t))},squash:function(e,t){return{snapshots:Ce(Ce({},t.snapshots),e.snapshots),updates:Ce(Ce({},e.updates),t.updates)}}})),D(_t(r),"_deleteShapes",r.history.createCommand("delete_shapes",(function(e){if(r.isReadOnly)return null;if(0===e.length)return null;var t,n=d(r.pageState.selectedIds),i=new Set(e),o=J(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;r.visitDescendants(a,(function(e){i.add(e)}))}}catch(f){o.e(f)}finally{o.f()}var s=d(i),u=r._arrowBindingsIndex.value,l=Te(s.flatMap((function(e){var t=r.getShapeById(e),n=u[e];return n&&n.length>0?n.map((function(e){var t=e.arrowId;return r.getShapeById(t)})).concat(t):t}))),c=n.filter((function(e){return!i.has(e)}));return{data:{deletedIds:s,snapshots:l,prevSelectedIds:n,postSelectedIds:c}}}),{do:function(e){var t=e.deletedIds,n=e.postSelectedIds;r.store.remove(t),r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:n})}))},undo:function(e){var t=e.snapshots,n=e.prevSelectedIds;r.store.put(t),r.store.update(r.pageState.id,(function(e){return Ce(Ce({},e),{},{selectedIds:n})}))}})),D(_t(r),"_selectionSharedStyles",ve("_selectionSharedStyles",(function(){var e,t=_t(r).selectedShapes,n=new uv,i=J(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;r._extractSharedStyles(o,n)}}catch(a){i.e(a)}finally{i.f()}return n}))),D(_t(r),"externalContentManager",new Kv(_t(r))),D(_t(r),"inputs",{originPagePoint:new Ya,originScreenPoint:new Ya,previousPagePoint:new Ya,previousScreenPoint:new Ya,currentPagePoint:new Ya,currentScreenPoint:new Ya,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new Ya}),D(_t(r),"_clickManager",new Uv(_t(r))),D(_t(r),"_prevCursor","default"),D(_t(r),"_shiftKeyTimeout",-1),D(_t(r),"_setShiftKeyTimeout",(function(){r.inputs.shiftKey=!1,r.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:r.inputs.shiftKey,ctrlKey:r.inputs.ctrlKey,altKey:r.inputs.altKey,code:"ShiftLeft"})})),D(_t(r),"_altKeyTimeout",-1),D(_t(r),"_setAltKeyTimeout",(function(){r.inputs.altKey=!1,r.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:r.inputs.shiftKey,ctrlKey:r.inputs.ctrlKey,altKey:r.inputs.altKey,code:"AltLeft"})})),D(_t(r),"_ctrlKeyTimeout",-1),D(_t(r),"_setCtrlKeyTimeout",(function(){r.inputs.ctrlKey=!1,r.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:r.inputs.shiftKey,ctrlKey:r.inputs.ctrlKey,altKey:r.inputs.altKey,code:"ControlLeft"})})),D(_t(r),"_restoreToolId","select"),D(_t(r),"_pinchStart",1),D(_t(r),"_didPinch",!1),D(_t(r),"_selectedIdsAtPointerDown",[]),D(_t(r),"capturedPointerId",null),r.store=i,r.user=new ug(null!==o&&void 0!==o?o:wf()),r.getContainer=null!==u&&void 0!==u?u:function(){return document.body},r.textMeasure=new ag(_t(r)),r.root=new Ug(_t(r));var c,f=av(a),p=new Set(Object.keys(i.schema.types.shape.migrations.subTypeMigrations)),h=J(f);try{for(h.s();!(c=h.n()).done;){var v=c.value;if(!p.has(v.type))throw Error('Editor and store have different shapes: "'.concat(v.type,'" was passed into the editor but not the schema'));p.delete(v.type)}}catch(F){h.e(F)}finally{h.f()}if(p.size>0)throw Error('Editor and store have different shapes: "'.concat(d(p)[0],'" is present in the store schema but not provided to the editor'));var g,m={},y=new Map,b=J(f);try{for(b.s();!(g=b.n()).done;){var w=g.value,x=w.util,k=w.props,S=Wi(null!==k&&void 0!==k?k:{});m[x.type]=new x(_t(r),x.type,S);var _,P=J(S.keys());try{for(P.s();!(_=P.n()).done;){var E=_.value;if(y.has(E.id)){if(y.get(E.id)!==E)throw Error('Multiple style props with id "'.concat(E.id,'" in use. Style prop IDs must be unique.'))}else y.set(E.id,E)}}catch(F){P.e(F)}finally{P.f()}}}catch(F){b.e(F)}finally{b.f()}r.shapeUtils=m;var T,M=J(f);try{for(M.s();!(T=M.n()).done;){var A=T.value.tool;if(A){if(Ke(r.root.children,A.id))throw Error("Can't override tool with id \"".concat(A.id,'"'));r.root.children[A.id]=new A(_t(r))}}}catch(F){M.e(F)}finally{M.f()}var O,L=J(s);try{for(L.s();!(O=L.n()).done;){var z=O.value;if(Ke(r.root.children,z.id))throw Error("Can't override tool with id \"".concat(z.id,'"'));r.root.children[z.id]=new z(_t(r))}}catch(F){L.e(F)}finally{L.f()}"undefined"!==typeof window&&"navigator"in window?(r.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),r.isChromeForIos=/crios.*safari/i.test(navigator.userAgent)):(r.isSafari=!1,r.isIos=!1,r.isChromeForIos=!1),r.store.onBeforeDelete=function(e){"shape"===e.typeName?r._shapeWillBeDeleted(e):"page"===e.typeName&&r._pageWillBeDeleted(e)},r.store.onAfterChange=function(e,t){r._updateDepth++,r._updateDepth>1e3&&console.error("[onAfterChange] Maximum update depth exceeded, bailing out."),"shape"===e.typeName&&"shape"===t.typeName?r._shapeDidChange(e,t):"instance_page_state"===e.typeName&&"instance_page_state"===t.typeName&&r._pageStateDidChange(e,t),r._updateDepth--},r.store.onAfterCreate=function(e){if("shape"===e.typeName&&r.isShapeOfType(e,tp)&&r._arrowDidUpdate(e),"page"===e.typeName){var t=kn.createId(e.id),n=Lr.createId(e.id);r.store.has(t)||r.store.put([kn.create({id:t})]),r.store.has(n)||r.store.put([Lr.create({id:n,pageId:e.id})])}},r._currentPageShapeIds=function(e,t){var n=e.query.ids("shape"),r=null;function i(){var i=t();return r=i,new Set(d(n.value).filter((function(t){return Fv(e,i,e.get(t))})))}return ve("_shapeIdsInCurrentPage",(function(n,o){if(ce(n))return i();var a=t();if(a!==r)return i();var s=e.history.getDiffSince(o);if(s===Q)return i();var u,c=new Pe(n),d=J(s);try{for(d.s();!(u=d.n()).done;){for(var f=u.value,p=0,h=Object.values(f.added);p<h.length;p++){var v=h[p];Ui(v)&&Fv(e,a,v)&&c.add(v.id)}for(var g=0,m=Object.values(f.updated);g<m.length;g++){var y=l(m[g],2),b=(y[0],y[1]);Ui(b)&&(Fv(e,a,b)?c.add(b.id):c.remove(b.id))}for(var w=0,x=Object.keys(f.removed);w<x.length;w++){var k=x[w];Ki(k)&&c.remove(k)}}}catch(F){d.e(F)}finally{d.f()}var S=c.get();return S?fe(S.value,S.diff):n}))}(r.store,(function(){return r.currentPageId})),r._parentIdsToChildIds=function(e){var t=e.query.ids("shape");function n(){var n={};return t.value.forEach((function(t){var r=e.get(t);n[r.parentId]||(n[r.parentId]=[]),n[r.parentId].push([t,r.index])})),Object.values(n).forEach((function(e){return e.sort((function(e,t){return e[1]<t[1]?-1:1}))})),n}return ve("parentsToChildrenWithIndexes",(function(t,r){var i;if(ce(t))return n();var o=e.history.getDiffSince(r);if(o===Q)return n();if(0===o.length)return t;for(var a,s=null,u=function(e){s||(s=Ce({},t)),s[e]?s[e]===t[e]&&(s[e]=d(s[e])):s[e]=[]},c=new Set,f=0,p=o.length;f<p;f++){a=o[f];for(var h=0,v=Object.values(a.added);h<v.length;h++){var g=v[h];Ui(g)&&(u(g.parentId),s[g.parentId].push([g.id,g.index]),c.add(s[g.parentId]))}for(var m=function(){var e=l(b[y],2),t=e[0],n=e[1];if(!Ui(n))return"continue";if(!Ui(t))return"continue";if(t.parentId!==n.parentId)u(t.parentId),u(n.parentId),s[t.parentId].splice(s[t.parentId].findIndex((function(e){return e[0]===n.id})),1),s[n.parentId].push([n.id,n.index]),c.add(s[n.parentId]);else if(t.index!==n.index){u(n.parentId);var r=s[n.parentId].findIndex((function(e){return e[0]===n.id}));s[n.parentId][r]=[n.id,n.index],c.add(s[n.parentId])}},y=0,b=Object.values(a.updated);y<b.length;y++)m();for(var w=function(){var e=k[x];if(!Ui(e))return"continue";u(e.parentId),s[e.parentId].splice(s[e.parentId].findIndex((function(t){return t[0]===e.id})),1)},x=0,k=Object.values(a.removed);x<k.length;x++)w()}var S,_=J(c);try{for(_.s();!(S=_.n()).done;)S.value.sort((function(e,t){return e[1]<t[1]?-1:1}))}catch(F){_.e(F)}finally{_.f()}return null!==(i=s)&&void 0!==i?i:t}))}(r.store),r.disposables.add(r.store.listen((function(e){r.emit("change",e)})));var N=r.getContainer(),R=function(){r._isFocused.set(!0)},B=function(){r._isFocused.set(!1)};return N.addEventListener("focusin",R),N.addEventListener("focus",R),N.addEventListener("focusout",B),N.addEventListener("blur",B),r.disposables.add((function(){N.removeEventListener("focusin",R),N.removeEventListener("focus",R),N.removeEventListener("focusout",B),N.removeEventListener("blur",B)})),r.store.ensureStoreIsUsable(),r.setPageState({editingId:null,hoveredId:null,erasingIds:[]},!0),r.root.enter(void 0,"initial"),r.instanceState.followingUserId&&r.stopFollowingUser(),r.updateRenderingBounds(),requestAnimationFrame((function(){r._tickManager.start()})),r}return z(n,[{key:"dispose",value:function(){this.disposables.forEach((function(e){return e()})),this.disposables.clear()}},{key:"undo",value:function(){return this.history.undo()}},{key:"canUndo",get:function(){return this.history.numUndos>0}},{key:"redo",value:function(){return this.history.redo(),this}},{key:"canRedo",get:function(){return this.history.numRedos>0}},{key:"mark",value:function(e,t,n){return this.history.mark(e,t,n)}},{key:"bail",value:function(){return this.history.bail(),this}},{key:"bailToMark",value:function(e){return this.history.bailToMark(e),this}},{key:"batch",value:function(e){return this.history.batch(e),this}},{key:"getShapeUtil",value:function(e){var t=Ve(this.shapeUtils,e.type);return Le(t,'No shape util found for type "'.concat(e.type,'"')),"prototype"in e&&e.prototype instanceof Rc&&Le(t instanceof e,'Shape util found for type "'.concat(e.type,'" is not an instance of the provided constructor')),t}},{key:"_arrowBindingsIndex",get:function(){return function(e){var t=e.store,n=t.query.filterHistory("shape"),r=t.query.records("shape",(function(){return{type:{eq:"arrow"}}}));function i(){var e,t={},n=J(r.value);try{for(n.s();!(e=n.n()).done;){var i=e.value,o=i.props,a=o.start,s=o.end;if("binding"===a.type){var u=t[a.boundShapeId];u?u.push({arrowId:i.id,handleId:"start"}):t[a.boundShapeId]=[{arrowId:i.id,handleId:"start"}]}if("binding"===s.type){var l=t[s.boundShapeId];l?l.push({arrowId:i.id,handleId:"end"}):t[s.boundShapeId]=[{arrowId:i.id,handleId:"end"}]}}}catch(c){n.e(c)}finally{n.f()}return t}return ve("arrowBindingsIndex",(function(t,r){var o;if(ce(t))return i();var a=t,s=n.getDiffSince(r);if(s===Q)return i();var u=void 0;function c(e){u||(u=Ce({},a)),u[e]?u[e]===a[e]&&(u[e]=d(u[e])):u[e]=[]}function f(e,t,n){c(e),u[e]=u[e].filter((function(e){return e.arrowId!==t||e.handleId!==n})),0===u[e].length&&delete u[e]}function p(e,t,n){c(e),u[e].push({arrowId:t,handleId:n})}var h,v=J(s);try{for(v.s();!(h=v.n()).done;){for(var g=h.value,m=0,y=Object.values(g.added);m<y.length;m++){var b=y[m];if(e.isShapeOfType(b,tp)){var w=b.props,x=w.start,k=w.end;"binding"===x.type&&p(x.boundShapeId,b.id,"start"),"binding"===k.type&&p(k.boundShapeId,b.id,"end")}}for(var S=0,_=Object.values(g.updated);S<_.length;S++){var P=l(_[S],2),E=P[0],C=P[1];if(e.isShapeOfType(E,tp)&&e.isShapeOfType(C,tp))for(var I=0,T=["start","end"];I<T.length;I++){var M=T[I],j=E.props[M],A=C.props[M];"binding"===j.type&&"point"===A.type?f(j.boundShapeId,E.id,M):"point"===j.type&&"binding"===A.type?p(A.boundShapeId,C.id,M):"binding"===j.type&&"binding"===A.type&&j.boundShapeId!==A.boundShapeId&&(f(j.boundShapeId,E.id,M),p(A.boundShapeId,C.id,M))}}for(var O=0,L=Object.values(g.removed);O<L.length;O++){var z=L[O];if(e.isShapeOfType(z,tp)){var D=z.props,N=D.start,R=D.end;"binding"===N.type&&f(N.boundShapeId,z.id,"start"),"binding"===R.type&&f(R.boundShapeId,z.id,"end")}}}}catch(B){v.e(B)}finally{v.f()}return null!==(o=u)&&void 0!==o?o:a}))}(this)}},{key:"getArrowsBoundTo",value:function(e){return this._arrowBindingsIndex.value[e]||V}},{key:"_reparentArrow",value:function(e){var t=this,n=this.getShapeById(e);if(n){var r=n.props,i=r.start,o=r.end,a="binding"===i.type?this.getShapeById(i.boundShapeId):void 0,s="binding"===o.type?this.getShapeById(o.boundShapeId):void 0,u=this.getAncestorPageId(n);if(u){var l;if(a&&s){var c;l=null!==(c=this.findCommonAncestor([a,s]))&&void 0!==c?c:u}else{if(!a&&!s)return;l=u}l&&l!==n.parentId&&this.reparentShapesById([e],l);var d=this.getShapeById(e);if(!d)throw Error("no reparented arrow");var f,p,h=this.getShapeNearestSibling(d,a),v=this.getShapeNearestSibling(d,s);if(h&&v)f=h.index>v.index?h:v;else if(h&&!v)f=h;else{if(!v||h)return;f=v}var g=this.getSortedChildIds(f.parentId).map((function(e){return t.getShapeById(e)})).filter((function(e){return e.index>f.index}));if(g.length){var m=g.find((function(e){return"arrow"!==e.type}));if(d.index>f.index&&(!m||d.index<m.index))return;p=C(f.index,g[0].index)}else p=I(f.index);p!==d.index&&this.updateShapes([{id:e,type:"arrow",index:p}])}}}},{key:"_unbindArrowTerminal",value:function(e,t){var n=Rf(this,e)[t],r=n.x,i=n.y;this.store.put([Ce(Ce({},e),{},{props:Ce(Ce({},e.props),{},D({},t,{type:"point",x:r,y:i}))})])}},{key:"_allPageStates",get:function(){return this.store.query.records("instance_page_state")}},{key:"_shapeWillBeDeleted",value:function(e){var t=this;e.parentId&&Ki(e.parentId)&&this._invalidParents.add(e.parentId);var n=this._arrowBindingsIndex.value[e.id];if(null!==n&&void 0!==n&&n.length){var r,i=J(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.arrowId,s=o.handleId,u=this.getShapeById(a);u&&this._unbindArrowTerminal(u,s)}}catch(f){i.e(f)}finally{i.f()}}var l=this._allPageStates.value,c=new Set([e.id]),d=Te(l.map((function(e){return t._cleanupInstancePageState(e,c)})));d.length&&this.store.put(d)}},{key:"_arrowDidUpdate",value:function(e){for(var t=0,n=["start","end"];t<n.length;t++){var r=n[t],i=e.props[r];if("binding"===i.type){var o=this.getShapeById(i.boundShapeId),a=this.getAncestorPageId(e)===this.getAncestorPageId(o);o&&a||this._unbindArrowTerminal(e,r)}}this._reparentArrow(e.id)}},{key:"_complete",value:function(){var e,t=J(this._invalidParents);try{for(t.s();!(e=t.n()).done;){var n,r=e.value;this._invalidParents.delete(r);var i=this.getShapeById(r);if(i){var o=this.getShapeUtil(i),a=null===(n=o.onChildrenChange)||void 0===n?void 0:n.call(o,i);null!==a&&void 0!==a&&a.length&&this.updateShapes(a,!0)}}}catch(s){t.e(s)}finally{t.f()}this.emit("update")}},{key:"_shapeDidChange",value:function(e,t){var n=this;if(this.isShapeOfType(t,tp)&&this._arrowDidUpdate(t),e.parentId!==t.parentId){var r=function(e){var t=n._arrowBindingsIndex.value[e];if(null!==t&&void 0!==t&&t.length){var r,i=J(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;n._reparentArrow(o.arrowId)}}catch(a){i.e(a)}finally{i.f()}}};r(t.id),this.visitDescendants(t.id,r)}if(e.parentId!==t.parentId&&Nn(t.parentId)){var i=new Set([e.id]);this.visitDescendants(e.id,(function(e){i.add(e)}));var o,a=J(this._allPageStates.value);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s.pageId!==t.parentId){var u=this._cleanupInstancePageState(s,i);u&&this.store.put([u])}}}catch(l){a.e(l)}finally{a.f()}}e.parentId&&Ki(e.parentId)&&this._invalidParents.add(e.parentId),t.parentId!==e.parentId&&Ki(t.parentId)&&this._invalidParents.add(t.parentId)}},{key:"_pageStateDidChange",value:function(e,t){var n=this;if((null===e||void 0===e?void 0:e.selectedIds)!==(null===t||void 0===t?void 0:t.selectedIds)){var r=t.selectedIds.filter((function(e){for(var r,i=null===(r=n.getShapeById(e))||void 0===r?void 0:r.parentId;Ki(i);){var o;if(t.selectedIds.includes(i))return!1;i=null===(o=n.getShapeById(i))||void 0===o?void 0:o.parentId}return!0})),i=0===r.length?null===t||void 0===t?void 0:t.focusLayerId:this.findCommonAncestor(Te(r.map((function(e){return n.getShapeById(e)}))),(function(e){return n.isShapeOfType(e,Up)}));r.length===t.selectedIds.length&&i==t.focusLayerId||this.store.put([Ce(Ce({},t),{},{selectedIds:r,focusLayerId:null!==i&&void 0!==i?i:null})])}}},{key:"_pageWillBeDeleted",value:function(e){var t;if(this.instanceState.currentPageId===e.id){var n=null===(t=this.pages.find((function(t){return t.id!==e.id})))||void 0===t?void 0:t.id;if(n){this.store.put([Ce(Ce({},this.instanceState),{},{currentPageId:n})]);var r=kn.createId(e.id),i=Lr.createId(e.id);this.store.remove([r,i])}}}},{key:"annotateError",value:function(e,t){var n=t.origin,r=t.willCrashApp,i=t.tags,o=t.extras,a=this.createErrorAnnotations(n,r);Re(e,{tags:Ce(Ce({},a.tags),i),extras:Ce(Ce({},a.extras),o)}),r&&this.store.markAsPossiblyCorrupted()}},{key:"createErrorAnnotations",value:function(e,t){try{return{tags:{origin:e,willCrashApp:t},extras:{activeStateNode:this.root.path.value,selectedShapes:this.selectedShapes,editingShape:this.editingId?this.getShapeById(this.editingId):void 0,inputs:this.inputs}}}catch(n){return{tags:{origin:e,willCrashApp:t},extras:{}}}}},{key:"crashingError",get:function(){return this._crashingError}},{key:"crash",value:function(e){this._crashingError=e,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:e})}},{key:"isIn",value:function(e){for(var t=e.split(".").reverse(),n=this.root;t.length>0;){var r=t.pop();if(!r)return!0;var i=n.current.value;if((null===i||void 0===i?void 0:i.id)!==r)return!1;if(0===t.length)return!0;n=i}return!1}},{key:"isInAny",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.some((function(t){return e.isIn(t)}))}},{key:"currentToolId",get:function(){var e,t=this.root.current.value,n=null===t||void 0===t?void 0:t.id;if("select"===n||"zoom"===n){var r,i,o=null===t||void 0===t?void 0:t.current.value;n=null!==(r=null===o||void 0===o||null===(i=o.info)||void 0===i?void 0:i.onInteractionEnd)&&void 0!==r?r:"select"}return null!==(e=n)&&void 0!==e?e:"select"}},{key:"setSelectedTool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.root.transition(e,t),this}},{key:"getStateDescendant",value:function(e){for(var t=e.split(".").reverse(),n=this.root;t.length>0;){var r,i=t.pop();if(!i)return n;var o=null===(r=n.children)||void 0===r?void 0:r[i];if(!o)return;n=o}return n}},{key:"blur",value:function(){return this.complete(),this.getContainer().blur(),this._isFocused.set(!1),this}},{key:"focus",value:function(){return this.getContainer().focus(),this._isFocused.set(!0),this}},{key:"canMoveCamera",get:function(){return this._canMoveCamera.value},set:function(e){this._canMoveCamera.set(e)}},{key:"isFocused",get:function(){return this._isFocused.value}},{key:"devicePixelRatio",get:function(){return this._dpr.value}},{key:"setDevicePixelRatio",value:function(e){return this._dpr.set(e),this}},{key:"isCoarsePointer",get:function(){return this._isCoarsePointer.value},set:function(e){this._isCoarsePointer.set(e)}},{key:"openMenus",get:function(){return this._openMenus.value}},{key:"addOpenMenu",value:function(e){var t=new Set(this.openMenus);return t.has(e)||(t.add(e),this._openMenus.set(d(t))),this}},{key:"deleteOpenMenu",value:function(e){var t=new Set(this.openMenus);return t.has(e)&&(t.delete(e),this._openMenus.set(d(t))),this}},{key:"isMenuOpen",get:function(){return this.openMenus.length>0}},{key:"isChangingStyle",get:function(){return this._isChangingStyle.value},set:function(e){var t=this;this._isChangingStyle.set(e),clearTimeout(this._isChangingStyleTimeout),e&&(this._isChangingStyleTimeout=setTimeout((function(){return t.isChangingStyle=!1}),2e3))}},{key:"isPenMode",get:function(){return this._isPenMode.value}},{key:"setPenMode",value:function(e){return e!==this.isPenMode&&this._isPenMode.set(e),this}},{key:"setReadOnly",value:function(e){return this._isReadOnly.set(e),e&&this.setSelectedTool("hand"),this}},{key:"isReadOnly",get:function(){return this._isReadOnly.value}},{key:"documentSettings",get:function(){return this.store.get(ri)}},{key:"updateDocumentSettings",value:function(e){this.store.put([Ce(Ce({},this.documentSettings),e)])}},{key:"gridSize",get:function(){return this.documentSettings.gridSize}},{key:"projectName",get:function(){return this.documentSettings.name}},{key:"setProjectName",value:function(e){this.updateDocumentSettings({name:e})}},{key:"locale",get:function(){return this.user.locale}},{key:"setLocale",value:function(e){this.user.updateUserPreferences({locale:e})}},{key:"isSnapMode",get:function(){return this.user.isSnapMode}},{key:"setSnapMode",value:function(e){return e!==this.isSnapMode&&this.user.updateUserPreferences({isSnapMode:e}),this}},{key:"isDarkMode",get:function(){return this.user.isDarkMode}},{key:"setDarkMode",value:function(e){return e!==this.isDarkMode&&this.user.updateUserPreferences({isDarkMode:e}),this}},{key:"animationSpeed",get:function(){return this.user.animationSpeed}},{key:"setAnimationSpeed",value:function(e){return e!==this.animationSpeed&&this.user.updateUserPreferences({animationSpeed:e}),this}},{key:"instanceState",get:function(){return this.store.get(kr)}},{key:"cursor",get:function(){return this.instanceState.cursor}},{key:"brush",get:function(){return this.instanceState.brush}},{key:"setBrush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||this.brush?(this.updateInstanceState({brush:e},!0),this):this}},{key:"zoomBrush",get:function(){return this.instanceState.zoomBrush}},{key:"setZoomBrush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||this.zoomBrush?(this.updateInstanceState({zoomBrush:e},!0),this):this}},{key:"scribble",get:function(){return this.instanceState.scribble}},{key:"setScribble",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.updateInstanceState({scribble:e},!0),this}},{key:"isFocusMode",get:function(){return this.instanceState.isFocusMode}},{key:"setFocusMode",value:function(e){return e!==this.isFocusMode&&this.updateInstanceState({isFocusMode:e},!0),this}},{key:"isToolLocked",get:function(){return this.instanceState.isToolLocked}},{key:"setToolLocked",value:function(e){return e!==this.isToolLocked&&this.updateInstanceState({isToolLocked:e},!0),this}},{key:"isGridMode",get:function(){return this.instanceState.isGridMode}},{key:"setGridMode",value:function(e){return e!==this.isGridMode&&this.updateInstanceState({isGridMode:e},!0),this}},{key:"updateInstanceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._updateInstanceState(e,t,n),this}},{key:"setCursor",value:function(e){var t=this.cursor,n=Ce(Ce({},t),{},{rotation:0},e);return t.type===n.type&&t.rotation===n.rotation&&t.color===n.color||this.updateInstanceState({cursor:n},!0),this}},{key:"_pageStates",get:function(){return this.store.query.records("instance_page_state")}},{key:"getPageStateByPageId",value:function(e){return this._pageStates.value.find((function(t){return t.pageId===e}))}},{key:"pageStateId",get:function(){return Lr.createId(this.currentPageId)}},{key:"pageState",get:function(){return this.store.get(this.pageStateId)}},{key:"setPageState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._setInstancePageState(e,t)}},{key:"selectedIds",get:function(){return this.pageState.selectedIds}},{key:"selectedIdsSet",get:function(){return new Set(this.selectedIds)}},{key:"setSelectedIds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._setSelectedIds(e,t),this}},{key:"isSelected",value:function(e){return this.selectedIdsSet.has(e)}},{key:"isWithinSelection",value:function(e){var t=this,n=this.getShapeById(e);return!!n&&(!!this.isSelected(e)||!!this.findAncestor(n,(function(e){return t.isSelected(e.id)})))}},{key:"select",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.setSelectedIds(t),this}},{key:"deselect",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.selectedIds;return r.length>0&&t.length>0&&this.setSelectedIds(r.filter((function(e){return!t.includes(e)}))),this}},{key:"selectAll",value:function(){var e=this.getSortedChildIds(this.currentPageId);return e.length<=0||this.setSelectedIds(this._getUnlockedShapeIds(e)),this}},{key:"selectNone",value:function(){return this.selectedIds.length>0&&this.setSelectedIds([]),this}},{key:"selectedShapes",get:function(){var e=this;return Te(this.pageState.selectedIds.map((function(t){return e.store.get(t)})))}},{key:"onlySelectedShape",get:function(){var e=this.selectedShapes;return 1===e.length?e[0]:null}},{key:"selectedPageBounds",get:function(){var e=this,t=this.pageState.selectedIds;return 0===t.length?null:ws.Common(Te(t.map((function(t){return e.getPageBoundsById(t)}))))}},{key:"selectionRotation",get:function(){var e=this,t=this.selectedIds;if(0===t.length)return 0;if(1===t.length)return this.getPageRotationById(this.selectedIds[0]);var n=t.map((function(t){return e.getPageRotationById(t)%(Math.PI/2)}));return n.every((function(e){return Math.abs(e-n[0])<Math.PI/180}))?this.getPageRotationById(t[0]):0}},{key:"selectionBounds",get:function(){var e=this,t=this.selectedIds;if(0!==t.length){var n=this.selectionRotation;if(0===n)return this.selectedPageBounds;if(1===t.length){var r=this.getBounds(this.getShapeById(t[0])).clone();return r.point=Cs.applyToPoint(this.getPageTransformById(t[0]),r.point),r}var i=this.selectedIds.flatMap((function(t){var n=e.getPageTransformById(t);return n?e.getOutlineById(t).map((function(e){return Cs.applyToPoint(n,e)})):[]})).map((function(e){return Ya.Rot(e,-n)})),o=ws.FromPoints(i);return o.point=o.point.rot(n),o}}},{key:"selectionPageCenter",get:function(){var e=this.selectionBounds,t=this.selectionRotation;return e?Ya.RotWith(e.center,e.point,t):null}},{key:"focusLayerId",get:function(){var e;return null!==(e=this.pageState.focusLayerId)&&void 0!==e?e:this.currentPageId}},{key:"focusLayerShape",get:function(){var e=this.pageState.focusLayerId;if(e)return this.getShapeById(e)}},{key:"popFocusLayer",value:function(){var e=this,t=this.pageState.focusLayerId,n=t&&this.getShapeById(t);if(n){var r,i=this.findAncestor(n,(function(t){return e.isShapeOfType(t,Up)}));this.setFocusLayer(null!==(r=null===i||void 0===i?void 0:i.id)&&void 0!==r?r:null),this.select(n.id)}else this.setFocusLayer(null),this.selectNone();return this}},{key:"setFocusLayer",value:function(e){return this._setFocusLayer(e),this}},{key:"editingId",get:function(){return this.pageState.editingId}},{key:"setEditingId",value:function(e){if(e){if(e!==this.editingId){var t=this.getShapeById(e),n=this.getShapeUtil(t);t&&n.canEdit(t)&&this.setPageState({editingId:e,hoveredId:null},!1)}}else this.setPageState({editingId:null});return this}},{key:"editingShape",get:function(){var e;return this.editingId&&null!==(e=this.getShapeById(this.editingId))&&void 0!==e?e:null}},{key:"hoveredId",get:function(){return this.pageState.hoveredId}},{key:"setHoveredId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e===this.pageState.hoveredId||this.setPageState({hoveredId:e},!0),this}},{key:"hoveredShape",get:function(){var e;return this.hoveredId&&null!==(e=this.getShapeById(this.hoveredId))&&void 0!==e?e:null}},{key:"hintingIds",get:function(){return this.pageState.hintingIds}},{key:"setHintingIds",value:function(e){return this.store.update(this.pageState.id,(function(t){return Ce(Ce({},t),{},{hintingIds:Ie(e)})})),this}},{key:"erasingIds",get:function(){return this.pageState.erasingIds}},{key:"erasingIdsSet",get:function(){return new Set(this.erasingIds)}},{key:"setErasingIds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.erasingIdsSet;return e.length===t.size&&e.every((function(e){return t.has(e)}))||this.setPageState({erasingIds:e},!0),this}},{key:"croppingId",get:function(){return this.pageState.croppingId}},{key:"setCroppingId",value:function(e){if(e!==this.croppingId)if(e){var t=this.getShapeById(e),n=this.getShapeUtil(t);t&&n.canCrop(t)&&this.setPageState({croppingId:e,hoveredId:null})}else this.setPageState({croppingId:null}),this.isInAny("select.crop","select.pointing_crop_handle","select.cropping")&&this.setSelectedTool("select.idle");return this}},{key:"_cleanupInstancePageState",value:function(e,t){var n=null,r=e.selectedIds.filter((function(e){return!t.has(e)}));r.length!==e.selectedIds.length&&(n||(n=Ce({},e)),n.selectedIds=r);var i=e.erasingIds.filter((function(e){return!t.has(e)}));i.length!==e.erasingIds.length&&(n||(n=Ce({},e)),n.erasingIds=i),e.hoveredId&&t.has(e.hoveredId)&&(n||(n=Ce({},e)),n.hoveredId=null),e.editingId&&t.has(e.editingId)&&(n||(n=Ce({},e)),n.editingId=null);var o=e.hintingIds.filter((function(e){return!t.has(e)}));return o.length!==e.hintingIds.length&&(n||(n=Ce({},e)),n.hintingIds=o),e.focusLayerId&&t.has(e.focusLayerId)&&(n||(n=Ce({},e)),n.focusLayerId=null),n}},{key:"cameraId",get:function(){return kn.createId(this.currentPageId)}},{key:"camera",get:function(){return this.store.get(this.cameraId)}},{key:"zoomLevel",get:function(){return this.camera.z}},{key:"_setCamera",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.camera.z,i=this.camera;if(i.x===e&&i.y===t&&i.z===r)return this;var o=Ce(Ce({},i),{},{x:e,y:t,z:r});return this.batch((function(){var e;n.store.put([o]);var t=n.inputs.currentScreenPoint;n.dispatch({type:"pointer",target:"canvas",name:"pointer_move",point:t,pointerId:Fu,ctrlKey:n.inputs.ctrlKey,altKey:n.inputs.altKey,shiftKey:n.inputs.shiftKey,button:0,isPen:null!==(e=n.isPenMode)&&void 0!==e&&e}),n._tickCameraState()})),this}},{key:"setCamera",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.camera.z,r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).stopFollowing,i=void 0===r||r;return this.stopCameraAnimation(),i&&this.instanceState.followingUserId&&this.stopFollowingUser(),e=Number.isNaN(e)?0:e,t=Number.isNaN(t)?0:t,n=Number.isNaN(n)?1:n,this._setCamera(e,t,n),this}},{key:"animateCamera",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.camera.z,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zu;e=Number.isNaN(e)?0:e,t=Number.isNaN(t)?0:t,n=Number.isNaN(n)?1:n;var i=this.viewportScreenBounds,o=i.width,a=i.height,s=new ws(-e,-t,o/n,a/n);return this._animateToViewport(s,r)}},{key:"centerOnPoint",value:function(e,t,n){if(!this.canMoveCamera)return this;var r=this.viewportPageBounds,i=r.width,o=r.height,a=this.camera;return null!==n&&void 0!==n&&n.duration?this.animateCamera(-(e-i/2),-(t-o/2),a.z,n):this.setCamera(-(e-i/2),-(t-o/2),a.z),this}},{key:"zoomToContent",value:function(){var e,t=null!==(e=this.selectedPageBounds)&&void 0!==e?e:this.allShapesCommonBounds;return t&&this.zoomToBounds(t.minX,t.minY,t.width,t.height,Math.min(1,this.zoomLevel),{duration:220}),this}},{key:"zoomToFit",value:function(e){var t=this;if(!this.canMoveCamera)return this;var n=d(this.currentPageShapeIds);if(n.length<=0)return this;var r=ws.Common(Te(n.map((function(e){return t.getPageBoundsById(e)}))));return this.zoomToBounds(r.minX,r.minY,r.width,r.height,void 0,e),this}},{key:"resetZoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.viewportScreenCenter,t=arguments.length>1?arguments[1]:void 0;if(!this.canMoveCamera)return this;var n=this.camera,r=n.x,i=n.y,o=n.z,a=e.x,s=e.y;return null!==t&&void 0!==t&&t.duration?this.animateCamera(r+(a/1-a)-(a/o-a),i+(s/1-s)-(s/o-s),1,t):this.setCamera(r+(a/1-a)-(a/o-a),i+(s/1-s)-(s/o-s),1),this}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.viewportScreenCenter,t=arguments.length>1?arguments[1]:void 0;if(!this.canMoveCamera)return this;for(var n=this.camera,r=n.x,i=n.y,o=n.z,a=Au,s=1;s<Mu.length;s++){var u=Mu[s];if(!(u-o<=(u-Mu[s-1])/2)){a=u;break}}var l=e.x,c=e.y;return null!==t&&void 0!==t&&t.duration?this.animateCamera(r+(l/a-l)-(l/o-l),i+(c/a-c)-(c/o-c),a,t):this.setCamera(r+(l/a-l)-(l/o-l),i+(c/a-c)-(c/o-c),a),this}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.viewportScreenCenter,t=arguments.length>1?arguments[1]:void 0;if(!this.canMoveCamera)return this;for(var n=this.camera,r=n.x,i=n.y,o=n.z,a=ju,s=Mu.length-1;s>0;s--){var u=Mu[s-1],l=Mu[s];if(!(l-o>=(l-u)/2)){a=u;break}}var c=e.x,d=e.y;return null!==t&&void 0!==t&&t.duration?this.animateCamera(r+(c/a-c)-(c/o-c),i+(d/a-d)-(d/o-d),a,t):this.setCamera(r+(c/a-c)-(c/o-c),i+(d/a-d)-(d/o-d),a),this}},{key:"zoomToSelection",value:function(e){var t=this;if(!this.canMoveCamera)return this;var n=this.selectedIds;if(n.length<=0)return this;var r=ws.Common(Te(n.map((function(e){return t.getPageBoundsById(e)}))));return this.zoomToBounds(r.minX,r.minY,r.width,r.height,Math.max(1,this.camera.z),e),this}},{key:"panZoomIntoView",value:function(e,t){var n=this;if(!this.canMoveCamera)return this;if(e.length<=0)return this;var r=ws.Common(Te(e.map((function(e){return n.getPageBoundsById(e)})))),i=this.viewportPageBounds;if(i.h<r.h||i.w<r.w)return this.zoomToBounds(r.minX,r.minY,r.width,r.height,this.camera.z,t),this;var o=this.viewportPageBounds.clone().expandBy(-32/this.zoomLevel),a=0,s=0;o.maxY<r.maxY?s=o.maxY-r.maxY:o.minY>r.minY&&(s=o.minY-r.minY),o.maxX<r.maxX?a=o.maxX-r.maxX:o.minX>r.minX&&(a=o.minX-r.minX);var u=this.camera;return null!==t&&void 0!==t&&t.duration?this.animateCamera(u.x+a,u.y+s,u.z,t):this.setCamera(u.x+a,u.y+s,u.z),this}},{key:"zoomToBounds",value:function(e,t,n,r,i,o){if(!this.canMoveCamera)return this;var a=this.viewportScreenBounds,s=Math.min(256,.28*a.width),u=Ja(Math.min((a.width-s)/n,(a.height-s)/r),ju,Au);return void 0!==i&&(u=Math.min(i,u)),null!==o&&void 0!==o&&o.duration?this.animateCamera(-e+(a.width-n*u)/2/u,-t+(a.height-r*u)/2/u,u,o):this.setCamera(-e+(a.width-n*u)/2/u,-t+(a.height-r*u)/2/u,u),this}},{key:"pan",value:function(e,t,n){var r;if(!this.canMoveCamera)return this;var i=this.camera,o=i.x,a=i.y,s=i.z,u=new Ya(e,t).div(s);return null!==(r=null===n||void 0===n?void 0:n.duration)&&void 0!==r&&r?this.animateCamera(o+u.x,a+u.y,s,n):(this.setCamera(o+u.x,a+u.y,s),this)}},{key:"stopCameraAnimation",value:function(){return this.emit("stop-camera-animation"),this}},{key:"_animateViewport",value:function(e){var t=this;if(this._viewportAnimation){var n=function e(){t.removeListener("tick",t._animateViewport),t.removeListener("stop-camera-animation",e),t._viewportAnimation=null};this.once("stop-camera-animation",n),this._viewportAnimation.elapsed+=e;var r=this._viewportAnimation,i=r.elapsed,o=r.easing,a=r.duration,s=r.start,u=r.end;if(i>a){var l=this.viewportScreenBounds.width/u.width,c=-u.x,d=-u.y;return this._setCamera(c,d,l),void n()}var f=o(1-(a-i)/a),p=s.minX+(u.minX-s.minX)*f,h=s.minY+(u.minY-s.minY)*f,v=s.maxX+(u.maxX-s.maxX)*f,g=s.maxY+(u.maxY-s.maxY)*f,m=new ws(p,h,v-p,g-h),y=this.viewportScreenBounds.width/m.width,b=-m.x,w=-m.y;this._setCamera(b,w,y)}}},{key:"_animateToViewport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.duration,r=void 0===n?0:n,i=t.easing,o=void 0===i?Ha.easeInOutCubic:i,a=this.animationSpeed,s=this.viewportPageBounds;return this.stopCameraAnimation(),this.instanceState.followingUserId&&this.stopFollowingUser(),0===r||0===a?this._setCamera(-e.x,-e.y,this.viewportScreenBounds.width/e.width):(this._viewportAnimation={elapsed:0,duration:r/a,easing:o,start:s.clone(),end:e},this.addListener("tick",this._animateViewport),this)}},{key:"slideCamera",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.canMoveCamera)return this;if(this.stopCameraAnimation(),0!==this.animationSpeed){var n=t.speed,r=t.friction,i=t.direction,o=t.speedThreshold,a=void 0===o?.01:o,s=Math.min(n,1),u=function t(){e.removeListener("tick",l),e.removeListener("stop-camera-animation",t)};this.once("stop-camera-animation",u);var l=function(t){var n=e.camera,o=n.x,l=n.y,c=n.z,d=i.clone().mul(s*t/c);(s*=1-r)<a?u():e._setCamera(o+d.x,l+d.y,c)};return this.addListener("tick",l),this}}},{key:"animateToUser",value:function(e){var t=this,n=d(this.store.query.records("instance_presence",(function(){return{userId:{eq:e}}})).value).sort((function(e,t){return e.lastActivityTimestamp-t.lastActivityTimestamp})).pop();n&&this.batch((function(){null!==t.instanceState.followingUserId&&t.stopFollowingUser();var r=n.currentPageId===t.currentPageId;r||t.setCurrentPageId(n.currentPageId);var i=r?{duration:500}:void 0,o=n.cursor;t.centerOnPoint(o.x,o.y,i);var a=t.instanceState.highlightedUserIds;t.updateInstanceState({highlightedUserIds:[].concat(d(a),[e])}),setTimeout((function(){var n=d(t.instanceState.highlightedUserIds),r=n.indexOf(e);r<0||(n.splice(r,1),t.updateInstanceState({highlightedUserIds:n}))}),Bu)}))}},{key:"animateToShape",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zu;if(!this.canMoveCamera)return this;var n=this.viewportScreenBounds.clone().expandBy(-32),r=n.width/n.height,i=this.getPageBoundsById(e);if(!i)return this;var o=i.width/i.height,a=i.clone(),s=i.width/n.width;return a.width+=(n.minX+n.maxX)*s,a.height+=(n.minY+n.maxY)*s,a.x-=n.minX*s,a.y-=n.minY*s,o>r?(a.height=i.width/r,a.y-=(a.height-i.height)/2):(a.width=i.height*r,a.x-=(a.width-i.width)/2),this._animateToViewport(a,t)}},{key:"updateViewportScreenBounds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getContainer();if(!t)return this;var n=t.getBoundingClientRect(),r=new ws(0,0,Math.max(n.width,1),Math.max(n.height,1)),i=r.equals(this.viewportScreenBounds),o=this._willSetInitialBounds;if(i)this._willSetInitialBounds=!1;else if(o)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:r.toJson()},!0,!0);else{var a=this.zoomLevel;if(e){var s=this.viewportPageCenter;this.updateInstanceState({screenBounds:r.toJson()},!0,!0);var u=this.viewportPageCenter;this.instanceState.followingUserId||this.pan((u.x-s.x)*a,(u.y-s.y)*a)}else{var l=this.screenToPage(0,0);this.updateInstanceState({screenBounds:r.toJson()},!0,!0);var c=this.screenToPage(0,0);this.instanceState.followingUserId||this.pan((c.x-l.x)*a,(c.y-l.y)*a)}}this._tickCameraState(),this.updateRenderingBounds();var d=this.editingId;return d&&this.panZoomIntoView([d]),this}},{key:"viewportScreenBounds",get:function(){var e=this.instanceState.screenBounds,t=e.x,n=e.y,r=e.w,i=e.h;return new ws(t,n,r,i)}},{key:"viewportScreenCenter",get:function(){return this.viewportScreenBounds.center}},{key:"viewportPageBounds",get:function(){var e=this.viewportScreenBounds,t=e.x,n=e.y,r=e.w,i=e.h,o=this.screenToPage(t,n),a=this.screenToPage(t+r,n+i);return new ws(o.x,o.y,a.x-o.x,a.y-o.y)}},{key:"viewportPageCenter",get:function(){return this.viewportPageBounds.center}},{key:"screenToPage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.camera,i=this.store.unsafeGetWithoutCapture(kr).screenBounds,o=r.x,a=r.y,s=r.z,u=void 0===s?1:s;return{x:(e-i.x)/u-o,y:(t-i.y)/u-a,z:n}}},{key:"pageToScreen",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.camera,i=r.x,o=r.y,a=r.z,s=void 0===a?1:a;return{x:e+i*s,y:t+o*s,z:n}}},{key:"startFollowingUser",value:function(e){var t=this,n=this.store.query.records("instance_presence",(function(){return{userId:{eq:e}}})),r=this.user.id;if(r||console.warn("You should set the userId for the current instance before following a user"),!n.value.some((function(e){return e.followingUserId===r}))){ae((function(){t.stopFollowingUser(),t.updateInstanceState({followingUserId:e},!0)}));var i=!1,o=function(){var e=d(n.value).sort((function(e,t){return e.lastActivityTimestamp-t.lastActivityTimestamp})).pop();if(e){var o=e.currentPageId===t.currentPageId,a=o?.5:1;o||t.setCurrentPageId(e.currentPageId,{stopFollowing:!1});var s=t.viewportPageBounds,u=s.center,l=s.width,c=s.height,f=ws.From(e.screenBounds),p=f.width/e.camera.z,h=f.height/e.camera.z,v=new Ya(p/2-e.camera.x,h/2-e.camera.y),g=l+(p-l)*a,m=c+(h-c)*a,y=e.followingUserId===r?c/m:Math.min(l/g,c/m),b=Ja(t.camera.z*y,ju,Au),w=t.viewportScreenBounds.w/b,x=t.viewportScreenBounds.h/b,k=v.sub(u),S=Ya.Add(u,Ya.Mul(k,a)),_=Ya.Sub(S,u).len(),P=Math.abs(b-t.camera.z);_<.1&&P<.005?i=!0:i&&_<.2&&P<.05||(i=!1,t.stopCameraAnimation(),t.setCamera(-(S.x-w/2),-(S.y-x/2),b,{stopFollowing:!1}))}else t.stopFollowingUser()};return this.once("stop-following",(function e(){t.removeListener("frame",o),t.removeListener("stop-following",e)})),this.addListener("frame",o),this}}},{key:"stopFollowingUser",value:function(){return this.updateInstanceState({followingUserId:null},!0),this.emit("stop-following"),this}},{key:"cameraState",get:function(){return this._cameraState.value}},{key:"computeUnorderedRenderingShapes",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.renderingBounds,o=r.renderingBoundsExpanded,a=r.erasingIdsSet,s=r.editingId,u=[],l=Iu,c=0,d=function e(t,r,d){var f,p;if(Dn.isId(t)){var h,v=J(n.getSortedChildIds(t));try{for(v.s();!(h=v.n()).done;){e(h.value,r,d)}}catch(E){v.e(E)}finally{v.f()}}else{var g=n.getShapeById(t);if(g){var m=g.opacity*r,y=!1;!d&&null!==a&&void 0!==a&&a.has(t)&&(y=!0,m*=.32);var b=n.getMaskedPageBoundsById(t),w=!!b&&(null===(f=null===i||void 0===i?void 0:i.includes(b))||void 0===f||f),x=!b||(null===(p=s!==t&&!(null!==o&&void 0!==o&&o.includes(b)))||void 0===p||p);u.push({id:t,index:l,backgroundIndex:c,opacity:m,isCulled:x,isInViewport:w,maskedPageBounds:b}),l+=1,c+=1;var k=n.getSortedChildIds(t);if(k.length){var S=null;n.getShapeUtil(g).providesBackgroundForChildren(g)&&(S=c,c=l,l+=Iu);var _,P=J(k);try{for(P.s();!(_=P.n()).done;){e(_.value,m,d||y)}}catch(E){P.e(E)}finally{P.f()}null!==S&&(c=S)}}}},f=J(e);try{for(f.s();!(t=f.n()).done;){d(t.value,1,!1)}}catch(p){f.e(p)}finally{f.f()}return u}},{key:"renderingShapes",get:function(){return this.computeUnorderedRenderingShapes([this.currentPageId],{renderingBounds:this.renderingBounds,renderingBoundsExpanded:this.renderingBoundsExpanded,erasingIdsSet:this.erasingIdsSet,editingId:this.editingId}).sort(nt)}},{key:"renderingBounds",get:function(){return this._renderingBounds.value}},{key:"renderingBoundsExpanded",get:function(){return this._renderingBoundsExpanded.value}},{key:"updateRenderingBounds",value:function(){var e=this.viewportPageBounds;return e.equals(this._renderingBounds.__unsafe__getWithoutCapture())||(this._renderingBounds.set(e.clone()),this._renderingBoundsExpanded.set(e.clone().expandBy(100/this.zoomLevel))),this}},{key:"_pages",get:function(){return this.store.query.records("page")}},{key:"pages",get:function(){return this._pages.value.sort(M)}},{key:"currentPage",get:function(){var e=this.getPageById(this.currentPageId);if(!e)throw Error("No current page (id ".concat(this.currentPageId,", ").concat(this.pages.length," pages))"));return e}},{key:"currentPageId",get:function(){return this.instanceState.currentPageId}},{key:"getPageById",value:function(e){return this.store.get(e)}},{key:"getPageInfoById",value:function(e){return this.store.get(e)}},{key:"currentPageShapeIds",get:function(){return this._currentPageShapeIds.value}},{key:"getShapeIdsInPage",value:function(e){var t=this.store.query.exec("shape",{parentId:{eq:e}});return this.getShapeAndDescendantIds(t.map((function(e){return e.id})))}},{key:"setCurrentPageId",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).stopFollowing,n=void 0===t||t;return this._setCurrentPageId(e,{stopFollowing:n}),this}},{key:"updatePage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._updatePage(e,t),this}},{key:"createPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dn.createId(),n=arguments.length>2?arguments[2]:void 0;return this._createPage(e,t,n),this}},{key:"duplicatePage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentPageId,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dn.createId();if(this.pages.length>=40)return this;var r=this.getPageById(t);if(!r)return this;var i=Ce({},this.camera),o=this.getContent(this.getSortedChildIds(r.id));return this.batch((function(){if(e.createPage(r.name+" Copy",n,r.index),e.setCurrentPageId(n),e.setCamera(i.x,i.y,i.z),o)return e.putContent(o)})),this}},{key:"renamePage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.isReadOnly||this.updatePage({id:e,name:t},n),this}},{key:"deletePage",value:function(e){this._deletePage(e)}},{key:"_assets",get:function(){return this.store.query.records("asset")}},{key:"assets",get:function(){return this._assets.value}},{key:"createAssets",value:function(e){return this._createAssets(e),this}},{key:"deleteAssets",value:function(e){return this._deleteAssets(e),this}},{key:"updateAssets",value:function(e){return this._updateAssets(e),this}},{key:"getAssetBySrc",value:function(e){return this.assets.find((function(t){return t.props.src===e}))}},{key:"getAssetById",value:function(e){return this.store.get(e)}},{key:"_boundsCache",get:function(){var e=this;return this.store.createComputedCache("bounds",(function(t){return e.getShapeUtil(t).getBounds(t)}))}},{key:"getBounds",value:function(e){var t,n=null!==(t=this._boundsCache.get(e.id))&&void 0!==t?t:new ws;return 0===n.width||0===n.height?new ws(n.x,n.y,Math.max(n.width,1),Math.max(n.height,1)):n}},{key:"getBoundsById",value:function(e){return this.getBounds(this.getShapeById(e))}},{key:"_outlineCache",get:function(){var e=this;return this.store.createComputedCache("outline",(function(t){return e.getShapeUtil(t).getOutline(t)}))}},{key:"getOutline",value:function(e){var t;return null!==(t=this._outlineCache.get(e.id))&&void 0!==t?t:V}},{key:"getOutlineById",value:function(e){return this.getOutline(this.getShapeById(e))}},{key:"_outlineSegmentsCache",get:function(){var e=this;return this.store.createComputedCache("outline-segments",(function(t){return e.getShapeUtil(t).getOutlineSegments(t)}))}},{key:"getOutlineSegments",value:function(e){var t;return null!==(t=this._outlineSegmentsCache.get(e.id))&&void 0!==t?t:V}},{key:"getOutlineSegmentsById",value:function(e){return this.getOutlineSegments(this.getShapeById(e))}},{key:"handlesCache",get:function(){var e=this;return this.store.createComputedCache("handles",(function(t){var n,r;return null===(n=(r=e.getShapeUtil(t)).getHandles)||void 0===n?void 0:n.call(r,t)}))}},{key:"getHandlesById",value:function(e){return this.handlesCache.get(e)}},{key:"getHandles",value:function(e){return this.getHandlesById(e.id)}},{key:"getTransform",value:function(e){return Cs.Compose(Cs.Translate(e.x,e.y),Cs.Rotate(e.rotation))}},{key:"_pageTransformCache",get:function(){var e=this;return this.store.createComputedCache("pageTransformCache",(function(t){var n;if(Nn(t.parentId))return e.getTransform(t);var r=null!==(n=e._pageTransformCache.get(t.parentId))&&void 0!==n?n:Cs.Identity();return Cs.Compose(r,e.getTransform(t))}))}},{key:"getParentTransform",value:function(e){var t;return Nn(e.parentId)?Cs.Identity():null!==(t=this._pageTransformCache.get(e.parentId))&&void 0!==t?t:Cs.Identity()}},{key:"getPageTransform",value:function(e){return this.getPageTransformById(e.id)}},{key:"getPageTransformById",value:function(e){return this._pageTransformCache.get(e)}},{key:"getPagePointById",value:function(e){var t=this.getPageTransformById(e);if(t)return Cs.applyToPoint(t,new Ya)}},{key:"getPageCenter",value:function(e){var t=this.getPageTransformById(e.id);if(!t)return null;var n=this.getShapeUtil(e).center(e);return Cs.applyToPoint(t,n)}},{key:"getPageCenterById",value:function(e){var t=this.getShapeById(e);return this.getPageCenter(t)}},{key:"getPageRotation",value:function(e){return this.getPageRotationById(e.id)}},{key:"getPageRotationById",value:function(e){var t=this.getPageTransformById(e);return t?Cs.Decompose(t).rotation:0}},{key:"_pageBoundsCache",get:function(){var e=this;return this.store.createComputedCache("pageBoundsCache",(function(t){var n=e._pageTransformCache.get(t.id);return n?ws.FromPoints(Cs.applyToPoints(n,e.getOutline(t))):new ws}))}},{key:"getPageBounds",value:function(e){return this.getPageBoundsById(e.id)}},{key:"getPageBoundsById",value:function(e){return this._pageBoundsCache.get(e)}},{key:"_clipPathCache",get:function(){var e=this;return this.store.createComputedCache("clipPathCache",(function(t){var n=e._pageMaskCache.get(t.id);if(n){var r=e._pageTransformCache.get(t.id);if(r){if(0===n.length)return"polygon(0px 0px, 0px 0px, 0px 0px)";var i=Cs.applyToPoints(Cs.Inverse(r),n);return"polygon(".concat(i.map((function(e){return"".concat(e.x,"px ").concat(e.y,"px")})).join(","),")")}}}))}},{key:"getClipPathById",value:function(e){return this._clipPathCache.get(e)}},{key:"_pageMaskCache",get:function(){var e=this;return this.store.createComputedCache("pageMaskCache",(function(t){if(!Nn(t.parentId)){var n=e.getAncestorsById(t.id).filter((function(t){return e.isShapeOfType(t,Wp)}));if(0!==n.length){var r=n.map((function(t){return Cs.applyToPoints(e._pageTransformCache.get(t.id),e.getOutline(t))})).reduce((function(e,t){var n;return t&&e&&null!==(n=Hs(e,t))&&void 0!==n?n:void 0}));return r}}}))}},{key:"getPageMaskById",value:function(e){return this._pageMaskCache.get(e)}},{key:"getMaskedPageBounds",value:function(e){return this.getMaskedPageBoundsById(e.id)}},{key:"getMaskedPageBoundsById",value:function(e){var t=this._pageBoundsCache.get(e);if(t){var n=this._pageMaskCache.get(e);if(n){var r=Hs(n,t.corners);if(!r)return;return ws.FromPoints(r)}return t}}},{key:"getAncestors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.parentId;if(Nn(n))return t.reverse(),t;var r=this.store.get(n);return r?(t.push(r),this.getAncestors(r,t)):t}},{key:"getAncestorsById",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.getShapeById(e);return n?this.getAncestors(n,t):t}},{key:"findAncestor",value:function(e,t){var n=e.parentId;if(!Nn(n)){var r=this.getShapeById(n);return r?t(r)?r:this.findAncestor(r,t):void 0}}},{key:"hasAncestor",value:function(e,t){return!!e&&(e.parentId===t||this.hasAncestor(this.getParentShape(e),t))}},{key:"findCommonAncestor",value:function(e,t){var n=this;if(0!==e.length){if(1===e.length){var r,i=e[0].parentId;if(Nn(i))return;return t?null===(r=this.findAncestor(e[0],t))||void 0===r?void 0:r.id:i}for(var o=f(e),a=o[0],s=o.slice(1),u=this.getParentShape(a);u;)if(!t||t(u)){if(s.every((function(e){return n.hasAncestor(e,u.id)})))return u.id;u=this.getParentShape(u)}else u=this.getParentShape(u)}}},{key:"isShapeOrAncestorLocked",value:function(e){return void 0!==e&&(!!e.isLocked||this.isShapeOrAncestorLocked(this.getParentShape(e)))}},{key:"allShapesCommonBounds",get:function(){var e=this,t=null;return this.currentPageShapeIds.forEach((function(n){var r=e.getMaskedPageBoundsById(n);r&&(t?t.expand(r):t=r.clone())})),t}},{key:"getPageCorners",value:function(e){var t=this.getAncestors(e),n=this.getBounds(e).corners,r=Cs.Compose.apply(Cs,d(t.flatMap((function(e){return[Cs.Translate(e.x,e.y),Cs.Rotate(e.rotation)]}))).concat([Cs.Translate(e.x,e.y),Cs.Rotate(e.rotation,0,0)]));return Cs.applyToPoints(r,n)}},{key:"isPointInShape",value:function(e,t){var n=this.getShapeUtil(t),r=this._pageMaskCache.get(t.id);if(r&&!gs(e,r))return!1;return n.hitTestPoint(t,this.getPointInShapeSpace(t,e))}},{key:"getShapesAtPoint",value:function(e){var t=this;return this.shapesArray.filter((function(n){var r=t._pageMaskCache.get(n.id);return r?gs(e,r):t.getShapeUtil(n).hitTestPoint(n,t.getPointInShapeSpace(n,e))}))}},{key:"getPointInShapeSpace",value:function(e,t){return Cs.applyToPoint(Cs.Inverse(this.getPageTransform(e)),t)}},{key:"getPointInParentSpace",value:function(e,t){var n=this.getShapeById(e);if(!n)return new Ya(0,0);if(Nn(n.parentId))return Ya.From(t);var r=this.getPageTransformById(n.parentId);return r?Cs.applyToPoint(Cs.Inverse(r),t):Ya.From(t)}},{key:"getDeltaInShapeSpace",value:function(e,t){var n=this.getPageTransform(e);return n?Ya.Rot(t,-Cs.Decompose(n).rotation):Ya.From(t)}},{key:"getDeltaInParentSpace",value:function(e,t){if(Nn(e.parentId))return Ya.From(t);var n=this.getShapeById(e.parentId);return n?this.getDeltaInShapeSpace(n,t):Ya.From(t)}},{key:"getParentsMappedToChildren",value:function(e){var t=this,n=e.map((function(e){return t.store.get(e)})),r=new Map;return n.forEach((function(e){var t;r.has(e.parentId)||r.set(e.parentId,new Set),null===(t=r.get(e.parentId))||void 0===t||t.add(e)})),r}},{key:"shapesArray",get:function(){var e=this;return Array.from(this.currentPageShapeIds,(function(t){return e.store.get(t)}))}},{key:"sortedShapesArray",get:function(){var e=this,t=new Set(this.shapesArray.sort(M)),n=[];function r(e){n.push(e),t.delete(e),t.forEach((function(t){t.parentId===e.id&&r(t)}))}return t.forEach((function(t){Ui(e.getShapeById(t.parentId))||r(t)})),n}},{key:"isShapeOfType",value:function(e,t){return e.type===t.type}},{key:"getShapeById",value:function(e){if(Ki(e))return this.store.get(e)}},{key:"getParentShape",value:function(e){if(void 0!==e&&Ki(e.parentId))return this.store.get(e.parentId)}},{key:"getShapeNearestSibling",value:function(e,t){if(t)return t.parentId===e.parentId?t:this.findAncestor(t,(function(t){return t.parentId===e.parentId}))}},{key:"isShapeInPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentPageId,n=!1;if(e.parentId===t)n=!0;else{var r=this.getShapeById(e.parentId);e:for(;r;){if(r.parentId===t){n=!0;break e}r=this.getShapeById(r.parentId)}}return n}},{key:"getAncestorPageId",value:function(e){if(void 0!==e)return Nn(e.parentId)?e.parentId:this.getAncestorPageId(this.getShapeById(e.parentId))}},{key:"reparentShapesById",value:function(e,t,n){var r,i=this,o=[],a=Nn(t)?Cs.Identity():this.getPageTransformById(t),s=a.decompose().rotation,u=[],l=Te(this.getSortedChildIds(t).map((function(e){return i.getShapeById(e)})));if(n){var c=l.find((function(e){return e.index===n}));if(c){var d=l[l.indexOf(c)+1];u=d?P(n,d.index,e.length):E(n,e.length)}else{var f=l.sort(M).find((function(e){return e.index>n}));u=f?P(n,f.index,e.length):E(n,e.length)}}else{var p=l.length&&l[l.length-1];u=p?E(p.index,e.length):T(e.length)}for(var h=0;h<e.length;h++){r=e[h];var v=this.getShapeById(r),g=this.getPagePointById(r);if(v&&g){var m=Cs.applyToPoint(Cs.Inverse(a),g),y=this.getPageRotation(v)-s;o.push({id:v.id,type:v.type,parentId:t,x:m.x,y:m.y,rotation:y,index:u[h]})}}return this.updateShapes(o),this}},{key:"getHighestIndexForParent",value:function(e){var t=this._parentIdsToChildIds.value[e];return t&&0!==t.length?I(t[t.length-1][1]):"a1"}},{key:"getSortedChildIds",value:function(e){var t=this._parentIdsToChildIds.value[e];return t?this._childIdsCache.get(t,(function(){return t.map((function(e){return l(e,1)[0]}))})):V}},{key:"visitDescendants",value:function(e,t){var n,r=J(this.getSortedChildIds(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;!1!==t(i)&&this.visitDescendants(i,t)}}catch(o){r.e(o)}finally{r.f()}}},{key:"getShapeAndDescendantIds",value:function(e){for(var t=new Set,n=d(e);n.length>0;){var r=n.pop();if(!r)break;t.has(r)||(t.add(r),this.getSortedChildIds(r).forEach((function(e){n.push(e)})))}return t}},{key:"getParentIdForNewShapeAtPoint",value:function(e,t){for(var n=this.sortedShapesArray,r=n.length-1;r>=0;r--){var i=n[r],o=this.getShapeUtil(i);if(o.canReceiveNewChildrenOfType(i,t)){var a=this.getMaskedPageBoundsById(i.id);if(a&&a.containsPoint(e)&&o.hitTestPoint(i,this.getPointInShapeSpace(i,e)))return i.id}}return this.focusLayerId}},{key:"getDroppingShape",value:function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.sortedShapesArray,i=function(){var i=r[o];if(n.find((function(e){return e.id===i.id||t.hasAncestor(i,e.id)})))return"continue";var a=t.getShapeUtil(i);if(!a.canDropShapes(i,n))return"continue";var s=t.getMaskedPageBoundsById(i.id);return s&&s.containsPoint(e)&&a.hitTestPoint(i,t.getPointInShapeSpace(i,e))?{v:i}:void 0},o=r.length-1;o>=0;o--){var a=i();if("continue"!==a&&"object"===typeof a)return a.v}}},{key:"getOutermostSelectableShape",value:function(e,t){for(var n=e,r=e;r;){var i;if(!this.isShapeOfType(r,Up)||this.focusLayerId===r.id||this.hasAncestor(this.focusLayerShape,r.id)||null!==(i=null===t||void 0===t?void 0:t(r))&&void 0!==i&&!i){if(this.focusLayerId===r.id)break}else n=r;r=this.getParentShape(r)}return n}},{key:"rotateShapesBy",value:function(e,t){if(e.length<=0)return this;var n=Dv({editor:this});return n?(Nv({delta:t,snapshot:n,editor:this,stage:"one-off"}),this):this}},{key:"nudgeShapes",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.length<=0)return this;var i,o=this.isGridMode?n?5*this.gridSize:this.gridSize:n?10:1,a=Ya.Mul(t,o),s=[],u=J(e);try{for(u.s();!(i=u.n()).done;){var l,c,d=i.value,f=this.getShapeById(d);if(!f)throw Error("Could not find a shape with the id ".concat(d,"."));var p=this.getDeltaInParentSpace(f,a),h=null===(l=(c=this.getShapeUtil(f)).onTranslateStart)||void 0===l?void 0:l.call(c,f);s.push(h?Ce(Ce({},h),{},{x:f.x+p.x,y:f.y+p.y}):{id:d,x:f.x+p.x,y:f.y+p.y,type:f.type})}}catch(v){u.e(v)}finally{u.f()}return this.updateShapes(s,r),this}},{key:"duplicateShapes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds,n=arguments.length>1?arguments[1]:void 0;if(t.length<=0)return this;for(var r=new Set(t),i=[],o=d(t);o.length>0;){var a=o.pop();if(!a)break;i.push(a),this.getSortedChildIds(a).forEach((function(e){return o.push(e)}))}i.reverse();var s=new Map(i.map((function(e){return[e,Vi()]}))),u=Te(i.map((function(t){var i,o=e.getShapeById(t);if(!o)return null;var a=s.get(t),u=0,l=0;if(n&&r.has(t)){var c=e.getParentTransform(o),d=new Ya(n.x,n.y).rot(-Cs.Decompose(c).rotation);u=d.x,l=d.y}var f=null!==(i=o.parentId)&&void 0!==i?i:e.currentPageId,p=e.getSortedChildIds(f),h=p.indexOf(o.id),v=p[h+1],g=v?e.getShapeById(v):null,m=g?C(o.index,g.index):I(o.index),y=We(o);if(e.isShapeOfType(o,tp)&&e.isShapeOfType(y,tp)){var b=e.getShapeUtil(tp).getArrowInfo(o),w=void 0,x=void 0;if("binding"===o.props.start.type&&!(w=s.get(o.props.start.boundShapeId)))if(null!==b&&void 0!==b&&b.isValid){var k=b.start.point,S=k.x,_=k.y;y.props.start={type:"point",x:S,y:_}}else{var P=Rf(e,o).start;y.props.start={type:"point",x:P.x,y:P.y}}if("binding"===o.props.end.type&&!(x=s.get(o.props.end.boundShapeId)))if(null!==b&&void 0!==b&&b.isValid){var E=b.end.point,T=E.x,M=E.y;y.props.end={type:"point",x:T,y:M}}else{var j=Rf(e,o).end;y.props.start={type:"point",x:j.x,y:j.y}}var A=zf(y)?Uf(e,y):Yf(e,y);if(null!==b&&void 0!==b&&b.isValid&&null!==A&&void 0!==A&&A.isValid&&!zf(o)){var O=Ya.Med(b.start.handle,b.end.handle),L=Ya.Dist(b.middle,O),z=Ya.Dist(A.middle,O);y.props.bend<0?y.props.bend+=z-L:y.props.bend-=z-L}"binding"===y.props.start.type&&w&&(y.props.start.boundShapeId=w),"binding"===y.props.end.type&&x&&(y.props.end.boundShapeId=x)}return y=Ce(Ce({},y),{},{id:a,x:o.x+u,y:o.y+l,index:m})})));return u.forEach((function(e){Ki(e.parentId)&&s.has(e.parentId)&&(e.parentId=s.get(e.parentId))})),this.history.batch((function(){var t=u.length+e.currentPageShapeIds.size>Iu;t&&qg(e);var r=t?u.slice(0,Iu-e.currentPageShapeIds.size):u,i=r.map((function(e){return e.id}));if(e.createShapes(r),e.setSelectedIds(i),void 0!==n){var o=e.viewportPageBounds,a=e.selectedPageBounds;a&&!o.contains(a)&&e.centerOnPoint(a.center.x,a.center.y,{duration:Tu})}})),this}},{key:"moveShapesToPage",value:function(e,t){var n=this;if(0===e.length)return this;if(this.isReadOnly)return this;var r=this.currentPageId;if(t===r)return this;if(!this.store.has(t))return this;var i=this.getContent(e);if(!i)return this;if(this.getShapeIdsInPage(t).size+i.shapes.length>Iu)return qg(this,t),this;var o=this.camera.z;return this.history.batch((function(){n.deleteShapes(e),n.setCurrentPageId(t),n.setFocusLayer(null),n.selectNone(),n.putContent(i,{select:!0,preserveIds:!0,preservePosition:!0});var r=n.selectionBounds.center,a=r.x,s=r.y;n.setCamera(n.camera.x,n.camera.y,o),n.centerOnPoint(a,s)})),this}},{key:"toggleLock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds;if(this.isReadOnly||0===e.length)return this;var t,n=!0,r=!0,i=[],o=J(e);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=this.getShapeById(a);s&&(i.push(s),s.isLocked?r=!1:n=!1)}}catch(u){o.e(u)}finally{o.f()}return r?(this.updateShapes(i.map((function(e){return{id:e.id,type:e.type,isLocked:!0}}))),this.setSelectedIds([])):n?this.updateShapes(i.map((function(e){return{id:e.id,type:e.type,isLocked:!1}}))):this.updateShapes(i.map((function(e){return{id:e.id,type:e.type,isLocked:!0}}))),this}},{key:"reorderShapes",value:function(e,t){var n=this;if(this.isReadOnly)return this;if(0===t.length)return this;var r=this.getParentsMappedToChildren(t),i=[];switch(e){case"toBack":r.forEach((function(e,t){var r=Te(n.getSortedChildIds(t).map((function(e){return n.getShapeById(e)})));if(e.size!==r.length){var o,a,s,u=J(r);try{for(u.s();!(s=u.n()).done;){var l=s.value;if(!e.has(l)){a=l.index;break}e.delete(l),o=l.index}}catch(d){u.e(d)}finally{u.f()}if(0!==e.size){var c=P(o,a,e.size);Array.from(e.values()).sort(M).forEach((function(e,t){return i.push({id:e.id,type:e.type,index:c[t]})}))}}}));break;case"toFront":r.forEach((function(e,t){var r=Te(n.getSortedChildIds(t).map((function(e){return n.getShapeById(e)}))),o=r.length;if(e.size!==o){for(var a,s,u=o-1;u>-1;u--){var l=r[u];if(!e.has(l)){a=l.index;break}e.delete(l),s=l.index}if(0!==e.size){var c=P(a,s,e.size);Array.from(e.values()).sort(M).forEach((function(e,t){return i.push({id:e.id,type:e.type,index:c[t]})}))}}}));break;case"forward":r.forEach((function(e,t){var r=Te(n.getSortedChildIds(t).map((function(e){return n.getShapeById(e)}))),o=r.length;if(e.size!==o)for(var a,s=new Set(Array.from(e).map((function(e){return r.indexOf(e)}))),u=-1,l=!1,c=0;c<o;c++){var d=s.has(c);if(!l&&d)l=!0,u=c,void 0;else if(l&&!d){var f;l=!1,a=c-u;for(var p=P(r[c].index,null===(f=r[c+1])||void 0===f?void 0:f.index,a),h=0;h<a;h++){var v=r[u+h];i.push({id:v.id,type:v.type,index:p[h]})}}}}));break;case"backward":r.forEach((function(e,t){var r=Te(n.getSortedChildIds(t).map((function(e){return n.getShapeById(e)}))),o=r.length;if(e.size!==o)for(var a,s=new Set(Array.from(e).map((function(e){return r.indexOf(e)}))),u=-1,l=!1,c=o-1;c>-1;c--){var d=s.has(c);if(!l&&d)l=!0,u=c;else if(l&&!d){var f;l=!1,a=u-c;for(var p=P(null===(f=r[c-1])||void 0===f?void 0:f.index,r[c].index,a),h=0;h<a;h++){var v=r[c+h+1];i.push({id:v.id,type:v.type,index:p[h]})}}}}))}return this.updateShapes(i),this}},{key:"sendToBack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds;return this.reorderShapes("toBack",e),this}},{key:"sendBackward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds;return this.reorderShapes("backward",e),this}},{key:"bringForward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds;return this.reorderShapes("forward",e),this}},{key:"bringToFront",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds;return this.reorderShapes("toFront",e),this}},{key:"flipShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selectedIds;if(this.isReadOnly)return this;var r=Te(n.map((function(e){return t.getShapeById(e)})));if(!r.length)return this;r=Te(r.map((function(e){return t.isShapeOfType(e,Up)?t.getSortedChildIds(e.id).map((function(e){return t.getShapeById(e)})):e})).flat());var i=ws.Common(Te(r.map((function(e){return t.getPageBounds(e)})))).center;return this.batch((function(){var n,o=J(r);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=t.getBounds(a),u=t.getPageTransformById(a.id);u&&t.resizeShape(a.id,{x:"horizontal"===e?-1:1,y:"vertical"===e?-1:1},{initialBounds:s,initialPageTransform:u,initialShape:a,mode:"scale_shape",scaleOrigin:i,scaleAxisRotation:0})}}catch(l){o.e(l)}finally{o.f()}})),this}},{key:"stackShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pageState.selectedIds,r=arguments.length>2?arguments[2]:void 0;if(this.isReadOnly)return this;var i=Te(n.map((function(e){return t.getShapeById(e)}))).filter((function(e){return!!e&&(!t.isShapeOfType(e,tp)||"binding"!==e.props.start.type&&"binding"!==e.props.end.type)})),o=i.length;if(void 0===r&&o<3||o<2)return this;var a,s,u,l,c,d=Object.fromEntries(i.map((function(e){return[e.id,t.getPageBounds(e)]})));if("horizontal"===e?(a="x",s="minX",u="maxX",l="width"):(a="y",s="minY",u="maxY",l="height"),void 0===r){var f=[];i.sort((function(e,t){return d[e.id][s]-d[t.id][s]}));for(var p=function(){var e=i[h],t=i[h+1],n=d[e.id],r=d[t.id][s]-n[u],o=f.find((function(e){return e.gap===r}));o?o.count++:f.push({gap:r,count:1})},h=0;h<o-1;h++)p();var v=0;f.forEach((function(e){e.count>v&&(v=e.count,c=e.gap)})),1===v&&(c=Math.max(0,f.reduce((function(e,t){return e+t.gap*t.count}),0)/(o-1)))}else c=r;var g=[],m=d[i[0].id][u];return i.forEach((function(e,n){var r,i;if(0!==n){var o={x:0,y:0};o[a]=m+c-d[e.id][a];var s=t.getParentShape(e),u=s?Ya.Rot(o,-t.getPageRotation(s)):o,f=null===(r=(i=t.getShapeUtil(e)).onTranslateStart)||void 0===r?void 0:r.call(i,e);g.push(f?Ce(Ce({},f),{},D({},a,e[a]+u[a])):D({id:e.id,type:e.type},a,e[a]+u[a])),m+=d[e.id][l]+c}})),this.updateShapes(g),this}},{key:"packShapes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageState.selectedIds,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;if(this.isReadOnly)return this;if(t.length<2)return this;for(var r,i,o=Te(t.map((function(t){return e.getShapeById(t)})).filter((function(t){return!!t&&(!e.isShapeOfType(t,tp)||"binding"!==t.props.start.type&&"binding"!==t.props.end.type)}))),a={},s={},u=0,l=0;l<o.length;l++)r=o[l],i=this.getPageBounds(r),a[r.id]=i,s[r.id]=i.clone(),u+=i.width*i.height;var c=ws.Common(Te(Object.values(a))),d=c.width;o.sort((function(e,t){return a[t.id].height-a[e.id].height}));for(var f,p,h=Math.max(Math.ceil(Math.sqrt(u/.95)),d),v=[new ws(c.x,c.y,h,1/0)],g=0,m=0,y=0;y<o.length;y++){i=s[(r=o[y]).id];for(var b=v.length-1;b>=0;b--)if(f=v[b],!(i.width>f.width||i.height>f.height)){i.x=f.x,i.y=f.y,m=Math.max(m,i.maxY),g=Math.max(g,i.maxX),i.width===f.width&&i.height===f.height?(p=v.pop(),b<v.length&&(v[b]=p)):i.height===f.height?(f.x+=i.width+n,f.width-=i.width+n):i.width===f.width?(f.y+=i.height+n,f.height-=i.height+n):(v.push(new ws(f.x+(i.width+n),f.y,f.width-(i.width+n),i.height)),f.y+=i.height+n,f.height-=i.height+n);break}}for(var w,x=ws.Common(Object.values(s)),k=Ya.Sub(c.center,x.center),S=[],_=0;_<o.length;_++){var P,E;r=o[_],i=a[r.id],w=s[r.id];var C=this.getDeltaInParentSpace(r,Ya.Sub(w.point,i.point).add(k)),I={id:r.id,type:r.type,x:r.x+C.x,y:r.y+C.y},T=null===(P=(E=this.getShapeUtil(r)).onTranslateStart)||void 0===P?void 0:P.call(E,Ce(Ce({},r),I));T?S.push(Ce(Ce({},I),T)):S.push(I)}return S.length&&this.updateShapes(S),this}},{key:"alignShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pageState.selectedIds;if(this.isReadOnly)return this;if(n.length<2)return this;var r=Te(n.map((function(e){return t.getShapeById(e)}))),i=Object.fromEntries(r.map((function(e){return[e.id,t.getPageBounds(e)]}))),o=ws.Common(Te(Object.values(i))),a=[];return r.forEach((function(n){var r,s,u=i[n.id];if(u){var l={x:0,y:0};switch(e){case"top":l.y=o.minY-u.minY;break;case"center-vertical":l.y=o.midY-u.minY-u.height/2;break;case"bottom":l.y=o.maxY-u.minY-u.height;break;case"left":l.x=o.minX-u.minX;break;case"center-horizontal":l.x=o.midX-u.minX-u.width/2;break;case"right":l.x=o.maxX-u.minX-u.width}var c=t.getParentShape(n),d=c?Ya.Rot(l,-t.getPageRotation(c)):l,f=null===(r=(s=t.getShapeUtil(n)).onTranslateStart)||void 0===r?void 0:r.call(s,n);a.push(f?Ce(Ce({},f),{},{x:n.x+d.x,y:n.y+d.y}):{id:n.id,type:n.type,x:n.x+d.x,y:n.y+d.y})}})),this.updateShapes(a),this}},{key:"distributeShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pageState.selectedIds;if(this.isReadOnly)return this;if(n.length<3)return this;var r,i,o,a,s,u=n.length,l=Te(n.map((function(e){return t.getShapeById(e)}))),c=Object.fromEntries(l.map((function(e){return[e.id,t.getPageBounds(e)]})));"horizontal"===e?(r="x",i="minX",o="maxX",a="midX",s="width"):(r="y",i="minY",o="maxY",a="midY",s="height");var d=[],f=l.sort((function(e,t){return c[e.id][i]-c[t.id][i]}))[0],p=l.sort((function(e,t){return c[t.id][o]-c[e.id][o]}))[0],h=c[f.id][a],v=(c[p.id][a]-h)/(u-1),g=h+v;return l.filter((function(e){return e!==f&&e!==p})).sort((function(e,t){return c[e.id][a]-c[t.id][a]})).forEach((function(e,n){var i,o,a={x:0,y:0};a[r]=g+v*n-c[e.id][s]/2-c[e.id][r];var u=t.getParentShape(e),l=u?Ya.Rot(a,-t.getPageRotation(u)):a,f=null===(i=(o=t.getShapeUtil(e)).onTranslateStart)||void 0===i?void 0:i.call(o,e);d.push(f?Ce(Ce({},f),{},D({},r,e[r]+l[r])):D({id:e.id,type:e.type},r,e[r]+l[r]))})),this.updateShapes(d),this}},{key:"stretchShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pageState.selectedIds;if(this.isReadOnly)return this;if(n.length<2)return this;var r=Te(n.map((function(e){return t.getShapeById(e)}))),i=Object.fromEntries(r.map((function(e){return[e.id,t.getBounds(e)]}))),o=Object.fromEntries(r.map((function(e){return[e.id,t.getPageBounds(e)]}))),a=ws.Common(Te(Object.values(o)));switch(e){case"vertical":this.batch((function(){var e,n=J(r);try{for(n.s();!(e=n.n()).done;){var s=e.value;if(!(t.getPageRotation(s)%Ga)){var u=i[s.id],l=o[s.id],c=t.getDeltaInParentSpace(s,new Ya(0,a.minY-l.minY)),d=Ya.Add(c,s),f=d.x,p=d.y;t.updateShapes([{id:s.id,type:s.type,x:f,y:p}],!0);var h=new Ya(1,a.height/l.height);t.resizeShape(s.id,h,{initialBounds:u,scaleOrigin:new Ya(l.center.x,a.minY),scaleAxisRotation:0})}}}catch(v){n.e(v)}finally{n.f()}}));break;case"horizontal":this.batch((function(){var e,n=J(r);try{for(n.s();!(e=n.n()).done;){var s=e.value,u=i[s.id],l=o[s.id];if(!(t.getPageRotation(s)%Ga)){var c=t.getDeltaInParentSpace(s,new Ya(a.minX-l.minX,0)),d=Ya.Add(c,s),f=d.x,p=d.y;t.updateShapes([{id:s.id,type:s.type,x:f,y:p}],!0);var h=new Ya(a.width/l.width,1);t.resizeShape(s.id,h,{initialBounds:u,scaleOrigin:new Ya(a.minX,l.center.y),scaleAxisRotation:0})}}}catch(v){n.e(v)}finally{n.f()}}))}return this.updateShapes([]),this}},{key:"resizeShape",value:function(e,t){var n,r,i,o,a,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isReadOnly)return this;Number.isFinite(t.x)||(t=new Ya(1,t.y)),Number.isFinite(t.y)||(t=new Ya(t.x,1));var l=null!==(n=u.initialShape)&&void 0!==n?n:this.getShapeById(e);if(!l)return this;var c=null!==(r=u.scaleOrigin)&&void 0!==r?r:null===(i=this.getPageBoundsById(e))||void 0===i?void 0:i.center;if(!c)return this;var d=this.getPageRotationById(e);if(null==d)return this;var f=null!==(o=u.scaleAxisRotation)&&void 0!==o?o:d,p=null!==(a=u.initialPageTransform)&&void 0!==a?a:this.getPageTransformById(e);if(!p)return this;var h=null!==(s=u.initialBounds)&&void 0!==s?s:this.getBoundsById(e);if(!h)return this;if(!ls(d,f))return this._resizeUnalignedShape(e,t,Ce(Ce({},u),{},{initialBounds:h,scaleOrigin:c,scaleAxisRotation:f,initialPageTransform:p,initialShape:l}));var v=this.getShapeUtil(l);if(v.isAspectRatioLocked(l)&&(t=Math.abs(t.x)>Math.abs(t.y)?new Ya(t.x,Math.sign(t.y)*Math.abs(t.x)):new Ya(Math.sign(t.x)*Math.abs(t.y),t.y)),v.onResize&&v.canResize(l)){var g,m,y=this._scalePagePoint(Cs.applyToPoint(p,new Ya(0,0)),c,t,f),b=this.getPointInParentSpace(l.id,y),w=new Ya(t.x,t.y),x=ts((d-f)%Math.PI,0);w.x=x?t.x:t.y,w.y=x?t.y:t.x;var k=Cs.applyToPoint(p,new Ya),S=this.getPointInParentSpace(l.id,k),_=S.x,P=S.y;this.updateShapes([Ce({id:e,type:l.type,x:b.x,y:b.y},v.onResize(Ce(Ce({},l),{},{x:_,y:P}),{newPoint:b,handle:null!==(g=u.dragHandle)&&void 0!==g?g:"bottom_right",mode:null!==(m=u.mode)&&void 0!==m?m:"scale_shape",scaleX:w.x,scaleY:w.y,initialBounds:h,initialShape:l}))],!0)}else{var E=Cs.applyToPoint(p,h.center),C=this._scalePagePoint(E,c,t,f),I=this.getPointInParentSpace(l.id,E),T=this.getPointInParentSpace(l.id,C),M=Ya.Sub(T,I);this.updateShapes([{id:e,type:l.type,x:l.x+M.x,y:l.y+M.y}],!0)}return this}},{key:"_resizeUnalignedShape",value:function(e,t,n){var r=n.initialShape.type,i=new Ya(t.x,t.y);if(Math.abs(t.x)>Math.abs(t.y)?i.x=Math.sign(t.x)*Math.abs(t.y):i.y=Math.sign(t.y)*Math.abs(t.x),this.resizeShape(e,i,{initialShape:n.initialShape,initialBounds:n.initialBounds}),Math.sign(t.x)*Math.sign(t.y)<0){var o=Cs.Decompose(n.initialPageTransform).rotation;o-=2*o,this.updateShapes([{id:e,type:r,rotation:o}],!0)}var a=Cs.applyToPoint(n.initialPageTransform,n.initialBounds.center),s=this._scalePagePoint(a,n.scaleOrigin,t,n.scaleAxisRotation),u=this.getPageCenterById(e),l=this.getPagePointById(e);if(!u||!l)return this;var c=Ya.Sub(s,u),d=Ya.Add(l,c),f=this.getPointInParentSpace(e,d),p=f.x,h=f.y;return this.updateShapes([{id:e,type:r,x:p,y:h}],!0),this}},{key:"_scalePagePoint",value:function(e,t,n,r){var i=Ya.RotWith(e,t,-r).sub(t),o=Ya.MulV(i,n);return Ya.Add(o,t).rotWith(t,r)}},{key:"getInitialMetaForShape",value:function(e){return{}}},{key:"createShapes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._createShapes(e,t),this}},{key:"animateShapes",value:function(e){var t,n,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.duration,a=void 0===o?500:o,s=i.ease,u=void 0===s?Ha.linear:s,l=ef(),c=a,d=[];e.forEach((function(e){if(e){var t={partial:e,values:[]},n=r.getShapeById(e.id);if(n){for(var i=0,o=["x","y","rotation"];i<o.length;i++){var a=o[i];void 0!==e[a]&&n[a]!==e[a]&&t.values.push({prop:a,from:n[a],to:e[a]})}d.push(t),r.animatingShapes.set(n.id,l)}}}));return this.addListener("tick",(function i(o){if((c-=o)<0){var s=r.animatingShapes,f=e.filter((function(e){return e&&s.get(e.id)===l}));return f.length&&r.updateShapes(f,!1),void r.removeListener("tick",i)}t=u(1-c/a);var p=r.animatingShapes;try{for(var h=[],v=0;v<d.length;v++)n=d[v],p.get(n.partial.id)===l&&h.push(Ce({id:n.partial.id,type:n.partial.type},n.values.reduce((function(e,n){var r=n.prop,i=n.from,o=n.to;return e[r]=i+(o-i)*t,e}),{})));r._updateShapes(h,!0)}catch(ok){}})),this}},{key:"groupShapes",value:function(){var e,t,n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vi();if(this.isReadOnly)return this;if(r.length<=1)return this;var o=Te(this._getUnlockedShapeIds(r).map((function(e){return n.getShapeById(e)}))),a=o.sort(M).map((function(e){return e.id})),s=ws.Common(Te(o.map((function(e){return n.getPageBounds(e)})))).point,u=s.x,l=s.y,c=null!==(e=this.findCommonAncestor(o))&&void 0!==e?e:this.currentPageId;if("select"!==this.currentToolId)return this;this.isIn("select.idle")||this.cancel();var d=o.filter((function(e){return e.parentId===c})).sort(M),f=null===(t=d[d.length-1])||void 0===t?void 0:t.index;return this.batch((function(){n.createShapes([{id:i,type:"group",parentId:c,index:f,x:u,y:l,opacity:1,props:{}}]),n.reparentShapesById(a,i),n.select(i)})),this}},{key:"ungroupShapes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds;if(this.isReadOnly)return this;if(0===t.length)return this;if("select"!==this.currentToolId)return this;this.isIn("select.idle")||this.cancel();var n=new Set,r=Te(t.map((function(t){return e.getShapeById(t)}))),i=[];return r.forEach((function(t){e.isShapeOfType(t,Up)?i.push(t):n.add(t.id)})),0===i.length||this.batch((function(){for(var t,r=0,o=i.length;r<o;r++){t=i[r];for(var a=e.getSortedChildIds(t.id),s=0,u=a.length;s<u;s++)n.add(a[s]);e.reparentShapesById(a,t.parentId,t.index)}e.deleteShapes(i.map((function(e){return e.id}))),e.select.apply(e,d(n))})),this}},{key:"updateShapes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Te(e);return this.animatingShapes.size>0&&r.forEach((function(e){return t.animatingShapes.delete(e.id)})),r=r.filter((function(e){var n=t.getShapeById(e.id);return!!n&&!(t.isShapeOrAncestorLocked(n)&&!Object.hasOwn(e,"isLocked"))})),this._updateShapes(r,n),this}},{key:"_getUnlockedShapeIds",value:function(e){var t=this;return e.filter((function(e){var n;return!(null!==(n=t.getShapeById(e))&&void 0!==n&&n.isLocked)}))}},{key:"deleteShapes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds;return this._deleteShapes(this._getUnlockedShapeIds(e)),this}},{key:"_extractSharedStyles",value:function(e,t){if(this.isShapeOfType(e,Up)){var n=this._parentIdsToChildIds.value[e.id];if(!n)return;for(var r=0,i=n.length;r<i;r++)this._extractSharedStyles(this.getShapeById(n[r][0]),t)}else{var o,a=J(this.getShapeUtil(e).styleProps);try{for(a.s();!(o=a.n()).done;){var s=l(o.value,2),u=s[0],c=s[1];t.applyValue(u,Ve(e.props,c))}}catch(d){a.e(d)}finally{a.f()}}}},{key:"_stylesForNextShape",get:function(){return this.instanceState.stylesForNextShape}},{key:"getStyleForNextShape",value:function(e){var t=this._stylesForNextShape[e.id];return void 0===t?e.defaultValue:t}},{key:"getShapeStyleIfExists",value:function(e,t){var n=this.getShapeUtil(e).styleProps.get(t);if(void 0!==n)return Ve(e.props,n)}},{key:"sharedStyles",get:function(){if(this.isIn("select")&&this.selectedIds.length>0)return this._selectionSharedStyles.value;var e=this.root.current.value,t=new uv;if(e.shapeType){var n,r=J(this.getShapeUtil(e.shapeType).styleProps.keys());try{for(r.s();!(n=r.n()).done;){var i=n.value;t.applyValue(i,this.getStyleForNextShape(i))}}catch(o){r.e(o)}finally{r.f()}}return t}},{key:"sharedOpacity",get:function(){var e=this;if(this.isIn("select")&&this.selectedIds.length>0){var t,n=[],r=function t(r){var i=e.getShapeById(r);if(i)if(e.isShapeOfType(i,Up)){var o,a=J(e.getSortedChildIds(i.id));try{for(a.s();!(o=a.n()).done;){t(o.value)}}catch(s){a.e(s)}finally{a.f()}}else n.push(i)},i=J(this.selectedIds);try{for(i.s();!(t=i.n()).done;){r(t.value)}}catch(l){i.e(l)}finally{i.f()}for(var o=null,a=0,s=n;a<s.length;a++){var u=s[a];if(null===o)o=u.opacity;else if(o!==u.opacity)return{type:"mixed"}}if(null!==o)return{type:"shared",value:o}}return{type:"shared",value:this.instanceState.opacityForNextShape}}},{key:"setOpacity",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.history.batch((function(){if(t.isIn("select")){var i=t.pageState.selectedIds,o=[],a=function e(n){var r=t.getShapeById(n);if(r)if(t.isShapeOfType(r,Up)){var i,a=J(t.getSortedChildIds(n));try{for(a.s();!(i=a.n()).done;){e(i.value)}}catch(s){a.e(s)}finally{a.f()}}else o.push(r)};if(i.length>0){var s,u=J(i);try{for(u.s();!(s=u.n()).done;){a(s.value)}}catch(l){u.e(l)}finally{u.f()}t.updateShapes(o.map((function(t){return{id:t.id,type:t.type,opacity:e}})),n)}}t.updateInstanceState({opacityForNextShape:e},n,r)})),this}},{key:"setStyle",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.history.batch((function(){if(n.isIn("select")){var o=n.pageState.selectedIds;if(o.length>0){var a,s=[],u=function r(i){var o=n.getShapeById(i);if(o)if(n.isShapeOfType(o,Up)){var a,u=J(n.getSortedChildIds(i));try{for(u.s();!(a=u.n()).done;){r(a.value)}}catch(f){u.e(f)}finally{u.f()}}else{var l=n.getShapeUtil(o),c=l.styleProps.get(e);if(c){var d={id:o.id,type:o.type,props:D({},c,t)};s.push({util:l,originalShape:o,updatePartial:d})}}},l=J(o);try{for(l.s();!(a=l.n()).done;){u(a.value)}}catch(c){l.e(c)}finally{l.f()}n.updateShapes(s.map((function(e){return e.updatePartial})),r)}}n.updateInstanceState({stylesForNextShape:Ce(Ce({},n._stylesForNextShape),{},D({},e.id,t))},r,i)})),this}},{key:"getContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIds;if(t&&0!==t.length){var n={},r=Ie(t.map((function(t){return e.getShapeById(t)})).sort(M).flatMap((function(t){var n=[t];return e.visitDescendants(t.id,(function(t){n.push(e.getShapeById(t))})),n})));r=r.map((function(t){if(n[t.id]=e.getPageTransformById(t.id),t=it(t),e.isShapeOfType(t,tp)){var i="binding"===t.props.start.type?t.props.start.boundShapeId:void 0,o="binding"===t.props.end.type?t.props.end.boundShapeId:void 0,a=e.getShapeUtil(tp).getArrowInfo(t);if("binding"===t.props.start.type&&!r.some((function(e){return e.id===i})))if(null!==a&&void 0!==a&&a.isValid){var s=a.start.point,u=s.x,l=s.y;t.props.start={type:"point",x:u,y:l}}else{var c=Rf(e,t).start;t.props.start={type:"point",x:c.x,y:c.y}}if("binding"===t.props.end.type&&!r.some((function(e){return e.id===o})))if(null!==a&&void 0!==a&&a.isValid){var d=a.end.point,f=d.x,p=d.y;t.props.end={type:"point",x:f,y:p}}else{var h=Rf(e,t).end;t.props.end={type:"point",x:h.x,y:h.y}}var v=zf(t)?Uf(e,t):Yf(e,t);if(null!==a&&void 0!==a&&a.isValid&&null!==v&&void 0!==v&&v.isValid&&!zf(t)){var g=Ya.Med(a.start.handle,a.end.handle),m=Ya.Dist(a.middle,g),y=Ya.Dist(v.middle,g);t.props.bend<0?t.props.bend+=y-m:t.props.bend-=y-m}return t}return t}));var i=[];r.forEach((function(t){if(void 0===r.find((function(e){return e.id===t.parentId}))){var n=e.getPagePointById(t.id),o=e.getPageRotationById(t.id);t.x=n.x,t.y=n.y,t.rotation=o,t.parentId=e.currentPageId,i.push(t.id)}}));var o=new Set;return r.forEach((function(e){"assetId"in e.props&&null!==e.props.assetId&&o.add(e.props.assetId)})),{shapes:r,rootShapeIds:i,schema:this.store.schema.serialize(),assets:Te(Array.from(o).map((function(t){return e.getAssetById(t)})))}}}},{key:"putContent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isReadOnly)return this;if(!e.schema)throw Error("Could not put content: content is missing a schema.");var r,i=n.select,o=void 0!==i&&i,a=n.preserveIds,s=void 0!==a&&a,u=n.preservePosition,l=void 0!==u&&u,c=n.point,d=void 0===c?void 0:c,f=this.currentPageId,p=e.assets,h=e.shapes,v=e.rootShapeIds,g=new Map(h.map((function(e){return[e.id,Vi()]}))),m=this.currentPageId,y=1/0,b=[],w=J(this.selectedShapes);try{for(w.s();!(r=w.n()).done;){var x=r.value;if(0===y)break;var k=this.isShapeOfType(x,Wp),S=this.getAncestors(x);k&&S.push(x);var _=k?S.length+1:S.length;if(_<y)y=_,b=S,m=k?x.id:x.parentId;else if(_===y){if(b.length!==S.length)throw Error("Ancestors: ".concat(b.length," !== ").concat(S.length));if(0===b.length){m=f;break}m=f;for(var P=0;P<b.length&&S[P]===b[P];P++)m=S[P].id}}}catch(U){w.e(U)}finally{w.f()}var E=!1;if(!Nn(m)){var C=this.getShapeById(m);if(C)if(this.viewportPageBounds.includes(this.getPageBounds(C))){if(1===v.length){var T=h.find((function(e){return e.id===v[0]}));this.isShapeOfType(C,Wp)&&this.isShapeOfType(T,Wp)&&T.props.w===(null===C||void 0===C?void 0:C.props.w)&&T.props.h===(null===C||void 0===C?void 0:C.props.h)&&(E=!0)}}else m=f;else m=f}E||(E=g.has(m)),E&&(m=this.getShapeById(m).parentId);var M=this.getHighestIndexForParent(m),j=[],A=h.map((function(e){var n;if(s)n=We(e),g.set(e.id,e.id);else{var r=g.get(e.id);n=We(Ce(Ce({},e),{},{id:r}))}if(v.includes(e.id)&&(n.parentId=f,j.push(n)),g.has(n.parentId)?n.parentId=g.get(e.parentId):(v.push(n.id),n.index=M,M=I(M)),t.isShapeOfType(n,tp)){if("binding"===n.props.start.type){var i=g.get(n.props.start.boundShapeId);n.props.start=i?Ce(Ce({},n.props.start),{},{boundShapeId:i}):{type:"point",x:0,y:0}}if("binding"===n.props.end.type){var o=g.get(n.props.end.boundShapeId);n.props.end=o?Ce(Ce({},n.props.end),{},{boundShapeId:o}):{type:"point",x:0,y:0}}}return n}));if(A.length+this.currentPageShapeIds.size>Iu)return qg(this),this;var O=[];if(p){for(var L=0;L<p.length;L++){var z=p[L],D=this.store.schema.migratePersistedRecord(z,e.schema);if("success"!==D.type)throw Error("Could not put content: could not migrate content for asset:\n".concat(JSON.stringify(z,null,2)));p[L]=D.value}var N=[];O=p.filter((function(e){return!t.store.has(e.id)})).map((function(e){var t;"image"!==e.type&&"video"!==e.type||(e.props.src&&null!==(t=e.props.src)&&void 0!==t&&t.startsWith("data:image")?(N.push(it(e)),e.props.src=null):N.push(it(e)));return e})),Promise.allSettled(N.map(function(){var e=Ba(Na().mark((function e(n){var r,i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zv(n.props.src,n.props.name,null!==(r=n.props.mimeType)&&void 0!==r?r:"image/png");case 2:return i=e.sent,e.next=5,t.externalContentManager.createAssetFromFile(t,i);case 5:return o=e.sent,e.abrupt("return",[n,o]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){t.updateAssets(Te(e.map((function(e){return"fulfilled"===e.status?Ce(Ce({},e.value[1]),{},{id:e.value[0].id}):void 0}))))}))}for(var R=0;R<A.length;R++){var B=A[R],F=this.store.schema.migratePersistedRecord(B,e.schema);if("success"!==F.type)throw Error("Could not put content: could not migrate content for shape:\n".concat(JSON.stringify(B,null,2)));A[R]=F.value}return this.batch((function(){O.length>0&&t.createAssets(O),t.createShapes(A,o),m!==f&&t.reparentShapesById(j.map((function(e){return e.id})),m);var e=A.map((function(e){return t.getShapeById(e.id)})),n=ws.Common(e.map((function(e){return t.getPageBounds(e)})));if(void 0===d)if(Nn(m)){var r=t.viewportPageBounds;d=l||r.includes(ws.From(n))?n.center:r.center}else{var i=t.getShapeById(m),a=t.getShapeUtil(i);d=a.center(i)}if(1===j.length){var s=j[0];if(t.isShapeOfType(s,Wp))for(;t.getShapesAtPoint(d).some((function(e){return t.isShapeOfType(e,Wp)&&e.props.w===s.props.w&&e.props.h===s.props.h}));)d.x+=n.w+16}t.updateShapes(j.map((function(e){var t,r,i=(null!==(t=e.x)&&void 0!==t?t:0)-(n.x+n.w/2),o=(null!==(r=e.y)&&void 0!==r?r:0)-(n.y+n.h/2);return{id:e.id,type:e.type,x:d.x+i,y:d.y+o}})))})),this}},{key:"replaceStoreContentsWithRecordsForOtherDocument",value:function(e){var t=this;ae((function(){t.store.clear();var n=l(function(e,t){var n,r=[],i=[],o=J(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;t(a)?r.push(a):i.push(a)}}catch(s){o.e(s)}finally{o.f()}return[r,i]}(e,(function(e){return"shape"===e.typeName})),2),r=n[0],i=n[1];t.store.put(i,"initialize"),t.store.ensureStoreIsUsable(),t.store.put(r,"initialize"),t.history.clear(),t.updateViewportScreenBounds(),t.updateRenderingBounds();var o=t.allShapesCommonBounds;o&&t.zoomToBounds(o.minX,o.minY,o.width,o.height,1)}))}},{key:"putExternalContent",value:function(){var e=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.externalContentManager.handleContent(t);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSvg",value:function(){var e=Ba(Na().mark((function e(){var t,n,r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j=this,A=arguments;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=A.length>0&&void 0!==A[0]?A[0]:this.selectedIds.length?this.selectedIds:Object.keys(this.currentPageShapeIds),n=A.length>1&&void 0!==A[1]?A[1]:{},0!==t.length){e.next=4;break}return e.abrupt("return");case 4:if(window.document){e.next=6;break}throw Error("No document");case 6:r=n.scale,i=void 0===r?1:r,o=n.background,a=void 0!==o&&o,s=n.padding,u=void 0===s?32:s,l=n.preserveAspectRatio,c=void 0!==l&&l,d=Ji(this),f=this.getShapeAndDescendantIds(t),p=this.computeUnorderedRenderingShapes([this.currentPageId]).filter((function(e){var t=e.id;return f.has(t)})),h=null,v=J(p),e.prev=12,v.s();case 14:if((g=v.n()).done){e.next=21;break}if(m=g.value.maskedPageBounds){e.next=18;break}return e.abrupt("continue",19);case 18:h?h.union(m):h=m.clone();case 19:e.next=14;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(12),v.e(e.t0);case 26:return e.prev=26,v.f(),e.finish(26);case 29:if(h){e.next=31;break}return e.abrupt("return");case 31:(y=1===t.length&&this.isShapeOfType(this.getShapeById(t[0]),Wp)?t[0]:null)||h.expandBy(u),b=h.width*i,w=h.height*i,x=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),c&&x.setAttribute("preserveAspectRatio",c),x.setAttribute("direction","ltr"),x.setAttribute("width",b+""),x.setAttribute("height",w+""),x.setAttribute("viewBox","".concat(h.minX," ").concat(h.minY," ").concat(h.width," ").concat(h.height)),x.setAttribute("stroke-linecap","round"),x.setAttribute("stroke-linejoin","round"),a?y?x.style.setProperty("background",d.solid):x.style.setProperty("background-color",d.background):x.style.setProperty("background-color","transparent");try{null===(k=(S=document.body).focus)||void 0===k||k.call(S)}catch(ok){}return _=window.document.createElementNS("http://www.w3.org/2000/svg","defs"),x.append(_),P=new Map,E={addExportDef:function(e){if(!P.has(e.key)){var t=Ba(Na().mark((function t(){var n,r,i,o,a;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getElement();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:r=document.createComment("def: ".concat(e.key)),_.appendChild(r),i=J(Array.isArray(n)?n:[n]);try{for(i.s();!(o=i.n()).done;)a=o.value,_.appendChild(a)}catch(s){i.e(s)}finally{i.f()}case 9:case"end":return t.stop()}}),t)})))();P.set(e.key,t)}}},e.next=51,Promise.all(p.map(function(){var e=Ba(Na().mark((function e(t){var n,r,i,o,a,s,u,l,c,f,p,h,v,g,m,b,w,x,k,S,P,C,I,T,M,A;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=t.id,l=t.opacity,c=t.index,f=t.backgroundIndex,u!==y){e.next=3;break}return e.abrupt("return",[]);case 3:if(p=j.getShapeById(u),!j.isShapeOfType(p,Up)){e.next=6;break}return e.abrupt("return",[]);case 6:return h=j.getShapeUtil(p),e.next=9,null===(n=h.toSvg)||void 0===n?void 0:n.call(h,p,E);case 9:return v=e.sent,e.next=12,null===(r=h.toBackgroundSvg)||void 0===r?void 0:r.call(h,p,E);case 12:return g=e.sent,v&&((m=document.createElementNS("http://www.w3.org/2000/svg","g")).appendChild(v),v=m),g&&((b=document.createElementNS("http://www.w3.org/2000/svg","g")).appendChild(g),g=b),v||g||(w=j.getPageBounds(p),(x=window.document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("width",w.width+""),x.setAttribute("height",w.height+""),x.setAttribute("fill",d.solid),x.setAttribute("stroke",d.grey.pattern),x.setAttribute("stroke-width","1"),v=x),k=j.getPageTransform(p).toCssString(),"scale"in p.props&&1!==p.props.scale&&(k="".concat(k," scale(").concat(p.props.scale,", ").concat(p.props.scale,")")),null===(i=v)||void 0===i||i.setAttribute("transform",k),null===(o=g)||void 0===o||o.setAttribute("transform",k),null===(a=v)||void 0===a||a.setAttribute("opacity",l+""),null===(s=g)||void 0===s||s.setAttribute("opacity",l+""),(S=j.getPageMaskById(p.id))&&(P=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),_.appendChild(P),C=ot(),P.id=C,(I=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M".concat(S.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n)})).join("L"),"Z")),P.appendChild(I),v&&((T=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("clip-path","url(#".concat(C,")")),T.appendChild(v),v=T),g&&((M=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("clip-path","url(#".concat(C,")")),M.appendChild(g),g=M)),A=[],v&&A.push({zIndex:c,element:v}),g&&A.push({zIndex:f,element:g}),e.abrupt("return",A);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 51:return C=e.sent.flat(),e.next=54,Promise.all(P.values());case 54:I=J(C.sort((function(e,t){return e.zIndex-t.zIndex})));try{for(I.s();!(T=I.n()).done;)M=T.value.element,x.appendChild(M)}catch(O){I.e(O)}finally{I.f()}return e.abrupt("return",x);case 57:case"end":return e.stop()}}),e,this,[[12,23,26,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"_updateInputsFromEvent",value:function(e){var t,n,r=this.inputs,i=r.previousScreenPoint,o=r.previousPagePoint,a=r.currentScreenPoint,s=r.currentPagePoint,u=this.store.unsafeGetWithoutCapture(kr).screenBounds,l=e.point,c=l.x,d=l.y,f=l.z,p=this.camera,h=p.x,v=p.y,g=p.z;i.setTo(a),o.setTo(s),a.set(c,d),s.set((c-u.x)/g-h,(d-u.y)/g-v,null!==f&&void 0!==f?f:.5),this.inputs.isPen="pointer"===e.type&&e.isPen,"pointer_down"===e.name&&this.inputs.pointerVelocity.set(0,0),this.store.put([{id:Fr,typeName:"pointer",x:s.x,y:s.y,lastActivityTimestamp:"pointer"===e.type&&e.pointerId===Fu&&null!==(t=null===(n=this.store.get(Fr))||void 0===n?void 0:n.lastActivityTimestamp)&&void 0!==t?t:Date.now(),meta:{}}])}},{key:"cancel",value:function(){return this.dispatch({type:"misc",name:"cancel"}),this}},{key:"interrupt",value:function(){return this.dispatch({type:"misc",name:"interrupt"}),this}},{key:"complete",value:function(){return this.dispatch({type:"misc",name:"complete"}),this}},{key:"cancelDoubleClick",value:function(){this._clickManager.cancelDoubleClickTimeout()}},{key:"dispatch",value:function(e){var t=this;if(this.crashingError)return this;var n=this.inputs,r=e.type;return this.batch((function(){if("misc"===e.type)return"cancel"!==e.name&&"complete"!==e.name||(t.inputs.isDragging=!1,t.inputs.isPanning&&(t.inputs.isPanning=!1,t.setCursor({type:t._prevCursor}))),void t.root.handleEvent(e);e.shiftKey?(clearInterval(t._shiftKeyTimeout),t._shiftKeyTimeout=-1,n.shiftKey=!0):!e.shiftKey&&n.shiftKey&&-1===t._shiftKeyTimeout&&(t._shiftKeyTimeout=setTimeout(t._setShiftKeyTimeout,150)),e.altKey?(clearInterval(t._altKeyTimeout),t._altKeyTimeout=-1,n.altKey=!0):!e.altKey&&n.altKey&&-1===t._altKeyTimeout&&(t._altKeyTimeout=setTimeout(t._setAltKeyTimeout,150)),e.ctrlKey?(clearInterval(t._ctrlKeyTimeout),t._ctrlKeyTimeout=-1,n.ctrlKey=!0):!e.ctrlKey&&n.ctrlKey&&-1===t._ctrlKeyTimeout&&(t._ctrlKeyTimeout=setTimeout(t._setCtrlKeyTimeout,150));var i=n.originPagePoint,o=n.originScreenPoint,a=n.currentPagePoint,s=n.currentScreenPoint;switch(n.isPointing||(n.isDragging=!1),r){case"pinch":if(!t.canMoveCamera)return;switch(t._updateInputsFromEvent(e),e.name){case"pinch_start":if(n.isPinching)return;return void(n.isEditing||(t._pinchStart=t.camera.z,t._selectedIdsAtPointerDown.length||(t._selectedIdsAtPointerDown=t.selectedIds.slice()),t._didPinch=!0,n.isPinching=!0,t.interrupt()));case"pinch":if(!n.isPinching)return;var u=e.point,l=u.x,c=u.y,d=u.z,f=void 0===d?1:d,p=e.delta,h=p.x,v=p.y,g=t.camera,m=g.x,y=g.y,b=g.z,w=Math.min(Au,Math.max(ju,f));return void t.setCamera(m+h/b-l/b+l/w,y+v/b-c/b+c/w,w);case"pinch_end":if(!n.isPinching)return t;n.isPinching=!1;var x=t._selectedIdsAtPointerDown;t.setSelectedIds(t._selectedIdsAtPointerDown,!0),t._selectedIdsAtPointerDown=[];var k,S=t.camera,_=S.x,P=S.y,E=S.z;if(E>.9&&E<1.05?k=1:E>.49&&E<.505&&(k=.5),E>t._pinchStart-.1&&E<t._pinchStart+.05&&(k=t._pinchStart),void 0!==k){var C=t.viewportScreenCenter,I=C.x,T=C.y;t.animateCamera(_+(I/k-I)-(I/E-I),P+(T/k-T)-(T/E-T),k,{duration:100})}return void(t._didPinch&&(t._didPinch=!1,requestAnimationFrame((function(){t._didPinch||t.setSelectedIds(x,!0)}))))}case"wheel":if(!t.canMoveCamera)return;if(t.isMenuOpen);else{if(n.ctrlKey){var M,j=t.inputs.currentScreenPoint,A=j.x,O=j.y,L=t.camera,z=L.x,D=L.y,N=L.z,R=Math.min(Au,Math.max(ju,N+(null!==(M=e.delta.z)&&void 0!==M?M:0)*N));return void t.setCamera(z+(A/R-A)-(A/N-A),D+(O/R-O)-(O/N-O),R)}t.pan(e.delta.x,e.delta.y),!n.isDragging&&n.isPointing&&i.dist(a)>(t.isCoarsePointer?6:4)/t.zoomLevel&&(n.isDragging=!0)}break;case"pointer":if(n.isPinching)return;t._updateInputsFromEvent(e);var B=e.isPen;switch(e.name){case"pointer_down":if(t._selectedIdsAtPointerDown=t.selectedIds.slice(),0===e.button&&(t.capturedPointerId=e.pointerId),n.buttons.add(e.button),n.isPointing=!0,n.isDragging=!1,t.isPenMode){if(!B)return}else B&&t.setPenMode(!0);if(5===e.button?(t._restoreToolId=t.currentToolId,t.complete(),t.setSelectedTool("eraser")):1===e.button&&(t.inputs.isPanning||(t._prevCursor=t.instanceState.cursor.type),t.inputs.isPanning=!0),t.inputs.isPanning)return t.stopCameraAnimation(),t.setCursor({type:"grabbing"}),t;o.setTo(s),i.setTo(a);break;case"pointer_move":if(!B&&t.isPenMode)return;if(t.inputs.isPanning&&t.inputs.isPointing){var F=t.inputs,U=F.currentScreenPoint,K=F.previousScreenPoint,V=Ya.Sub(U,K);return void t.pan(V.x,V.y)}!n.isDragging&&n.isPointing&&i.dist(a)>(t.isCoarsePointer?6:4)/t.zoomLevel&&(n.isDragging=!0);break;case"pointer_up":if(n.buttons.delete(e.button),n.isPointing=!1,n.isDragging=!1,t.isMenuOpen)return;if(!B&&t.isPenMode)return;t.capturedPointerId===e.pointerId&&(t.capturedPointerId=null,e.button=0),n.isPanning?1===e.button?t.inputs.keys.has(" ")?(t.slideCamera({speed:Math.min(2,t.inputs.pointerVelocity.len()),direction:t.inputs.pointerVelocity,friction:Du}),t.setCursor({type:"grab"})):(n.isPanning=!1,t.slideCamera({speed:Math.min(2,t.inputs.pointerVelocity.len()),direction:t.inputs.pointerVelocity,friction:Du}),t.setCursor({type:t._prevCursor})):0===e.button&&(t.slideCamera({speed:Math.min(2,t.inputs.pointerVelocity.len()),direction:t.inputs.pointerVelocity,friction:Du}),t.setCursor({type:"grab"})):5===e.button&&(t.complete(),t.setSelectedTool(t._restoreToolId))}break;case"keyboard":switch("ShiftRight"===e.key&&(e.key="ShiftLeft"),"AltRight"===e.key&&(e.key="AltLeft"),"ControlRight"===e.code&&(e.code="ControlLeft"),e.name){case"key_down":n.keys.add(e.code),e.ctrlKey||"Space"!==e.code||(t.inputs.isPanning||(t._prevCursor=t.instanceState.cursor.type),t.inputs.isPanning=!0,t.setCursor({type:t.inputs.isPointing?"grabbing":"grab"}));break;case"key_up":n.keys.delete(e.code),"Space"!==e.code||t.inputs.buttons.has(1)||(t.inputs.isPanning=!1,t.setCursor({type:t._prevCursor}))}}if("pointer"===e.type&&(1===e.button?e.name="middle_click":2===e.button&&(e.name="right_click"),e.isPen===t.isPenMode))switch(e.name){case"pointer_down":var W=t._clickManager.transformPointerDownEvent(e);if(e.name!==W.name)return t.root.handleEvent(e),t.emit("event",e),t.root.handleEvent(W),void t.emit("event",W);break;case"pointer_up":var H=t._clickManager.transformPointerUpEvent(e);if(e.name!==H.name)return t.root.handleEvent(e),t.emit("event",e),t.root.handleEvent(H),void t.emit("event",H);break;case"pointer_move":t._clickManager.handleMove()}t.root.handleEvent(e),t.emit("event",e)})),this}}]),n}(xf.EventEmitter);function qg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.currentPageId,n=e.getPageById(t).name;e.emit("max-shapes",{name:n,pageId:t,count:Iu})}Yg([ve],Xg.prototype,"canUndo",1),Yg([ve],Xg.prototype,"canRedo",1),Yg([ve],Xg.prototype,"_arrowBindingsIndex",1),Yg([ve],Xg.prototype,"_allPageStates",1),Yg([ve],Xg.prototype,"devicePixelRatio",1),Yg([ve],Xg.prototype,"openMenus",1),Yg([ve],Xg.prototype,"isMenuOpen",1),Yg([ve],Xg.prototype,"documentSettings",1),Yg([ve],Xg.prototype,"_pageStates",1),Yg([ve],Xg.prototype,"pageStateId",1),Yg([ve],Xg.prototype,"pageState",1),Yg([ve],Xg.prototype,"selectedIds",1),Yg([ve],Xg.prototype,"selectedIdsSet",1),Yg([ve],Xg.prototype,"selectedShapes",1),Yg([ve],Xg.prototype,"onlySelectedShape",1),Yg([ve],Xg.prototype,"selectedPageBounds",1),Yg([ve],Xg.prototype,"selectionRotation",1),Yg([ve],Xg.prototype,"selectionBounds",1),Yg([ve],Xg.prototype,"selectionPageCenter",1),Yg([ve],Xg.prototype,"editingShape",1),Yg([ve],Xg.prototype,"hoveredId",1),Yg([ve],Xg.prototype,"hoveredShape",1),Yg([ve],Xg.prototype,"hintingIds",1),Yg([ve],Xg.prototype,"erasingIds",1),Yg([ve],Xg.prototype,"erasingIdsSet",1),Yg([ve],Xg.prototype,"cameraId",1),Yg([ve],Xg.prototype,"camera",1),Yg([ve],Xg.prototype,"zoomLevel",1),Yg([ve],Xg.prototype,"viewportScreenBounds",1),Yg([ve],Xg.prototype,"viewportScreenCenter",1),Yg([ve],Xg.prototype,"viewportPageBounds",1),Yg([ve],Xg.prototype,"viewportPageCenter",1),Yg([ve],Xg.prototype,"cameraState",1),Yg([ve],Xg.prototype,"renderingShapes",1),Yg([ve],Xg.prototype,"renderingBounds",1),Yg([ve],Xg.prototype,"renderingBoundsExpanded",1),Yg([ve],Xg.prototype,"_pages",1),Yg([ve],Xg.prototype,"pages",1),Yg([ve],Xg.prototype,"_assets",1),Yg([ve],Xg.prototype,"_boundsCache",1),Yg([ve],Xg.prototype,"_outlineCache",1),Yg([ve],Xg.prototype,"_outlineSegmentsCache",1),Yg([ve],Xg.prototype,"handlesCache",1),Yg([ve],Xg.prototype,"_pageTransformCache",1),Yg([ve],Xg.prototype,"_pageBoundsCache",1),Yg([ve],Xg.prototype,"_clipPathCache",1),Yg([ve],Xg.prototype,"_pageMaskCache",1),Yg([ve],Xg.prototype,"allShapesCommonBounds",1),Yg([ve],Xg.prototype,"shapesArray",1),Yg([ve],Xg.prototype,"sortedShapesArray",1),Yg([ve],Xg.prototype,"_stylesForNextShape",1),Yg([ve({isEqual:function(e,t){return e.equals(t)}})],Xg.prototype,"sharedStyles",1),Yg([ve],Xg.prototype,"sharedOpacity",1);var $g="TLDRAW_TAB_ID_v2",Gg=globalThis.window;var Qg=null!==(Kg=null!==(Vg=null===Gg||void 0===Gg?void 0:Gg[$g])&&void 0!==Vg?Vg:null===Gg||void 0===Gg?void 0:Gg.sessionStorage[$g])&&void 0!==Kg?Kg:"TLDRAW_INSTANCE_STATE_V1_"+ef();Gg&&(Gg[$g]=Qg,Gg&&(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(Gg.navigator.platform)||Gg.navigator.userAgent.includes("Mac")&&"ontouchend"in document)?Gg.sessionStorage[$g]=Qg:delete Gg.sessionStorage[$g]),null===Gg||void 0===Gg||Gg.addEventListener("beforeunload",(function(){Gg.sessionStorage[$g]=Qg}));var Zg=0,Jg=nn({version:Wt,currentPageId:An,isFocusMode:Gt,exportBackground:Gt,isDebugMode:Gt,isToolLocked:Gt,isGridMode:Gt,pageStates:en(nn({pageId:An,camera:nn({x:Wt,y:Wt,z:Wt}),selectedIds:en(_r),focusLayerId:_r.nullable()}))}),em=yt({currentVersion:Zg});function tm(e,t){var n=function(e){if(!e||"object"!==typeof e)return console.warn("Invalid instance state"),null;if(!("version"in e)||"number"!==typeof e.version)return console.warn("No version in instance state"),null;var t=xt({value:e,fromVersion:e.version,toVersion:Zg,migrations:em});if("error"===t.type)return console.warn(t.reason),null;var n=Ce(Ce({},t.value),{},{version:Zg});try{Jg.validate(n)}catch(ok){return console.warn(ok),null}return n}(t);if(n){var r=e.allRecords().filter((function(e){return"instance_page_state"===e.typeName||"camera"===e.typeName})),i={added:{},updated:{},removed:Ce({},qe(r.map((function(e){return[e.id,e]}))))};e.has(kr)&&(i.removed[kr]=e.get(kr));var o,a={removed:{},updated:{},added:D({},kr,e.schema.types.instance.create({id:kr,currentPageId:n.currentPageId,isDebugMode:n.isDebugMode,isFocusMode:n.isFocusMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,exportBackground:n.exportBackground}))},s=J(n.pageStates);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=kn.createId(u.pageId),c=Lr.createId(u.pageId);a.added[l]=kn.create({id:kn.createId(u.pageId),x:u.camera.x,y:u.camera.y,z:u.camera.z}),a.added[c]=Lr.create({id:Lr.createId(u.pageId),pageId:u.pageId,selectedIds:u.selectedIds,focusLayerId:u.focusLayerId})}}catch(d){s.e(d)}finally{s.f()}ae((function(){e.applyDiff(ht([i,a])),e.ensureStoreIsUsable()}))}}function nm(e){for(var t=[],n=0,r=Object.values(e);n<r.length;n++){var i,o=r[n];null!==(i=o.typeName)&&void 0!==i&&i.match(/^(instance.*|pointer|camera)$/)&&t.push(o)}var a=t.filter((function(e){return"instance"===e.typeName&&e.id!==kr}))[0];if(!a)return null;var s={version:Zg,currentPageId:a.currentPageId,exportBackground:!!a.exportBackground,isFocusMode:!!a.isFocusMode,isDebugMode:!!a.isDebugMode,isToolLocked:!!a.isToolLocked,isGridMode:!1,pageStates:t.filter((function(e){return"instance_page_state"===e.typeName&&e.instanceId===a.id})).map((function(t){var n,r=null!==(n=e[t.cameraId])&&void 0!==n?n:{x:0,y:0,z:1};return{pageId:t.pageId,camera:{x:r.x,y:r.y,z:r.z},selectedIds:t.selectedIds,focusLayerId:t.focusLayerId}}))};try{return Jg.validate(s),s}catch(ok){return null}}var rm,im,om=function(e,t){return t.some((function(t){return e instanceof t}))};var am=new WeakMap,sm=new WeakMap,um=new WeakMap,lm=new WeakMap,cm=new WeakMap;var dm={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return sm.get(e);if("objectStoreNames"===t)return e.objectStoreNames||um.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return hm(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function fm(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(im||(im=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(vm(this),n),hm(am.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hm(e.apply(vm(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=e.call.apply(e,[vm(this),t].concat(r));return um.set(o,t.sort?t.sort():[t]),hm(o)}}function pm(e){return"function"===typeof e?fm(e):(e instanceof IDBTransaction&&function(e){if(!sm.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=function(){t(),r()},o=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));sm.set(e,t)}}(e),om(e,rm||(rm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,dm):e)}function hm(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",o)},i=function(){t(hm(e.result)),r()},o=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((function(t){t instanceof IDBCursor&&am.set(t,e)})).catch((function(){})),cm.set(t,e),t}(e);if(lm.has(e))return lm.get(e);var t=pm(e);return t!==e&&(lm.set(e,t),cm.set(t,e)),t}var vm=function(e){return cm.get(e)};function gm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,o=n.blocking,a=n.terminated,s=indexedDB.open(e,t),u=hm(s);return i&&s.addEventListener("upgradeneeded",(function(e){i(hm(s.result),e.oldVersion,e.newVersion,hm(s.transaction),e)})),r&&s.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),u.then((function(e){a&&e.addEventListener("close",(function(){return a()})),o&&e.addEventListener("versionchange",(function(e){return o(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),u}function mm(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).blocked,n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(function(e){return t(e.oldVersion,e)})),hm(n).then((function(){}))}var ym=["get","getKey","getAll","getAllKeys","count"],bm=["put","add","delete","clear"],wm=new Map;function xm(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(wm.get(t))return wm.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=bm.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||ym.includes(n))){var o=function(){var e=Ba(Na().mark((function e(t){var o,a,s,u,l,c,d=arguments;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this.transaction(t,i?"readwrite":"readonly"),s=a.store,u=d.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=d[c];return r&&(s=s.index(l.shift())),e.next=6,Promise.all([(o=s)[n].apply(o,l),i&&a.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return wm.set(t,o),o}}}dm=function(e){return Ce(Ce({},e),{},{get:function(t,n,r){return xm(t,n)||e.get(t,n,r)},has:function(t,n){return!!xm(t,n)||e.has(t,n)}})}(dm);var km="TLDRAW_DOCUMENT_v2",Sm="TLDRAW_DB_NAME_INDEX_v2",_m={Records:"records",Schema:"schema",SessionState:"session_state"};function Pm(e,t){return Em.apply(this,arguments)}function Em(){return(Em=Ba(Na().mark((function e(t,n){var r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Dm(t),e.next=3,gm(t,3,{upgrade:function(e){e.objectStoreNames.contains(_m.Records)||e.createObjectStore(_m.Records),e.objectStoreNames.contains(_m.Schema)||e.createObjectStore(_m.Schema),e.objectStoreNames.contains(_m.SessionState)||e.createObjectStore(_m.SessionState)}});case 3:return r=e.sent,e.prev=4,e.next=7,n(r);case 7:return e.abrupt("return",e.sent);case 8:return e.prev=8,r.close(),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[4,,8,11]])})))).apply(this,arguments)}function Cm(e){return Im.apply(this,arguments)}function Im(){return Im=Ba(Na().mark((function e(t){var n,r,i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.persistenceKey,r=t.sessionId,i=t.didCancel,o=km+n,zm().includes(o)){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.next=6,Om({persistenceKey:n,didCancel:i});case 6:return e.next=8,Pm(o,function(){var e=Ba(Na().mark((function e(t){var n,o,a,s,u,l,c,d,f;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===i||void 0===i||!i()){e.next=2;break}return e.abrupt("return",void 0);case 2:if(o=t.transaction([_m.Records,_m.Schema,_m.SessionState],"readonly"),a=o.objectStore(_m.Records),s=o.objectStore(_m.Schema),u=o.objectStore(_m.SessionState),!r){e.next=21;break}return e.next=9,u.get(r);case 9:if(e.t2=n=e.sent,e.t1=null===e.t2,e.t1){e.next=13;break}e.t1=void 0===n;case 13:if(!e.t1){e.next=17;break}e.t3=void 0,e.next=18;break;case 17:e.t3=n.snapshot;case 18:e.t0=e.t3,e.next=22;break;case 21:e.t0=null;case 22:if(l=e.t0){e.next=28;break}return e.next=26,u.getAll();case 26:d=e.sent,l=null===(c=d.sort((function(e,t){return e.updatedAt-t.updatedAt})).pop())||void 0===c?void 0:c.snapshot;case 28:return e.next=30,a.getAll();case 30:return e.t4=e.sent,e.next=33,s.get(_m.Schema);case 33:if(e.t5=e.sent,e.t6=l,f={records:e.t4,schema:e.t5,sessionStateSnapshot:e.t6},null===i||void 0===i||!i()){e.next=39;break}return o.abort(),e.abrupt("return",void 0);case 39:return e.next=41,o.done;case 41:return e.abrupt("return",f);case 42:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)}))),Im.apply(this,arguments)}function Tm(e){return Mm.apply(this,arguments)}function Mm(){return Mm=Ba(Na().mark((function e(t){var n,r,i,o,a,s,u;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.persistenceKey,r=t.schema,i=t.changes,o=t.sessionId,a=t.sessionStateSnapshot,s=t.didCancel,u=km+n,e.next=4,Pm(u,function(){var e=Ba(Na().mark((function e(t){var n,u,c,d,f,p,h,v,g,m,y,b,w,x,k,S;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.transaction([_m.Records,_m.Schema,_m.SessionState],"readwrite"),u=n.objectStore(_m.Records),c=n.objectStore(_m.Schema),d=n.objectStore(_m.SessionState),f=0,p=Object.entries(i.added);case 5:if(!(f<p.length)){e.next=12;break}return h=l(p[f],2),v=h[0],g=h[1],e.next=9,u.put(g,v);case 9:f++,e.next=5;break;case 12:m=0,y=Object.values(i.updated);case 13:if(!(m<y.length)){e.next=20;break}return b=l(y[m],2),b[0],w=b[1],e.next=17,u.put(w,w.id);case 17:m++,e.next=13;break;case 20:x=0,k=Object.keys(i.removed);case 21:if(!(x<k.length)){e.next=28;break}return S=k[x],e.next=25,u.delete(S);case 25:x++,e.next=21;break;case 28:if(c.put(r.serialize(),_m.Schema),a&&o?d.put({snapshot:a,updatedAt:Date.now(),id:o},o):(a||o)&&console.error("sessionStateSnapshot and instanceId must be provided together"),null===s||void 0===s||!s()){e.next=32;break}return e.abrupt("return",n.abort());case 32:return e.next=34,n.done;case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)}))),Mm.apply(this,arguments)}function jm(e){return Am.apply(this,arguments)}function Am(){return Am=Ba(Na().mark((function e(t){var n,r,i,o,a,s,u;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.persistenceKey,r=t.schema,i=t.snapshot,o=t.sessionId,a=t.sessionStateSnapshot,s=t.didCancel,u=km+n,e.next=4,Pm(u,function(){var e=Ba(Na().mark((function e(t){var n,u,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.transaction([_m.Records,_m.Schema,_m.SessionState],"readwrite"),u=n.objectStore(_m.Records),c=n.objectStore(_m.Schema),d=n.objectStore(_m.SessionState),e.next=6,u.clear();case 6:f=0,p=Object.entries(i);case 7:if(!(f<p.length)){e.next=14;break}return h=l(p[f],2),v=h[0],g=h[1],e.next=11,u.put(g,v);case 11:f++,e.next=7;break;case 14:if(c.put(r.serialize(),_m.Schema),a&&o?d.put({snapshot:a,updatedAt:Date.now(),id:o},o):(a||o)&&console.error("sessionStateSnapshot and instanceId must be provided together"),null===s||void 0===s||!s()){e.next=18;break}return e.abrupt("return",n.abort());case 18:return e.next=20,n.done;case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)}))),Am.apply(this,arguments)}function Om(e){return Lm.apply(this,arguments)}function Lm(){return Lm=Ba(Na().mark((function e(t){var n,r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.persistenceKey,r=t.didCancel,e.next=3,Pm(km+n,function(){var e=Ba(Na().mark((function e(t){var n,i,o,a,s,u,l;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.transaction([_m.SessionState],"readwrite"),i=n.objectStore(_m.SessionState),e.next=4,i.getAll();case 4:if(o=e.sent.sort((function(e,t){return e.updatedAt-t.updatedAt})),!(o.length<10)){e.next=9;break}return e.next=8,n.done;case 8:return e.abrupt("return");case 9:a=o.slice(0,o.length-10),s=J(a),e.prev=11,s.s();case 13:if((u=s.n()).done){e.next=19;break}return l=u.value.id,e.next=17,i.delete(l);case 17:e.next=13;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),s.e(e.t0);case 24:return e.prev=24,s.f(),e.finish(24);case 27:if(null===r||void 0===r||!r()){e.next=29;break}return e.abrupt("return",n.abort());case 29:return e.next=31,n.done;case 31:case"end":return e.stop()}}),e,null,[[11,21,24,27]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)}))),Lm.apply(this,arguments)}function zm(){var e,t,n=null!==(e=JSON.parse((null===(t=window)||void 0===t?void 0:t.localStorage.getItem(Sm))||"[]"))&&void 0!==e?e:[];return Array.isArray(n)?n:[]}function Dm(e){var t,n=new Set(zm());n.add(e),null===(t=window)||void 0===t||t.localStorage.setItem(Sm,JSON.stringify(d(n)))}var Nm=Symbol("UPDATE_INSTANCE_STATE"),Rm="undefined"===typeof BroadcastChannel?function(){function e(t){j(this,e),D(this,"onmessage",void 0)}return z(e,[{key:"postMessage",value:function(e){}},{key:"close",value:function(){}}]),e}():BroadcastChannel,Bm=function(){function e(t,n){var r=this,i=n.persistenceKey,o=n.sessionId,a=void 0===o?Qg:o,s=n.onLoad,u=n.onLoadError,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Rm("tldraw-tab-sync-".concat(i));j(this,e),D(this,"disposables",new Set),D(this,"diffQueue",[]),D(this,"didDispose",!1),D(this,"shouldDoFullDBWrite",!0),D(this,"isReloading",!1),D(this,"persistenceKey",void 0),D(this,"sessionId",void 0),D(this,"serializedSchema",void 0),D(this,"isDebugging",!1),D(this,"documentTypes",void 0),D(this,"$sessionStateSnapshot",void 0),D(this,"initTime",Date.now()),D(this,"isPersisting",!1),D(this,"didLastWriteError",!1),D(this,"scheduledPersistTimeout",null),this.store=t,this.channel=l,"undefined"!==typeof window&&(window.tlsync=this),this.persistenceKey=i,this.sessionId=a,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=function(e){var t=e.query.ids("page");return ve("sessionStateSnapshot",(function(){var n=e.get(kr);if(!n)return null;var r=d(t.value);return{version:Zg,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map((function(t){var n,r,i,o,a,s=e.get(Lr.createId(t)),u=e.get(kn.createId(t));return{pageId:t,camera:{x:null!==(n=null===u||void 0===u?void 0:u.x)&&void 0!==n?n:0,y:null!==(r=null===u||void 0===u?void 0:u.y)&&void 0!==r?r:0,z:null!==(i=null===u||void 0===u?void 0:u.z)&&void 0!==i?i:1},selectedIds:null!==(o=null===s||void 0===s?void 0:s.selectedIds)&&void 0!==o?o:[],focusLayerId:null!==(a=null===s||void 0===s?void 0:s.focusLayerId)&&void 0!==a?a:null}}))}}))}(this.store),this.disposables.add(t.listen((function(e){var t=e.changes;r.diffQueue.push(t),r.channel.postMessage({type:"diff",storeId:r.store.id,changes:t,schema:r.serializedSchema}),r.schedulePersist()}),{source:"user",scope:"document"})),this.disposables.add(t.listen((function(){r.diffQueue.push(Nm),r.schedulePersist()}),{scope:"session"})),this.connect(s,u),this.documentTypes=new Set(Object.values(this.store.schema.types).filter((function(e){return"document"===e.scope})).map((function(e){return e.typeName})))}return z(e,[{key:"debug",value:function(){var e;this.isDebugging&&(e=console).debug.apply(e,arguments)}},{key:"connect",value:function(){var e=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l=this;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.debug("connecting"),e.prev=1,e.next=4,Cm({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:function(){return l.didDispose}});case 4:r=e.sent,e.next=13;break;case 7:return e.prev=7,e.t0=e.catch(1),n(e.t0),window.alert("Oops! We could not access your browser's storage\u2014and the app won't work correctly without that. We now need to reload the page and try again.\n\nKeep seeing this message?\n\u2022 If you're using tldraw in a private or \"incognito\" window, try loading tldraw in a regular window or in a different browser."),"undefined"!==typeof window&&window.location.reload(),e.abrupt("return");case 13:if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose){e.next=16;break}return e.abrupt("return");case 16:if(e.prev=16,!r){e.next=27;break}if(a=Object.fromEntries(r.records.map((function(e){return[e.id,e]}))),s=null!==(i=r.sessionStateSnapshot)&&void 0!==i?i:nm(a),"error"!==(u=this.store.schema.migrateStoreSnapshot({store:a,schema:null!==(o=r.schema)&&void 0!==o?o:this.store.schema.serializeEarliestVersion()})).type){e.next=25;break}return console.error("failed to migrate store",u),n(new Error("Failed to migrate store: ".concat(u.reason))),e.abrupt("return");case 25:this.store.mergeRemoteChanges((function(){l.store.put(Object.values(u.value).filter((function(e){return l.documentTypes.has(e.typeName)})),"initialize")})),s&&tm(this.store,s);case 27:this.channel.onmessage=function(e){var t,r=e.data;l.debug("got message",r);var i,o,a,s=r,u=St(l.serializedSchema,null!==(t=s.schema)&&void 0!==t?t:l.store.schema.serializeEarliestVersion());return-1===u?Date.now()-l.initTime<5e3?void n(new Error("Schema mismatch, please close other tabs and reload the page")):(l.debug("reloading"),l.isReloading=!0,void(null===(i=window)||void 0===i||null===(o=i.location)||void 0===o||null===(a=o.reload)||void 0===a||a.call(o))):1===u?(l.debug("telling them to reload"),l.channel.postMessage({type:"announce",schema:l.serializedSchema}),l.shouldDoFullDBWrite=!0,void l.persistIfNeeded()):void("diff"===s.type&&(l.debug("applying diff"),ae((function(){l.store.mergeRemoteChanges((function(){l.store.applyDiff(s.changes),l.store.ensureStoreIsUsable()}))}))))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add((function(){l.channel.close()})),t(this),e.next=40;break;case 33:if(e.prev=33,e.t1=e.catch(16),this.debug("error loading data from store",e.t1),!this.didDispose){e.next=38;break}return e.abrupt("return");case 38:return n(e.t1),e.abrupt("return");case 40:case"end":return e.stop()}}),e,this,[[1,7],[16,33]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach((function(e){return e()}))}},{key:"schedulePersist",value:function(){var e=this;this.debug("schedulePersist",this.scheduledPersistTimeout),this.scheduledPersistTimeout||(this.scheduledPersistTimeout=setTimeout((function(){e.scheduledPersistTimeout=null,e.persistIfNeeded()}),this.didLastWriteError?1e4:350))}},{key:"persistIfNeeded",value:function(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),this.isPersisting||this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist()}},{key:"doPersist",value:function(){var e=Ba(Na().mark((function e(){var t,n,r=this;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Le(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start"),t=this.diffQueue,this.diffQueue=[],e.prev=5,!this.shouldDoFullDBWrite){e.next=12;break}return this.shouldDoFullDBWrite=!1,e.next=10,jm({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:function(){return r.didDispose},sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});case 10:e.next=15;break;case 12:return n=ht(t.filter((function(e){return e!==Nm}))),e.next=15,Tm({persistenceKey:this.persistenceKey,changes:n,schema:this.store.schema,didCancel:function(){return r.didDispose},sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});case 15:this.didLastWriteError=!1,e.next=25;break;case 18:e.prev=18,e.t0=e.catch(5),this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",e.t0),window.alert("Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.\n\nKeep seeing this message?\n\u2022 If you're using tldraw in a private or \"incognito\" window, try loading tldraw in a regular window or in a different browser.\n\u2022 If your hard disk is full, try clearing up some space and then reload the page."),"undefined"!==typeof window&&window.location.reload();case 25:this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist();case 28:case"end":return e.stop()}}),e,this,[[5,18]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Fm=["initialData","defaultName"];function Um(e){var t,n=e.initialData,r=e.defaultName,i=void 0===r?"":r,o=gt(e,Fm),a="schema"in o?o.schema:Gi({shapes:(t=av(o.shapes),Object.fromEntries(t.map((function(e){return[e.type,e]}))))});return new pt({schema:a,initialData:n,props:{defaultName:i}})}function Km(e){var n=l((0,t.useState)((function(){return Um(e)})),2),r=n[0],i=n[1],o=function(e){var n=(0,t.useRef)(e);return(0,t.useEffect)((function(){n.current=e})),n.current}(e);if(Object.keys(o).some((function(t){return o[t]!==e[t]}))){var a=Um(e);return i(a),a}return r}var Vm=["persistenceKey","sessionId"];var Wm=function(e,n){var r=l((0,t.useState)(2),2),i=r[0],o=r[1];return(0,t.useEffect)((function(){var t=n.url,r=n.style,i=void 0===r?"normal":r,a=n.weight,s=void 0===a?"500":a,u=n.display,l=n.featureSettings,c=n.stretch,d=n.unicodeRange,f=n.variant,p=!1;o(2);var h={style:i,weight:s,display:u,featureSettings:l,stretch:c,unicodeRange:d,variant:f},v=new FontFace(e,"url(".concat(t,")"),h);return v.load().then((function(){p||(document.fonts.add(v),o(0))})).catch((function(e){p||(console.error(e),o(1))})),v.$$_url=t,v.$$_fontface="\n@font-face {\n\tfont-family: ".concat(v.family,";\n\tfont-stretch: ").concat(v.stretch,";\n\tfont-weight: ").concat(v.weight,";\n\tfont-style: ").concat(v.style,';\n\tsrc: url("').concat(t,'") format("woff2")\n}'),function(){document.fonts.delete(v),p=!0}}),[e,n]),i};var Hm=!1;if("undefined"!==typeof window){var Ym=window.navigator.userAgent,Xm=!!Ym.match(/iPad/i)||!!Ym.match(/iPhone/i),qm=!!Ym.match(/WebKit/i);Hm=Xm&&qm&&!Ym.match(/CriOS/i)}var $m=["store","components"],Gm=["store","user"],Qm=[],Zm=[],Jm=(0,t.memo)((function(e){var n,r,i=e.store,o=e.components,a=gt(e,$m),s=l(t.useState(null),2),u=s[0],c=s[1],d=(0,t.useMemo)((function(){return wf()}),[]),f=void 0===(null===o||void 0===o?void 0:o.ErrorFallback)?Jd:null===o||void 0===o?void 0:o.ErrorFallback,p=Ce(Ce({},a),{},{shapes:null!==(n=a.shapes)&&void 0!==n?n:Qm,tools:null!==(r=a.tools)&&void 0!==r?r:Zm});return(0,La.jsx)("div",{ref:c,draggable:!1,className:"tl-container tl-theme__light",tabIndex:0,children:(0,La.jsx)(el,{fallback:f,onError:function(e){return Re(e,{tags:{origin:"react.tldraw-before-app"}})},children:u&&(0,La.jsx)(bu,{container:u,children:(0,La.jsx)(al,{overrides:o,children:i?i instanceof pt?(0,La.jsx)(ny,Ce(Ce({},p),{},{store:i,user:d})):(0,La.jsx)(ty,Ce(Ce({},p),{},{store:i,user:d})):(0,La.jsx)(ey,Ce(Ce({},p),{},{store:i,user:d}))})})})})}));function ey(e){var n=e.defaultName,r=e.initialData,i=e.shapes,o=e.persistenceKey,a=e.sessionId,s=e.user,u=function(e){var n,r=e.persistenceKey,i=e.sessionId,o=gt(e,Vm),a=l((0,t.useState)(null),2),s=a[0],u=a[1],c=Km(o);return(0,t.useEffect)((function(){var e=ef();if(r){u({id:e,storeWithStatus:{status:"loading"}});var t=function(t){u((function(n){return(null===n||void 0===n?void 0:n.id)===e?{id:e,storeWithStatus:t}:n}))},n=new Bm(c,{sessionId:i,persistenceKey:r,onLoad:function(){t({store:c,status:"synced-local"})},onLoadError:function(e){t({status:"error",error:e})}});return function(){u((function(t){return(null===t||void 0===t?void 0:t.id)===e?null:t})),n.close()}}u({id:e,storeWithStatus:{status:"not-synced",store:c}})}),[r,c,i]),null!==(n=null===s||void 0===s?void 0:s.storeWithStatus)&&void 0!==n?n:{status:"loading"}}({shapes:i,initialData:r,persistenceKey:o,sessionId:a,defaultName:n});return(0,La.jsx)(ty,Ce(Ce({},e),{},{store:u,user:s}))}var ty=(0,t.memo)((function(e){var n=e.store,r=e.user,i=gt(e,Gm),o=wu();switch((0,t.useLayoutEffect)((function(){r.userPreferences.value.isDarkMode&&(o.classList.remove("tl-theme__light"),o.classList.add("tl-theme__dark"))}),[o,r.userPreferences.value.isDarkMode]),n.status){case"error":throw n.error;case"loading":return(0,La.jsx)(oy,{children:"Connecting..."})}return(0,La.jsx)(ny,Ce(Ce({},i),{},{store:n.store,user:r}))}));function ny(e){var n=e.onMount,r=e.children,i=e.store,o=e.tools,a=e.shapes,s=e.autoFocus,u=e.user,c=e.assetUrls,d=sl().ErrorFallback,f=wu(),p=l((0,t.useState)(null),2),h=p[0],v=p[1];(0,t.useLayoutEffect)((function(){var e=new Xg({store:i,shapes:a,tools:o,getContainer:function(){return f},user:u});return window.app=e,window.editor=e,v(e),function(){e.dispose()}}),[f,a,o,i,u]),t.useLayoutEffect((function(){h&&s&&h.focus()}),[h,s]);var g=function(e){var n=(0,t.useRef)();return(0,t.useLayoutEffect)((function(){n.current=e})),(0,t.useDebugValue)(e),(0,t.useCallback)((function(){var e=n.current;return Le(e,"fn does not exist"),e.apply(void 0,arguments)}),[])}((function(e){var t=null===n||void 0===n?void 0:n(e);return e.emit("mount"),window.tldrawReady=!0,t}));t.useLayoutEffect((function(){if(h)return null===g||void 0===g?void 0:g(h)}),[h,g]);var m,y=(0,t.useSyncExternalStore)((0,t.useCallback)((function(e){return h?(h.on("crash",e),function(){return h.off("crash",e)}):function(){}}),[h]),(function(){var e;return null!==(e=null===h||void 0===h?void 0:h.crashingError)&&void 0!==e?e:null})),b=function(e){var n=(0,t.useMemo)((function(){return function(e){return{draw:{url:e.fonts.draw},serif:{url:e.fonts.serif},sansSerif:{url:e.fonts.sansSerif},monospace:{url:e.fonts.monospace}}}(e)}),[e]),r=[Wm("tldraw_draw",n.draw),Wm("tldraw_serif",n.serif),Wm("tldraw_sans",n.sansSerif),Wm("tldraw_mono",n.monospace)];return{error:r.some((function(e){return 1===e})),done:!r.some((function(e){return 2===e}))}}((m=c,(0,t.useMemo)((function(){return m?{fonts:Object.assign(Ce({},Da.fonts),Ce({},null===m||void 0===m?void 0:m.fonts))}:Da}),[m]))),w=b.done;return b.error?(0,La.jsx)(ay,{children:"Could not load assets. Please refresh the page."}):w?h?(0,La.jsx)(el,{fallback:d,onError:function(e){return h.annotateError(e,{origin:"react.tldraw",willCrashApp:!0})},children:y?(0,La.jsx)(iy,{crashingError:y}):(0,La.jsx)(Ua.Provider,{value:h,children:(0,La.jsx)(ry,{children:r})})}):null:(0,La.jsx)(oy,{children:"Loading assets..."})}function ry(e){var n=e.children;return function(){var e=Ka(),n=wu();t.useEffect((function(){var t=function(e){return n.style.setProperty("--tl-zoom",e.toString())},r=De(t,100),i=new ge("useZoomCss",(function(){e.currentPageShapeIds.size<300?t(e.zoomLevel):r(e.zoomLevel)}));return i.attach(),i.execute(),function(){i.detach()}}),[e,n])}(),function(){var e=Ka(),t=wu();Se("useCursor",(function(){var n=e.cursor,r=n.type,i=n.rotation,o=n.color;xd.includes(r)?t.style.setProperty("--tl-cursor","var(--tl-cursor-".concat(r,")")):t.style.setProperty("--tl-cursor",wd(r,i,o))}),[e,t])}(),function(){var e=Ka(),n=wu(),r=_e("isDarkMode",(function(){return e.isDarkMode}),[e]),i=_e(Zs.forceSrgb);t.useEffect((function(){r?(n.setAttribute("data-color-mode","dark"),n.classList.remove("tl-theme__light"),n.classList.add("tl-theme__dark"),e.setCursor({color:"white"})):(n.setAttribute("data-color-mode","light"),n.classList.remove("tl-theme__dark"),n.classList.add("tl-theme__light"),e.setCursor({color:"black"})),i?n.classList.add("tl-theme__force-sRGB"):n.classList.remove("tl-theme__force-sRGB")}),[e,n,i,r])}(),function(){var e=Ka();t.useEffect((function(){if(Hm)return document.addEventListener("focusout",t),function(){return document.removeEventListener("focusout",t)};function t(t){(t.target instanceof HTMLInputElement&&"text"===t.target.type||t.target instanceof HTMLTextAreaElement)&&e.complete()}}),[e])}(),function(){var e=l((0,t.useState)(0),2),n=(e[0],e[1]);(0,t.useEffect)((function(){return n((function(e){return e+1}))}),[])}(),n}function iy(e){throw e.crashingError}function oy(e){var t=e.children,n=sl().Spinner;return(0,La.jsxs)("div",{className:"tl-loading",children:[n?(0,La.jsx)(n,{}):null,t]})}function ay(e){var t=e.children;return(0,La.jsx)("div",{className:"tl-loading",children:t})}var sy=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"info",{}),D(_t(e),"scribble",{}),D(_t(e),"markId",""),D(_t(e),"excludedShapeIds",new Set),D(_t(e),"onEnter",(function(t){e.markId=e.editor.mark("erase scribble begin"),e.info=t;var n=e.editor.inputs.originPagePoint;e.excludedShapeIds=new Set(e.editor.shapesArray.filter((function(t){return e.editor.isShapeOrAncestorLocked(t)||(e.editor.isShapeOfType(t,Up)||e.editor.isShapeOfType(t,Wp))&&e.editor.isPointInShape(n,t)})).map((function(e){return e.id}))),e.startScribble(),e.update()})),D(_t(e),"startScribble",(function(){var t;e.scribble.tick&&e.editor.off("tick",null===(t=e.scribble)||void 0===t?void 0:t.tick);e.scribble=new jg({onUpdate:e.onScribbleUpdate,onComplete:e.onScribbleComplete,color:"muted-1",size:12}),e.editor.on("tick",e.scribble.tick)})),D(_t(e),"pushPointToScribble",(function(){var t=e.editor.inputs.currentPagePoint,n=t.x,r=t.y;e.scribble.addPoint(n,r)})),D(_t(e),"onScribbleUpdate",(function(t){e.editor.setScribble(t)})),D(_t(e),"onScribbleComplete",(function(){e.editor.off("tick",e.scribble.tick),e.editor.setScribble(null)})),D(_t(e),"onExit",(function(){e.scribble.stop()})),D(_t(e),"onPointerMove",(function(){e.update()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),e}return z(n,[{key:"update",value:function(){var e=this.editor,t=e.shapesArray,n=e.erasingIdsSet,r=e.inputs,i=r.currentPagePoint,o=r.previousPagePoint,a=this.excludedShapeIds;this.pushPointToScribble();var s,u=new Set(n),l=J(t);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(!this.editor.isShapeOfType(c,Up)){var f=this.editor.getPageMaskById(c.id);if(!f||gs(i,f)){var p=this.editor.getShapeUtil(c),h=this.editor.getPointInShapeSpace(c,o),v=this.editor.getPointInShapeSpace(c,i);p.hitTestLineSegment(c,h,v)&&u.add(this.editor.getOutermostSelectableShape(c).id)}}}}catch(g){l.e(g)}finally{l.f()}this.editor.setErasingIds(d(u).filter((function(e){return!a.has(e)})))}},{key:"complete",value:function(){this.editor.deleteShapes(this.editor.pageState.erasingIds),this.editor.setErasingIds([]),this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.editor.setErasingIds([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}}]),n}(_f);D(sy,"id","erasing");var uy=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),e}return z(n)}(_f);D(uy,"id","idle");var ly=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){var t,n=e.editor.inputs,r=new Set,i=r.size,o=J(d(e.editor.sortedShapesArray).reverse());try{for(o.s();!(t=o.n()).done;){var a=t.value;if(e.editor.isPointInShape(n.currentPagePoint,a)){if(e.editor.isShapeOfType(a,Up))continue;var s=e.editor.getOutermostSelectableShape(a);if(e.editor.isShapeOfType(s,Wp)&&r.size>i)break;r.add(s.id)}}}catch(u){o.e(u)}finally{o.f()}e.editor.setErasingIds(d(r))})),D(_t(e),"onPointerMove",(function(t){e.editor.inputs.isDragging&&e.parent.transition("erasing",t)})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onInterrupt",(function(){e.cancel()})),e}return z(n,[{key:"complete",value:function(){var e=this.editor.erasingIds;e.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(e)),this.editor.setErasingIds([]),this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.editor.setErasingIds([]),this.parent.transition("idle",{})}}]),n}(_f);D(ly,"id","pointing");var cy=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),e}return z(n)}(_f);D(cy,"id","eraser"),D(cy,"initial","idle"),D(cy,"children",(function(){return[uy,ly,sy]}));var dy=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.update()})),D(_t(e),"onPointerMove",(function(){e.update()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),e}return z(n,[{key:"update",value:function(){var e=this.editor.inputs,t=e.currentScreenPoint,n=e.previousScreenPoint,r=Ya.Sub(t,n);(Math.abs(r.x)>0||Math.abs(r.y)>0)&&this.editor.pan(r.x,r.y)}},{key:"complete",value:function(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:Du}),this.parent.transition("idle",{})}}]),n}(_f);D(dy,"id","dragging");var fy=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.setCursor({type:"grab"})})),D(_t(e),"onPointerDown",(function(t){e.parent.transition("pointing",t)})),D(_t(e),"onCancel",(function(){e.editor.setSelectedTool("select")})),e}return z(n)}(_f);D(fy,"id","idle");var py=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.stopCameraAnimation(),e.editor.setCursor({type:"grabbing"})})),D(_t(e),"onPointerMove",(function(t){e.editor.inputs.isDragging&&e.parent.transition("dragging",t)})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"onCancel",(function(){e.complete()})),D(_t(e),"onComplete",(function(){e.complete()})),D(_t(e),"onInterrupt",(function(){e.complete()})),e}return z(n,[{key:"complete",value:function(){this.parent.transition("idle",{})}}]),n}(_f);D(py,"id","pointing");var hy=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onDoubleClick",(function(t){if("settle"===t.phase){var n=e.editor.inputs.currentScreenPoint;e.editor.zoomIn(n,{duration:220,easing:Ha.easeOutQuint})}})),D(_t(e),"onTripleClick",(function(t){if("settle"===t.phase){var n=e.editor.inputs.currentScreenPoint;e.editor.zoomOut(n,{duration:320,easing:Ha.easeOutQuint})}})),D(_t(e),"onQuadrupleClick",(function(t){if("settle"===t.phase){var n=e.editor,r=n.zoomLevel,i=n.inputs.currentScreenPoint;1===r?e.editor.zoomToFit({duration:400,easing:Ha.easeOutQuint}):e.editor.resetZoom(i,{duration:320,easing:Ha.easeOutQuint})}})),e}return z(n)}(_f);D(hy,"id","hand"),D(hy,"initial","idle"),D(hy,"children",(function(){return[fy,py,dy]}));var vy=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onPointerDown",(function(t){e.parent.transition("lasering",t)})),e}return z(n)}(_f);D(vy,"id","idle");var gy=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"scribble",{}),D(_t(e),"onEnter",(function(){e.startScribble(),e.pushPointToScribble()})),D(_t(e),"onExit",(function(){e.editor.setErasingIds([]),e.scribble.stop()})),D(_t(e),"onPointerMove",(function(){e.pushPointToScribble()})),D(_t(e),"onPointerUp",(function(){e.complete()})),D(_t(e),"startScribble",(function(){var t;e.scribble.tick&&e.editor.off("tick",null===(t=e.scribble)||void 0===t?void 0:t.tick);e.scribble=new jg({onUpdate:e.onScribbleUpdate,onComplete:e.onScribbleComplete,color:"laser",opacity:.7,size:4,delay:1200}),e.editor.on("tick",e.scribble.tick)})),D(_t(e),"pushPointToScribble",(function(){var t=e.editor.inputs.currentPagePoint,n=t.x,r=t.y;e.scribble.addPoint(n,r)})),D(_t(e),"onScribbleUpdate",(function(t){e.editor.setScribble(t)})),D(_t(e),"onScribbleComplete",(function(){e.editor.off("tick",e.scribble.tick),e.editor.setScribble(null)})),D(_t(e),"onCancel",(function(){e.cancel()})),D(_t(e),"onComplete",(function(){e.complete()})),e}return z(n,[{key:"complete",value:function(){this.parent.transition("idle",{})}},{key:"cancel",value:function(){this.parent.transition("idle",{})}}]),n}(_f);D(gy,"id","lasering");var my=function(e){Et(n,e);var t=Tt(n);function n(){var e;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return D(_t(e=t.call.apply(t,[this].concat(i))),"onEnter",(function(){e.editor.setCursor({type:"cross"})})),e}return z(n)}(_f);D(my,"id","laser"),D(my,"initial","idle"),D(my,"children",(function(){return[vy,gy]}));var yy=[hy,cy,my];function by(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?by(Object(n),!0).forEach((function(t){xy(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):by(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ky(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Sy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Py(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _y(e){return function(e){if(Array.isArray(e))return Ey(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Py(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Py(e,t){if(e){if("string"===typeof e)return Ey(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ey(e,t):void 0}}function Ey(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cy(e){var t,n,r=e.sizes.shift(),i=Math.max(Math.ceil(r[0]),1),o=Math.max(Math.ceil(r[1]),1),a=[i-1,o-1,1,1],s=Date.now(),u="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;u?(t=new OffscreenCanvas(1,1),n=new OffscreenCanvas(i,o)):((t=document.createElement("canvas")).width=1,t.height=1,(n=document.createElement("canvas")).width=i,n.height=o);var l=t.getContext("2d"),c=n.getContext("2d");c&&(c.fillRect.apply(c,a),l.drawImage(n,i-1,o-1,1,1,0,0,1,1));var d=l&&0!==l.getImageData(0,0,1,1).data[3],f=Date.now()-s;return[t,n].forEach((function(e){e.height=0,e.width=0})),u?(postMessage({width:i,height:o,benchmark:f,isTestPass:d}),!d&&e.sizes.length&&Cy(e)):d?e.onSuccess(i,o,f):(e.onError(i,o,f),e.sizes.length&&Cy(e)),d}var Iy=[16384,14188,11402,11180,10836,8192,4096,1],Ty=[8388607,65535,32767,16384,8192,4096,1],My=[4194303,65535,32767,16384,8192,4096,1],jy=["onError","onSuccess"],Ay={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Oy={};function Ly(e){var t=e.width===e.height,n=1===e.height,r=1===e.width,i=[];if(e.width&&e.height)for(var o=e.min||Ay.min,a=e.step||Ay.step,s=Math.max(e.width,e.height);s>=o;){var u=t||n?s:1,l=t||r?s:1;i.push([u,l]),s-=a}else e.sizes.forEach((function(e){var o=t||n?e:1,a=t||r?e:1;i.push([o,a])}));return i}function zy(e){var t=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),i=e.onError,o=e.onSuccess,a=ky(e,jy),s=null;if(!t)return!1;if(e.useWorker&&n){var u="\n            var canvasTest = ".concat(Cy.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),l=new Blob([u],{type:"application/javascript"}),c=URL.createObjectURL(l);s=new Worker(c),URL.revokeObjectURL(c),s.onmessage=function(e){var t=e.data,n=t.width,i=t.height,o=t.benchmark;t.isTestPass?(Oy[r].onSuccess(n,i,o),delete Oy[r]):Oy[r].onError(n,i,o)}}return e.usePromise?new Promise((function(t,n){var u=wy(wy({},e),{},{onError:function(t,r,o){var a;if(0===e.sizes.length)a=!0;else{var s=Sy(e.sizes.slice(-1),1),u=Sy(s[0],2),l=u[0],c=u[1];a=t===l&&r===c}i(t,r,o),a&&n({width:t,height:r,benchmark:o})},onSuccess:function(e,n,r){o(e,n,r),t({width:e,height:n,benchmark:r})}});if(s){var l=u.onError,c=u.onSuccess;Oy[r]={onError:l,onSuccess:c},s.postMessage(a)}else Cy(u)})):s?(Oy[r]={onError:i,onSuccess:o},void s.postMessage(a)):Cy(e)}var Dy={maxArea:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Ly({width:e.max,height:e.max,min:e.min,step:e.step,sizes:_y(Iy)});return zy(wy(wy(wy({},Ay),e),{},{sizes:t}))},maxHeight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Ly({width:1,height:e.max,min:e.min,step:e.step,sizes:_y(Ty)});return zy(wy(wy(wy({},Ay),e),{},{sizes:t}))},maxWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Ly({width:e.max,height:1,min:e.min,step:e.step,sizes:_y(My)});return zy(wy(wy(wy({},Ay),e),{},{sizes:t}))},test:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=wy(wy({},Ay),e);return t.sizes=_y(t.sizes),t.width&&t.height&&(t.sizes=[[t.width,t.height]]),zy(t)}},Ny=null;function Ry(){return Ny||(Ny=function(){return By.apply(this,arguments)}()),Ny}function By(){return(By=Ba(Na().mark((function e(){var t,n,r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dy.maxWidth({usePromise:!0});case 2:return t=e.sent,e.next=5,Dy.maxHeight({usePromise:!0});case 5:return n=e.sent,e.next=8,Dy.maxArea({usePromise:!0});case 8:return r=e.sent,e.abrupt("return",{maxWidth:t.width,maxHeight:n.height,maxArea:r.width*r.height});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fy(e){var t=e.cloneNode(!0);return e.setAttribute("width",+e.getAttribute("width")+""),e.setAttribute("height",+e.getAttribute("height")+""),(new XMLSerializer).serializeToString(t).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1")}function Uy(e,t){return Ky.apply(this,arguments)}function Ky(){return Ky=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.type,i=n.quality,o=n.scale,a=+t.getAttribute("width"),s=+t.getAttribute("height"),u=a*o,l=s*o,e.next=7,Vy(t);case 7:return c=e.sent,e.next=10,Ry();case 10:return d=e.sent,a>d.maxWidth&&(u=d.maxWidth,l=u/a*s),s>d.maxHeight&&(l=d.maxHeight,u=l/s*a),u*l>d.maxArea&&(f=Math.sqrt(d.maxArea/(u*l)),u*=f,l*=f),u=Math.floor(u),l=Math.floor(l),p=u/a,e.next=19,new Promise((function(e){var t=new Image;t.crossOrigin="anonymous",t.onload=Ba(Na().mark((function n(){var r,i;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(e){return setTimeout(e,250)}));case 2:r=document.createElement("canvas"),i=r.getContext("2d"),r.width=u,r.height=l,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(t,0,0,u,l),URL.revokeObjectURL(c),e(r);case 11:case"end":return n.stop()}}),n)}))),t.onerror=function(){e(null)},t.src=c}));case 19:if(h=e.sent){e.next=22;break}return e.abrupt("return",null);case 22:return e.next=24,new Promise((function(e){return h.toBlob((function(t){t&&!Zs.throwToBlob.value||e(null),e(t)}),"image/"+r,i)}));case 24:if(v=e.sent){e.next=27;break}return e.abrupt("return",null);case 27:return e.t0=DataView,e.next=30,v.arrayBuffer();case 30:return e.t1=e.sent,g=new e.t0(e.t1),e.abrupt("return",bv(g,p,{type:"image/"+r}));case 33:case"end":return e.stop()}}),e)}))),Ky.apply(this,arguments)}function Vy(e){return Wy.apply(this,arguments)}function Wy(){return Wy=Ba(Na().mark((function e(t){var n,r,i,o,a,s;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.cloneNode(!0)).setAttribute("encoding",'UTF-8"'),r=new FileReader,i=Array.from(n.querySelectorAll("image")),o=Na().mark((function e(){var t,n,i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s[a],!(n=t.getAttribute("xlink:href"))){e.next=13;break}if(n.startsWith("data:")){e.next=13;break}return e.next=6,fetch(n);case 6:return e.next=8,e.sent.blob();case 8:return i=e.sent,e.next=11,new Promise((function(e,t){r.onload=function(){return e(r.result)},r.onerror=function(){return t(r.error)},r.readAsDataURL(i)}));case 11:o=e.sent,t.setAttribute("xlink:href",o);case 13:case"end":return e.stop()}}),e)})),a=0,s=i;case 6:if(!(a<s.length)){e.next=11;break}return e.delegateYield(o(),"t0",8);case 8:a++,e.next=6;break;case 11:return e.abrupt("return",Hy(n));case 12:case"end":return e.stop()}}),e)}))),Wy.apply(this,arguments)}function Hy(e){var t=(new XMLSerializer).serializeToString(e),n=window.btoa(unescape(encodeURIComponent(t)));return"data:image/svg+xml;base64,".concat(n)}function Yy(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}function Xy(){return Xy=Ba(Na().mark((function e(){var t,n,r=arguments;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r.length>0&&void 0!==r[0]?r[0]:{}).shouldReload,n=void 0===t||t,sessionStorage.clear(),e.next=4,Promise.all(zm().map((function(e){return mm(e)})));case 4:localStorage.clear(),n&&window.location.reload();case 6:case"end":return e.stop()}}),e)}))),Xy.apply(this,arguments)}function qy(){return qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qy.apply(this,arguments)}function $y(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).checkForDefaultPrevented,r=void 0===n||n;return function(n){if(null===e||void 0===e||e(n),!1===r||!n.defaultPrevented)return null===t||void 0===t?void 0:t(n)}}function Gy(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.forEach((function(t){return function(e,t){"function"===typeof e?e(t):null!==e&&void 0!==e&&(e.current=t)}(t,e)}))}}function Qy(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0,t.useCallback)(Gy.apply(void 0,n),n)}"undefined"!==typeof window&&(window.__tldraw__hardReset=function(){return Xy.apply(this,arguments)});var Zy=["children"],Jy=["scope","children"];function eb(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];var i=function(){var n=r.map((function(e){return(0,t.createContext)(e)}));return function(r){var i=(null===r||void 0===r?void 0:r[e])||n;return(0,t.useMemo)((function(){return D({},"__scope".concat(e),Ce(Ce({},r),{},D({},e,i)))}),[r,i])}};return i.scopeName=e,[function(n,i){var o=(0,t.createContext)(i),a=r.length;function s(n){var r=n.scope,i=n.children,s=gt(n,Jy),u=(null===r||void 0===r?void 0:r[e][a])||o,l=(0,t.useMemo)((function(){return s}),Object.values(s));return(0,t.createElement)(u.Provider,{value:l},i)}return r=[].concat(d(r),[i]),s.displayName=n+"Provider",[s,function(r,s){var u=(null===s||void 0===s?void 0:s[e][a])||o,l=(0,t.useContext)(u);if(l)return l;if(void 0!==i)return i;throw new Error("`".concat(r,"` must be used within `").concat(n,"`"))}]},tb.apply(void 0,[i].concat(d(n)))]}function tb(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0];if(1===n.length)return i;var o=function(){var e=n.map((function(e){return{useScope:e(),scopeName:e.scopeName}}));return function(n){var r=e.reduce((function(e,t){var r=t.useScope,i=t.scopeName,o=r(n)["__scope".concat(i)];return Ce(Ce({},e),o)}),{});return(0,t.useMemo)((function(){return D({},"__scope".concat(i.scopeName),r)}),[r])}};return o.scopeName=i.scopeName,o}var nb=Boolean(null===globalThis||void 0===globalThis?void 0:globalThis.document)?t.useLayoutEffect:function(){},rb=r["useId".toString()]||function(){},ib=0;function ob(e){var n=l(t.useState(rb()),2),r=n[0],i=n[1];return nb((function(){e||i((function(e){return null!==e&&void 0!==e?e:String(ib++)}))}),[e]),e||(r?"radix-".concat(r):"")}function ab(e){var n=(0,t.useRef)(e);return(0,t.useEffect)((function(){n.current=e})),(0,t.useMemo)((function(){return function(){for(var e,t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return null===(t=n.current)||void 0===t?void 0:(e=t).call.apply(e,[n].concat(i))}}),[])}function sb(e){var n=e.prop,r=e.defaultProp,i=e.onChange,o=void 0===i?function(){}:i,a=function(e){var n=e.defaultProp,r=e.onChange,i=(0,t.useState)(n),o=l(i,1)[0],a=(0,t.useRef)(o),s=ab(r);return(0,t.useEffect)((function(){a.current!==o&&(s(o),a.current=o)}),[o,a,s]),i}({defaultProp:r,onChange:o}),s=l(a,2),u=s[0],c=s[1],d=void 0!==n,f=d?n:u,p=ab(o);return[f,(0,t.useCallback)((function(e){if(d){var t="function"===typeof e?e(n):e;t!==n&&p(t)}else c(e)}),[d,n,c,p])]}var ub=n(1168),lb=["children"],cb=["children"],db=(0,t.forwardRef)((function(e,n){var r=e.children,i=gt(e,lb),o=t.Children.toArray(r),a=o.find(hb);if(a){var s=a.props.children,u=o.map((function(e){return e===a?t.Children.count(s)>1?t.Children.only(null):(0,t.isValidElement)(s)?s.props.children:null:e}));return(0,t.createElement)(fb,qy({},i,{ref:n}),(0,t.isValidElement)(s)?(0,t.cloneElement)(s,void 0,u):null)}return(0,t.createElement)(fb,qy({},i,{ref:n}),r)}));db.displayName="Slot";var fb=(0,t.forwardRef)((function(e,n){var r=e.children,i=gt(e,cb);return(0,t.isValidElement)(r)?(0,t.cloneElement)(r,Ce(Ce({},function(e,t){var n=Ce({},t),r=function(){var r=e[i],o=t[i];/^on[A-Z]/.test(i)?r&&o?n[i]=function(){o.apply(void 0,arguments),r.apply(void 0,arguments)}:r&&(n[i]=r):"style"===i?n[i]=Ce(Ce({},r),o):"className"===i&&(n[i]=[r,o].filter(Boolean).join(" "))};for(var i in t)r();return Ce(Ce({},e),n)}(i,r.props)),{},{ref:n?Gy(n,r.ref):r.ref})):t.Children.count(r)>1?t.Children.only(null):null}));fb.displayName="SlotClone";var pb=function(e){var n=e.children;return(0,t.createElement)(t.Fragment,null,n)};function hb(e){return(0,t.isValidElement)(e)&&e.type===pb}var vb=["asChild"],gb=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((function(e,n){var r=(0,t.forwardRef)((function(e,r){var i=e.asChild,o=gt(e,vb),a=i?db:n;return(0,t.useEffect)((function(){window[Symbol.for("radix-ui")]=!0}),[]),(0,t.createElement)(a,qy({},o,{ref:r}))}));return r.displayName="Primitive.".concat(n),Ce(Ce({},e),{},D({},n,r))}),{});function mb(e,t){e&&(0,ub.flushSync)((function(){return e.dispatchEvent(t)}))}var yb,bb=["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"],wb="dismissableLayer.update",xb="dismissableLayer.pointerDownOutside",kb="dismissableLayer.focusOutside",Sb=(0,t.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),_b=(0,t.forwardRef)((function(e,n){var r,i=e.disableOutsidePointerEvents,o=void 0!==i&&i,a=e.onEscapeKeyDown,s=e.onPointerDownOutside,u=e.onFocusOutside,c=e.onInteractOutside,f=e.onDismiss,p=gt(e,bb),h=(0,t.useContext)(Sb),v=l((0,t.useState)(null),2),g=v[0],m=v[1],y=null!==(r=null===g||void 0===g?void 0:g.ownerDocument)&&void 0!==r?r:null===globalThis||void 0===globalThis?void 0:globalThis.document,b=l((0,t.useState)({}),2)[1],w=Qy(n,(function(e){return m(e)})),x=Array.from(h.layers),k=l(d(h.layersWithOutsidePointerEventsDisabled).slice(-1),1)[0],S=x.indexOf(k),_=g?x.indexOf(g):-1,P=h.layersWithOutsidePointerEventsDisabled.size>0,E=_>=S,C=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=ab(e),i=(0,t.useRef)(!1),o=(0,t.useRef)((function(){}));return(0,t.useEffect)((function(){var e=function(e){if(e.target&&!i.current){var t=function(){Cb(xb,r,a,{discrete:!0})},a={originalEvent:e};"touch"===e.pointerType?(n.removeEventListener("click",o.current),o.current=t,n.addEventListener("click",o.current,{once:!0})):t()}i.current=!1},t=window.setTimeout((function(){n.addEventListener("pointerdown",e)}),0);return function(){window.clearTimeout(t),n.removeEventListener("pointerdown",e),n.removeEventListener("click",o.current)}}),[n,r]),{onPointerDownCapture:function(){return i.current=!0}}}((function(e){var t=e.target,n=d(h.branches).some((function(e){return e.contains(t)}));E&&!n&&(null===s||void 0===s||s(e),null===c||void 0===c||c(e),e.defaultPrevented||null===f||void 0===f||f())}),y),I=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=ab(e),i=(0,t.useRef)(!1);return(0,t.useEffect)((function(){var e=function(e){e.target&&!i.current&&Cb(kb,r,{originalEvent:e},{discrete:!1})};return n.addEventListener("focusin",e),function(){return n.removeEventListener("focusin",e)}}),[n,r]),{onFocusCapture:function(){return i.current=!0},onBlurCapture:function(){return i.current=!1}}}((function(e){var t=e.target;d(h.branches).some((function(e){return e.contains(t)}))||(null===u||void 0===u||u(e),null===c||void 0===c||c(e),e.defaultPrevented||null===f||void 0===f||f())}),y);return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=ab(e);(0,t.useEffect)((function(){var e=function(e){"Escape"===e.key&&r(e)};return n.addEventListener("keydown",e),function(){return n.removeEventListener("keydown",e)}}),[r,n])}((function(e){_===h.layers.size-1&&(null===a||void 0===a||a(e),!e.defaultPrevented&&f&&(e.preventDefault(),f()))}),y),(0,t.useEffect)((function(){if(g)return o&&(0===h.layersWithOutsidePointerEventsDisabled.size&&(yb=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(g)),h.layers.add(g),Eb(),function(){o&&1===h.layersWithOutsidePointerEventsDisabled.size&&(y.body.style.pointerEvents=yb)}}),[g,y,o,h]),(0,t.useEffect)((function(){return function(){g&&(h.layers.delete(g),h.layersWithOutsidePointerEventsDisabled.delete(g),Eb())}}),[g,h]),(0,t.useEffect)((function(){var e=function(){return b({})};return document.addEventListener(wb,e),function(){return document.removeEventListener(wb,e)}}),[]),(0,t.createElement)(gb.div,qy({},p,{ref:w,style:Ce({pointerEvents:P?E?"auto":"none":void 0},e.style),onFocusCapture:$y(e.onFocusCapture,I.onFocusCapture),onBlurCapture:$y(e.onBlurCapture,I.onBlurCapture),onPointerDownCapture:$y(e.onPointerDownCapture,C.onPointerDownCapture)}))})),Pb=(0,t.forwardRef)((function(e,n){var r=(0,t.useContext)(Sb),i=(0,t.useRef)(null),o=Qy(n,i);return(0,t.useEffect)((function(){var e=i.current;if(e)return r.branches.add(e),function(){r.branches.delete(e)}}),[r.branches]),(0,t.createElement)(gb.div,qy({},e,{ref:o}))}));function Eb(){var e=new CustomEvent(wb);document.dispatchEvent(e)}function Cb(e,t,n,r){var i=r.discrete,o=n.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),i?mb(o,a):o.dispatchEvent(a)}var Ib=_b,Tb=Pb,Mb=["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"],jb="focusScope.autoFocusOnMount",Ab="focusScope.autoFocusOnUnmount",Ob={bubbles:!1,cancelable:!0},Lb=(0,t.forwardRef)((function(e,n){var r=e.loop,i=void 0!==r&&r,o=e.trapped,a=void 0!==o&&o,s=e.onMountAutoFocus,u=e.onUnmountAutoFocus,c=gt(e,Mb),d=l((0,t.useState)(null),2),f=d[0],p=d[1],h=ab(s),v=ab(u),g=(0,t.useRef)(null),m=Qy(n,(function(e){return p(e)})),y=(0,t.useRef)({paused:!1,pause:function(){this.paused=!0},resume:function(){this.paused=!1}}).current;(0,t.useEffect)((function(){if(a){var e=function(e){if(!y.paused&&f){var t=e.target;f.contains(t)?g.current=t:Rb(g.current,{select:!0})}},t=function(e){if(!y.paused&&f){var t=e.relatedTarget;null!==t&&(f.contains(t)||Rb(g.current,{select:!0}))}};document.addEventListener("focusin",e),document.addEventListener("focusout",t);var n=new MutationObserver((function(e){var t,n=document.activeElement,r=J(e);try{for(r.s();!(t=r.n()).done;){t.value.removedNodes.length>0&&(null!==f&&void 0!==f&&f.contains(n)||Rb(f))}}catch(i){r.e(i)}finally{r.f()}}));return f&&n.observe(f,{childList:!0,subtree:!0}),function(){document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}}),[a,f,y.paused]),(0,t.useEffect)((function(){if(f){Bb.add(y);var e=document.activeElement;if(!f.contains(e)){var t=new CustomEvent(jb,Ob);f.addEventListener(jb,h),f.dispatchEvent(t),t.defaultPrevented||(!function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.select,i=void 0!==r&&r,o=document.activeElement,a=J(e);try{for(a.s();!(t=a.n()).done;){if(Rb(t.value,{select:i}),document.activeElement!==o)return}}catch(s){a.e(s)}finally{a.f()}}((n=zb(f),n.filter((function(e){return"A"!==e.tagName}))),{select:!0}),document.activeElement===e&&Rb(f))}return function(){f.removeEventListener(jb,h),setTimeout((function(){var t=new CustomEvent(Ab,Ob);f.addEventListener(Ab,v),f.dispatchEvent(t),t.defaultPrevented||Rb(null!==e&&void 0!==e?e:document.body,{select:!0}),f.removeEventListener(Ab,v),Bb.remove(y)}),0)}}var n}),[f,h,v,y]);var b=(0,t.useCallback)((function(e){if((i||a)&&!y.paused){var t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){var r=e.currentTarget,o=function(e){var t=zb(e),n=Db(t,e),r=Db(t.reverse(),e);return[n,r]}(r),s=l(o,2),u=s[0],c=s[1];u&&c?e.shiftKey||n!==c?e.shiftKey&&n===u&&(e.preventDefault(),i&&Rb(c,{select:!0})):(e.preventDefault(),i&&Rb(u,{select:!0})):n===r&&e.preventDefault()}}}),[i,a,y.paused]);return(0,t.createElement)(gb.div,qy({tabIndex:-1},c,{ref:m,onKeyDown:b}))}));function zb(e){for(var t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){var t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});n.nextNode();)t.push(n.currentNode);return t}function Db(e,t){var n,r=J(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!Nb(i,{upTo:t}))return i}}catch(o){r.e(o)}finally{r.f()}}function Nb(e,t){var n=t.upTo;if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==n&&e===n)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function Rb(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).select,n=void 0!==t&&t;if(e&&e.focus){var r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&n&&e.select()}}var Bb=function(){var e=[];return{add:function(t){var n=e[0];t!==n&&(null===n||void 0===n||n.pause()),(e=Fb(e,t)).unshift(t)},remove:function(t){var n;null===(n=(e=Fb(e,t))[0])||void 0===n||n.resume()}}}();function Fb(e,t){var n=d(e),r=n.indexOf(t);return-1!==r&&n.splice(r,1),n}var Ub=["container"],Kb=(0,t.forwardRef)((function(e,n){var r,i=e.container,o=void 0===i?null===globalThis||void 0===globalThis||null===(r=globalThis.document)||void 0===r?void 0:r.body:i,a=gt(e,Ub);return o?ub.createPortal((0,t.createElement)(gb.div,qy({},a,{ref:n})),o):null}));var Vb=function(e){var n=e.present,r=e.children,i=function(e){var n=l((0,t.useState)(),2),r=n[0],i=n[1],o=(0,t.useRef)({}),a=(0,t.useRef)(e),s=(0,t.useRef)("none"),u=e?"mounted":"unmounted",c=function(e,n){return(0,t.useReducer)((function(e,t){var r=n[e][t];return null!==r&&void 0!==r?r:e}),e)}(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),d=l(c,2),f=d[0],p=d[1];return(0,t.useEffect)((function(){var e=Wb(o.current);s.current="mounted"===f?e:"none"}),[f]),nb((function(){var t=o.current,n=a.current;if(n!==e){var r=s.current,i=Wb(t);if(e)p("MOUNT");else if("none"===i||"none"===(null===t||void 0===t?void 0:t.display))p("UNMOUNT");else{p(n&&r!==i?"ANIMATION_OUT":"UNMOUNT")}a.current=e}}),[e,p]),nb((function(){if(r){var e=function(e){var t=Wb(o.current).includes(e.animationName);e.target===r&&t&&(0,ub.flushSync)((function(){return p("ANIMATION_END")}))},t=function(e){e.target===r&&(s.current=Wb(o.current))};return r.addEventListener("animationstart",t),r.addEventListener("animationcancel",e),r.addEventListener("animationend",e),function(){r.removeEventListener("animationstart",t),r.removeEventListener("animationcancel",e),r.removeEventListener("animationend",e)}}p("ANIMATION_END")}),[r,p]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:(0,t.useCallback)((function(e){e&&(o.current=getComputedStyle(e)),i(e)}),[])}}(n),o="function"===typeof r?r({present:i.isPresent}):t.Children.only(r),a=Qy(i.ref,o.ref);return"function"===typeof r||i.isPresent?(0,t.cloneElement)(o,{ref:a}):null};function Wb(e){return(null===e||void 0===e?void 0:e.animationName)||"none"}Vb.displayName="Presence";var Hb=0;function Yb(){(0,t.useEffect)((function(){var e,t,n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:Xb()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:Xb()),Hb++,function(){1===Hb&&document.querySelectorAll("[data-radix-focus-guard]").forEach((function(e){return e.remove()})),Hb--}}),[])}function Xb(){var e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var qb=function(){return qb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},qb.apply(this,arguments)};function $b(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;function Gb(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;var Qb="right-scroll-bar-position",Zb="width-before-scroll-bar";function Jb(e,n){return function(e,n){var r=(0,t.useState)((function(){return{value:e,callback:n,facade:{get current(){return r.value},set current(e){var t=r.value;t!==e&&(r.value=e,r.callback(e,t))}}}}))[0];return r.callback=n,r.facade}(n||null,(function(t){return e.forEach((function(e){return function(e,t){return"function"===typeof e?e(t):e&&(e.current=t),e}(e,t)}))}))}function ew(e){return e}function tw(e,t){void 0===t&&(t=ew);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var i=t(e,r);return n.push(i),function(){n=n.filter((function(e){return e!==i}))}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var i=n;n=[],i.forEach(e),t=n}var o=function(){var n=t;t=[],n.forEach(e)},a=function(){return Promise.resolve().then(o)};a(),n={push:function(e){t.push(e),a()},filter:function(e){return t=t.filter(e),n}}}};return i}var nw=function(e){void 0===e&&(e={});var t=tw(null);return t.options=qb({async:!0,ssr:!1},e),t}(),rw=function(){},iw=t.forwardRef((function(e,n){var r=t.useRef(null),i=t.useState({onScrollCapture:rw,onWheelCapture:rw,onTouchMoveCapture:rw}),o=i[0],a=i[1],s=e.forwardProps,u=e.children,l=e.className,c=e.removeScrollBar,d=e.enabled,f=e.shards,p=e.sideCar,h=e.noIsolation,v=e.inert,g=e.allowPinchZoom,m=e.as,y=void 0===m?"div":m,b=$b(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),w=p,x=Jb([r,n]),k=qb(qb({},b),o);return t.createElement(t.Fragment,null,d&&t.createElement(w,{sideCar:nw,removeScrollBar:c,shards:f,noIsolation:h,inert:v,setCallbacks:a,allowPinchZoom:!!g,lockRef:r}),s?t.cloneElement(t.Children.only(u),qb(qb({},k),{ref:x})):t.createElement(y,qb({},k,{className:l,ref:x}),u))}));iw.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},iw.classNames={fullWidth:Zb,zeroRight:Qb};var ow,aw=function(e){var n=e.sideCar,r=$b(e,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=n.read();if(!i)throw new Error("Sidecar medium not found");return t.createElement(i,qb({},r))};aw.isSideCarExport=!0;function sw(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=ow||n.nc;return t&&e.setAttribute("nonce",t),e}var uw=function(){var e=0,t=null;return{add:function(n){var r,i;0==e&&(t=sw())&&(i=n,(r=t).styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i)),function(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}(t)),e++},remove:function(){!--e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},lw=function(){var e=function(){var e=uw();return function(n,r){t.useEffect((function(){return e.add(n),function(){e.remove()}}),[n&&r])}}();return function(t){var n=t.styles,r=t.dynamic;return e(n,r),null}},cw={left:0,top:0,right:0,gap:0},dw=function(e){return parseInt(e||"",10)||0},fw=function(e){if(void 0===e&&(e="margin"),"undefined"===typeof window)return cw;var t=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],i=t["padding"===e?"paddingRight":"marginRight"];return[dw(n),dw(r),dw(i)]}(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},pw=lw(),hw=function(e,t,n,r){var i=e.left,o=e.top,a=e.right,s=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(s,"px ").concat(r,";\n  }\n  body {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(i,"px;\n    padding-top: ").concat(o,"px;\n    padding-right: ").concat(a,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(s,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(Qb," {\n    right: ").concat(s,"px ").concat(r,";\n  }\n  \n  .").concat(Zb," {\n    margin-right: ").concat(s,"px ").concat(r,";\n  }\n  \n  .").concat(Qb," .").concat(Qb," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(Zb," .").concat(Zb," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(s,"px;\n  }\n")},vw=function(e){var n=e.noRelative,r=e.noImportant,i=e.gapMode,o=void 0===i?"margin":i,a=t.useMemo((function(){return fw(o)}),[o]);return t.createElement(pw,{styles:hw(a,!n,o,r?"":"!important")})},gw=!1;if("undefined"!==typeof window)try{var mw=Object.defineProperty({},"passive",{get:function(){return gw=!0,!0}});window.addEventListener("test",mw,mw),window.removeEventListener("test",mw,mw)}catch(uD){gw=!1}var yw=!!gw&&{passive:!1},bw=function(e,t){var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===n[t])},ww=function(e,t){var n=t;do{if("undefined"!==typeof ShadowRoot&&n instanceof ShadowRoot&&(n=n.host),xw(e,n)){var r=kw(e,n);if(r[1]>r[2])return!0}n=n.parentNode}while(n&&n!==document.body);return!1},xw=function(e,t){return"v"===e?function(e){return bw(e,"overflowY")}(t):function(e){return bw(e,"overflowX")}(t)},kw=function(e,t){return"v"===e?[(n=t).scrollTop,n.scrollHeight,n.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var n},Sw=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},_w=function(e){return[e.deltaX,e.deltaY]},Pw=function(e){return e&&"current"in e?e.current:e},Ew=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},Cw=0,Iw=[];var Tw,Mw=(Tw=function(e){var n=t.useRef([]),r=t.useRef([0,0]),i=t.useRef(),o=t.useState(Cw++)[0],a=t.useState((function(){return lw()}))[0],s=t.useRef(e);t.useEffect((function(){s.current=e}),[e]),t.useEffect((function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var t=Gb([e.lockRef.current],(e.shards||[]).map(Pw),!0).filter(Boolean);return t.forEach((function(e){return e.classList.add("allow-interactivity-".concat(o))})),function(){document.body.classList.remove("block-interactivity-".concat(o)),t.forEach((function(e){return e.classList.remove("allow-interactivity-".concat(o))}))}}}),[e.inert,e.lockRef.current,e.shards]);var u=t.useCallback((function(e,t){if("touches"in e&&2===e.touches.length)return!s.current.allowPinchZoom;var n,o=Sw(e),a=r.current,u="deltaX"in e?e.deltaX:a[0]-o[0],l="deltaY"in e?e.deltaY:a[1]-o[1],c=e.target,d=Math.abs(u)>Math.abs(l)?"h":"v";if("touches"in e&&"h"===d&&"range"===c.type)return!1;var f=ww(d,c);if(!f)return!0;if(f?n=d:(n="v"===d?"h":"v",f=ww(d,c)),!f)return!1;if(!i.current&&"changedTouches"in e&&(u||l)&&(i.current=n),!n)return!0;var p=i.current||n;return function(e,t,n,r,i){var o=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),a=o*r,s=n.target,u=t.contains(s),l=!1,c=a>0,d=0,f=0;do{var p=kw(e,s),h=p[0],v=p[1]-p[2]-o*h;(h||v)&&xw(e,s)&&(d+=v,f+=h),s=s.parentNode}while(!u&&s!==document.body||u&&(t.contains(s)||t===s));return(c&&(i&&0===d||!i&&a>d)||!c&&(i&&0===f||!i&&-a>f))&&(l=!0),l}(p,t,e,"h"===p?u:l,!0)}),[]),l=t.useCallback((function(e){var t=e;if(Iw.length&&Iw[Iw.length-1]===a){var r="deltaY"in t?_w(t):Sw(t),i=n.current.filter((function(e){return e.name===t.type&&e.target===t.target&&function(e,t){return e[0]===t[0]&&e[1]===t[1]}(e.delta,r)}))[0];if(i&&i.should)t.cancelable&&t.preventDefault();else if(!i){var o=(s.current.shards||[]).map(Pw).filter(Boolean).filter((function(e){return e.contains(t.target)}));(o.length>0?u(t,o[0]):!s.current.noIsolation)&&t.cancelable&&t.preventDefault()}}}),[]),c=t.useCallback((function(e,t,r,i){var o={name:e,delta:t,target:r,should:i};n.current.push(o),setTimeout((function(){n.current=n.current.filter((function(e){return e!==o}))}),1)}),[]),d=t.useCallback((function(e){r.current=Sw(e),i.current=void 0}),[]),f=t.useCallback((function(t){c(t.type,_w(t),t.target,u(t,e.lockRef.current))}),[]),p=t.useCallback((function(t){c(t.type,Sw(t),t.target,u(t,e.lockRef.current))}),[]);t.useEffect((function(){return Iw.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",l,yw),document.addEventListener("touchmove",l,yw),document.addEventListener("touchstart",d,yw),function(){Iw=Iw.filter((function(e){return e!==a})),document.removeEventListener("wheel",l,yw),document.removeEventListener("touchmove",l,yw),document.removeEventListener("touchstart",d,yw)}}),[]);var h=e.removeScrollBar,v=e.inert;return t.createElement(t.Fragment,null,v?t.createElement(a,{styles:Ew(o)}):null,h?t.createElement(vw,{gapMode:"margin"}):null)},nw.useMedium(Tw),aw),jw=t.forwardRef((function(e,n){return t.createElement(iw,qb({},e,{ref:n,sideCar:Mw}))}));jw.classNames=iw.classNames;var Aw=jw,Ow=function(e){return"undefined"===typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body},Lw=new WeakMap,zw=new WeakMap,Dw={},Nw=0,Rw=function e(t){return t&&(t.host||e(t.parentNode))},Bw=function(e,t,n,r){var i=function(e,t){return t.map((function(t){if(e.contains(t))return t;var n=Rw(t);return n&&e.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)})).filter((function(e){return Boolean(e)}))}(t,Array.isArray(e)?e:[e]);Dw[n]||(Dw[n]=new WeakMap);var o=Dw[n],a=[],s=new Set,u=new Set(i);i.forEach((function e(t){t&&!s.has(t)&&(s.add(t),e(t.parentNode))}));return function e(t){t&&!u.has(t)&&Array.prototype.forEach.call(t.children,(function(t){if(s.has(t))e(t);else{var i=t.getAttribute(r),u=null!==i&&"false"!==i,l=(Lw.get(t)||0)+1,c=(o.get(t)||0)+1;Lw.set(t,l),o.set(t,c),a.push(t),1===l&&u&&zw.set(t,!0),1===c&&t.setAttribute(n,"true"),u||t.setAttribute(r,"true")}}))}(t),s.clear(),Nw++,function(){a.forEach((function(e){var t=Lw.get(e)-1,i=o.get(e)-1;Lw.set(e,t),o.set(e,i),t||(zw.has(e)||e.removeAttribute(r),zw.delete(e)),i||e.removeAttribute(n)})),--Nw||(Lw=new WeakMap,Lw=new WeakMap,zw=new WeakMap,Dw={})}},Fw=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),i=t||Ow(e);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),Bw(r,i,n,"aria-hidden")):function(){return null}},Uw=["forceMount"],Kw=["__scopeDialog"],Vw=["forceMount"],Ww=["__scopeDialog","trapFocus","onOpenAutoFocus","onCloseAutoFocus"],Hw=["__scopeDialog"],Yw=["__scopeDialog"],Xw="Dialog",qw=l(eb(Xw),2),$w=qw[0],Gw=(qw[1],l($w(Xw),2)),Qw=Gw[0],Zw=Gw[1],Jw=function(e){var n=e.__scopeDialog,r=e.children,i=e.open,o=e.defaultOpen,a=e.onOpenChange,s=e.modal,u=void 0===s||s,c=(0,t.useRef)(null),d=(0,t.useRef)(null),f=l(sb({prop:i,defaultProp:o,onChange:a}),2),p=f[0],h=void 0!==p&&p,v=f[1];return(0,t.createElement)(Qw,{scope:n,triggerRef:c,contentRef:d,contentId:ob(),titleId:ob(),descriptionId:ob(),open:h,onOpenChange:v,onOpenToggle:(0,t.useCallback)((function(){return v((function(e){return!e}))}),[v]),modal:u},r)},ex="DialogPortal",tx=l($w(ex,{forceMount:void 0}),2),nx=tx[0],rx=tx[1],ix=function(e){var n=e.__scopeDialog,r=e.forceMount,i=e.children,o=e.container,a=Zw(ex,n);return(0,t.createElement)(nx,{scope:n,forceMount:r},t.Children.map(i,(function(e){return(0,t.createElement)(Vb,{present:r||a.open},(0,t.createElement)(Kb,{asChild:!0,container:o},e))})))},ox="DialogOverlay",ax=(0,t.forwardRef)((function(e,n){var r=rx(ox,e.__scopeDialog),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,Uw),s=Zw(ox,e.__scopeDialog);return s.modal?(0,t.createElement)(Vb,{present:o||s.open},(0,t.createElement)(sx,qy({},a,{ref:n}))):null})),sx=(0,t.forwardRef)((function(e,n){var r=e.__scopeDialog,i=gt(e,Kw),o=Zw(ox,r);return(0,t.createElement)(Aw,{as:db,allowPinchZoom:!0,shards:[o.contentRef]},(0,t.createElement)(gb.div,qy({"data-state":mx(o.open)},i,{ref:n,style:Ce({pointerEvents:"auto"},i.style)})))})),ux="DialogContent",lx=(0,t.forwardRef)((function(e,n){var r=rx(ux,e.__scopeDialog),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,Vw),s=Zw(ux,e.__scopeDialog);return(0,t.createElement)(Vb,{present:o||s.open},s.modal?(0,t.createElement)(cx,qy({},a,{ref:n})):(0,t.createElement)(dx,qy({},a,{ref:n})))})),cx=(0,t.forwardRef)((function(e,n){var r=Zw(ux,e.__scopeDialog),i=(0,t.useRef)(null),o=Qy(n,r.contentRef,i);return(0,t.useEffect)((function(){var e=i.current;if(e)return Fw(e)}),[]),(0,t.createElement)(fx,qy({},e,{ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:$y(e.onCloseAutoFocus,(function(e){var t;e.preventDefault(),null===(t=r.triggerRef.current)||void 0===t||t.focus()})),onPointerDownOutside:$y(e.onPointerDownOutside,(function(e){var t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()})),onFocusOutside:$y(e.onFocusOutside,(function(e){return e.preventDefault()}))}))})),dx=(0,t.forwardRef)((function(e,n){var r=Zw(ux,e.__scopeDialog),i=(0,t.useRef)(!1),o=(0,t.useRef)(!1);return(0,t.createElement)(fx,qy({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:function(t){var n,a;(null===(n=e.onCloseAutoFocus)||void 0===n||n.call(e,t),t.defaultPrevented)||(i.current||null===(a=r.triggerRef.current)||void 0===a||a.focus(),t.preventDefault());i.current=!1,o.current=!1},onInteractOutside:function(t){var n,a;null===(n=e.onInteractOutside)||void 0===n||n.call(e,t),t.defaultPrevented||(i.current=!0,"pointerdown"===t.detail.originalEvent.type&&(o.current=!0));var s=t.target;(null===(a=r.triggerRef.current)||void 0===a?void 0:a.contains(s))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&o.current&&t.preventDefault()}}))})),fx=(0,t.forwardRef)((function(e,n){var r=e.__scopeDialog,i=e.trapFocus,o=e.onOpenAutoFocus,a=e.onCloseAutoFocus,s=gt(e,Ww),u=Zw(ux,r),l=Qy(n,(0,t.useRef)(null));return Yb(),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(Lb,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:o,onUnmountAutoFocus:a},(0,t.createElement)(_b,qy({role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":mx(u.open)},s,{ref:l,onDismiss:function(){return u.onOpenChange(!1)}}))),!1)})),px="DialogTitle",hx=(0,t.forwardRef)((function(e,n){var r=e.__scopeDialog,i=gt(e,Hw),o=Zw(px,r);return(0,t.createElement)(gb.h2,qy({id:o.titleId},i,{ref:n}))})),vx="DialogClose",gx=(0,t.forwardRef)((function(e,n){var r=e.__scopeDialog,i=gt(e,Yw),o=Zw(vx,r);return(0,t.createElement)(gb.button,qy({type:"button"},i,{ref:n,onClick:$y(e.onClick,(function(){return o.onOpenChange(!1)}))}))}));function mx(e){return e?"open":"closed"}var yx="DialogTitleWarning",bx=l(function(e,n){var r=(0,t.createContext)(n);function i(e){var n=e.children,i=gt(e,Zy),o=(0,t.useMemo)((function(){return i}),Object.values(i));return(0,t.createElement)(r.Provider,{value:o},n)}return i.displayName=e+"Provider",[i,function(i){var o=(0,t.useContext)(r);if(o)return o;if(void 0!==n)return n;throw new Error("`".concat(i,"` must be used within `").concat(e,"`"))}]}(yx,{contentName:ux,titleName:px,docsSlug:"dialog"}),2),wx=(bx[0],bx[1],Jw),xx=ix,kx=ax,Sx=lx,_x=(0,t.createContext)(null);function Px(e){var t=e.assetUrls,n=e.children;return(0,La.jsx)(_x.Provider,{value:t,children:n})}function Ex(){var e=(0,t.useContext)(_x);if(!e)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return e}var Cx={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrowheads","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},Ix={locale:"en",label:"English",messages:Cx};function Tx(e,t){return Mx.apply(this,arguments)}function Mx(){return Mx=Ba(Na().mark((function e(t,n){var r,i,o,a,s;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n.translations.en);case 2:if(e.sent.ok){e.next=6;break}return console.warn("No main translations found."),e.abrupt("return",Ix);case 6:if("en"!==t){e.next=8;break}return e.abrupt("return",Ix);case 8:if(r=Ma.find((function(e){return e.locale===t})),r){e.next=12;break}return console.warn("No translation found for locale ".concat(t)),e.abrupt("return",Ix);case 12:return e.next=14,fetch(n.translations[r.locale]);case 14:return i=e.sent,e.next=17,i.json();case 17:if(o=e.sent){e.next=21;break}return console.warn("No messages found for locale ".concat(t)),e.abrupt("return",Ix);case 21:for(s in a=[],Ix)o[s]||a.push(s);return a.length,e.abrupt("return",{locale:t,label:r.label,messages:Ce(Ce({},Ix.messages),o)});case 25:case"end":return e.stop()}}),e)}))),Mx.apply(this,arguments)}var jx=t.createContext({}),Ax=function(){return t.useContext(jx)},Ox=ke((function(e){var n=e.overrides,r=e.children,i=Ka().locale,o=Ex(),a=l(t.useState((function(){return n&&n.en?{locale:"en",label:"English",messages:Ce(Ce({},Cx),n.en)}:{locale:"en",label:"English",messages:Cx}})),2),s=a[0],u=a[1];return t.useEffect((function(){var e=!1;function t(){return(t=Ba(Na().mark((function t(){var r;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Tx(i,o);case 2:(r=t.sent)&&!e&&(n&&n[i]?u(Ce(Ce({},r),{},{messages:Ce(Ce({},r.messages),n[i])})):u(r));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){e=!0}}),[o,i,n]),(0,La.jsx)(jx.Provider,{value:s,children:r})}));function Lx(){var e=Ax();return t.useCallback((function(t){var n;return null!==(n=e.messages[t])&&void 0!==n?n:t}),[e])}function zx(e){return(0,La.jsx)("svg",Ce(Ce({width:16,height:16,viewBox:"0 0 16 16"},e),{},{children:(0,La.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,La.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),(0,La.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:(0,La.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}))}var Dx=["small","invertIcon","icon","color","className"],Nx=(0,t.memo)((function(e){var n=e.small,r=e.invertIcon,i=e.icon,o=e.color,a=e.className,s=gt(e,Dx),u=Ex().icons[i],l=(0,t.useRef)(null);return(0,t.useLayoutEffect)((function(){null!==l&&void 0!==l&&l.current&&(l.current.style.webkitMask="url(".concat(u,") center 100% / 100% no-repeat"))}),[l,u]),(0,La.jsx)("div",Ce(Ce({},s),{},{ref:l,className:Fa("tlui-icon",{"tlui-icon__small":n},a),style:{color:o,mask:"url(".concat(u,") center 100% / 100% no-repeat"),transform:r?"scale(-1, 1)":void 0}}))}));var Rx="undefined"!==typeof window&&window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,Bx=Rx?"\u2318":"Ctrl",Fx=Rx?"\u2325":"Alt";function Ux(e){return"\u2014 "+e.split(",")[0].split("").map((function(e){var t=e.replace(/\$/g,Bx).replace(/\?/g,Fx).replace(/!/g,"\u21e7");return t[0].toUpperCase()+t.slice(1)})).join("\u2009")}function Kx(e){var t,n=e.children;return(0,La.jsx)("kbd",{className:"tlui-kbd",children:(t=n,t.split(",")[0].split("").map((function(e){var t=e.replace(/\$/g,Bx).replace(/\?/g,Fx).replace(/!/g,"\u21e7");return t[0].toUpperCase()+t.slice(1)}))).map((function(e,t){return(0,La.jsx)("span",{children:e},t)}))})}var Vx=["label","icon","invertIcon","iconLeft","smallIcon","kbd","isChecked","type","children","spinner"],Wx=t.forwardRef((function(e,t){var n,r=e.label,i=e.icon,o=e.invertIcon,a=e.iconLeft,s=e.smallIcon,u=e.kbd,l=e.isChecked,c=void 0!==l&&l,d=e.type,f=void 0===d?"normal":d,p=e.children,h=e.spinner,v=gt(e,Vx),g=Lx(),m=r?g(r):"";return(0,La.jsxs)("button",Ce(Ce({ref:t,draggable:!1,type:"button"},v),{},{title:null!==(n=v.title)&&void 0!==n?n:m,className:Fa("tlui-button","tlui-button__".concat(f),v.className),children:[a&&(0,La.jsx)(Nx,{icon:a,className:"tlui-icon-left",small:!0}),p,r&&(0,La.jsxs)("span",{draggable:!1,children:[m,c&&(0,La.jsx)(Nx,{icon:"check"})]}),u&&(0,La.jsx)(Kx,{children:u}),i&&!h&&(0,La.jsx)(Nx,{icon:i,small:!!r||s,invertIcon:o}),h&&(0,La.jsx)(zx,{})]}))}));function Hx(e){var t=e.className,n=e.children;return(0,La.jsx)("div",{className:Fa("tlui-dialog__header",t),children:n})}function Yx(e){var t=e.className,n=e.children;return(0,La.jsx)(hx,{dir:"ltr",className:Fa("tlui-dialog__header__title",t),children:n})}function Xx(){return(0,La.jsx)("div",{className:"tlui-dialog__header__close",children:(0,La.jsx)(gx,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:(0,La.jsx)(Wx,{"aria-label":"Close",onTouchEnd:function(e){return e.target.click()},children:(0,La.jsx)(Nx,{small:!0,icon:"cross-2"})})})})}function qx(e){var t=e.className,n=e.children,r=e.style;return(0,La.jsx)("div",{className:Fa("tlui-dialog__body",t),style:r,children:n})}function $x(e){var t=e.className,n=e.children;return(0,La.jsx)("div",{className:Fa("tlui-dialog__footer",t),children:n})}var Gx=["scope","children"];function Qx(e){var n=e+"CollectionProvider",r=l(eb(n),2),i=r[0],o=r[1],a=l(i(n,{collectionRef:{current:null},itemMap:new Map}),2),s=a[0],u=a[1],c=function(e){var n=e.scope,r=e.children,i=t.useRef(null),o=t.useRef(new Map).current;return t.createElement(s,{scope:n,itemMap:o,collectionRef:i},r)},d=e+"CollectionSlot",f=t.forwardRef((function(e,n){var r=e.scope,i=e.children,o=Qy(n,u(d,r).collectionRef);return t.createElement(db,{ref:o},i)})),p=e+"CollectionItemSlot",h="data-radix-collection-item",v=t.forwardRef((function(e,n){var r,i=e.scope,o=e.children,a=gt(e,Gx),s=t.useRef(null),l=Qy(n,s),c=u(p,i);return t.useEffect((function(){return c.itemMap.set(s,Ce({ref:s},a)),function(){c.itemMap.delete(s)}})),t.createElement(db,(D(r={},h,""),D(r,"ref",l),r),o)}));return[{Provider:c,Slot:f,ItemSlot:v},function(n){var r=u(e+"CollectionConsumer",n),i=t.useCallback((function(){var e=r.collectionRef.current;if(!e)return[];var t=Array.from(e.querySelectorAll("[".concat(h,"]"))),n=Array.from(r.itemMap.values()).sort((function(e,n){return t.indexOf(e.ref.current)-t.indexOf(n.ref.current)}));return n}),[r.collectionRef,r.itemMap]);return i},o]}var Zx=(0,t.createContext)(void 0);function Jx(e){var n=(0,t.useContext)(Zx);return e||n||"ltr"}var ek=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],tk=["strategy"],nk=["mainAxis","crossAxis","limiter"],rk=["apply"];function ik(e){return e.split("-")[1]}function ok(e){return"y"===e?"height":"width"}function ak(e){return e.split("-")[0]}function sk(e){return["top","bottom"].includes(ak(e))?"x":"y"}function uk(e,t,n){var r,i=e.reference,o=e.floating,a=i.x+i.width/2-o.width/2,s=i.y+i.height/2-o.height/2,u=sk(t),l=ok(u),c=i[l]/2-o[l]/2,d="x"===u;switch(ak(t)){case"top":r={x:a,y:i.y-o.height};break;case"bottom":r={x:a,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:s};break;case"left":r={x:i.x-o.width,y:s};break;default:r={x:i.x,y:i.y}}switch(ik(t)){case"start":r[u]-=c*(n&&d?-1:1);break;case"end":r[u]+=c*(n&&d?-1:1)}return r}var lk=function(){var e=Ba(Na().mark((function e(t,n,r){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.placement,o=void 0===i?"bottom":i,a=r.strategy,s=void 0===a?"absolute":a,u=r.middleware,l=void 0===u?[]:u,c=r.platform,d=l.filter(Boolean),e.next=10,null==c.isRTL?void 0:c.isRTL(n);case 10:return f=e.sent,e.next=13,c.getElementRects({reference:t,floating:n,strategy:s});case 13:p=e.sent,h=uk(p,o,f),v=h.x,g=h.y,m=o,y={},b=0,w=0;case 21:if(!(w<d.length)){e.next=56;break}return k=d[w],S=k.name,_=k.fn,e.next=27,_({x:v,y:g,initialPlacement:o,placement:m,strategy:s,middlewareData:y,rects:p,platform:c,elements:{reference:t,floating:n}});case 27:if(P=e.sent,E=P.x,C=P.y,I=P.data,T=P.reset,v=null!=E?E:v,g=null!=C?C:g,y=Ce(Ce({},y),{},D({},S,Ce(Ce({},y[S]),I))),e.t0=T&&b<=50,!e.t0){e.next=53;break}if(b++,e.t1="object"==typeof T,!e.t1){e.next=52;break}if(T.placement&&(m=T.placement),e.t2=T.rects,!e.t2){e.next=51;break}if(!0!==T.rects){e.next=49;break}return e.next=46,c.getElementRects({reference:t,floating:n,strategy:s});case 46:e.t3=e.sent,e.next=50;break;case 49:e.t3=T.rects;case 50:p=e.t3;case 51:x=uk(p,m,f),v=x.x,g=x.y;case 52:w=-1;case 53:w++,e.next=21;break;case 56:return e.abrupt("return",{x:v,y:g,placement:m,strategy:s,middlewareData:y});case 57:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function ck(e,t){return"function"==typeof e?e(t):e}function dk(e){return"number"!=typeof e?function(e){return Ce({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function fk(e){return Ce(Ce({},e),{},{top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height})}function pk(e,t){return hk.apply(this,arguments)}function hk(){return hk=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),i=t.x,o=t.y,a=t.platform,s=t.rects,u=t.elements,l=t.strategy,c=ck(n,t),d=c.boundary,f=void 0===d?"clippingAncestors":d,p=c.rootBoundary,h=void 0===p?"viewport":p,v=c.elementContext,g=void 0===v?"floating":v,m=c.altBoundary,y=void 0!==m&&m,b=c.padding,w=dk(void 0===b?0:b),x=u[y?"floating"===g?"reference":"floating":g],e.t0=fk,e.t1=a,e.next=24,null==a.isElement?void 0:a.isElement(x);case 24:if(e.t3=r=e.sent,e.t2=null==e.t3,e.t2){e.next=28;break}e.t2=r;case 28:if(!e.t2){e.next=32;break}e.t4=x,e.next=38;break;case 32:if(e.t5=x.contextElement,e.t5){e.next=37;break}return e.next=36,null==a.getDocumentElement?void 0:a.getDocumentElement(u.floating);case 36:e.t5=e.sent;case 37:e.t4=e.t5;case 38:return e.t6=e.t4,e.t7=f,e.t8=h,e.t9=l,e.t10={element:e.t6,boundary:e.t7,rootBoundary:e.t8,strategy:e.t9},e.next=45,e.t1.getClippingRect.call(e.t1,e.t10);case 45:return e.t11=e.sent,k=(0,e.t0)(e.t11),S="floating"===g?Ce(Ce({},s.floating),{},{x:i,y:o}):s.reference,e.next=50,null==a.getOffsetParent?void 0:a.getOffsetParent(u.floating);case 50:return _=e.sent,e.next=53,null==a.isElement?void 0:a.isElement(_);case 53:if(e.t13=e.sent,!e.t13){e.next=58;break}return e.next=57,null==a.getScale?void 0:a.getScale(_);case 57:e.t13=e.sent;case 58:if(e.t12=e.t13,e.t12){e.next=61;break}e.t12={x:1,y:1};case 61:if(P=e.t12,e.t14=fk,!a.convertOffsetParentRelativeRectToViewportRelativeRect){e.next=69;break}return e.next=66,a.convertOffsetParentRelativeRectToViewportRelativeRect({rect:S,offsetParent:_,strategy:l});case 66:e.t15=e.sent,e.next=70;break;case 69:e.t15=S;case 70:return e.t16=e.t15,E=(0,e.t14)(e.t16),e.abrupt("return",{top:(k.top-E.top+w.top)/P.y,bottom:(E.bottom-k.bottom+w.bottom)/P.y,left:(k.left-E.left+w.left)/P.x,right:(E.right-k.right+w.right)/P.x});case 73:case"end":return e.stop()}}),e)}))),hk.apply(this,arguments)}var vk=Math.min,gk=Math.max;function mk(e,t,n){return gk(e,vk(t,n))}var yk=function(e){return{name:"arrow",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j,A,O,L,z,N;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.x,a=t.y,s=t.placement,u=t.rects,l=t.platform,c=t.elements,d=ck(e,t)||{},f=d.element,p=d.padding,h=void 0===p?0:p,null!=f){n.next=3;break}return n.abrupt("return",{});case 3:return v=dk(h),g={x:o,y:a},m=sk(s),y=ok(m),n.next=9,l.getDimensions(f);case 9:return b=n.sent,x=(w="y"===m)?"top":"left",k=w?"bottom":"right",S=w?"clientHeight":"clientWidth",_=u.reference[y]+u.reference[m]-g[m]-u.floating[y],P=g[m]-u.reference[m],n.next=18,null==l.getOffsetParent?void 0:l.getOffsetParent(f);case 18:if(E=n.sent,C=E?E[S]:0,n.t0=C,!n.t0){n.next=25;break}return n.next=24,null==l.isElement?void 0:l.isElement(E);case 24:n.t0=n.sent;case 25:if(n.t1=n.t0,n.t1){n.next=28;break}C=c.floating[S]||u.floating[y];case 28:return I=_/2-P/2,T=C/2-b[y]/2-1,M=vk(v[x],T),j=vk(v[k],T),A=M,O=C-b[y]-j,L=C/2-b[y]/2+I,z=mk(A,L,O),N=null!=ik(s)&&L!=z&&u.reference[y]/2-(L<A?M:j)-b[y]/2<0,n.abrupt("return",(D(i={},m,g[m]-(N?L<A?A-L:O-L:0)),D(i,"data",(D(r={},m,z),D(r,"centerOffset",L-z),r)),i));case 30:case"end":return n.stop()}}),n)})))()}}},bk=["top","right","bottom","left"],wk=(bk.reduce((function(e,t){return e.concat(t,t+"-start",t+"-end")}),[]),{left:"right",right:"left",bottom:"top",top:"bottom"});function xk(e){return e.replace(/left|right|bottom|top/g,(function(e){return wk[e]}))}function kk(e,t,n){void 0===n&&(n=!1);var r=ik(e),i=sk(e),o=ok(i),a="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=xk(a)),{main:a,cross:xk(a)}}var Sk={start:"end",end:"start"};function _k(e){return e.replace(/start|end/g,(function(e){return Sk[e]}))}var Pk=function(e){return void 0===e&&(e={}),{name:"flip",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l,c,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j,A,O,L,z,D,N,R,B,F,U;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.placement,o=t.middlewareData,a=t.rects,s=t.initialPlacement,u=t.platform,l=t.elements,c=ck(e,t),f=c.mainAxis,p=void 0===f||f,h=c.crossAxis,v=void 0===h||h,g=c.fallbackPlacements,m=c.fallbackStrategy,y=void 0===m?"bestFit":m,b=c.fallbackAxisSideDirection,w=void 0===b?"none":b,x=c.flipAlignment,k=void 0===x||x,S=gt(c,ek),_=ak(i),P=ak(s)===s,n.next=23,null==u.isRTL?void 0:u.isRTL(l.floating);case 23:return E=n.sent,C=g||(P||!k?[xk(s)]:function(e){var t=xk(e);return[_k(e),t,_k(t)]}(s)),g||"none"===w||C.push.apply(C,d(function(e,t,n,r){var i=ik(e),o=function(e,t,n){var r=["left","right"],i=["right","left"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?["top","bottom"]:["bottom","top"];default:return[]}}(ak(e),"start"===n,r);return i&&(o=o.map((function(e){return e+"-"+i})),t&&(o=o.concat(o.map(_k)))),o}(s,k,w,E))),I=[s].concat(d(C)),n.next=29,pk(t,S);case 29:if(T=n.sent,M=[],j=(null==(r=o.flip)?void 0:r.overflows)||[],p&&M.push(T[_]),v&&(A=kk(i,a,E),O=A.main,L=A.cross,M.push(T[O],T[L])),j=[].concat(d(j),[{placement:i,overflows:M}]),M.every((function(e){return e<=0}))){n.next=48;break}if(N=((null==(z=o.flip)?void 0:z.index)||0)+1,!(R=I[N])){n.next=37;break}return n.abrupt("return",{data:{index:N,overflows:j},reset:{placement:R}});case 37:if(B=null==(D=j.filter((function(e){return e.overflows[0]<=0})).sort((function(e,t){return e.overflows[1]-t.overflows[1]}))[0])?void 0:D.placement,B){n.next=46;break}n.t0=y,n.next="bestFit"===n.t0?42:"initialPlacement"===n.t0?45:46;break;case 42:return U=null==(F=j.map((function(e){return[e.placement,e.overflows.filter((function(e){return e>0})).reduce((function(e,t){return e+t}),0)]})).sort((function(e,t){return e[1]-t[1]}))[0])?void 0:F[0],U&&(B=U),n.abrupt("break",46);case 45:B=s;case 46:if(i===B){n.next=48;break}return n.abrupt("return",{reset:{placement:B}});case 48:return n.abrupt("return",{});case 49:case"end":return n.stop()}}),n)})))()}}};function Ek(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Ck(e){return bk.some((function(t){return e[t]>=0}))}var Ik=function(e){return void 0===e&&(e={}),{name:"hide",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.rects,i=ck(e,t),o=i.strategy,a=void 0===o?"referenceHidden":o,s=gt(i,tk),n.t0=a,n.next="referenceHidden"===n.t0?4:"escaped"===n.t0?11:18;break;case 4:return n.t1=Ek,n.next=7,pk(t,Ce(Ce({},s),{},{elementContext:"reference"}));case 7:return n.t2=n.sent,n.t3=r.reference,u=(0,n.t1)(n.t2,n.t3),n.abrupt("return",{data:{referenceHiddenOffsets:u,referenceHidden:Ck(u)}});case 11:return n.t4=Ek,n.next=14,pk(t,Ce(Ce({},s),{},{altBoundary:!0}));case 14:return n.t5=n.sent,n.t6=r.floating,l=(0,n.t4)(n.t5,n.t6),n.abrupt("return",{data:{escapedOffsets:l,escaped:Ck(l)}});case 18:return n.abrupt("return",{});case 19:case"end":return n.stop()}}),n)})))()}}};var Tk=function(e){return void 0===e&&(e=0),{name:"offset",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.x,i=t.y,n.next=4,function(){var e=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.placement,i=t.platform,o=t.elements,e.next=5,null==i.isRTL?void 0:i.isRTL(o.floating);case 5:return a=e.sent,s=ak(r),u=ik(r),l="x"===sk(r),c=["left","top"].includes(s)?-1:1,d=a&&l?-1:1,f=ck(n,t),p="number"==typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:Ce({mainAxis:0,crossAxis:0,alignmentAxis:null},f),h=p.mainAxis,v=p.crossAxis,g=p.alignmentAxis,e.abrupt("return",(u&&"number"==typeof g&&(v="end"===u?-1*g:g),l?{x:v*d,y:h*c}:{x:h*c,y:v*d}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,e);case 4:return o=n.sent,n.abrupt("return",{x:r+o.x,y:i+o.y,data:o});case 6:case"end":return n.stop()}}),n)})))()}}};function Mk(e){return"x"===e?"y":"x"}var jk=function(e){return void 0===e&&(e={}),{name:"shift",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.x,o=t.y,a=t.placement,s=ck(e,t),u=s.mainAxis,l=void 0===u||u,c=s.crossAxis,d=void 0!==c&&c,f=s.limiter,p=void 0===f?{fn:function(e){return{x:e.x,y:e.y}}}:f,h=gt(s,nk),v={x:i,y:o},n.next=14,pk(t,h);case 14:return g=n.sent,m=sk(ak(a)),y=Mk(m),b=v[m],w=v[y],l&&(x="y"===m?"bottom":"right",b=mk(b+g["y"===m?"top":"left"],b,b-g[x])),d&&(k="y"===y?"bottom":"right",w=mk(w+g["y"===y?"top":"left"],w,w-g[k])),S=p.fn(Ce(Ce({},t),{},(D(r={},m,b),D(r,y,w),r))),n.abrupt("return",Ce(Ce({},S),{},{data:{x:S.x-i,y:S.y-o}}));case 22:case"end":return n.stop()}}),n)})))()}}},Ak=function(e){return void 0===e&&(e={}),{options:e,fn:function(t){var n,r=t.x,i=t.y,o=t.placement,a=t.rects,s=t.middlewareData,u=ck(e,t),l=u.offset,c=void 0===l?0:l,d=u.mainAxis,f=void 0===d||d,p=u.crossAxis,h=void 0===p||p,v={x:r,y:i},g=sk(o),m=Mk(g),y=v[g],b=v[m],w=ck(c,t),x="number"==typeof w?{mainAxis:w,crossAxis:0}:Ce({mainAxis:0,crossAxis:0},w);if(f){var k="y"===g?"height":"width",S=a.reference[g]-a.floating[k]+x.mainAxis,_=a.reference[g]+a.reference[k]-x.mainAxis;y<S?y=S:y>_&&(y=_)}if(h){var P,E,C="y"===g?"width":"height",I=["top","left"].includes(ak(o)),T=a.reference[m]-a.floating[C]+(I&&(null==(P=s.offset)?void 0:P[m])||0)+(I?0:x.crossAxis),M=a.reference[m]+a.reference[C]+(I?0:(null==(E=s.offset)?void 0:E[m])||0)-(I?x.crossAxis:0);b<T?b=T:b>M&&(b=M)}return D(n={},g,y),D(n,m,b),n}}},Ok=function(e){return void 0===e&&(e={}),{name:"size",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.placement,i=t.rects,o=t.platform,a=t.elements,s=ck(e,t),u=s.apply,l=void 0===u?function(){}:u,c=gt(s,rk),n.next=10,pk(t,c);case 10:if(d=n.sent,f=ak(r),p=ik(r),h="x"===sk(r),v=i.floating,g=v.width,m=v.height,"top"!==f&&"bottom"!==f){n.next=36;break}return y=f,n.t0=p,n.next=22,null==o.isRTL?void 0:o.isRTL(a.floating);case 22:if(!n.sent){n.next=26;break}n.t1="start",n.next=27;break;case 26:n.t1="end";case 27:if(n.t2=n.t1,n.t0!==n.t2){n.next=32;break}n.t3="left",n.next=33;break;case 32:n.t3="right";case 33:b=n.t3,n.next=37;break;case 36:b=f,y="end"===p?"top":"bottom";case 37:return w=m-d[y],x=g-d[b],k=!t.middlewareData.shift,S=w,_=x,h?(P=g-d.left-d.right,_=p||k?vk(x,P):P):(E=m-d.top-d.bottom,S=p||k?vk(w,E):E),k&&!p&&(C=gk(d.left,0),I=gk(d.right,0),T=gk(d.top,0),M=gk(d.bottom,0),h?_=g-2*(0!==C||0!==I?C+I:gk(d.left,d.right)):S=m-2*(0!==T||0!==M?T+M:gk(d.top,d.bottom))),n.next=43,l(Ce(Ce({},t),{},{availableWidth:_,availableHeight:S}));case 43:return n.next=45,o.getDimensions(a.floating);case 45:return j=n.sent,n.abrupt("return",g!==j.width||m!==j.height?{reset:{rects:!0}}:{});case 47:case"end":return n.stop()}}),n)})))()}}};function Lk(e){var t;return(null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function zk(e){return Lk(e).getComputedStyle(e)}function Dk(e){return e instanceof Lk(e).Node}function Nk(e){return Dk(e)?(e.nodeName||"").toLowerCase():""}function Rk(e){return e instanceof Lk(e).HTMLElement}function Bk(e){return e instanceof Lk(e).Element}function Fk(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Lk(e).ShadowRoot||e instanceof ShadowRoot)}function Uk(e){var t=zk(e),n=t.overflow,r=t.overflowX,i=t.overflowY,o=t.display;return/auto|scroll|overlay|hidden|clip/.test(n+i+r)&&!["inline","contents"].includes(o)}function Kk(e){return["table","td","th"].includes(Nk(e))}function Vk(e){var t=Wk(),n=zk(e);return"none"!==n.transform||"none"!==n.perspective||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((function(e){return(n.willChange||"").includes(e)}))||["paint","layout","strict","content"].some((function(e){return(n.contain||"").includes(e)}))}function Wk(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Hk(e){return["html","body","#document"].includes(Nk(e))}var Yk=Math.min,Xk=Math.max,qk=Math.round;function $k(e){var t=zk(e),n=parseFloat(t.width)||0,r=parseFloat(t.height)||0,i=Rk(e),o=i?e.offsetWidth:n,a=i?e.offsetHeight:r,s=qk(n)!==o||qk(r)!==a;return s&&(n=o,r=a),{width:n,height:r,fallback:s}}function Gk(e){return Bk(e)?e:e.contextElement}var Qk={x:1,y:1};function Zk(e){var t=Gk(e);if(!Rk(t))return Qk;var n=t.getBoundingClientRect(),r=$k(t),i=r.width,o=r.height,a=r.fallback,s=(a?qk(n.width):n.width)/i,u=(a?qk(n.height):n.height)/o;return s&&Number.isFinite(s)||(s=1),u&&Number.isFinite(u)||(u=1),{x:s,y:u}}var Jk={x:0,y:0};function eS(e,t,n){var r,i;if(void 0===t&&(t=!0),!Wk())return Jk;var o=e?Lk(e):window;return!n||t&&n!==o?Jk:{x:(null==(r=o.visualViewport)?void 0:r.offsetLeft)||0,y:(null==(i=o.visualViewport)?void 0:i.offsetTop)||0}}function tS(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=e.getBoundingClientRect(),o=Gk(e),a=Qk;t&&(r?Bk(r)&&(a=Zk(r)):a=Zk(e));var s=eS(o,n,r),u=(i.left+s.x)/a.x,l=(i.top+s.y)/a.y,c=i.width/a.x,d=i.height/a.y;if(o)for(var f=Lk(o),p=r&&Bk(r)?Lk(r):r,h=f.frameElement;h&&r&&p!==f;){var v=Zk(h),g=h.getBoundingClientRect(),m=getComputedStyle(h);g.x+=(h.clientLeft+parseFloat(m.paddingLeft))*v.x,g.y+=(h.clientTop+parseFloat(m.paddingTop))*v.y,u*=v.x,l*=v.y,c*=v.x,d*=v.y,u+=g.x,l+=g.y,h=Lk(h).frameElement}return fk({width:c,height:d,x:u,y:l})}function nS(e){return((Dk(e)?e.ownerDocument:e.document)||window.document).documentElement}function rS(e){return Bk(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function iS(e){return tS(nS(e)).left+rS(e).scrollLeft}function oS(e){if("html"===Nk(e))return e;var t=e.assignedSlot||e.parentNode||Fk(e)&&e.host||nS(e);return Fk(t)?t.host:t}function aS(e){var t=oS(e);return Hk(t)?t.ownerDocument.body:Rk(t)&&Uk(t)?t:aS(t)}function sS(e,t){var n;void 0===t&&(t=[]);var r=aS(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=Lk(r);return i?t.concat(o,o.visualViewport||[],Uk(r)?r:[]):t.concat(r,sS(r))}function uS(e,t,n){var r;if("viewport"===t)r=function(e,t){var n=Lk(e),r=nS(e),i=n.visualViewport,o=r.clientWidth,a=r.clientHeight,s=0,u=0;if(i){o=i.width,a=i.height;var l=Wk();(!l||l&&"fixed"===t)&&(s=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:s,y:u}}(e,n);else if("document"===t)r=function(e){var t=nS(e),n=rS(e),r=e.ownerDocument.body,i=Xk(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Xk(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight),a=-n.scrollLeft+iS(e),s=-n.scrollTop;return"rtl"===zk(r).direction&&(a+=Xk(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:s}}(nS(e));else if(Bk(t))r=function(e,t){var n=tS(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=Rk(e)?Zk(e):{x:1,y:1};return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:i*o.x,y:r*o.y}}(t,n);else{var i=eS(e);r=Ce(Ce({},t),{},{x:t.x-i.x,y:t.y-i.y})}return fk(r)}function lS(e,t){var n=oS(e);return!(n===t||!Bk(n)||Hk(n))&&("fixed"===zk(n).position||lS(n,t))}function cS(e,t){return Rk(e)&&"fixed"!==zk(e).position?t?t(e):e.offsetParent:null}function dS(e,t){var n=Lk(e);if(!Rk(e))return n;for(var r=cS(e,t);r&&Kk(r)&&"static"===zk(r).position;)r=cS(r,t);return r&&("html"===Nk(r)||"body"===Nk(r)&&"static"===zk(r).position&&!Vk(r))?n:r||function(e){for(var t=oS(e);Rk(t)&&!Hk(t);){if(Vk(t))return t;t=oS(t)}return null}(e)||n}function fS(e,t,n){var r=Rk(t),i=nS(t),o="fixed"===n,a=tS(e,!0,o,t),s={scrollLeft:0,scrollTop:0},u={x:0,y:0};if(r||!r&&!o)if(("body"!==Nk(t)||Uk(i))&&(s=rS(t)),Rk(t)){var l=tS(t,!0,o,t);u.x=l.x+t.clientLeft,u.y=l.y+t.clientTop}else i&&(u.x=iS(i));return{x:a.left+s.scrollLeft-u.x,y:a.top+s.scrollTop-u.y,width:a.width,height:a.height}}var pS={getClippingRect:function(e){var t=e.element,n=e.boundary,r=e.rootBoundary,i=e.strategy,o="clippingAncestors"===n?function(e,t){var n=t.get(e);if(n)return n;for(var r=sS(e).filter((function(e){return Bk(e)&&"body"!==Nk(e)})),i=null,o="fixed"===zk(e).position,a=o?oS(e):e;Bk(a)&&!Hk(a);){var s=zk(a),u=Vk(a);u||"fixed"!==s.position||(i=null),(o?!u&&!i:!u&&"static"===s.position&&i&&["absolute","fixed"].includes(i.position)||Uk(a)&&!u&&lS(e,a))?r=r.filter((function(e){return e!==a})):i=s,a=oS(a)}return t.set(e,r),r}(t,this._c):[].concat(n),a=[].concat(d(o),[r]),s=a[0],u=a.reduce((function(e,n){var r=uS(t,n,i);return e.top=Xk(r.top,e.top),e.right=Yk(r.right,e.right),e.bottom=Yk(r.bottom,e.bottom),e.left=Xk(r.left,e.left),e}),uS(t,s,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){var t=e.rect,n=e.offsetParent,r=e.strategy,i=Rk(n),o=nS(n);if(n===o)return t;var a={scrollLeft:0,scrollTop:0},s={x:1,y:1},u={x:0,y:0};if((i||!i&&"fixed"!==r)&&(("body"!==Nk(n)||Uk(o))&&(a=rS(n)),Rk(n))){var l=tS(n);s=Zk(n),u.x=l.x+n.clientLeft,u.y=l.y+n.clientTop}return{width:t.width*s.x,height:t.height*s.y,x:t.x*s.x-a.scrollLeft*s.x+u.x,y:t.y*s.y-a.scrollTop*s.y+u.y}},isElement:Bk,getDimensions:function(e){return $k(e)},getOffsetParent:dS,getDocumentElement:nS,getScale:Zk,getElementRects:function(e){var t=this;return Ba(Na().mark((function n(){var r,i,o,a,s;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.reference,i=e.floating,o=e.strategy,a=t.getOffsetParent||dS,s=t.getDimensions,n.t0=fS,n.t1=r,n.next=6,a(i);case 6:return n.t2=n.sent,n.t3=o,n.t4=(0,n.t0)(n.t1,n.t2,n.t3),n.t5=Ce,n.t6={x:0,y:0},n.next=13,s(i);case 13:return n.t7=n.sent,n.t8=(0,n.t5)(n.t6,n.t7),n.abrupt("return",{reference:n.t4,floating:n.t8});case 16:case"end":return n.stop()}}),n)})))()},getClientRects:function(e){return Array.from(e.getClientRects())},isRTL:function(e){return"rtl"===zk(e).direction}};function hS(e,t,n,r){void 0===r&&(r={});var i=r,o=i.ancestorScroll,a=void 0===o||o,s=i.ancestorResize,u=void 0===s||s,l=i.elementResize,c=void 0===l||l,f=i.animationFrame,p=void 0!==f&&f,h=a||u?[].concat(d(Bk(e)?sS(e):e.contextElement?sS(e.contextElement):[]),d(sS(t))):[];h.forEach((function(e){var t=!Bk(e)&&e.toString().includes("V");!a||p&&!t||e.addEventListener("scroll",n,{passive:!0}),u&&e.addEventListener("resize",n)}));var v,g=null;c&&(g=new ResizeObserver((function(){n()})),Bk(e)&&!p&&g.observe(e),Bk(e)||!e.contextElement||p||g.observe(e.contextElement),g.observe(t));var m=p?tS(e):null;return p&&function t(){var r=tS(e);!m||r.x===m.x&&r.y===m.y&&r.width===m.width&&r.height===m.height||n(),m=r,v=requestAnimationFrame(t)}(),n(),function(){var e;h.forEach((function(e){a&&e.removeEventListener("scroll",n),u&&e.removeEventListener("resize",n)})),null==(e=g)||e.disconnect(),g=null,p&&cancelAnimationFrame(v)}}var vS=function(e){return{name:"arrow",options:e,fn:function(t){var n,r="function"===typeof e?e(t):e,i=r.element,o=r.padding;return i&&(n=i,{}.hasOwnProperty.call(n,"current"))?null!=i.current?yk({element:i.current,padding:o}).fn(t):{}:i?yk({element:i,padding:o}).fn(t):{}}}},gS="undefined"!==typeof document?t.useLayoutEffect:t.useEffect;function mS(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;var n,r,i;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((n=e.length)!=t.length)return!1;for(r=n;0!==r--;)if(!mS(e[r],t[r]))return!1;return!0}if((n=(i=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=n;0!==r--;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;0!==r--;){var o=i[r];if(("_owner"!==o||!e.$$typeof)&&!mS(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function yS(e){return"undefined"===typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function bS(e,t){var n=yS(e);return Math.round(t*n)/n}function wS(e){var n=t.useRef(e);return gS((function(){n.current=e})),n}function xS(e){void 0===e&&(e={});var n=e,r=n.placement,i=void 0===r?"bottom":r,o=n.strategy,a=void 0===o?"absolute":o,s=n.middleware,u=void 0===s?[]:s,c=n.platform,d=n.elements,f=void 0===d?{}:d,p=f.reference,h=f.floating,v=n.transform,g=void 0===v||v,m=n.whileElementsMounted,y=n.open,b=l(t.useState({x:0,y:0,strategy:a,placement:i,middlewareData:{},isPositioned:!1}),2),w=b[0],x=b[1],k=l(t.useState(u),2),S=k[0],_=k[1];mS(S,u)||_(u);var P=l(t.useState(null),2),E=P[0],C=P[1],I=l(t.useState(null),2),T=I[0],M=I[1],j=t.useCallback((function(e){e!=z.current&&(z.current=e,C(e))}),[C]),A=t.useCallback((function(e){e!==D.current&&(D.current=e,M(e))}),[M]),O=p||E,L=h||T,z=t.useRef(null),D=t.useRef(null),N=t.useRef(w),R=wS(m),B=wS(c),F=t.useCallback((function(){if(z.current&&D.current){var e={placement:i,strategy:a,middleware:S};B.current&&(e.platform=B.current),function(e,t,n){var r=new Map,i=Ce({platform:pS},n),o=Ce(Ce({},i.platform),{},{_c:r});return lk(e,t,Ce(Ce({},i),{},{platform:o}))}(z.current,D.current,e).then((function(e){var t=Ce(Ce({},e),{},{isPositioned:!0});U.current&&!mS(N.current,t)&&(N.current=t,ub.flushSync((function(){x(t)})))}))}}),[S,i,a,B]);gS((function(){!1===y&&N.current.isPositioned&&(N.current.isPositioned=!1,x((function(e){return Ce(Ce({},e),{},{isPositioned:!1})})))}),[y]);var U=t.useRef(!1);gS((function(){return U.current=!0,function(){U.current=!1}}),[]),gS((function(){if(O&&(z.current=O),L&&(D.current=L),O&&L){if(R.current)return R.current(O,L,F);F()}}),[O,L,F,R]);var K=t.useMemo((function(){return{reference:z,floating:D,setReference:j,setFloating:A}}),[j,A]),V=t.useMemo((function(){return{reference:O,floating:L}}),[O,L]),W=t.useMemo((function(){var e={position:a,left:0,top:0};if(!V.floating)return e;var t=bS(V.floating,w.x),n=bS(V.floating,w.y);return g?Ce(Ce({},e),{},{transform:"translate("+t+"px, "+n+"px)"},yS(V.floating)>=1.5&&{willChange:"transform"}):{position:a,left:t,top:n}}),[a,g,V.floating,w.x,w.y]);return t.useMemo((function(){return Ce(Ce({},w),{},{update:F,refs:K,elements:V,floatingStyles:W})}),[w,F,K,V,W])}function kS(e){var n=l((0,t.useState)(void 0),2),r=n[0],i=n[1];return nb((function(){if(e){i({width:e.offsetWidth,height:e.offsetHeight});var t=new ResizeObserver((function(t){if(Array.isArray(t)&&t.length){var n,r,o=t[0];if("borderBoxSize"in o){var a=o.borderBoxSize,s=Array.isArray(a)?a[0]:a;n=s.inlineSize,r=s.blockSize}else n=e.offsetWidth,r=e.offsetHeight;i({width:n,height:r})}}));return t.observe(e,{box:"border-box"}),function(){return t.unobserve(e)}}i(void 0)}),[e]),r}var SS=["__scopePopper","virtualRef"],_S=["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","collisionBoundary","collisionPadding","sticky","hideWhenDetached","avoidCollisions","onPlaced"],PS="Popper",ES=l(eb(PS),2),CS=ES[0],IS=ES[1],TS=l(CS(PS),2),MS=TS[0],jS=TS[1],AS=function(e){var n=e.__scopePopper,r=e.children,i=l((0,t.useState)(null),2),o=i[0],a=i[1];return(0,t.createElement)(MS,{scope:n,anchor:o,onAnchorChange:a},r)},OS="PopperAnchor",LS=(0,t.forwardRef)((function(e,n){var r=e.__scopePopper,i=e.virtualRef,o=gt(e,SS),a=jS(OS,r),s=(0,t.useRef)(null),u=Qy(n,s);return(0,t.useEffect)((function(){a.onAnchorChange((null===i||void 0===i?void 0:i.current)||s.current)})),i?null:(0,t.createElement)(gb.div,qy({},o,{ref:u}))})),zS="PopperContent",DS=l(CS(zS),2),NS=DS[0],RS=(DS[1],(0,t.forwardRef)((function(e,n){var r,i,o,a,s,u,c,d,f=e.__scopePopper,p=e.side,h=void 0===p?"bottom":p,v=e.sideOffset,g=void 0===v?0:v,m=e.align,y=void 0===m?"center":m,b=e.alignOffset,w=void 0===b?0:b,x=e.arrowPadding,k=void 0===x?0:x,S=e.collisionBoundary,_=void 0===S?[]:S,P=e.collisionPadding,E=void 0===P?0:P,C=e.sticky,I=void 0===C?"partial":C,T=e.hideWhenDetached,M=void 0!==T&&T,j=e.avoidCollisions,A=void 0===j||j,O=e.onPlaced,L=gt(e,_S),z=jS(zS,f),N=l((0,t.useState)(null),2),R=N[0],B=N[1],F=Qy(n,(function(e){return B(e)})),U=l((0,t.useState)(null),2),K=U[0],V=U[1],W=kS(K),H=null!==(r=null===W||void 0===W?void 0:W.width)&&void 0!==r?r:0,Y=null!==(i=null===W||void 0===W?void 0:W.height)&&void 0!==i?i:0,X=h+("center"!==y?"-"+y:""),q="number"===typeof E?E:Ce({top:0,right:0,bottom:0,left:0},E),$=Array.isArray(_)?_:[_],G=$.length>0,Q={padding:q,boundary:$.filter(BS),altBoundary:G},Z=xS({strategy:"fixed",placement:X,whileElementsMounted:hS,elements:{reference:z.anchor},middleware:[Tk({mainAxis:g+Y,alignmentAxis:w}),A&&jk(Ce({mainAxis:!0,crossAxis:!1,limiter:"partial"===I?Ak():void 0},Q)),A&&Pk(Ce({},Q)),Ok(Ce(Ce({},Q),{},{apply:function(e){var t=e.elements,n=e.rects,r=e.availableWidth,i=e.availableHeight,o=n.reference,a=o.width,s=o.height,u=t.floating.style;u.setProperty("--radix-popper-available-width","".concat(r,"px")),u.setProperty("--radix-popper-available-height","".concat(i,"px")),u.setProperty("--radix-popper-anchor-width","".concat(a,"px")),u.setProperty("--radix-popper-anchor-height","".concat(s,"px"))}})),K&&vS({element:K,padding:k}),FS({arrowWidth:H,arrowHeight:Y}),M&&Ik({strategy:"referenceHidden"})]}),J=Z.refs,ee=Z.floatingStyles,te=Z.placement,ne=Z.isPositioned,re=Z.middlewareData,ie=l(US(te),2),oe=ie[0],ae=ie[1],se=ab(O);nb((function(){ne&&(null===se||void 0===se||se())}),[ne,se]);var ue=null===(o=re.arrow)||void 0===o?void 0:o.x,le=null===(a=re.arrow)||void 0===a?void 0:a.y,ce=0!==(null===(s=re.arrow)||void 0===s?void 0:s.centerOffset),de=l((0,t.useState)(),2),fe=de[0],pe=de[1];return nb((function(){R&&pe(window.getComputedStyle(R).zIndex)}),[R]),(0,t.createElement)("div",{ref:J.setFloating,"data-radix-popper-content-wrapper":"",style:Ce(Ce({},ee),{},D({transform:ne?ee.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:fe},"--radix-popper-transform-origin",[null===(u=re.transformOrigin)||void 0===u?void 0:u.x,null===(c=re.transformOrigin)||void 0===c?void 0:c.y].join(" "))),dir:e.dir},(0,t.createElement)(NS,{scope:f,placedSide:oe,onArrowChange:V,arrowX:ue,arrowY:le,shouldHideArrow:ce},(0,t.createElement)(gb.div,qy({"data-side":oe,"data-align":ae},L,{ref:F,style:Ce(Ce({},L.style),{},{animation:ne?void 0:"none",opacity:null!==(d=re.hide)&&void 0!==d&&d.referenceHidden?0:void 0})}))))})));function BS(e){return null!==e}var FS=function(e){return{name:"transformOrigin",options:e,fn:function(t){var n,r,i,o,a,s=t.placement,u=t.rects,c=t.middlewareData,d=0!==(null===(n=c.arrow)||void 0===n?void 0:n.centerOffset),f=d?0:e.arrowWidth,p=d?0:e.arrowHeight,h=l(US(s),2),v=h[0],g={start:"0%",center:"50%",end:"100%"}[h[1]],m=(null!==(r=null===(i=c.arrow)||void 0===i?void 0:i.x)&&void 0!==r?r:0)+f/2,y=(null!==(o=null===(a=c.arrow)||void 0===a?void 0:a.y)&&void 0!==o?o:0)+p/2,b="",w="";return"bottom"===v?(b=d?g:"".concat(m,"px"),w="".concat(-p,"px")):"top"===v?(b=d?g:"".concat(m,"px"),w="".concat(u.floating.height+p,"px")):"right"===v?(b="".concat(-p,"px"),w=d?g:"".concat(y,"px")):"left"===v&&(b="".concat(u.floating.width+p,"px"),w=d?g:"".concat(y,"px")),{data:{x:b,y:w}}}}};function US(e){var t=l(e.split("-"),2),n=t[0],r=t[1];return[n,void 0===r?"center":r]}var KS=AS,VS=LS,WS=RS,HS=["__scopeRovingFocusGroup","orientation","loop","dir","currentTabStopId","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus"],YS=["__scopeRovingFocusGroup","focusable","active","tabStopId"],XS="rovingFocusGroup.onEntryFocus",qS={bubbles:!1,cancelable:!0},$S="RovingFocusGroup",GS=l(Qx($S),3),QS=GS[0],ZS=GS[1],JS=l(eb($S,[GS[2]]),2),e_=JS[0],t_=JS[1],n_=l(e_($S),2),r_=n_[0],i_=n_[1],o_=(0,t.forwardRef)((function(e,n){return(0,t.createElement)(QS.Provider,{scope:e.__scopeRovingFocusGroup},(0,t.createElement)(QS.Slot,{scope:e.__scopeRovingFocusGroup},(0,t.createElement)(a_,qy({},e,{ref:n}))))})),a_=(0,t.forwardRef)((function(e,n){var r=e.__scopeRovingFocusGroup,i=e.orientation,o=e.loop,a=void 0!==o&&o,s=e.dir,u=e.currentTabStopId,c=e.defaultCurrentTabStopId,f=e.onCurrentTabStopIdChange,p=e.onEntryFocus,h=gt(e,HS),v=(0,t.useRef)(null),g=Qy(n,v),m=Jx(s),y=l(sb({prop:u,defaultProp:c,onChange:f}),2),b=y[0],w=void 0===b?null:b,x=y[1],k=l((0,t.useState)(!1),2),S=k[0],_=k[1],P=ab(p),E=ZS(r),C=(0,t.useRef)(!1),I=l((0,t.useState)(0),2),T=I[0],M=I[1];return(0,t.useEffect)((function(){var e=v.current;if(e)return e.addEventListener(XS,P),function(){return e.removeEventListener(XS,P)}}),[P]),(0,t.createElement)(r_,{scope:r,orientation:i,dir:m,loop:a,currentTabStopId:w,onItemFocus:(0,t.useCallback)((function(e){return x(e)}),[x]),onItemShiftTab:(0,t.useCallback)((function(){return _(!0)}),[]),onFocusableItemAdd:(0,t.useCallback)((function(){return M((function(e){return e+1}))}),[]),onFocusableItemRemove:(0,t.useCallback)((function(){return M((function(e){return e-1}))}),[])},(0,t.createElement)(gb.div,qy({tabIndex:S||0===T?-1:0,"data-orientation":i},h,{ref:g,style:Ce({outline:"none"},e.style),onMouseDown:$y(e.onMouseDown,(function(){C.current=!0})),onFocus:$y(e.onFocus,(function(e){var t=!C.current;if(e.target===e.currentTarget&&t&&!S){var n=new CustomEvent(XS,qS);if(e.currentTarget.dispatchEvent(n),!n.defaultPrevented){var r=E().filter((function(e){return e.focusable}));c_([r.find((function(e){return e.active})),r.find((function(e){return e.id===w}))].concat(d(r)).filter(Boolean).map((function(e){return e.ref.current})))}}C.current=!1})),onBlur:$y(e.onBlur,(function(){return _(!1)}))})))})),s_="RovingFocusGroupItem",u_=(0,t.forwardRef)((function(e,n){var r=e.__scopeRovingFocusGroup,i=e.focusable,o=void 0===i||i,a=e.active,s=void 0!==a&&a,u=e.tabStopId,l=gt(e,YS),c=ob(),d=u||c,f=i_(s_,r),p=f.currentTabStopId===d,h=ZS(r),v=f.onFocusableItemAdd,g=f.onFocusableItemRemove;return(0,t.useEffect)((function(){if(o)return v(),function(){return g()}}),[o,v,g]),(0,t.createElement)(QS.ItemSlot,{scope:r,id:d,focusable:o,active:s},(0,t.createElement)(gb.span,qy({tabIndex:p?0:-1,"data-orientation":f.orientation},l,{ref:n,onMouseDown:$y(e.onMouseDown,(function(e){o?f.onItemFocus(d):e.preventDefault()})),onFocus:$y(e.onFocus,(function(){return f.onItemFocus(d)})),onKeyDown:$y(e.onKeyDown,(function(e){if("Tab"===e.key&&e.shiftKey)f.onItemShiftTab();else if(e.target===e.currentTarget){var t=function(e,t,n){var r=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,n);return"vertical"===t&&["ArrowLeft","ArrowRight"].includes(r)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(r)?void 0:l_[r]}(e,f.orientation,f.dir);if(void 0!==t){e.preventDefault();var n=h().filter((function(e){return e.focusable})).map((function(e){return e.ref.current}));if("last"===t)n.reverse();else if("prev"===t||"next"===t){"prev"===t&&n.reverse();var r=n.indexOf(e.currentTarget);n=f.loop?function(e,t){return e.map((function(n,r){return e[(t+r)%e.length]}))}(n,r+1):n.slice(r+1)}setTimeout((function(){return c_(n)}))}}}))})))})),l_={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function c_(e){var t,n=document.activeElement,r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i===n)return;if(i.focus(),document.activeElement!==n)return}}catch(uD){r.e(uD)}finally{r.f()}}var d_=o_,f_=u_,p_=["__scopeMenu"],h_=["forceMount"],v_=["__scopeMenu","loop","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEntryFocus","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","disableOutsideScroll"],g_=["__scopeMenu"],m_=["disabled","onSelect"],y_=["__scopeMenu","disabled","textValue"],b_=["checked","onCheckedChange"],w_=["__scopeMenu","forceMount"],x_=["forceMount"],k_=["Enter"," "],S_=["ArrowUp","PageDown","End"],__=[].concat(["ArrowDown","PageUp","Home"],S_),P_={ltr:[].concat(k_,["ArrowRight"]),rtl:[].concat(k_,["ArrowLeft"])},E_={ltr:["ArrowLeft"],rtl:["ArrowRight"]},C_="Menu",I_=l(Qx(C_),3),T_=I_[0],M_=I_[1],j_=l(eb(C_,[I_[2],IS,t_]),2),A_=j_[0],O_=j_[1],L_=IS(),z_=t_(),D_=l(A_(C_),2),N_=D_[0],R_=D_[1],B_=l(A_(C_),2),F_=B_[0],U_=B_[1],K_=function(e){var n=e.__scopeMenu,r=e.open,i=void 0!==r&&r,o=e.children,a=e.dir,s=e.onOpenChange,u=e.modal,c=void 0===u||u,d=L_(n),f=l((0,t.useState)(null),2),p=f[0],h=f[1],v=(0,t.useRef)(!1),g=ab(s),m=Jx(a);return(0,t.useEffect)((function(){var e=function(){v.current=!0,document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})},t=function(){return v.current=!1};return document.addEventListener("keydown",e,{capture:!0}),function(){document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0})}}),[]),(0,t.createElement)(KS,d,(0,t.createElement)(N_,{scope:n,open:i,onOpenChange:g,content:p,onContentChange:h},(0,t.createElement)(F_,{scope:n,onClose:(0,t.useCallback)((function(){return g(!1)}),[g]),isUsingKeyboardRef:v,dir:m,modal:c},o)))},V_=(0,t.forwardRef)((function(e,n){var r=e.__scopeMenu,i=gt(e,p_),o=L_(r);return(0,t.createElement)(VS,qy({},o,i,{ref:n}))})),W_="MenuPortal",H_=l(A_(W_,{forceMount:void 0}),2),Y_=H_[0],X_=H_[1],q_=function(e){var n=e.__scopeMenu,r=e.forceMount,i=e.children,o=e.container,a=R_(W_,n);return(0,t.createElement)(Y_,{scope:n,forceMount:r},(0,t.createElement)(Vb,{present:r||a.open},(0,t.createElement)(Kb,{asChild:!0,container:o},i)))},$_="MenuContent",G_=l(A_($_),2),Q_=G_[0],Z_=G_[1],J_=(0,t.forwardRef)((function(e,n){var r=X_($_,e.__scopeMenu),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,h_),s=R_($_,e.__scopeMenu),u=U_($_,e.__scopeMenu);return(0,t.createElement)(T_.Provider,{scope:e.__scopeMenu},(0,t.createElement)(Vb,{present:o||s.open},(0,t.createElement)(T_.Slot,{scope:e.__scopeMenu},u.modal?(0,t.createElement)(eP,qy({},a,{ref:n})):(0,t.createElement)(tP,qy({},a,{ref:n})))))})),eP=(0,t.forwardRef)((function(e,n){var r=R_($_,e.__scopeMenu),i=(0,t.useRef)(null),o=Qy(n,i);return(0,t.useEffect)((function(){var e=i.current;if(e)return Fw(e)}),[]),(0,t.createElement)(nP,qy({},e,{ref:o,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:$y(e.onFocusOutside,(function(e){return e.preventDefault()}),{checkForDefaultPrevented:!1}),onDismiss:function(){return r.onOpenChange(!1)}}))})),tP=(0,t.forwardRef)((function(e,n){var r=R_($_,e.__scopeMenu);return(0,t.createElement)(nP,qy({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:function(){return r.onOpenChange(!1)}}))})),nP=(0,t.forwardRef)((function(e,n){var r=e.__scopeMenu,i=e.loop,o=void 0!==i&&i,a=e.trapFocus,s=e.onOpenAutoFocus,u=e.onCloseAutoFocus,c=e.disableOutsidePointerEvents,d=e.onEntryFocus,f=e.onEscapeKeyDown,p=e.onPointerDownOutside,h=e.onFocusOutside,v=e.onInteractOutside,g=e.onDismiss,m=e.disableOutsideScroll,y=gt(e,v_),b=R_($_,r),w=U_($_,r),x=L_(r),k=z_(r),S=M_(r),_=l((0,t.useState)(null),2),P=_[0],E=_[1],C=(0,t.useRef)(null),I=Qy(n,C,b.onContentChange),T=(0,t.useRef)(0),M=(0,t.useRef)(""),j=(0,t.useRef)(0),A=(0,t.useRef)(null),O=(0,t.useRef)("right"),L=(0,t.useRef)(0),z=m?Aw:t.Fragment,D=m?{as:db,allowPinchZoom:!0}:void 0,N=function(e){var t,n,r=M.current+e,i=S().filter((function(e){return!e.disabled})),o=document.activeElement,a=null===(t=i.find((function(e){return e.ref.current===o})))||void 0===t?void 0:t.textValue,s=function(e,t,n){var r=t.length>1&&Array.from(t).every((function(e){return e===t[0]})),i=r?t[0]:t,o=n?e.indexOf(n):-1,a=function(e,t){return e.map((function(n,r){return e[(t+r)%e.length]}))}(e,Math.max(o,0));1===i.length&&(a=a.filter((function(e){return e!==n})));var s=a.find((function(e){return e.toLowerCase().startsWith(i.toLowerCase())}));return s!==n?s:void 0}(i.map((function(e){return e.textValue})),r,a),u=null===(n=i.find((function(e){return e.textValue===s})))||void 0===n?void 0:n.ref.current;!function e(t){M.current=t,window.clearTimeout(T.current),""!==t&&(T.current=window.setTimeout((function(){return e("")}),1e3))}(r),u&&setTimeout((function(){return u.focus()}))};(0,t.useEffect)((function(){return function(){return window.clearTimeout(T.current)}}),[]),Yb();var R=(0,t.useCallback)((function(e){var t,n;return O.current===(null===(t=A.current)||void 0===t?void 0:t.side)&&function(e,t){if(!t)return!1;var n={x:e.clientX,y:e.clientY};return function(e,t){for(var n=e.x,r=e.y,i=!1,o=0,a=t.length-1;o<t.length;a=o++){var s=t[o].x,u=t[o].y,l=t[a].x,c=t[a].y;u>r!==c>r&&n<(l-s)*(r-u)/(c-u)+s&&(i=!i)}return i}(n,t)}(e,null===(n=A.current)||void 0===n?void 0:n.area)}),[]);return(0,t.createElement)(Q_,{scope:r,searchRef:M,onItemEnter:(0,t.useCallback)((function(e){R(e)&&e.preventDefault()}),[R]),onItemLeave:(0,t.useCallback)((function(e){var t;R(e)||(null===(t=C.current)||void 0===t||t.focus(),E(null))}),[R]),onTriggerLeave:(0,t.useCallback)((function(e){R(e)&&e.preventDefault()}),[R]),pointerGraceTimerRef:j,onPointerGraceIntentChange:(0,t.useCallback)((function(e){A.current=e}),[])},(0,t.createElement)(z,D,(0,t.createElement)(Lb,{asChild:!0,trapped:a,onMountAutoFocus:$y(s,(function(e){var t;e.preventDefault(),null===(t=C.current)||void 0===t||t.focus()})),onUnmountAutoFocus:u},(0,t.createElement)(_b,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:f,onPointerDownOutside:p,onFocusOutside:h,onInteractOutside:v,onDismiss:g},(0,t.createElement)(d_,qy({asChild:!0},k,{dir:w.dir,orientation:"vertical",loop:o,currentTabStopId:P,onCurrentTabStopIdChange:E,onEntryFocus:$y(d,(function(e){w.isUsingKeyboardRef.current||e.preventDefault()}))}),(0,t.createElement)(WS,qy({role:"menu","aria-orientation":"vertical","data-state":PP(b.open),"data-radix-menu-content":"",dir:w.dir},x,y,{ref:I,style:Ce({outline:"none"},y.style),onKeyDown:$y(y.onKeyDown,(function(e){var t=e.target.closest("[data-radix-menu-content]")===e.currentTarget,n=e.ctrlKey||e.altKey||e.metaKey,r=1===e.key.length;t&&("Tab"===e.key&&e.preventDefault(),!n&&r&&N(e.key));var i=C.current;if(e.target===i&&__.includes(e.key)){e.preventDefault();var o=S().filter((function(e){return!e.disabled})).map((function(e){return e.ref.current}));S_.includes(e.key)&&o.reverse(),function(e){var t,n=document.activeElement,r=J(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i===n)return;if(i.focus(),document.activeElement!==n)return}}catch(uD){r.e(uD)}finally{r.f()}}(o)}})),onBlur:$y(e.onBlur,(function(e){e.currentTarget.contains(e.target)||(window.clearTimeout(T.current),M.current="")})),onPointerMove:$y(e.onPointerMove,IP((function(e){var t=e.target,n=L.current!==e.clientX;if(e.currentTarget.contains(t)&&n){var r=e.clientX>L.current?"right":"left";O.current=r,L.current=e.clientX}})))})))))))})),rP=(0,t.forwardRef)((function(e,n){e.__scopeMenu;var r=gt(e,g_);return(0,t.createElement)(gb.div,qy({role:"group"},r,{ref:n}))})),iP="MenuItem",oP="menu.itemSelect",aP=(0,t.forwardRef)((function(e,n){var r=e.disabled,i=void 0!==r&&r,o=e.onSelect,a=gt(e,m_),s=(0,t.useRef)(null),u=U_(iP,e.__scopeMenu),l=Z_(iP,e.__scopeMenu),c=Qy(n,s),d=(0,t.useRef)(!1);return(0,t.createElement)(sP,qy({},a,{ref:c,disabled:i,onClick:$y(e.onClick,(function(){var e=s.current;if(!i&&e){var t=new CustomEvent(oP,{bubbles:!0,cancelable:!0});e.addEventListener(oP,(function(e){return null===o||void 0===o?void 0:o(e)}),{once:!0}),mb(e,t),t.defaultPrevented?d.current=!1:u.onClose()}})),onPointerDown:function(t){var n;null===(n=e.onPointerDown)||void 0===n||n.call(e,t),d.current=!0},onPointerUp:$y(e.onPointerUp,(function(e){var t;d.current||null===(t=e.currentTarget)||void 0===t||t.click()})),onKeyDown:$y(e.onKeyDown,(function(e){var t=""!==l.searchRef.current;i||t&&" "===e.key||k_.includes(e.key)&&(e.currentTarget.click(),e.preventDefault())}))}))})),sP=(0,t.forwardRef)((function(e,n){var r=e.__scopeMenu,i=e.disabled,o=void 0!==i&&i,a=e.textValue,s=gt(e,y_),u=Z_(iP,r),c=z_(r),d=(0,t.useRef)(null),f=Qy(n,d),p=l((0,t.useState)(!1),2),h=p[0],v=p[1],g=l((0,t.useState)(""),2),m=g[0],y=g[1];return(0,t.useEffect)((function(){var e,t=d.current;t&&y((null!==(e=t.textContent)&&void 0!==e?e:"").trim())}),[s.children]),(0,t.createElement)(T_.ItemSlot,{scope:r,disabled:o,textValue:null!==a&&void 0!==a?a:m},(0,t.createElement)(f_,qy({asChild:!0},c,{focusable:!o}),(0,t.createElement)(gb.div,qy({role:"menuitem","data-highlighted":h?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0},s,{ref:f,onPointerMove:$y(e.onPointerMove,IP((function(e){o?u.onItemLeave(e):(u.onItemEnter(e),e.defaultPrevented||e.currentTarget.focus())}))),onPointerLeave:$y(e.onPointerLeave,IP((function(e){return u.onItemLeave(e)}))),onFocus:$y(e.onFocus,(function(){return v(!0)})),onBlur:$y(e.onBlur,(function(){return v(!1)}))}))))})),uP=(0,t.forwardRef)((function(e,n){var r=e.checked,i=void 0!==r&&r,o=e.onCheckedChange,a=gt(e,b_);return(0,t.createElement)(pP,{scope:e.__scopeMenu,checked:i},(0,t.createElement)(aP,qy({role:"menuitemcheckbox","aria-checked":EP(i)?"mixed":i},a,{ref:n,"data-state":CP(i),onSelect:$y(a.onSelect,(function(){return null===o||void 0===o?void 0:o(!!EP(i)||!i)}),{checkForDefaultPrevented:!1})})))})),lP="MenuRadioGroup",cP=l(A_(lP,{value:void 0,onValueChange:function(){}}),2),dP=(cP[0],cP[1],"MenuItemIndicator"),fP=l(A_(dP,{checked:!1}),2),pP=fP[0],hP=fP[1],vP=(0,t.forwardRef)((function(e,n){var r=e.__scopeMenu,i=e.forceMount,o=gt(e,w_),a=hP(dP,r);return(0,t.createElement)(Vb,{present:i||EP(a.checked)||!0===a.checked},(0,t.createElement)(gb.span,qy({},o,{ref:n,"data-state":CP(a.checked)})))})),gP="MenuSub",mP=l(A_(gP),2),yP=mP[0],bP=mP[1],wP=function(e){var n=e.__scopeMenu,r=e.children,i=e.open,o=void 0!==i&&i,a=e.onOpenChange,s=R_(gP,n),u=L_(n),c=l((0,t.useState)(null),2),d=c[0],f=c[1],p=l((0,t.useState)(null),2),h=p[0],v=p[1],g=ab(a);return(0,t.useEffect)((function(){return!1===s.open&&g(!1),function(){return g(!1)}}),[s.open,g]),(0,t.createElement)(KS,u,(0,t.createElement)(N_,{scope:n,open:o,onOpenChange:g,content:h,onContentChange:v},(0,t.createElement)(yP,{scope:n,contentId:ob(),triggerId:ob(),trigger:d,onTriggerChange:f},r)))},xP="MenuSubTrigger",kP=(0,t.forwardRef)((function(e,n){var r=R_(xP,e.__scopeMenu),i=U_(xP,e.__scopeMenu),o=bP(xP,e.__scopeMenu),a=Z_(xP,e.__scopeMenu),s=(0,t.useRef)(null),u=a.pointerGraceTimerRef,l=a.onPointerGraceIntentChange,c={__scopeMenu:e.__scopeMenu},d=(0,t.useCallback)((function(){s.current&&window.clearTimeout(s.current),s.current=null}),[]);return(0,t.useEffect)((function(){return d}),[d]),(0,t.useEffect)((function(){var e=u.current;return function(){window.clearTimeout(e),l(null)}}),[u,l]),(0,t.createElement)(V_,qy({asChild:!0},c),(0,t.createElement)(sP,qy({id:o.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":o.contentId,"data-state":PP(r.open)},e,{ref:Gy(n,o.onTriggerChange),onClick:function(t){var n;null===(n=e.onClick)||void 0===n||n.call(e,t),e.disabled||t.defaultPrevented||(t.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:$y(e.onPointerMove,IP((function(t){a.onItemEnter(t),t.defaultPrevented||e.disabled||r.open||s.current||(a.onPointerGraceIntentChange(null),s.current=window.setTimeout((function(){r.onOpenChange(!0),d()}),100))}))),onPointerLeave:$y(e.onPointerLeave,IP((function(e){var t;d();var n=null===(t=r.content)||void 0===t?void 0:t.getBoundingClientRect();if(n){var i,o=null===(i=r.content)||void 0===i?void 0:i.dataset.side,s="right"===o,l=s?-5:5,c=n[s?"left":"right"],f=n[s?"right":"left"];a.onPointerGraceIntentChange({area:[{x:e.clientX+l,y:e.clientY},{x:c,y:n.top},{x:f,y:n.top},{x:f,y:n.bottom},{x:c,y:n.bottom}],side:o}),window.clearTimeout(u.current),u.current=window.setTimeout((function(){return a.onPointerGraceIntentChange(null)}),300)}else{if(a.onTriggerLeave(e),e.defaultPrevented)return;a.onPointerGraceIntentChange(null)}}))),onKeyDown:$y(e.onKeyDown,(function(t){var n,o=""!==a.searchRef.current;e.disabled||o&&" "===t.key||P_[i.dir].includes(t.key)&&(r.onOpenChange(!0),null===(n=r.content)||void 0===n||n.focus(),t.preventDefault())}))})))})),SP="MenuSubContent",_P=(0,t.forwardRef)((function(e,n){var r=X_($_,e.__scopeMenu),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,x_),s=R_($_,e.__scopeMenu),u=U_($_,e.__scopeMenu),l=bP(SP,e.__scopeMenu),c=(0,t.useRef)(null),d=Qy(n,c);return(0,t.createElement)(T_.Provider,{scope:e.__scopeMenu},(0,t.createElement)(Vb,{present:o||s.open},(0,t.createElement)(T_.Slot,{scope:e.__scopeMenu},(0,t.createElement)(nP,qy({id:l.contentId,"aria-labelledby":l.triggerId},a,{ref:d,align:"start",side:"rtl"===u.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:function(e){var t;u.isUsingKeyboardRef.current&&(null===(t=c.current)||void 0===t||t.focus()),e.preventDefault()},onCloseAutoFocus:function(e){return e.preventDefault()},onFocusOutside:$y(e.onFocusOutside,(function(e){e.target!==l.trigger&&s.onOpenChange(!1)})),onEscapeKeyDown:$y(e.onEscapeKeyDown,(function(e){u.onClose(),e.preventDefault()})),onKeyDown:$y(e.onKeyDown,(function(e){var t,n=e.currentTarget.contains(e.target),r=E_[u.dir].includes(e.key);n&&r&&(s.onOpenChange(!1),null===(t=l.trigger)||void 0===t||t.focus(),e.preventDefault())}))})))))}));function PP(e){return e?"open":"closed"}function EP(e){return"indeterminate"===e}function CP(e){return EP(e)?"indeterminate":e?"checked":"unchecked"}function IP(e){return function(t){return"mouse"===t.pointerType?e(t):void 0}}var TP=K_,MP=V_,jP=q_,AP=J_,OP=rP,LP=aP,zP=uP,DP=vP,NP=wP,RP=kP,BP=_P,FP=["__scopeDropdownMenu","disabled"],UP=["__scopeDropdownMenu"],KP=["__scopeDropdownMenu"],VP=["__scopeDropdownMenu"],WP=["__scopeDropdownMenu"],HP=["__scopeDropdownMenu"],YP=["__scopeDropdownMenu"],XP=["__scopeDropdownMenu"],qP=["__scopeDropdownMenu"],$P="DropdownMenu",GP=l(eb($P,[O_]),2),QP=GP[0],ZP=(GP[1],O_()),JP=l(QP($P),2),eE=JP[0],tE=JP[1],nE=function(e){var n=e.__scopeDropdownMenu,r=e.children,i=e.dir,o=e.open,a=e.defaultOpen,s=e.onOpenChange,u=e.modal,c=void 0===u||u,d=ZP(n),f=(0,t.useRef)(null),p=l(sb({prop:o,defaultProp:a,onChange:s}),2),h=p[0],v=void 0!==h&&h,g=p[1];return(0,t.createElement)(eE,{scope:n,triggerId:ob(),triggerRef:f,contentId:ob(),open:v,onOpenChange:g,onOpenToggle:(0,t.useCallback)((function(){return g((function(e){return!e}))}),[g]),modal:c},(0,t.createElement)(TP,qy({},d,{open:v,onOpenChange:g,dir:i,modal:c}),r))},rE="DropdownMenuTrigger",iE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=e.disabled,o=void 0!==i&&i,a=gt(e,FP),s=tE(rE,r),u=ZP(r);return(0,t.createElement)(MP,qy({asChild:!0},u),(0,t.createElement)(gb.button,qy({type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":o?"":void 0,disabled:o},a,{ref:Gy(n,s.triggerRef),onPointerDown:$y(e.onPointerDown,(function(e){o||0!==e.button||!1!==e.ctrlKey||(s.onOpenToggle(),s.open||e.preventDefault())})),onKeyDown:$y(e.onKeyDown,(function(e){o||(["Enter"," "].includes(e.key)&&s.onOpenToggle(),"ArrowDown"===e.key&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(e.key)&&e.preventDefault())}))})))})),oE=function(e){var n=e.__scopeDropdownMenu,r=gt(e,UP),i=ZP(n);return(0,t.createElement)(jP,qy({},i,r))},aE="DropdownMenuContent",sE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,KP),o=tE(aE,r),a=ZP(r),s=(0,t.useRef)(!1);return(0,t.createElement)(AP,qy({id:o.contentId,"aria-labelledby":o.triggerId},a,i,{ref:n,onCloseAutoFocus:$y(e.onCloseAutoFocus,(function(e){var t;s.current||null===(t=o.triggerRef.current)||void 0===t||t.focus(),s.current=!1,e.preventDefault()})),onInteractOutside:$y(e.onInteractOutside,(function(e){var t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;o.modal&&!r||(s.current=!0)})),style:Ce(Ce({},e.style),{},{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))})),uE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,VP),o=ZP(r);return(0,t.createElement)(OP,qy({},o,i,{ref:n}))})),lE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,WP),o=ZP(r);return(0,t.createElement)(LP,qy({},o,i,{ref:n}))})),cE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,HP),o=ZP(r);return(0,t.createElement)(zP,qy({},o,i,{ref:n}))})),dE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,YP),o=ZP(r);return(0,t.createElement)(DP,qy({},o,i,{ref:n}))})),fE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,XP),o=ZP(r);return(0,t.createElement)(RP,qy({},o,i,{ref:n}))})),pE=(0,t.forwardRef)((function(e,n){var r=e.__scopeDropdownMenu,i=gt(e,qP),o=ZP(r);return(0,t.createElement)(BP,qy({},o,i,{ref:n,style:Ce(Ce({},e.style),{},{"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))})),hE=nE,vE=iE,gE=oE,mE=sE,yE=uE,bE=lE,wE=cE,xE=dE,kE=function(e){var n=e.__scopeDropdownMenu,r=e.children,i=e.open,o=e.onOpenChange,a=e.defaultOpen,s=ZP(n),u=l(sb({prop:i,defaultProp:a,onChange:o}),2),c=u[0],d=void 0!==c&&c,f=u[1];return(0,t.createElement)(NP,qy({},s,{open:d,onOpenChange:f}),r)},SE=fE,_E=pE,PE=function(){},EE=t.createContext({});function CE(e){var t=e.onEvent,n=e.children;return(0,La.jsx)(EE.Provider,{value:null!==t&&void 0!==t?t:PE,children:n})}function IE(){return t.useContext(EE)}function TE(e,n){var r=Ka(),i=(0,t.useRef)(!1),o=IE(),a=(0,t.useCallback)((function(t){i.current=t,r.batch((function(){t?(r.complete(),r.addOpenMenu(e)):(r.deleteOpenMenu(e),r.openMenus.forEach((function(t){t.startsWith(e)&&r.deleteOpenMenu(t)}))),null===n||void 0===n||n(t)}))}),[r,e,n]);return(0,t.useEffect)((function(){return i.current&&(o("open-menu",{source:"unknown",id:e}),r.addOpenMenu(e)),function(){i.current&&(r.deleteOpenMenu(e),r.openMenus.forEach((function(t){t.startsWith(e)&&(o("close-menu",{source:"unknown",id:e}),r.deleteOpenMenu(t))})),i.current=!1)}}),[r,e,o]),[_e("is menu open",(function(){return r.openMenus.includes(e)}),[r,e]),a]}var ME=["noClose"],jE=["children","onSelect"],AE=["children","onSelect"];function OE(e){var t=e.id,n=e.children,r=e.modal,i=void 0!==r&&r,o=l(TE(t),2),a=o[0],s=o[1];return(0,La.jsx)(hE,{open:a,dir:"ltr",modal:i,onOpenChange:s,children:n})}function LE(e){var t=e.children,n=e["data-testid"];return(0,La.jsx)(vE,{dir:"ltr","data-testid":n,asChild:!0,children:t})}function zE(e){var t=e.side,n=void 0===t?"bottom":t,r=e.align,i=void 0===r?"start":r,o=e.sideOffset,a=void 0===o?8:o,s=e.alignOffset,u=void 0===s?8:s,l=e.children,c=wu();return(0,La.jsx)(gE,{dir:"ltr",container:c,children:(0,La.jsx)(mE,{className:"tlui-menu",align:i,sideOffset:a,side:n,alignOffset:u,collisionPadding:4,children:l})})}function DE(e){var t=e.id,n=e.children,r=l(TE(t),2),i=r[0],o=r[1];return(0,La.jsx)(kE,{open:i,onOpenChange:o,children:n})}function NE(e){var t=e.label,n=e["data-testid"],r=e["data-direction"];return(0,La.jsx)(SE,{dir:"ltr","data-direction":r,"data-testid":n,asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button tlui-menu__submenu__trigger",label:t,icon:"chevron-right"})})}function RE(e){var t=e.alignOffset,n=void 0===t?0:t,r=e.sideOffset,i=void 0===r?5:r,o=e.children,a=wu();return(0,La.jsx)(gE,{container:a,dir:"ltr",children:(0,La.jsx)(_E,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:n,sideOffset:i,collisionPadding:4,children:o})})}function BE(e){var t=e.children,n=e.size,r=void 0===n?"medium":n;return(0,La.jsx)(yE,{dir:"ltr",className:"tlui-menu__group","data-size":r,children:t})}function FE(e){var t=e.noClose,n=gt(e,ME);return(0,La.jsx)(bE,{dir:"ltr",asChild:!0,onClick:t||void 0!==n.isChecked?ou:void 0,children:(0,La.jsx)(Wx,Ce({className:"tlui-menu__button"},n))})}function UE(e){var t=e.children,n=e.onSelect,r=gt(e,jE);return(0,La.jsxs)(wE,Ce(Ce({dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:function(e){null===n||void 0===n||n(e),ou(e)}},r),{},{children:[(0,La.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:"scale(".concat(r.checked?1:.5,")"),opacity:r.checked?1:.5},children:(0,La.jsx)(Nx,{small:!0,icon:r.checked?"check":"checkbox-empty"})}),t]}))}function KE(e){var t=e.children,n=e.onSelect,r=gt(e,AE);return(0,La.jsxs)(wE,Ce(Ce({dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:function(e){null===n||void 0===n||n(e),ou(e)}},r),{},{children:[(0,La.jsx)(xE,{dir:"ltr",className:"tlui-menu__checkbox-item__check",children:(0,La.jsx)(Nx,{icon:"check"})}),t]}))}var VE=(0,t.forwardRef)((function(e,n){return(0,t.createElement)(gb.span,qy({},e,{ref:n,style:Ce({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"},e.style)}))})),WE=["__scopeToast","hotkey","label"],HE=["__scopeToast","onFocusFromOutsideViewport"],YE=["forceMount","open","defaultOpen","onOpenChange"],XE=["__scopeToast","type","duration","open","onClose","onEscapeKeyDown","onPause","onResume","onSwipeStart","onSwipeMove","onSwipeCancel","onSwipeEnd"],qE=["__scopeToast","children"],$E=["__scopeToast"],GE=["__scopeToast"],QE=["altText"],ZE=["__scopeToast"],JE=["__scopeToast","altText"],eC="ToastProvider",tC=l(Qx("Toast"),3),nC=tC[0],rC=tC[1],iC=l(eb("Toast",[tC[2]]),2),oC=iC[0],aC=(iC[1],l(oC(eC),2)),sC=aC[0],uC=aC[1],lC=function(e){var n=e.__scopeToast,r=e.label,i=void 0===r?"Notification":r,o=e.duration,a=void 0===o?5e3:o,s=e.swipeDirection,u=void 0===s?"right":s,c=e.swipeThreshold,d=void 0===c?50:c,f=e.children,p=l((0,t.useState)(null),2),h=p[0],v=p[1],g=l((0,t.useState)(0),2),m=g[0],y=g[1],b=(0,t.useRef)(!1),w=(0,t.useRef)(!1);return(0,t.createElement)(nC.Provider,{scope:n},(0,t.createElement)(sC,{scope:n,label:i,duration:a,swipeDirection:u,swipeThreshold:d,toastCount:m,viewport:h,onViewportChange:v,onToastAdd:(0,t.useCallback)((function(){return y((function(e){return e+1}))}),[]),onToastRemove:(0,t.useCallback)((function(){return y((function(e){return e-1}))}),[]),isFocusedToastEscapeKeyDownRef:b,isClosePausedRef:w},f))};lC.propTypes={label:function(e){if(e.label&&"string"===typeof e.label&&!e.label.trim()){var t="Invalid prop `label` supplied to `".concat(eC,"`. Expected non-empty `string`.");return new Error(t)}return null}};var cC="ToastViewport",dC=["F8"],fC="toast.viewportPause",pC="toast.viewportResume",hC=(0,t.forwardRef)((function(e,n){var r=e.__scopeToast,i=e.hotkey,o=void 0===i?dC:i,a=e.label,s=void 0===a?"Notifications ({hotkey})":a,u=gt(e,WE),l=uC(cC,r),c=rC(r),f=(0,t.useRef)(null),p=(0,t.useRef)(null),h=(0,t.useRef)(null),v=(0,t.useRef)(null),g=Qy(n,v,l.onViewportChange),m=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=l.toastCount>0;(0,t.useEffect)((function(){var e=function(e){var t;o.every((function(t){return e[t]||e.code===t}))&&(null===(t=v.current)||void 0===t||t.focus())};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[o]),(0,t.useEffect)((function(){var e=f.current,t=v.current;if(y&&e&&t){var n=function(){if(!l.isClosePausedRef.current){var e=new CustomEvent(fC);t.dispatchEvent(e),l.isClosePausedRef.current=!0}},r=function(){if(l.isClosePausedRef.current){var e=new CustomEvent(pC);t.dispatchEvent(e),l.isClosePausedRef.current=!1}},i=function(t){!e.contains(t.relatedTarget)&&r()},o=function(){e.contains(document.activeElement)||r()};return e.addEventListener("focusin",n),e.addEventListener("focusout",i),e.addEventListener("pointermove",n),e.addEventListener("pointerleave",o),window.addEventListener("blur",n),window.addEventListener("focus",r),function(){e.removeEventListener("focusin",n),e.removeEventListener("focusout",i),e.removeEventListener("pointermove",n),e.removeEventListener("pointerleave",o),window.removeEventListener("blur",n),window.removeEventListener("focus",r)}}}),[y,l.isClosePausedRef]);var b=(0,t.useCallback)((function(e){var t=e.tabbingDirection,n=c().map((function(e){var n=e.ref.current,r=[n].concat(d(function(e){var t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){var t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}(n)));return"forwards"===t?r:r.reverse()}));return("forwards"===t?n.reverse():n).flat()}),[c]);return(0,t.useEffect)((function(){var e=v.current;if(e){var t=function(t){var n=t.altKey||t.ctrlKey||t.metaKey;if("Tab"===t.key&&!n){var r,i=document.activeElement,o=t.shiftKey;if(t.target===e&&o)return void(null===(r=p.current)||void 0===r||r.focus());var a,s,u=b({tabbingDirection:o?"backwards":"forwards"}),l=u.findIndex((function(e){return e===i}));if(LC(u.slice(l+1)))t.preventDefault();else o?null===(a=p.current)||void 0===a||a.focus():null===(s=h.current)||void 0===s||s.focus()}};return e.addEventListener("keydown",t),function(){return e.removeEventListener("keydown",t)}}}),[c,b]),(0,t.createElement)(Tb,{ref:f,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:y?void 0:"none"}},y&&(0,t.createElement)(gC,{ref:p,onFocusFromOutsideViewport:function(){LC(b({tabbingDirection:"forwards"}))}}),(0,t.createElement)(nC.Slot,{scope:r},(0,t.createElement)(gb.ol,qy({tabIndex:-1},u,{ref:g}))),y&&(0,t.createElement)(gC,{ref:h,onFocusFromOutsideViewport:function(){LC(b({tabbingDirection:"backwards"}))}}))})),vC="ToastFocusProxy",gC=(0,t.forwardRef)((function(e,n){var r=e.__scopeToast,i=e.onFocusFromOutsideViewport,o=gt(e,HE),a=uC(vC,r);return(0,t.createElement)(VE,qy({"aria-hidden":!0,tabIndex:0},o,{ref:n,style:{position:"fixed"},onFocus:function(e){var t,n=e.relatedTarget;!(null!==(t=a.viewport)&&void 0!==t&&t.contains(n))&&i()}}))})),mC="Toast",yC=(0,t.forwardRef)((function(e,n){var r=e.forceMount,i=e.open,o=e.defaultOpen,a=e.onOpenChange,s=gt(e,YE),u=l(sb({prop:i,defaultProp:o,onChange:a}),2),c=u[0],d=void 0===c||c,f=u[1];return(0,t.createElement)(Vb,{present:r||d},(0,t.createElement)(kC,qy({open:d},s,{ref:n,onClose:function(){return f(!1)},onPause:ab(e.onPause),onResume:ab(e.onResume),onSwipeStart:$y(e.onSwipeStart,(function(e){e.currentTarget.setAttribute("data-swipe","start")})),onSwipeMove:$y(e.onSwipeMove,(function(e){var t=e.detail.delta,n=t.x,r=t.y;e.currentTarget.setAttribute("data-swipe","move"),e.currentTarget.style.setProperty("--radix-toast-swipe-move-x","".concat(n,"px")),e.currentTarget.style.setProperty("--radix-toast-swipe-move-y","".concat(r,"px"))})),onSwipeCancel:$y(e.onSwipeCancel,(function(e){e.currentTarget.setAttribute("data-swipe","cancel"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")})),onSwipeEnd:$y(e.onSwipeEnd,(function(e){var t=e.detail.delta,n=t.x,r=t.y;e.currentTarget.setAttribute("data-swipe","end"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.setProperty("--radix-toast-swipe-end-x","".concat(n,"px")),e.currentTarget.style.setProperty("--radix-toast-swipe-end-y","".concat(r,"px")),f(!1)}))})))})),bC=l(oC(mC,{onClose:function(){}}),2),wC=bC[0],xC=bC[1],kC=(0,t.forwardRef)((function(e,n){var r=e.__scopeToast,i=e.type,o=void 0===i?"foreground":i,a=e.duration,s=e.open,u=e.onClose,c=e.onEscapeKeyDown,d=e.onPause,f=e.onResume,p=e.onSwipeStart,h=e.onSwipeMove,v=e.onSwipeCancel,g=e.onSwipeEnd,m=gt(e,XE),y=uC(mC,r),b=l((0,t.useState)(null),2),w=b[0],x=b[1],k=Qy(n,(function(e){return x(e)})),S=(0,t.useRef)(null),_=(0,t.useRef)(null),P=a||y.duration,E=(0,t.useRef)(0),C=(0,t.useRef)(P),I=(0,t.useRef)(0),T=y.onToastAdd,M=y.onToastRemove,j=ab((function(){var e;(null===w||void 0===w?void 0:w.contains(document.activeElement))&&(null===(e=y.viewport)||void 0===e||e.focus()),u()})),A=(0,t.useCallback)((function(e){e&&e!==1/0&&(window.clearTimeout(I.current),E.current=(new Date).getTime(),I.current=window.setTimeout(j,e))}),[j]);(0,t.useEffect)((function(){var e=y.viewport;if(e){var t=function(){A(C.current),null===f||void 0===f||f()},n=function(){var e=(new Date).getTime()-E.current;C.current=C.current-e,window.clearTimeout(I.current),null===d||void 0===d||d()};return e.addEventListener(fC,n),e.addEventListener(pC,t),function(){e.removeEventListener(fC,n),e.removeEventListener(pC,t)}}}),[y.viewport,P,d,f,A]),(0,t.useEffect)((function(){s&&!y.isClosePausedRef.current&&A(P)}),[s,P,y.isClosePausedRef,A]),(0,t.useEffect)((function(){return T(),function(){return M()}}),[T,M]);var O=(0,t.useMemo)((function(){return w?jC(w):null}),[w]);return y.viewport?(0,t.createElement)(t.Fragment,null,O&&(0,t.createElement)(SC,{__scopeToast:r,role:"status","aria-live":"foreground"===o?"assertive":"polite","aria-atomic":!0},O),(0,t.createElement)(wC,{scope:r,onClose:j},(0,ub.createPortal)((0,t.createElement)(nC.ItemSlot,{scope:r},(0,t.createElement)(Ib,{asChild:!0,onEscapeKeyDown:$y(c,(function(){y.isFocusedToastEscapeKeyDownRef.current||j(),y.isFocusedToastEscapeKeyDownRef.current=!1}))},(0,t.createElement)(gb.li,qy({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":y.swipeDirection},m,{ref:k,style:Ce({userSelect:"none",touchAction:"none"},e.style),onKeyDown:$y(e.onKeyDown,(function(e){"Escape"===e.key&&(null===c||void 0===c||c(e.nativeEvent),e.nativeEvent.defaultPrevented||(y.isFocusedToastEscapeKeyDownRef.current=!0,j()))})),onPointerDown:$y(e.onPointerDown,(function(e){0===e.button&&(S.current={x:e.clientX,y:e.clientY})})),onPointerMove:$y(e.onPointerMove,(function(e){if(S.current){var t=e.clientX-S.current.x,n=e.clientY-S.current.y,r=Boolean(_.current),i=["left","right"].includes(y.swipeDirection),o=["left","up"].includes(y.swipeDirection)?Math.min:Math.max,a=i?o(0,t):0,s=i?0:o(0,n),u="touch"===e.pointerType?10:2,l={x:a,y:s},c={originalEvent:e,delta:l};r?(_.current=l,AC("toast.swipeMove",h,c,{discrete:!1})):OC(l,y.swipeDirection,u)?(_.current=l,AC("toast.swipeStart",p,c,{discrete:!1}),e.target.setPointerCapture(e.pointerId)):(Math.abs(t)>u||Math.abs(n)>u)&&(S.current=null)}})),onPointerUp:$y(e.onPointerUp,(function(e){var t=_.current,n=e.target;if(n.hasPointerCapture(e.pointerId)&&n.releasePointerCapture(e.pointerId),_.current=null,S.current=null,t){var r=e.currentTarget,i={originalEvent:e,delta:t};OC(t,y.swipeDirection,y.swipeThreshold)?AC("toast.swipeEnd",g,i,{discrete:!0}):AC("toast.swipeCancel",v,i,{discrete:!0}),r.addEventListener("click",(function(e){return e.preventDefault()}),{once:!0})}}))})))),y.viewport))):null}));kC.propTypes={type:function(e){if(e.type&&!["foreground","background"].includes(e.type)){var t="Invalid prop `type` supplied to `".concat(mC,"`. Expected `foreground | background`.");return new Error(t)}return null}};var SC=function(e){var n=e.__scopeToast,r=e.children,i=gt(e,qE),o=uC(mC,n),a=l((0,t.useState)(!1),2),s=a[0],u=a[1],c=l((0,t.useState)(!1),2),d=c[0],f=c[1];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=ab(e);nb((function(){var e=0,n=0;return e=window.requestAnimationFrame((function(){return n=window.requestAnimationFrame(t)})),function(){window.cancelAnimationFrame(e),window.cancelAnimationFrame(n)}}),[t])}((function(){return u(!0)})),(0,t.useEffect)((function(){var e=window.setTimeout((function(){return f(!0)}),1e3);return function(){return window.clearTimeout(e)}}),[]),d?null:(0,t.createElement)(Kb,{asChild:!0},(0,t.createElement)(VE,i,s&&(0,t.createElement)(t.Fragment,null,o.label," ",r)))},_C=(0,t.forwardRef)((function(e,n){e.__scopeToast;var r=gt(e,$E);return(0,t.createElement)(gb.div,qy({},r,{ref:n}))})),PC=(0,t.forwardRef)((function(e,n){e.__scopeToast;var r=gt(e,GE);return(0,t.createElement)(gb.div,qy({},r,{ref:n}))})),EC="ToastAction",CC=(0,t.forwardRef)((function(e,n){var r=e.altText,i=gt(e,QE);return r?(0,t.createElement)(MC,{altText:r,asChild:!0},(0,t.createElement)(TC,qy({},i,{ref:n}))):null}));CC.propTypes={altText:function(e){return e.altText?null:new Error("Missing prop `altText` expected on `".concat(EC,"`"))}};var IC="ToastClose",TC=(0,t.forwardRef)((function(e,n){var r=e.__scopeToast,i=gt(e,ZE),o=xC(IC,r);return(0,t.createElement)(MC,{asChild:!0},(0,t.createElement)(gb.button,qy({type:"button"},i,{ref:n,onClick:$y(e.onClick,o.onClose)})))})),MC=(0,t.forwardRef)((function(e,n){e.__scopeToast;var r=e.altText,i=gt(e,JE);return(0,t.createElement)(gb.div,qy({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},i,{ref:n}))}));function jC(e){var t=[];return Array.from(e.childNodes).forEach((function(e){if(e.nodeType===e.TEXT_NODE&&e.textContent&&t.push(e.textContent),function(e){return e.nodeType===e.ELEMENT_NODE}(e)){var n=e.ariaHidden||e.hidden||"none"===e.style.display,r=""===e.dataset.radixToastAnnounceExclude;if(!n)if(r){var i=e.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push.apply(t,d(jC(e)))}})),t}function AC(e,t,n,r){var i=r.discrete,o=n.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),i?mb(o,a):o.dispatchEvent(a)}var OC=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.abs(e.x),i=Math.abs(e.y),o=r>i;return"left"===t||"right"===t?o&&r>n:!o&&i>n};function LC(e){var t=document.activeElement;return e.some((function(e){return e===t||(e.focus(),document.activeElement!==t)}))}var zC=yC,DC=_C,NC=PC,RC=CC,BC=TC,FC="2.0.0-alpha.14",UC=Ce(Ce({},Da),{},{icons:Object.fromEntries(["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"].map((function(e){return[e,"https://unpkg.com/@tldraw/assets@".concat(FC,"/icons/icon/").concat(e,".svg")]}))),translations:Object.fromEntries(Ma.map((function(e){return[e.locale,"https://unpkg.com/@tldraw/assets@".concat(FC,"/translations/").concat(e.locale,".json")]}))),embedIcons:Object.fromEntries(zo.map((function(e){return[e.type,"https://unpkg.com/@tldraw/assets@".concat(FC,"/embed-icons/").concat(e.type,".png")]})))});function KC(e){return e?{fonts:Object.assign(Ce({},UC.fonts),Ce({},null===e||void 0===e?void 0:e.fonts)),icons:Object.assign(Ce({},UC.icons),Ce({},null===e||void 0===e?void 0:e.icons)),embedIcons:Object.assign(Ce({},UC.embedIcons),Ce({},null===e||void 0===e?void 0:e.embedIcons)),translations:Object.assign(Ce({},UC.translations),Ce({},null===e||void 0===e?void 0:e.translations))}:UC}var VC=t.forwardRef((function(e,n){var r=e.className,i=e.label,o=e.icon,a=e.iconLeft,s=e.autoselect,u=void 0!==s&&s,c=e.autofocus,d=void 0!==c&&c,f=e.defaultValue,p=e.placeholder,h=e.onComplete,v=e.onValueChange,g=e.onCancel,m=e.onBlur,y=e.shouldManuallyMaintainScrollPositionWhenFocused,b=void 0!==y&&y,w=e.children,x=e.value,k=t.useRef(null);t.useImperativeHandle(n,(function(){return k.current}));var S=Lx(),_=t.useRef(null!==f&&void 0!==f?f:""),P=t.useRef(null!==f&&void 0!==f?f:""),E=l(t.useState(!1),2),C=E[0],I=E[1],T=t.useCallback((function(e){I(!0);var t=e.currentTarget;P.current=t.value,requestAnimationFrame((function(){u&&t.select()}))}),[u]),M=t.useCallback((function(e){var t=e.currentTarget.value;P.current=t,null===v||void 0===v||v(t)}),[v]),j=t.useCallback((function(e){switch(e.key){case"Enter":e.currentTarget.blur(),e.stopPropagation(),null===h||void 0===h||h(e.currentTarget.value);break;case"Escape":e.currentTarget.value=_.current,e.currentTarget.blur(),e.stopPropagation(),null===g||void 0===g||g(e.currentTarget.value)}}),[h,g]),A=t.useCallback((function(e){I(!1);var t=e.currentTarget.value;null===m||void 0===m||m(t)}),[m]);return t.useEffect((function(){var e=window.visualViewport;if(C&&b&&e){var t=function(){var e;null===(e=k.current)||void 0===e||e.scrollIntoView({block:"center"})};return e.addEventListener("resize",t),e.addEventListener("scroll",t),requestAnimationFrame((function(){var e;null===(e=k.current)||void 0===e||e.scrollIntoView({block:"center"})})),function(){e.removeEventListener("resize",t),e.removeEventListener("scroll",t)}}}),[C,b]),(0,La.jsxs)("div",{draggable:!1,className:"tlui-input__wrapper",children:[w,i&&(0,La.jsx)("label",{children:S(i)}),a&&(0,La.jsx)(Nx,{icon:a,className:"tlui-icon-left",small:!0}),(0,La.jsx)("input",{ref:k,className:Fa("tlui-input",r),type:"text",defaultValue:f,onKeyUp:j,onChange:M,onFocus:T,onBlur:A,autoFocus:d,placeholder:p,value:x}),o&&(0,La.jsx)(Nx,{icon:o,small:!!i})]})}));function WC(e){return rf(e)?{isValid:!0,hasProtocol:!0}:rf("https://"+e)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}var HC=ke((function(e){var t=e.onClose,n=Ka().onlySelectedShape;return n&&"url"in n.props&&"string"===typeof n.props.url?(0,La.jsx)(YC,{onClose:t,selectedShape:n}):null})),YC=ke((function(e){var n=e.onClose,r=e.selectedShape,i=Ka(),o=Lx(),a=(0,t.useRef)(null);(0,t.useEffect)((function(){requestAnimationFrame((function(){var e;return null===(e=a.current)||void 0===e?void 0:e.focus()}))}),[]);var s=(0,t.useRef)(r.props.url),u=l((0,t.useState)((function(){var e=WC(r.props.url),t=!0===e.isValid?e.hasProtocol?r.props.url:"https://"+r.props.url:"https://";return{actual:t,safe:t,valid:!0}})),2),c=u[0],d=u[1],f=(0,t.useCallback)((function(e){var t=e.replace(/https?:\/\/(https?:\/\/)/,(function(e,t){return t})),n=WC(t),r=!0===n.isValid?n.hasProtocol?t:"https://"+t:"https://";d({actual:t,safe:r,valid:n.isValid})}),[]),p=(0,t.useCallback)((function(){var e=i.onlySelectedShape;e&&(i.updateShapes([{id:e.id,type:e.type,props:{url:""}}]),n())}),[i,n]),h=(0,t.useCallback)((function(){var e=i.onlySelectedShape;e&&(e&&"url"in e.props&&e.props.url!==c.safe&&i.updateShapes([{id:e.id,type:e.type,props:{url:c.safe}}]),n())}),[i,n,c]),v=(0,t.useCallback)((function(){n()}),[n]);if(!r)return n(),null;var g=s.current&&!c.valid;return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)(Hx,{children:[(0,La.jsx)(Yx,{children:o("edit-link-dialog.title")}),(0,La.jsx)(Xx,{})]}),(0,La.jsx)(qx,{children:(0,La.jsxs)("div",{className:"tlui-edit-link-dialog",children:[(0,La.jsx)(VC,{ref:a,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:c.actual,onValueChange:f,onComplete:h,onCancel:v}),(0,La.jsx)("div",{children:c.valid?o("edit-link-dialog.detail"):o("edit-link-dialog.invalid-url")})]})}),(0,La.jsxs)($x,{className:"tlui-dialog__footer__actions",children:[(0,La.jsx)(Wx,{onClick:v,onTouchEnd:v,children:o("edit-link-dialog.cancel")}),g?(0,La.jsx)(Wx,{type:"danger",onTouchEnd:p,onClick:p,children:o("edit-link-dialog.clear")}):(0,La.jsx)(Wx,{type:"primary",disabled:!c.valid,onTouchEnd:h,onClick:h,children:o("edit-link-dialog.save")})]})]})})),XC=ke((function(e){var n=e.onClose,r=Ka(),i=Lx(),o=Ex(),a=l((0,t.useState)(null),2),s=a[0],u=a[1],c=l((0,t.useState)(""),2),d=c[0],f=c[1],p=l((0,t.useState)(null),2),h=p[0],v=p[1],g=l((0,t.useState)(!1),2),m=g[0],y=g[1],b=(0,t.useRef)(-1);return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)(Hx,{children:[(0,La.jsx)(Yx,{children:s?"".concat(i("embed-dialog.title")," \u2014 ").concat(s.title):i("embed-dialog.title")}),(0,La.jsx)(Xx,{})]}),s?(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)(qx,{className:"tlui-embed-dialog__enter",children:[(0,La.jsx)(VC,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:function(e){f(e);var t=Nc(e);v(t&&t.definition.type===s.type?t:null),y(!1),clearTimeout(b.current),b.current=setTimeout((function(){return y(!t)}),320)}}),""===d?(0,La.jsxs)("div",{className:"tlui-embed-dialog__instruction",children:[(0,La.jsx)("span",{children:i("embed-dialog.instruction")})," ",s.instructionLink&&(0,La.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",href:s.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",(0,La.jsx)(Nx,{icon:"external-link",small:!0})]})]}):(0,La.jsx)("div",{className:"tlui-embed-dialog__warning",children:m?i("embed-dialog.invalid-url"):"\xa0"})]}),(0,La.jsxs)($x,{className:"tlui-dialog__footer__actions",children:[(0,La.jsx)(Wx,{onClick:function(){u(null),v(null),f("")},label:"embed-dialog.back"}),(0,La.jsx)("div",{className:"tlui-embed__spacer"}),(0,La.jsx)(Wx,{label:"embed-dialog.cancel",onClick:n}),(0,La.jsx)(Wx,{type:"primary",disabled:!h,label:"embed-dialog.create",onClick:function(){h&&(r.putExternalContent({type:"embed",url:d,point:r.viewportPageCenter,embed:h.definition}),n())}})]})]}):(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(qx,{className:"tlui-embed-dialog__list",children:zo.map((function(e){return(0,La.jsxs)("button",{className:"tlui-embed-dialog__item",onClick:function(){return u(e)},children:[(0,La.jsx)("div",{className:"tlui-embed-dialog__item__image",children:(0,La.jsx)("div",{className:"tlui-embed-dialog__item__image__img",style:{backgroundImage:"url(".concat(o.embedIcons[e.type],")")}})}),(0,La.jsx)("div",{className:"tlui-embed-dialog__item__title",children:e.title})]},e.type)}))}),(0,La.jsx)("div",{className:"tlui-dialog__scrim"})]})]})})),qC=n(4162);function $C(e,t,n){return GC.apply(this,arguments)}function GC(){return GC=Ba(Na().mark((function e(t,n,r){var i,o,a,s,u,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,M,j,A;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.elements,o=n.files,a={shapes:[],rootShapeIds:[],assets:[],schema:t.store.schema.serialize()},s=new Map,u=new Map,c=t.currentPageId,d=new Map,f=[],p=new Set,i.forEach((function(e){if(d.set(e.id,Vi()),null!==e.boundElements){var t,n=J(e.boundElements);try{for(n.s();!(t=n.n()).done;){var r=t.value;"text"===r.type&&p.add(r.id)}}catch(uD){n.e(uD)}finally{n.f()}}})),h="a1",v=J(i),e.prev=11,m=Na().mark((function e(){var t,n,r,v,m,y,b,w,x,k,S,_,P,E,C,M,j,A,O,L,z,D,N,R,B,F,U,K,V,W,H,Y,X,q,$,G,Q,Z,ee,te;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g.value,!p.has(t.id)){e.next=3;break}return e.abrupt("return","continue");case 3:n=d.get(t.id),r={id:n,typeName:"shape",parentId:c,index:h,x:t.x,y:t.y,rotation:0,isLocked:t.locked,opacity:QC(t.opacity),meta:{}},0!==t.angle&&u.set(n,t.angle),t.groupIds&&t.groupIds.length>0?s.has(t.groupIds[0])?null===(v=s.get(t.groupIds[0]))||void 0===v||v.push(n):s.set(t.groupIds[0],[n]):f.push(n),e.t0=t.type,e.next="rectangle"===e.t0||"ellipse"===e.t0||"diamond"===e.t0?10:"freedraw"===e.t0?32:"line"===e.t0?34:"arrow"===e.t0?39:"text"===e.t0?63:"image"===e.t0?66:72;break;case 10:if(w="",x="middle",null===t.boundElements){e.next=29;break}k=J(t.boundElements),e.prev=14,_=Na().mark((function e(){var t,n;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"text"===(t=S.value).type&&(n=i.find((function(e){return e.id===t.id})))&&(w=n.text,x=oI[n.textAlign]);case 2:case"end":return e.stop()}}),e)})),k.s();case 17:if((S=k.n()).done){e.next=21;break}return e.delegateYield(_(),"t1",19);case 19:e.next=17;break;case 21:e.next=26;break;case 23:e.prev=23,e.t2=e.catch(14),k.e(e.t2);case 26:return e.prev=26,k.f(),e.finish(26);case 29:return P="transparent"===t.backgroundColor?t.strokeColor:t.backgroundColor,a.shapes.push(Ce(Ce({},r),{},{type:"geo",props:{geo:t.type,url:null!==(m=t.link)&&void 0!==m?m:"",w:t.width,h:t.height,size:null!==(y=ZC[t.strokeWidth])&&void 0!==y?y:"draw",color:null!==(b=nI[P])&&void 0!==b?b:"black",text:w,align:x,dash:uI(t),fill:lI(t)}})),e.abrupt("break",72);case 32:return a.shapes.push(Ce(Ce({},r),{},{type:"draw",props:{dash:uI(t),size:ZC[t.strokeWidth],color:null!==(E=nI[t.strokeColor])&&void 0!==E?E:"black",segments:[{type:"free",points:t.points.map((function(e){var t=l(e,3),n=t[0],r=t[1],i=t[2];return{x:n,y:r,z:void 0===i?.5:i}}))}]}})),e.abrupt("break",72);case 34:return M=t.points[0],j=t.points[t.points.length-1],A=T(t.points.length),a.shapes.push(Ce(Ce({},r),{},{type:"line",props:{dash:uI(t),size:ZC[t.strokeWidth],color:null!==(C=nI[t.strokeColor])&&void 0!==C?C:"black",spline:t.roundness?"cubic":"line",handles:Ce({start:{id:"start",type:"vertex",index:A[0],x:M[0],y:M[1]},end:{id:"end",type:"vertex",index:A[A.length-1],x:j[0],y:j[1]}},Object.fromEntries(t.points.slice(1,-1).map((function(e,t){var n=l(e,2),r=n[0],i=n[1],o=ef();return[o,{id:o,type:"vertex",index:A[t+1],x:r,y:i}]}))))}})),e.abrupt("break",72);case 39:if(B="",null===t.boundElements){e.next=57;break}F=J(t.boundElements),e.prev=42,K=Na().mark((function e(){var t,n;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"text"===(t=U.value).type&&(n=i.find((function(e){return e.id===t.id})))&&(B=n.text);case 2:case"end":return e.stop()}}),e)})),F.s();case 45:if((U=F.n()).done){e.next=49;break}return e.delegateYield(K(),"t3",47);case 47:e.next=45;break;case 49:e.next=54;break;case 51:e.prev=51,e.t4=e.catch(42),F.e(e.t4);case 54:return e.prev=54,F.f(),e.finish(54);case 57:return V=t.points[0],W=t.points[t.points.length-1],H=d.get(null===(O=t.startBinding)||void 0===O?void 0:O.elementId),Y=d.get(null===(L=t.endBinding)||void 0===L?void 0:L.elementId),a.shapes.push(Ce(Ce({},r),{},{type:"arrow",props:{text:B,bend:sI(t,V,W),dash:uI(t),size:null!==(z=ZC[t.strokeWidth])&&void 0!==z?z:"m",color:null!==(D=nI[t.strokeColor])&&void 0!==D?D:"black",start:H?{type:"binding",boundShapeId:H,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:V[0],y:V[1]},end:Y?{type:"binding",boundShapeId:Y,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:W[0],y:W[1]},arrowheadEnd:null!==(N=aI[t.endArrowhead])&&void 0!==N?N:"none",arrowheadStart:null!==(R=aI[t.startArrowhead])&&void 0!==R?R:"none"}})),e.abrupt("break",72);case 63:return $=eI(t.fontSize),G=$.size,Q=$.scale,a.shapes.push(Ce(Ce({},r),{},{type:"text",props:{size:G,scale:Q,font:null!==(X=tI[t.fontFamily])&&void 0!==X?X:"draw",color:null!==(q=nI[t.strokeColor])&&void 0!==q?q:"black",text:t.text,align:oI[t.textAlign]}})),e.abrupt("break",72);case 66:if(ee=o[t.fileId]){e.next=69;break}return e.abrupt("break",72);case 69:te=Mi.createId(),a.assets.push({id:te,typeName:"asset",type:"image",props:{w:t.width,h:t.height,name:null!==(Z=t.id)&&void 0!==Z?Z:"Untitled",isAnimated:!1,mimeType:ee.mimeType,src:ee.dataURL},meta:{}}),a.shapes.push(Ce(Ce({},r),{},{type:"image",props:{w:t.width,h:t.height,assetId:te}}));case 72:h=I(h);case 73:case"end":return e.stop()}}),e,null,[[14,23,26,29],[42,51,54,57]])})),v.s();case 14:if((g=v.n()).done){e.next=21;break}return e.delegateYield(m(),"t0",16);case 16:if("continue"!==e.t0){e.next=19;break}return e.abrupt("continue",19);case 19:e.next=14;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(11),v.e(e.t1);case 26:return e.prev=26,v.f(),e.finish(26);case 29:y=null!==r&&void 0!==r?r:t.inputs.shiftKey?t.inputs.currentPagePoint:void 0,t.mark("paste"),t.putContent(a,{point:y,select:!1,preserveIds:!0}),b=J(s.values());try{for(b.s();!(w=b.n()).done;)(x=w.value).length>1&&(t.groupShapes(x),null!==(k=t.getShapeById(x[0]))&&void 0!==k&&k.parentId&&Ki(k.parentId)&&f.push(k.parentId))}catch(uD){b.e(uD)}finally{b.f()}S=J(u);try{for(S.s();!(_=S.n()).done;)P=l(_.value,2),E=P[0],C=P[1],t.select(E),t.rotateShapesBy([E],C)}catch(uD){S.e(uD)}finally{S.f()}M=Te(f.map((function(e){return t.getShapeById(e)}))),j=ws.Common(M.map((function(e){return t.getPageBounds(e)}))),A=t.viewportPageBounds.center,t.updateShapes(M.map((function(e){var t,n,r=(null!==(t=e.x)&&void 0!==t?t:0)-(j.x+j.w/2),i=(null!==(n=e.y)&&void 0!==n?n:0)-(j.y+j.h/2);return{id:e.id,type:e.type,x:A.x+r,y:A.y+i}}))),t.setSelectedIds(f);case 41:case"end":return e.stop()}}),e,null,[[11,23,26,29]])}))),GC.apply(this,arguments)}var QC=function(e){var t=e/100;return t<.2?.1:t<.4?.25:t<.6?.5:t<.8?.75:1},ZC={1:"s",2:"m",3:"l",4:"xl"},JC={16:"s",20:"m",28:"l",36:"xl"};function eI(e){var t=JC[e];return t?{size:t,scale:1}:e<16?{size:"s",scale:e/16}:e>36?{size:"xl",scale:e/36}:{size:"m",scale:1}}var tI={1:"draw",2:"sans",3:"mono"},nI={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},rI={solid:"draw",dashed:"dashed",dotted:"dotted"},iI={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},oI={left:"start",center:"middle",right:"end"},aI={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function sI(e,t,n){var r=0;if(e.points.length>2){var i=new Ya(t[0],t[1]),o=new Ya(n[0],n[1]),a=new Ya(e.points[1][0],e.points[1][1]),s=Ya.Sub(o,i),u=Ya.Per(s),l=Ya.Med(o,i),c=Ya.Sub(l,u),d=Ya.Add(l,u),f=Ya.NearestPointOnLineSegment(c,d,a,!1);r=Ya.Dist(f,l),Ya.Clockwise(f,o,l)&&(r*=-1)}return r}var uI=function(e){var t,n=null!==(t=rI[e.strokeStyle])&&void 0!==t?t:"draw";return"draw"===n&&0===e.roughness&&(n="solid"),n},lI=function(e){var t;return"transparent"===e.backgroundColor?"none":null!==(t=iI[e.fillStyle])&&void 0!==t?t:"solid"};function cI(e,t,n){return dI.apply(this,arguments)}function dI(){return dI=Ba(Na().mark((function e(t,n,r){var i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map(function(){var e=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.next=4,e.sent.blob();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return i=e.sent,o=i.map((function(e){return new File([e],"tldrawFile",{type:e.type})})),t.mark("paste"),e.next=7,t.putExternalContent({type:"files",files:o,point:r,ignoreParent:!1});case 7:n.forEach((function(e){return URL.revokeObjectURL(e)}));case 8:case"end":return e.stop()}}),e)}))),dI.apply(this,arguments)}function fI(e,t,n){var r=null!==n&&void 0!==n?n:e.inputs.shiftKey?e.inputs.currentPagePoint:void 0;e.mark("paste"),e.putContent(t,{point:r,select:!0})}function pI(e,t,n){return hI.apply(this,arguments)}function hI(){return(hI=Ba(Na().mark((function e(t,n,r){var i,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n);case 3:if(o=e.sent,null===(i=o.headers.get("content-type"))||void 0===i||!i.match(/^image\//)){e.next=8;break}return t.mark("paste"),cI(t,[n]),e.abrupt("return");case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),"Failed to fetch"!==e.t0.message&&console.error(e.t0);case 13:return t.mark("paste"),e.next=16,t.putExternalContent({type:"url",point:r,url:n});case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function vI(){var e=Ka();return _e("editor.isFocused",(function(){return e.isFocused}),[e])}var gI=["input","select","textarea"];function mI(e){var t=document.activeElement;return e.isMenuOpen||t&&(t.getAttribute("contenteditable")||gI.indexOf(t.tagName.toLowerCase())>-1)}function yI(e){return bI.apply(this,arguments)}function bI(){return(bI=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.addEventListener("loadend",(function(){var t=r.result;e(t)})),r.addEventListener("error",(function(){n(r.error)})),r.readAsText(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wI(e){var t=document.implementation.createHTMLDocument("");return t.documentElement.innerHTML=e.trim(),t.body.textContent||t.body.innerText||""}var xI=function(e){return e.types.find((function(e){return e.match(/^image\//)}))},kI=function(e,t,n){var r=function(e){var t,n=e.split(/[\n\s]/),r=J(n);try{for(r.s();!(t=r.n()).done;){var i=t.value;try{var o=new URL(i);if("http:"!==o.protocol&&"https:"!==o.protocol)return}catch(ok){return}}}catch(uD){r.e(uD)}finally{r.f()}return Sc(n)}(t);if(r){var i,o=J(r);try{for(o.s();!(i=o.n()).done;){pI(e,i.value,n)}}catch(uD){o.e(uD)}finally{o.f()}}else!function(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(ok){return!1}}(t)?/^<svg/.test(t)?(e.mark("paste"),e.putExternalContent({type:"svg-text",text:t,point:n})):(e.mark("paste"),e.putExternalContent({type:"text",text:t,point:n})):pI(e,t,n)},SI=function(){var e=Ba(Na().mark((function e(t,n,r){var i,o,a,s;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t.editingId){e.next=2;break}return e.abrupt("return");case 2:if(n){e.next=4;break}throw Error("No clipboard data");case 4:i=[],o=Na().mark((function e(){var t;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s[a],e.t0=t.kind,e.next="file"===e.t0?4:"string"===e.t0?6:8;break;case 4:return i.push({type:"file",source:new Promise((function(e){return e(t.getAsFile())}))}),e.abrupt("break",8);case 6:return"text/html"===t.type?i.push({type:"html",source:new Promise((function(e){return t.getAsString(e)}))}):"text/plain"===t.type?i.push({type:"text",source:new Promise((function(e){return t.getAsString(e)}))}):i.push({type:t.type,source:new Promise((function(e){return t.getAsString(e)}))}),e.abrupt("break",8);case 8:case"end":return e.stop()}}),e)})),a=0,s=Object.values(n.items);case 7:if(!(a<s.length)){e.next=12;break}return e.delegateYield(o(),"t0",9);case 9:a++,e.next=7;break;case 12:PI(t,i,r);case 13:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),_I=function(){var e=Ba(Na().mark((function e(t,n,r){var i,o,a,s;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],o=J(n),e.prev=2,s=Na().mark((function e(){var t,n,r,o;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.value,xI(t)){n=J(t.types);try{for(n.s();!(r=n.n()).done;)(o=r.value).match(/^image\//)&&i.push({type:"blob",source:t.getType(o)})}catch(uD){n.e(uD)}finally{n.f()}}t.types.includes("text/html")&&i.push({type:"html",source:new Promise((function(e){return t.getType("text/html").then((function(t){return yI(t).then(e)}))}))}),t.types.includes("text/uri-list")&&i.push({type:"url",source:new Promise((function(e){return t.getType("text/uri-list").then((function(t){return yI(t).then(e)}))}))}),t.types.includes("text/plain")&&i.push({type:"text",source:new Promise((function(e){return t.getType("text/plain").then((function(t){return yI(t).then(e)}))}))});case 5:case"end":return e.stop()}}),e)})),o.s();case 5:if((a=o.n()).done){e.next=9;break}return e.delegateYield(s(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),o.e(e.t1);case 14:return e.prev=14,o.f(),e.finish(14);case 17:return e.next=19,PI(t,i,r);case 19:return e.abrupt("return",e.sent);case 20:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})));return function(t,n,r){return e.apply(this,arguments)}}();function PI(e,t,n){return EI.apply(this,arguments)}function EI(){return EI=Ba(Na().mark((function e(t,n,r){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.filter((function(e){return("file"===e.type||"blob"===e.type)&&null!==e.source})),!i.length){e.next=9;break}return e.next=4,Promise.all(i.map((function(e){return e.source})));case 4:return o=e.sent,a=o.filter(Boolean).map((function(e){return URL.createObjectURL(e)})),e.next=8,cI(t,a,r);case 8:return e.abrupt("return",e.sent);case 9:return e.next=11,Promise.all(n.filter((function(e){return"file"!==e.type})).map((function(e){return new Promise((function(t){var n=e;"file"!==n.type?n.source.then((function(e){var r,i=null===(r=e.match(/<tldraw[^>]*>(.*)<\/tldraw>/))||void 0===r?void 0:r[1];if(i)try{var o=(0,qC.decompressFromBase64)(i);if(null===o)return void t({type:"error",data:o,reason:"found tldraw data comment but could not parse base64"});var a=JSON.parse(o);return"application/tldraw"!==a.type&&t({type:"error",data:a,reason:"found tldraw data comment but JSON was of a different type: ".concat(a.type)}),"string"===typeof a.data?void t({type:"error",data:a,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"}):void t({type:"tldraw",data:a.data})}catch(ok){return void t({type:"error",data:i,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"})}else{if("html"===n.type)return void t({type:"text",data:e,subtype:"html"});if("url"===n.type)return void t({type:"text",data:e,subtype:"url"});try{var s=JSON.parse(e);return"excalidraw/clipboard"===s.type?void t({type:"excalidraw",data:s}):void t({type:"text",data:e,subtype:"json"})}catch(ok){return void t({type:"text",data:e,subtype:"text"})}}t({type:"error",data:e,reason:"unhandled case"})})):t({type:"error",data:null,reason:"unexpected file"})}))})));case 11:s=e.sent,u=J(s),e.prev=13,u.s();case 15:if((l=u.n()).done){e.next=22;break}if("tldraw"!==(c=l.value).type){e.next=20;break}return fI(t,c.data,r),e.abrupt("return");case 20:e.next=15;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(13),u.e(e.t0);case 27:return e.prev=27,u.f(),e.finish(27);case 30:d=J(s),e.prev=31,d.s();case 33:if((f=d.n()).done){e.next=40;break}if("excalidraw"!==(p=f.value).type){e.next=38;break}return $C(t,p.data,r),e.abrupt("return");case 38:e.next=33;break;case 40:e.next=45;break;case 42:e.prev=42,e.t1=e.catch(31),d.e(e.t1);case 45:return e.prev=45,d.f(),e.finish(45);case 48:h=J(s),e.prev=49,h.s();case 51:if((v=h.n()).done){e.next=66;break}if("text"!==(g=v.value).type||"html"!==g.subtype){e.next=64;break}if(m=(new DOMParser).parseFromString(g.data,"text/html"),y=m.querySelector("body"),!(y&&1===Array.from(y.children).filter((function(e){return 1===e.nodeType})).length&&y.firstElementChild&&"A"===y.firstElementChild.tagName&&y.firstElementChild.hasAttribute("href")&&""!==y.firstElementChild.getAttribute("href"))){e.next=61;break}return b=y.firstElementChild.getAttribute("href"),kI(t,b,r),e.abrupt("return");case 61:if(s.some((function(e){return"text"===e.type&&"html"!==e.subtype}))||!g.data.trim()){e.next=64;break}return kI(t,wI(g.data),r),e.abrupt("return");case 64:e.next=51;break;case 66:e.next=71;break;case 68:e.prev=68,e.t2=e.catch(49),h.e(e.t2);case 71:return e.prev=71,h.f(),e.finish(71);case 74:w=J(s),e.prev=75,w.s();case 77:if((x=w.n()).done){e.next=84;break}if("text"!==(k=x.value).type||"url"!==k.subtype){e.next=82;break}return pI(t,k.data,r),e.abrupt("return");case 82:e.next=77;break;case 84:e.next=89;break;case 86:e.prev=86,e.t3=e.catch(75),w.e(e.t3);case 89:return e.prev=89,w.f(),e.finish(89);case 92:S=J(s),e.prev=93,S.s();case 95:if((_=S.n()).done){e.next=102;break}if("text"!==(P=_.value).type||"text"!==P.subtype||!P.data.trim()){e.next=100;break}return kI(t,P.data,r),e.abrupt("return");case 100:e.next=95;break;case 102:e.next=107;break;case 104:e.prev=104,e.t4=e.catch(93),S.e(e.t4);case 107:return e.prev=107,S.f(),e.finish(107);case 110:case"end":return e.stop()}}),e,null,[[13,24,27,30],[31,42,45,48],[49,68,71,74],[75,86,89,92],[93,104,107,110]])}))),EI.apply(this,arguments)}var CI=function(e){var t=e.getContent();if(t){var n=(0,qC.compressToBase64)(JSON.stringify({type:"application/tldraw",kind:"content",data:t}));if("undefined"!==typeof navigator){var r,i=t.shapes.map((function(t){return e.isShapeOfType(t,pd)||e.isShapeOfType(t,dh)||e.isShapeOfType(t,tp)?t.props.text:e.isShapeOfType(t,dp)||e.isShapeOfType(t,Uc)?t.props.url:null})).filter(rt);if(null!==(r=navigator.clipboard)&&void 0!==r&&r.write){var o=new Blob(["<tldraw>".concat(n,"</tldraw>")],{type:"text/html"}),a=i.join(" ");""===a&&(a=" "),navigator.clipboard.write([new ClipboardItem({"text/html":o,"text/plain":new Blob([a],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText("<tldraw>".concat(n,"</tldraw>"))}}else navigator&&navigator.clipboard&&navigator.clipboard.writeText("")};var II=(0,t.createContext)({});function TI(e){var n=e.children,r=l((0,t.useState)([]),2),i=r[0],o=r[1],a=(0,t.useCallback)((function(e){var t,n=null!==(t=e.id)&&void 0!==t?t:ef();return o((function(t){return[].concat(d(t.filter((function(t){return t.id!==e.id}))),[Ce(Ce({},e),{},{id:n})])})),n}),[]),s=(0,t.useCallback)((function(e){return o((function(t){return t.filter((function(t){return t.id!==e}))})),e}),[]),u=(0,t.useCallback)((function(){o((function(){return[]}))}),[]);return(0,La.jsx)(II.Provider,{value:{toasts:i,addToast:a,removeToast:s,clearToasts:u},children:n})}function MI(){var e=(0,t.useContext)(II);if(!e)throw new Error("useToasts must be used within a ToastsProvider");return e}function jI(){var e=Ka(),n=MI().addToast,r=Lx();return(0,t.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selectedIds,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"svg";if(0===t.length&&(t=d(e.currentPageShapeIds)),0!==t.length)switch(i){case"svg":window.navigator.clipboard&&(window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":LI(e,t)})]):NI(Ba(Na().mark((function n(){return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=Fy,n.next=3,AI(e,t);case 3:return n.t1=n.sent,n.abrupt("return",(0,n.t0)(n.t1));case 5:case"end":return n.stop()}}),n)})))));break;case"jpeg":case"png":var o="jpeg"===i?"image/jpeg":"image/png",a=function(e,t,n){return DI.apply(this,arguments)}(e,t,i).then((function(e){if(e){if(window.navigator.clipboard)return e;throw new Error("Copy not supported")}throw n({id:"copy-fail",icon:"warning-triangle",title:r("toast.error.copy-fail.title"),description:r("toast.error.copy-fail.desc")}),new Error("Copy not possible")}));window.navigator.clipboard.write([new ClipboardItem(D({},o,a))]).catch((function(e){e.toString().match(/^TypeError: DOMString not supported/)||console.error(e),a.then((function(e){window.navigator.clipboard.write([new ClipboardItem(D({},o,e))])}))}));break;case"json":var s=e.getContent(t);if(window.navigator.clipboard){var u=JSON.stringify(s);window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([u],{type:"text/plain"})})]):NI(Ba(Na().mark((function e(){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u);case 1:case"end":return e.stop()}}),e)}))))}break;default:throw new Error("Copy type ".concat(i," not supported."))}}),[e,n,r])}function AI(e,t){return OI.apply(this,arguments)}function OI(){return(OI=Ba(Na().mark((function e(t,n){var r;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getSvg(n,{scale:1,background:t.instanceState.exportBackground});case 2:if(r=e.sent){e.next=5;break}throw new Error("Could not construct SVG.");case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function LI(e,t){return zI.apply(this,arguments)}function zI(){return(zI=Ba(Na().mark((function e(t,n){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Blob,e.t1=Fy,e.next=4,AI(t,n);case 4:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=[e.t3],e.t5={type:"text/plain"},e.abrupt("return",new e.t0(e.t4,e.t5));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function DI(){return(DI=Ba(Na().mark((function e(t,n,r){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Uy,e.next=3,AI(t,n);case 3:return e.t1=e.sent,e.t2={type:r,quality:1,scale:2},e.next=7,(0,e.t0)(e.t1,e.t2);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function NI(e){return RI.apply(this,arguments)}function RI(){return(RI=Ba(Na().mark((function e(t){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator&&navigator.clipboard){e.next=2;break}return e.abrupt("return");case 2:return e.t0=navigator.clipboard,e.next=5,t();case 5:e.t1=e.sent,e.t0.writeText.call(e.t0,e.t1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var BI=(0,t.createContext)({});function FI(e){var n=e.children,r=Ka(),i=IE(),o=l((0,t.useState)([]),2),a=o[0],s=o[1],u=(0,t.useCallback)((function(e){var t,n=null!==(t=e.id)&&void 0!==t?t:ef();return s((function(t){return[].concat(d(t.filter((function(t){return t.id!==e.id}))),[Ce(Ce({},e),{},{id:n})])})),i("open-menu",{source:"dialog",id:n}),r.addOpenMenu(n),n}),[r,i]),c=(0,t.useCallback)((function(e,t){return s((function(n){return n.map((function(n){return n.id===e?Ce(Ce({},n),t):n}))})),i("open-menu",{source:"dialog",id:e}),r.addOpenMenu(e),e}),[r,i]),f=(0,t.useCallback)((function(e){return s((function(t){return t.filter((function(t){var n;return t.id!==e||(null===(n=t.onClose)||void 0===n||n.call(t),!1)}))})),i("close-menu",{source:"dialog",id:e}),r.deleteOpenMenu(e),e}),[r,i]),p=(0,t.useCallback)((function(){s((function(e){return e.forEach((function(e){var t;null===(t=e.onClose)||void 0===t||t.call(e),i("close-menu",{source:"dialog",id:e.id}),r.deleteOpenMenu(e.id)})),[]}))}),[r,i]);return(0,La.jsx)(BI.Provider,{value:{dialogs:a,addDialog:u,removeDialog:f,clearDialogs:p,updateDialog:c},children:n})}function UI(){var e=(0,t.useContext)(BI);if(!e)throw new Error("useDialogs must be used within a DialogsProvider");return e}function KI(){var e=Ka(),n=(0,t.useRef)();return(0,t.useEffect)((function(){var t=window.document.createElement("input");function r(e){return i.apply(this,arguments)}function i(){return i=Ba(Na().mark((function n(r){var i;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((i=r.target.files)&&0!==i.length){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,e.putExternalContent({type:"files",files:Array.from(i),point:e.viewportPageBounds.center,ignoreParent:!1});case 5:t.value="";case 6:case"end":return n.stop()}}),n)}))),i.apply(this,arguments)}return t.type="file",t.accept=kv,t.multiple=!0,n.current=t,t.addEventListener("change",r),function(){n.current=void 0,t.removeEventListener("change",r)}}),[e]),(0,t.useCallback)((function(){var e;null===(e=n.current)||void 0===e||e.click()}),[n])}var VI=t.createContext({});function WI(e){var n=e.overrides,r=e.children,i=Ka(),o=UI(),a=o.addDialog,s=o.clearDialogs,u=MI().clearToasts,l=KI(),c=function(){var e=Ka(),n=(0,t.useRef)(null),r=(0,t.useRef)(null);return(0,t.useCallback)(function(){var t=Ba(Na().mark((function t(){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f=function(){e.isChromeForIos?(l(),window.print()):e.isSafari?(l(),document.execCommand("print",!1)):window.print()},d=function(e,t,n){try{i.innerHTML+='<div class="'.concat(s,'__item">\n        <div class="').concat(s,'__item__header">\n          ').concat(e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),'\n        </div>\n        <div class="').concat(s,'__item__main">\n          ').concat(n.outerHTML,'\n        </div>\n        <div class="').concat(s,"__item__footer ").concat(s,"__item__footer__").concat(t?"":"hide",'">\n          ').concat(null!==t&&void 0!==t?t:"","\n        </div>\n      </div>")}catch(ok){console.error(ok)}},i=document.createElement("div"),o=document.createElement("style"),(a=function(e,t){e&&(e.innerHTML=""),t&&document.head.contains(t)&&document.head.removeChild(t),e&&document.body.contains(e)&&document.body.removeChild(e)})(n.current,r.current),n.current=i,r.current=o,s="tl-print-surface-".concat(ef()),i.className=s,u=!1,o.innerHTML="\n\t\t\t.".concat(s," {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\n\t\t\t.").concat(s," svg {\n\t\t\t\tmax-width: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: block;\n\t\t\t}\n\n\t\t\t@media print {\t\t\t\t  \n\t\t\t\thtml, body {\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tmargin: 0;\n\t\t\t\t}\n\n\t\t\t\tbody {\n\t\t\t\t\tposition: relative;\n\t\t\t\t}\n\n\t\t\t\tbody > * {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s," {\n\t\t\t\t\tdisplay: block !important;\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item {\n\t\t\t\t\tpadding: 10mm;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\tpage-break-after: always;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\theight: 100%;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item__main {\n\t\t\t\t\tflex: 1;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tmax-height: 100%;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item__header {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item__footer {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t\ttext-align: right;\n\t\t\t\t}\n\n\t\t\t\t.").concat(s,"__item__footer__hide {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t").concat("","\n\t\t\t}\n\n\t\t"),l=function(){document.head.appendChild(o),document.body.appendChild(i)},c=function(){e.once("change-history",(function(){a(i,o)}))},window.addEventListener("beforeprint",l),window.addEventListener("afterprint",c),p=e.pages,h=e.currentPageId,v=e.selectedIds,g={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"},!(e.selectedIds.length>0)){t.next=27;break}return t.next=23,e.getSvg(v,g);case 23:(m=t.sent)&&(y=p.find((function(e){return e.id===h})),d("tldraw \u2014 ".concat(null===y||void 0===y?void 0:y.name),null,m),f()),t.next=46;break;case 27:if(!u){t.next=41;break}b=0;case 29:if(!(b<p.length)){t.next=38;break}return w=p[b],t.next=33,e.getSvg(e.getSortedChildIds(w.id),g);case 33:(x=t.sent)&&d("tldraw \u2014 ".concat(w.name),"".concat(b,"/").concat(p.length),x);case 35:b++,t.next=29;break;case 38:f(),t.next=46;break;case 41:return k=e.currentPage,t.next=44,e.getSvg(e.getSortedChildIds(k.id),g);case 44:(S=t.sent)&&(d("tldraw \u2014 ".concat(k.name),null,S),f());case 46:window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",c);case 48:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),[e])}(),f=function(){var e=Ka(),n=IE(),r=(0,t.useCallback)((function(t){0!==e.selectedIds.length&&(CI(e),n("copy",{source:t}))}),[e,n]),i=(0,t.useCallback)((function(t){0!==e.selectedIds.length&&(CI(e),e.deleteShapes(),n("cut",{source:t}))}),[e,n]),o=(0,t.useCallback)(function(){var t=Ba(Na().mark((function t(r,i,a){return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.editingId&&!mI(e)){t.next=2;break}return t.abrupt("return");case 2:Array.isArray(r)&&r[0]instanceof ClipboardItem?(_I(e,r,a),n("paste",{source:"menu"})):navigator.clipboard.read().then((function(e){o(e,i,a)}));case 3:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),[e,n]);return{copy:r,cut:i,paste:o}}(),p=f.cut,h=f.copy,v=f.paste,g=jI(),m=function(){var e=Ka(),n=MI().addToast,r=Lx();return(0,t.useCallback)(function(){var t=Ba(Na().mark((function t(){var i,o,a,s,u,l,c,f,p,h,v=arguments;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=v.length>0&&void 0!==v[0]?v[0]:e.selectedIds,o=v.length>1&&void 0!==v[1]?v[1]:"png",0===i.length&&(i=d(e.currentPageShapeIds)),0!==i.length){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.getSvg(i,{scale:1,background:e.instanceState.exportBackground});case 7:if(a=t.sent){t.next=10;break}throw new Error("Could not construct SVG.");case 10:s="shapes",1===i.length&&(u=e.getShapeById(i[0]),s=e.isShapeOfType(u,Wp)?null!==(l=u.props.name)&&void 0!==l?l:"frame":u.id.replace(/:/,"_")),t.t0=o,t.next="svg"===t.t0?15:"webp"===t.t0||"png"===t.t0?20:"json"===t.t0?30:35;break;case 15:return t.next=17,Vy(a);case 17:return Yy(t.sent,"".concat(s||"shapes",".svg")),t.abrupt("return");case 20:return t.next=22,Uy(a,{type:o,quality:1,scale:2});case 22:if(c=t.sent){t.next=26;break}return n({id:"export-fail",title:r("toast.error.export-fail.title"),description:r("toast.error.export-fail.desc")}),t.abrupt("return");case 26:return Yy(f=URL.createObjectURL(c),"".concat(s||"shapes",".").concat(o)),URL.revokeObjectURL(f),t.abrupt("return");case 30:return p=e.getContent(i),Yy(h=URL.createObjectURL(new Blob([JSON.stringify(p,null,4)],{type:"application/json"})),"".concat(s||"shapes",".json")),URL.revokeObjectURL(h),t.abrupt("return");case 35:throw new Error("Export type ".concat(o," not supported."));case 36:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),[e,n,r])}(),y=IE(),b=t.useMemo((function(){var e=function(e){return Object.fromEntries(e.map((function(e){return[e.id,e]})))}([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect:function(e){y("edit-link",{source:e}),i.mark("edit-link"),a({component:HC})}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect:function(e){y("insert-embed",{source:e}),a({component:XC})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect:function(e){y("insert-media",{source:e}),l()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect:function(e){y("undo",{source:e}),i.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect:function(e){y("redo",{source:e}),i.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect:function(e){y("export-as",{format:"svg",source:e}),m(i.selectedIds,"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect:function(e){y("export-as",{format:"png",source:e}),m(i.selectedIds,"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect:function(e){y("export-as",{format:"json",source:e}),m(i.selectedIds,"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect:function(e){y("copy-as",{format:"svg",source:e}),g(i.selectedIds,"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect:function(e){y("copy-as",{format:"png",source:e}),g(i.selectedIds,"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect:function(e){y("copy-as",{format:"json",source:e}),g(i.selectedIds,"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect:function(e){y("toggle-auto-size",{source:e}),i.mark(),i.updateShapes(i.selectedShapes.filter((function(e){return i.isShapeOfType(e,pd)&&!1===e.props.autoSize})).map((function(e){return{id:e.id,type:e.type,props:Ce(Ce({},e.props),{},{w:8,autoSize:!0})}})))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect:function(e){y("open-embed-link",{source:e});var t=i.selectedIds,n="No embed shapes selected";if(1===t.length){var r=i.getShapeById(t[0]);r&&i.isShapeOfType(r,Uc)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank";Va.openWindow(e,t)}(r.props.url,"_blank"):console.error(n)}else console.error(n)}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect:function(e){y("convert-to-bookmark",{source:e});var t,n=[],r=[],o=J(i.selectedShapes);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a&&i.isShapeOfType(a,Uc)&&a.props.url){var s=new Ya(a.x,a.y);s.rot(-a.rotation),s.add(new Ya(a.props.w/2-150,a.props.h/2-160)),s.rot(a.rotation),n.push({id:Vi(),type:"bookmark",rotation:a.rotation,x:s.x,y:s.y,props:{url:a.props.url,opacity:"1"}}),r.push(a.id)}}}catch(uD){o.e(uD)}finally{o.f()}i.mark("convert shapes to bookmark"),i.deleteShapes(r),i.createShapes(n)}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect:function(e){y("convert-to-embed",{source:e});var t,n=[],r=[],o=J(Te(i.selectedIds.map((function(e){return i.getShapeById(e)}))));try{for(o.s();!(t=o.n()).done;){var a=t.value;if(i.isShapeOfType(a,dp)){var s=a.props.url,u=Nc(a.props.url);if(u&&u.definition){var l=u.definition,c=l.width,d=l.height,f=new Ya(a.x,a.y);f.rot(-a.rotation),f.add(new Ya(a.props.w/2-c/2,a.props.h/2-d/2)),f.rot(a.rotation);var p={id:Vi(),type:"embed",x:f.x,y:f.y,rotation:a.rotation,props:{url:s,w:c,h:d}};n.push(p),r.push(a.id)}}}}catch(uD){o.e(uD)}finally{o.f()}i.mark("convert shapes to embed"),i.deleteShapes(r),i.createShapes(n)}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect:function(e){if("select"===i.currentToolId){y("duplicate-shapes",{source:e});var t=i.selectedIds,n=ws.Common(Te(t.map((function(e){return i.getPageBoundsById(e)})))),r=i.canMoveCamera?{x:n.width+10,y:0}:{x:16/i.zoomLevel,y:16/i.zoomLevel};i.mark("duplicate shapes"),i.duplicateShapes(t,r)}}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect:function(e){y("ungroup-shapes",{source:e}),i.mark("ungroup"),i.ungroupShapes(i.selectedIds)}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect:function(e){y("group-shapes",{source:e});var t=i.onlySelectedShape;t&&i.isShapeOfType(t,Up)?(i.mark("ungroup"),i.ungroupShapes(i.selectedIds)):(i.mark("group"),i.groupShapes(i.selectedIds))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"left",source:e}),i.mark("align left"),i.alignShapes("left",i.selectedIds)}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"center-horizontal",source:e}),i.mark("align center horizontal"),i.alignShapes("center-horizontal",i.selectedIds)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"right",source:e}),i.mark("align right"),i.alignShapes("right",i.selectedIds)}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"center-vertical",source:e}),i.mark("align center vertical"),i.alignShapes("center-vertical",i.selectedIds)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"top",source:e}),i.mark("align top"),i.alignShapes("top",i.selectedIds)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect:function(e){y("align-shapes",{operation:"bottom",source:e}),i.mark("align bottom"),i.alignShapes("bottom",i.selectedIds)}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect:function(e){y("distribute-shapes",{operation:"horizontal",source:e}),i.mark("distribute horizontal"),i.distributeShapes("horizontal",i.selectedIds)}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect:function(e){y("distribute-shapes",{operation:"vertical",source:e}),i.mark("distribute vertical"),i.distributeShapes("vertical",i.selectedIds)}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect:function(e){y("stretch-shapes",{operation:"horizontal",source:e}),i.mark("stretch horizontal"),i.stretchShapes("horizontal",i.selectedIds)}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect:function(e){y("stretch-shapes",{operation:"vertical",source:e}),i.mark("stretch vertical"),i.stretchShapes("vertical",i.selectedIds)}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect:function(e){y("flip-shapes",{operation:"horizontal",source:e}),i.mark("flip horizontal"),i.flipShapes("horizontal",i.selectedIds)}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect:function(e){y("flip-shapes",{operation:"vertical",source:e}),i.mark("flip vertical"),i.flipShapes("vertical",i.selectedIds)}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect:function(e){y("pack-shapes",{source:e}),i.mark("pack"),i.packShapes(i.selectedIds)}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect:function(e){y("stack-shapes",{operation:"vertical",source:e}),i.mark("stack-vertical"),i.stackShapes("vertical",i.selectedIds)}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect:function(e){y("stack-shapes",{operation:"horizontal",source:e}),i.mark("stack-horizontal"),i.stackShapes("horizontal",i.selectedIds)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect:function(e){y("reorder-shapes",{operation:"toFront",source:e}),i.mark("bring to front"),i.bringToFront()}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect:function(e){y("reorder-shapes",{operation:"forward",source:e}),i.mark("bring forward"),i.bringForward()}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect:function(e){y("reorder-shapes",{operation:"backward",source:e}),i.mark("send backward"),i.sendBackward()}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect:function(e){y("reorder-shapes",{operation:"toBack",source:e}),i.mark("send to back"),i.sendToBack()}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect:function(e){i.mark("cut"),p(e)}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect:function(e){h(e)}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect:function(e){var t;null===(t=navigator.clipboard)||void 0===t||t.read().then((function(t){v(t,e,"context-menu"===e?i.inputs.currentPagePoint:void 0)}))}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect:function(e){y("select-all-shapes",{source:e}),"select"!==i.currentToolId&&(i.cancel(),i.setSelectedTool("select")),i.mark("select all kbd"),i.selectAll()}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect:function(e){y("select-none-shapes",{source:e}),i.mark("select none"),i.selectNone()}},{id:"delete",label:"action.delete",kbd:"\u232b,del,backspace",icon:"trash",readonlyOk:!1,onSelect:function(e){"select"===i.currentToolId&&(y("delete-shapes",{source:e}),i.mark("delete"),i.deleteShapes())}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect:function(e){if(0!==i.selectedIds.length){y("rotate-cw",{source:e}),i.mark("rotate-cw");var t=i.selectionRotation%($a/2),n=ts(t,0)||ts(t,$a/2);i.rotateShapesBy(i.selectedIds,$a/2-(n?0:t))}}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect:function(e){if(0!==i.selectedIds.length){y("rotate-ccw",{source:e}),i.mark("rotate-ccw");var t=i.selectionRotation%($a/2),n=ts(t,0);i.rotateShapesBy(i.selectedIds,n?-$a/2:-t)}}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect:function(e){y("zoom-in",{source:e}),i.zoomIn(i.viewportScreenCenter,{duration:Tu})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect:function(e){y("zoom-out",{source:e}),i.zoomOut(i.viewportScreenCenter,{duration:Tu})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect:function(e){y("reset-zoom",{source:e}),i.resetZoom(i.viewportScreenCenter,{duration:Tu})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect:function(e){y("zoom-to-fit",{source:e}),i.zoomToFit({duration:Tu})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect:function(e){y("zoom-to-selection",{source:e}),i.zoomToSelection({duration:Tu})}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect:function(e){y("toggle-snap-mode",{source:e}),i.setSnapMode(!i.isSnapMode)},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect:function(e){y("toggle-dark-mode",{source:e}),i.setDarkMode(!i.isDarkMode)},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect:function(e){y("toggle-reduce-motion",{source:e}),i.setAnimationSpeed(0===i.animationSpeed?1:0)},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect:function(e){y("toggle-transparent",{source:e}),i.updateInstanceState({exportBackground:!i.instanceState.exportBackground},!0)},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect:function(e){y("toggle-tool-lock",{source:e}),i.setToolLocked(!i.isToolLocked)},checkbox:!0},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect:function(e){requestAnimationFrame((function(){i.batch((function(){y("toggle-focus-mode",{source:e}),s(),u(),i.setFocusMode(!i.isFocusMode)}))}))}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect:function(e){y("toggle-grid-mode",{source:e}),i.setGridMode(!i.isGridMode)},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect:function(e){y("toggle-debug-mode",{source:e}),i.updateInstanceState({isDebugMode:!i.instanceState.isDebugMode},!0)},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect:function(e){y("print",{source:e}),c()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect:function(e){y("exit-pen-mode",{source:e}),i.setPenMode(!1)}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect:function(e){y("stop-following",{source:e}),i.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect:function(e){y("zoom-to-content",{source:e}),i.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!l",onSelect:function(e){y("toggle-lock",{source:e}),i.toggleLock()}}]);return n?n(i,e,void 0):e}),[y,n,i,a,l,m,g,p,h,v,s,u,c]);return(0,La.jsx)(VI.Provider,{value:b,children:r})}function HI(){var e=t.useContext(VI);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}function YI(e){return e.filter((function(e){return void 0!==e&&null!==e&&!1!==e}))}function XI(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=YI(n);return 0===i.length?null:{id:e,type:"group",checkbox:i.every((function(e){return"item"===e.type&&e.actionItem.checkbox})),disabled:i.every((function(e){return e.disabled})),readonlyOk:i.some((function(e){return e.readonlyOk})),children:i}}function qI(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=YI(r);return 0===o.length?null:{id:e,type:"submenu",label:t,children:o,disabled:o.every((function(e){return e.disabled})),readonlyOk:o.some((function(e){return e.readonlyOk}))}}function $I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.readonlyOk,r=void 0===n||n,i=t.disabled;return{id:e,type:"custom",disabled:void 0!==i&&i,readonlyOk:r}}function GI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw Error("No action item provided to menuItem");if(!e.label)throw Error("Trying to create menu item for action item that doesn't have a label");var n=t.checked,r=void 0!==n&&n,i=t.disabled,o=void 0!==i&&i;return{id:e.id,type:"item",actionItem:e,disabled:o,checked:r,readonlyOk:e.readonlyOk}}function QI(e){return e.selectedIds.map((function(t){return e.getShapeById(t)})).filter((function(t){return!!t&&((!e.isShapeOfType(t,tp)||"binding"!==t.props.start.type)&&(!e.isShapeOfType(t,tp)||"binding"!==t.props.end.type))}))}var ZI=function(){var e=Ka();return _e("threeStackableItems",(function(){return QI(e).length>2}),[e])},JI=function(){var e=Ka();return _e("allowGroup",(function(){return QI(e).length>1}),[e])},eT=function(){var e=Ka();return _e("allowUngroup",(function(){return e.selectedIds.some((function(t){var n;return"group"===(null===(n=e.getShapeById(t))||void 0===n?void 0:n.type)}))}),[])};var tT="undefined"!==typeof window&&"navigator"in window&&Boolean(navigator.clipboard)&&Boolean(navigator.clipboard.read),nT=[0,380,420,460,580,640,840,1023],rT=t.createContext(0);function iT(e){var t=e.children,n=Ka(),r=_e("breakpoint",(function(){for(var e=n.viewportScreenBounds.width,t=nT,r=0;r<t.length-1;r++)if(e>t[r]&&e<=t[r+1])return r;return t.length}),[n]);return(0,La.jsx)(rT.Provider,{value:r,children:t})}function oT(){var e=(0,t.useContext)(rT),n=new URL(window.location.href).searchParams.get("layout");return"desktop"===n?e=7:"mobile"===n&&(e=1),e}function aT(){var e=Ka();return _e("hasLinkShapeSelected",(function(){var t=e.selectedShapes;return 1===t.length&&"url"in t[0].props&&"embed"!==t[0].type}),[e])}var sT=t.createContext({}),uT=ke((function(e){var n=e.overrides,r=e.children,i=Ka(),o=HI(),a=i.selectedIds.length,s=a>0,u=a>1,l=a>2,c=ZI(),d=JI(),f=eT(),p=aT(),h=oT(),v=1===i.zoomLevel,g=(0,t.useMemo)((function(){var e=[GI(o["align-left"],{disabled:!u}),GI(o["align-center-horizontal"],{disabled:!u}),GI(o["align-right"],{disabled:!u}),GI(o["stretch-horizontal"],{disabled:!u}),GI(o["align-top"],{disabled:!u}),GI(o["align-center-vertical"],{disabled:!u}),GI(o["align-bottom"],{disabled:!u}),GI(o["stretch-vertical"],{disabled:!u}),GI(o["distribute-horizontal"],{disabled:!l}),GI(o["distribute-vertical"],{disabled:!l}),GI(o["stack-horizontal"],{disabled:!c}),GI(o["stack-vertical"],{disabled:!c}),GI(o["send-to-back"],{disabled:!s}),GI(o["send-backward"],{disabled:!s}),GI(o["bring-forward"],{disabled:!s}),GI(o["bring-to-front"],{disabled:!s}),h<5?GI(o["zoom-to-100"],{disabled:!!v}):GI(o["rotate-ccw"],{disabled:!s}),GI(o["rotate-cw"],{disabled:!s}),GI(o["edit-link"],{disabled:!p}),d?GI(o.group,{disabled:!u}):f?GI(o.ungroup):GI(o.group,{disabled:!u})];return n?n(i,e,{actions:o,oneSelected:s,twoSelected:u,threeSelected:l}):e}),[i,v,d,n,o,s,u,l,c,f,p,h]);return(0,La.jsx)(sT.Provider,{value:g,children:r})}));function lT(){var e=Ka();return _e("showAutoSizeToggle",(function(){var t=e.selectedShapes;return 1===t.length&&e.isShapeOfType(t[0],pd)&&!1===t[0].props.autoSize}),[e])}var cT=t.createContext({}),dT=ke((function(e){var n,r=e.overrides,i=e.children,o=Ka(),a=HI(),s=lT(),u=function(){var e=Ka();return _e("onlyFlippableShape",(function(){var t=e.selectedShapes;return 1===t.length&&t.every((function(t){return e.isShapeOfType(t,Up)||e.isShapeOfType(t,tp)||e.isShapeOfType(t,Dh)||e.isShapeOfType(t,Sp)}))}),[e])}(),l=o.selectedIds.length,c=l>0,d=_e("oneEmbedSelected",(function(){return 1===o.selectedIds.length&&o.selectedIds.some((function(e){var t=o.getShapeById(e);return t&&o.isShapeOfType(t,Uc)&&t.props.url}))}),[]),f=_e("oneEmbeddableBookmarkSelected",(function(){return 1===o.selectedIds.length&&o.selectedIds.some((function(e){var t=o.getShapeById(e);return t&&o.isShapeOfType(t,dp)&&t.props.url&&Nc(t.props.url)}))}),[]),p=l>1,h=l>2,v=ZI(),g=_e("atLeastOneShapeOnPage",(function(){return o.currentPageShapeIds.size>0}),[]),m=_e("isTransparentBg",(function(){return o.instanceState.exportBackground}),[]),y=JI(),b=eT(),w=Boolean(null===(n=window.navigator.clipboard)||void 0===n?void 0:n.write),x=aT(),k=o.onlySelectedShape,S=k&&o.isShapeOrAncestorLocked(k),_=(0,t.useMemo)((function(){var e=YI([XI("selection",d&&GI(a["open-embed-link"]),d&&!S&&GI(a["convert-to-bookmark"]),f&&GI(a["convert-to-embed"]),s&&GI(a["toggle-auto-size"]),x&&!S&&GI(a["edit-link"]),c&&!S&&GI(a.duplicate),y&&!S&&GI(a.group),b&&!S&&GI(a.ungroup),c&&GI(a["toggle-lock"])),XI("modify",(p||u)&&qI("arrange","context-menu.arrange",p&&XI("align",GI(a["align-left"]),GI(a["align-center-horizontal"]),GI(a["align-right"]),GI(a["align-top"]),GI(a["align-center-vertical"]),GI(a["align-bottom"])),h&&XI("distribute",GI(a["distribute-horizontal"]),GI(a["distribute-vertical"])),p&&XI("stretch",GI(a["stretch-horizontal"]),GI(a["stretch-vertical"])),u&&!S&&XI("flip",GI(a["flip-horizontal"]),GI(a["flip-vertical"])),p&&XI("order",GI(a.pack,{disabled:!p}),v&&GI(a["stack-vertical"]),v&&GI(a["stack-horizontal"]))),c&&!S&&qI("reorder","context-menu.reorder",XI("reorder",GI(a["bring-to-front"]),GI(a["bring-forward"]),GI(a["send-backward"]),GI(a["send-to-back"]))),c&&!S&&$I("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),XI("clipboard-group",c&&!S&&GI(a.cut),c&&GI(a.copy),tT&&GI(a.paste)),g&&XI("conversions",qI("copy-as","context-menu.copy-as",XI("copy-as-group",GI(a["copy-as-svg"]),w&&GI(a["copy-as-png"]),GI(a["copy-as-json"])),XI("export-bg",GI(a["toggle-transparent"],{checked:!m}))),qI("export-as","context-menu.export-as",XI("export-as-group",GI(a["export-as-svg"]),GI(a["export-as-png"]),GI(a["export-as-json"])),XI("export-bg,",GI(a["toggle-transparent"],{checked:!m})))),g&&XI("set-selection-group",GI(a["select-all"]),c&&GI(a["select-none"])),c&&!S&&XI("delete-group",GI(a.delete))]);return r&&(e=r(o,e,{actions:a,oneSelected:c,twoSelected:p,threeSelected:h,showAutoSizeToggle:s,showUngroup:b,onlyFlippableShapeSelected:u})),e}),[o,r,a,c,p,h,s,u,g,v,y,b,w,x,d,f,m,S]);return(0,La.jsx)(cT.Provider,{value:_,children:i})}));function fT(){var e=t.useContext(cT);if(!e)throw new Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return e}var pT=t.createContext({});function hT(e){var n=e.overrides,r=e.children,i=Ka(),o=IE(),a=UI().addDialog,s=KI(),u=_e(Qs.highlighterTool),l=t.useMemo((function(){var e=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect:function(e){i.setSelectedTool("select"),o("select-tool",{source:e,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect:function(e){i.setSelectedTool("hand"),o("select-tool",{source:e,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect:function(e){i.setSelectedTool("eraser"),o("select-tool",{source:e,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect:function(e){i.setSelectedTool("draw"),o("select-tool",{source:e,id:"draw"})}}].concat(d(d($o.values).map((function(e){return{id:e,label:"tool.".concat(e),readonlyOk:!1,meta:{geo:e},kbd:"rectangle"===e?"r":"ellipse"===e?"o":void 0,icon:"geo-"+e,onSelect:function(t){i.batch((function(){i.updateInstanceState({stylesForNextShape:Ce(Ce({},i.instanceState.stylesForNextShape),{},D({},$o.id,e))},!0),i.setSelectedTool("geo"),o("select-tool",{source:t,id:"geo-".concat(e)})}))}}}))),[{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect:function(e){i.setSelectedTool("arrow"),o("select-tool",{source:e,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect:function(e){i.setSelectedTool("line"),o("select-tool",{source:e,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect:function(e){i.setSelectedTool("frame"),o("select-tool",{source:e,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect:function(e){i.setSelectedTool("text"),o("select-tool",{source:e,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect:function(e){s(),o("select-tool",{source:e,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect:function(e){i.setSelectedTool("note"),o("select-tool",{source:e,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect:function(e){i.setSelectedTool("laser"),o("select-tool",{source:e,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect:function(e){a({component:XC}),o("select-tool",{source:e,id:"embed"})}}]);u&&e.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect:function(e){i.setSelectedTool("highlight"),o("select-tool",{source:e,id:"highlight"})}});var t=Object.fromEntries(e.map((function(e){return[e.id,e]})));return n?n(i,t,{insertMedia:s}):t}),[u,n,i,o,s,a]);return(0,La.jsx)(pT.Provider,{value:l,children:r})}function vT(){var e=t.useContext(pT);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}var gT=t.createContext({}),mT=ke((function(e){var n=e.overrides,r=e.children,i=Ka(),o=vT(),a=HI(),s=(0,t.useMemo)((function(){var e=Te([XI("shortcuts-dialog.tools",GI(a["toggle-tool-lock"]),GI(o.select),GI(o.draw),GI(o.eraser),GI(o.hand),GI(o.rectangle),GI(o.ellipse),GI(o.arrow),GI(o.line),GI(o.text),GI(o.frame),GI(o.note),GI(o.laser)),XI("shortcuts-dialog.file",GI(a["insert-media"]),GI(a.print)),XI("shortcuts-dialog.preferences",GI(a["toggle-dark-mode"]),GI(a["toggle-focus-mode"]),GI(a["toggle-grid"])),XI("shortcuts-dialog.edit",GI(a.undo),GI(a.redo),GI(a.cut),GI(a.copy),GI(a.paste),GI(a["select-all"]),GI(a.delete),GI(a.duplicate),GI(a["export-as-svg"]),GI(a["export-as-png"])),XI("shortcuts-dialog.view",GI(a["zoom-in"]),GI(a["zoom-out"]),GI(a["zoom-to-100"]),GI(a["zoom-to-fit"]),GI(a["zoom-to-selection"])),XI("shortcuts-dialog.transform",GI(a["bring-to-front"]),GI(a["bring-forward"]),GI(a["send-backward"]),GI(a["send-to-back"]),GI(a.group),GI(a.ungroup),GI(a["flip-horizontal"]),GI(a["flip-vertical"]),GI(a["align-top"]),GI(a["align-center-vertical"]),GI(a["align-bottom"]),GI(a["align-left"]),GI(a["align-center-horizontal"]),GI(a["align-right"]))]);return n?n(i,e,{tools:o,actions:a}):e}),[i,n,a,o]);return(0,La.jsx)(gT.Provider,{value:s,children:r})}));function yT(){var e=Ka();return _e("isReadOnlyMode",(function(){return e.isReadOnly}),[e])}var bT=function(){var e=Lx(),n=yT(),r=function(){var e=t.useContext(gT);if(!e)throw new Error("Shortcuts must be used inside of a ShortcutsProvider.");return e}();return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)(Hx,{className:"tlui-shortcuts-dialog__header",children:[(0,La.jsx)(Yx,{children:e("shortcuts-dialog.title")}),(0,La.jsx)(Xx,{})]}),(0,La.jsx)(qx,{className:"tlui-shortcuts-dialog__body",children:r.map((function t(r){if(n&&!r.readonlyOk)return null;switch(r.type){case"group":return(0,La.jsxs)("div",{className:"tlui-shortcuts-dialog__group",children:[(0,La.jsx)("h2",{className:"tlui-shortcuts-dialog__group__title",children:e(r.id)}),(0,La.jsx)("div",{className:"tlui-shortcuts-dialog__group__content",children:r.children.filter((function(e){return"item"===e.type&&e.actionItem.kbd})).map(t)})]},r.id);case"item":var i=r.actionItem,o=i.id,a=i.label,s=i.shortcutsLabel,u=i.kbd;return(0,La.jsxs)("div",{className:"tlui-shortcuts-dialog__key-pair",children:[(0,La.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:e(null!==s&&void 0!==s?s:a)}),(0,La.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:(0,La.jsx)(Kx,{children:u})})]},o)}}))}),(0,La.jsx)("div",{className:"tlui-dialog__scrim"})]})};function wT(){var e=Ka();return{languages:Ma,currentLanguage:e.locale}}var xT=t.createContext({}),kT=ke((function(e){var n=e.overrides,r=e.children,i=Ka(),o=HI(),a=i.selectedIds.length,s=a>0,u=a>1,l=a>2,c=wT(),d=c.languages,f=c.currentLanguage,p=UI().addDialog,h=(0,t.useMemo)((function(){var e=Te([XI("top",$I("LANGUAGE_MENU",{readonlyOk:!0}),GI({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect:function(){p({component:bT})}}))]);return n?n(i,e,{actions:o,currentLanguage:f,languages:d,oneSelected:s,twoSelected:u,threeSelected:l}):e}),[i,n,d,o,s,u,l,f,p]);return(0,La.jsx)(xT.Provider,{value:h,children:r})}));function ST(){var e=Ka();return _e("useCanRedo",(function(){return e.canRedo}),[e])}function _T(){var e=Ka();return _e("useCanUndo",(function(){return e.canUndo}),[e])}var PT=t.createContext({});function ET(e){var n,r=e.overrides,i=e.children,o=Ka(),a=HI(),s=oT()<5,u=_e("isDarkMode",(function(){return o.isDarkMode}),[o]),l=_e("animationSpeed",(function(){return o.animationSpeed}),[o]),c=_e("isGridMode",(function(){return o.isGridMode}),[o]),d=_e("isSnapMode",(function(){return o.isSnapMode}),[o]),f=_e("isToolLock",(function(){return o.instanceState.isToolLocked}),[o]),p=_e("isFocusMode",(function(){return o.instanceState.isFocusMode}),[o]),h=_e("isDebugMode",(function(){return o.instanceState.isDebugMode}),[o]),v=_e("exportBackground",(function(){return o.instanceState.exportBackground}),[o]),g=_e("emptyPage",(function(){return 0===o.currentPageShapeIds.size}),[o]),m=_e("selectedCount",(function(){return o.selectedIds.length}),[o]),y=0===m,b=m>0,w=m>1,x=m>2,k=Boolean(null===(n=window.navigator.clipboard)||void 0===n?void 0:n.write),S=aT(),_=lT(),P=JI(),E=eT(),C=_T(),I=ST(),T=_e("isZoomedTo100",(function(){return 1===o.zoomLevel}),[o]),M=(0,t.useMemo)((function(){var e=Te([XI("menu",qI("file","menu.file",XI("print",GI(a.print,{disabled:g}))),qI("edit","menu.edit",XI("undo-actions",GI(a.undo,{disabled:!C}),GI(a.redo,{disabled:!I})),XI("clipboard-actions",GI(a.cut,{disabled:y}),GI(a.copy,{disabled:y}),GI(a.paste,{disabled:!tT})),XI("conversions",qI("copy-as","menu.copy-as",XI("copy-as-group",GI(a["copy-as-svg"],{disabled:g}),GI(a["copy-as-png"],{disabled:g||!k}),GI(a["copy-as-json"],{disabled:g})),XI("export-bg",GI(a["toggle-transparent"],{checked:!v}))),qI("export-as","menu.export-as",XI("export-as-group",GI(a["export-as-svg"],{disabled:g}),GI(a["export-as-png"],{disabled:g}),GI(a["export-as-json"],{disabled:g})),XI("export-bg",GI(a["toggle-transparent"],{checked:!v})))),XI("set-selection-group",GI(a["select-all"],{disabled:g}),GI(a["select-none"],{disabled:!b})),XI("selection",_&&GI(a["toggle-auto-size"]),S&&GI(a["edit-link"]),GI(a.duplicate,{disabled:!b}),P&&GI(a.group),E&&GI(a.ungroup)),XI("delete-group",GI(a.delete,{disabled:!b}))),qI("view","menu.view",XI("view-actions",GI(a["zoom-in"]),GI(a["zoom-out"]),GI(a["zoom-to-100"],{disabled:T}),GI(a["zoom-to-fit"],{disabled:g}),GI(a["zoom-to-selection"],{disabled:g||!b})))),XI("extras",GI(a["insert-embed"]),GI(a["insert-media"])),XI("preferences",qI("preferences","menu.preferences",XI("preferences-actions",GI(a["toggle-snap-mode"],{checked:d}),GI(a["toggle-tool-lock"],{checked:f}),GI(a["toggle-grid"],{checked:c}),GI(a["toggle-dark-mode"],{checked:u}),GI(a["toggle-focus-mode"],{checked:p}),GI(a["toggle-reduce-motion"],{checked:0===l}),GI(a["toggle-debug-mode"],{checked:h}))),s&&$I("LANGUAGE_MENU",{readonlyOk:!0}))]);return r?r(o,e,{actions:a,noneSelected:y,oneSelected:b,twoSelected:w,threeSelected:x}):e}),[o,r,a,b,w,x,g,s,P,E,S,k,_,y,C,I,l,u,c,d,f,p,v,h,T]);return(0,La.jsx)(PT.Provider,{value:M,children:i})}function CT(e){return{id:e.id,type:"item",readonlyOk:e.readonlyOk,toolItem:e}}var IT=t.createContext([]);function TT(e){var n=e.overrides,r=e.children,i=Ka(),o=vT(),a=_e(Qs.highlighterTool),s=t.useMemo((function(){var e=Te([CT(o.select),CT(o.hand),CT(o.draw),CT(o.eraser),CT(o.arrow),CT(o.text),CT(o.note),CT(o.asset),CT(o.rectangle),CT(o.ellipse),CT(o.diamond),CT(o.triangle),CT(o.trapezoid),CT(o.rhombus),CT(o.pentagon),CT(o.hexagon),CT(o.star),CT(o.oval),CT(o["x-box"]),CT(o["check-box"]),CT(o["arrow-left"]),CT(o["arrow-up"]),CT(o["arrow-down"]),CT(o["arrow-right"]),CT(o.frame),CT(o.line),a?CT(o.highlight):null,CT(o.laser)]);return n?n(i,e,{tools:o}):e}),[i,a,n,o]);return(0,La.jsx)(IT.Provider,{value:s,children:r})}function MT(e){return(0,t.useMemo)((function(){return e}),e)}function jT(e){var n=MT(null==e?[]:Array.isArray(e)?e:[e]);return(0,t.useMemo)((function(){var e,t={},r=J(n);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.translations){var o,a=J(Xe(i.translations));try{for(a.s();!(o=a.n()).done;){var s=l(o.value,2),u=s[0],c=s[1],d=t[u];d||(d=t[u]={}),Object.assign(d,c)}}catch(uD){a.e(uD)}finally{a.f()}}}}catch(uD){r.e(uD)}finally{r.f()}return t}),[n])}function AT(e){var n=function(){var e=MI(),n=e.addToast,r=e.removeToast,i=e.clearToasts,o=UI(),a=o.addDialog,s=o.clearDialogs,u=o.removeDialog,l=o.updateDialog,c=oT()<5,d=Lx();return(0,t.useMemo)((function(){return{addToast:n,removeToast:r,clearToasts:i,addDialog:a,clearDialogs:s,removeDialog:u,updateDialog:l,msg:d,isMobile:c}}),[a,n,s,i,d,u,r,l,c])}(),r=MT(null==e?[]:Array.isArray(e)?e:[e]);return(0,t.useMemo)((function(){return function(e,t){var n,r={},i=J(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.translations){var a,s=J(Xe(o.translations));try{for(s.s();!(a=s.n()).done;){var u=l(a.value,2),c=u[0],d=u[1],f=r[c];f||(f=r[c]={}),Object.assign(f,d)}}catch(uD){s.e(uD)}finally{s.f()}}}}catch(uD){i.e(uD)}finally{i.f()}return{actionsMenu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.actionsMenu&&(r=s.actionsMenu(n,r,Ce(Ce({},t),i)))}}catch(uD){a.e(uD)}finally{a.f()}return r},actions:function(n,r){var i,o=J(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.actions&&(r=a.actions(n,r,t))}}catch(uD){o.e(uD)}finally{o.f()}return r},contextMenu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.contextMenu&&(r=s.contextMenu(n,r,Ce(Ce({},t),i)))}}catch(uD){a.e(uD)}finally{a.f()}return r},helpMenu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.helpMenu&&(r=s.helpMenu(n,r,Ce(Ce({},t),i)))}}catch(uD){a.e(uD)}finally{a.f()}return r},menu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.menu&&(r=s.menu(n,r,Ce(Ce({},t),i)))}}catch(uD){a.e(uD)}finally{a.f()}return r},toolbar:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.toolbar&&(r=s.toolbar(n,r,Ce(Ce({},t),i)))}}catch(uD){a.e(uD)}finally{a.f()}return r},keyboardShortcutsMenu:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.keyboardShortcutsMenu&&(r=s.keyboardShortcutsMenu(n,r,Ce(Ce({},t),i)))}}catch(uD){a.e(uD)}finally{a.f()}return r},tools:function(n,r,i){var o,a=J(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.tools&&(r=s.tools(n,r,Ce(Ce({},t),i)))}}catch(uD){a.e(uD)}finally{a.f()}return r},translations:r}}(r,n)}),[r,n])}function OT(e){var t=e.overrides,n=e.assetUrls,r=e.onUiEvent,i=e.children;return(0,La.jsx)(Px,{assetUrls:KC(n),children:(0,La.jsx)(Ox,{overrides:jT(t),children:(0,La.jsx)(CE,{onEvent:r,children:(0,La.jsx)(TI,{children:(0,La.jsx)(FI,{children:(0,La.jsx)(iT,{children:(0,La.jsx)(LT,{overrides:t,children:i})})})})})})})}function LT(e){var t=e.overrides,n=e.children,r=AT(t);return(0,La.jsx)(WI,{overrides:r.actions,children:(0,La.jsx)(hT,{overrides:r.tools,children:(0,La.jsx)(TT,{overrides:r.toolbar,children:(0,La.jsx)(uT,{overrides:r.actionsMenu,children:(0,La.jsx)(mT,{overrides:r.keyboardShortcutsMenu,children:(0,La.jsx)(dT,{overrides:r.contextMenu,children:(0,La.jsx)(kT,{overrides:r.helpMenu,children:(0,La.jsx)(ET,{overrides:r.menu,children:n})})})})})})})})}function zT(){var e=Ka(),n=HI()["back-to-content"],r=l((0,t.useState)(!1),2),i=r[0],o=r[1];return(0,t.useEffect)((function(){var t=!1,n=setInterval((function(){var n=e.renderingShapes.filter((function(e){return e.isInViewport})),r=0===n.length&&e.shapesArray.length>0;t!==r&&(o(r),t=r)}),1e3);return function(){clearInterval(n)}}),[e]),i?(0,La.jsx)(Wx,{iconLeft:n.icon,label:n.label,onClick:function(){n.onSelect("helper-buttons"),o(!1)}}):null}var DT=0;var NT=t.memo((function(e){var t=e.renderDebugMenuItems,n=Lx();return(0,La.jsxs)("div",{className:"tlui-debug-panel",children:[(0,La.jsx)(RT,{}),(0,La.jsx)(BT,{}),(0,La.jsxs)(OE,{id:"debug",children:[(0,La.jsx)(LE,{children:(0,La.jsx)(Wx,{icon:"dots-horizontal",title:n("debug-panel.more")})}),(0,La.jsx)(zE,{side:"top",align:"end",alignOffset:0,children:(0,La.jsx)(FT,{renderDebugMenuItems:t})})]})]})})),RT=ke((function(){var e=Ka();return(0,La.jsx)("div",{className:"tlui-debug-panel__current-state",children:e.root.path.value})})),BT=function(){var e=Ka(),t=_e("rendering shapes count",(function(){return e.renderingShapes.length}),[e]);return(0,La.jsxs)("div",{children:[t," Shapes"]})},FT=ke((function(e){var n=e.renderDebugMenuItems,r=Ka(),i=MI().addToast,o=UI().addDialog,a=l(t.useState(!1),2),s=a[0],u=a[1];return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)(BE,{children:[(0,La.jsx)(FE,{onClick:function(){i({id:ef(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!"})},children:(0,La.jsx)("span",{children:"Show toast"})}),(0,La.jsx)(FE,{onClick:function(){o({component:function(e){var t=e.onClose;return(0,La.jsx)(WT,{displayDontShowAgain:!0,onCancel:function(){t()},onContinue:function(){t()}})},onClose:function(){}})},children:(0,La.jsx)("span",{children:"Show dialog"})}),(0,La.jsx)(FE,{onClick:function(){return function(e,t){for(var n=Array(t),r=Math.floor(Math.sqrt(t)),i=0;i<t;i++)DT++,n[i]={id:Vi("box"+DT),type:"geo",x:i%r*132,y:132*Math.floor(i/r)};e.batch((function(){e.createShapes(n).setSelectedIds(n.map((function(e){return e.id})))}))}(r,100)},children:(0,La.jsx)("span",{children:"Create 100 shapes"})}),(0,La.jsx)(FE,{onClick:function(){function e(t){var n=t.children,r=0;if(!n.length)return 0;for(var i=0,o=d(n);i<o.length;i++){r++,r+=e(o[i])}return r}var t,n=r.selectedShapes,i=0===n.length?r.renderingShapes:n,o=i.map((function(e){return document.getElementById(e.id).parentElement})),a=o.length,s=J(o);try{for(s.s();!(t=s.n()).done;){a+=e(t.value)}}catch(uD){s.e(uD)}finally{s.f()}window.alert("Shapes ".concat(i.length,", DOM nodes:").concat(a))},children:(0,La.jsx)("span",{children:"Count shapes and nodes"})}),function(){if(s)throw Error("oh no!")}(),(0,La.jsx)(FE,{onClick:function(){u(!0)},children:(0,La.jsx)("span",{children:"Throw error"})}),(0,La.jsx)(FE,{onClick:function(){Wa()},children:(0,La.jsx)("span",{children:"Hard reset"})})]}),(0,La.jsxs)(BE,{children:[(0,La.jsx)(UT,{label:"Read-only",value:r.isReadOnly,onChange:function(e){return r.setReadOnly(e)}}),(0,La.jsx)(KT,{flag:Zs.debugSvg}),(0,La.jsx)(KT,{flag:Zs.forceSrgb}),(0,La.jsx)(KT,{flag:Zs.debugCursors,onChange:function(e){if(e){var t=VT.map((function(e,t){return{id:Vi(),type:"geo",x:t%5*175,y:175*Math.floor(t/5),props:{text:e,w:150,h:150,fill:"semi"}}}));r.createShapes(t)}}})]}),(0,La.jsx)(BE,{children:Object.values(Qs).map((function(e){return(0,La.jsx)(KT,{flag:e},e.name)}))}),null===n||void 0===n?void 0:n()]})}));function UT(e){var t=e.label,n=e.value,r=e.onChange;return(0,La.jsx)(UE,{title:t,checked:n,onSelect:function(){return r(!n)},children:t})}var KT=ke((function(e){var t=e.flag,n=e.onChange;return(0,La.jsx)(UT,{label:t.name.replace(/([a-z0-9])([A-Z])/g,(function(e){return"".concat(e[0]," ").concat(e[1].toLowerCase())})).replace(/^[a-z]/,(function(e){return e.toUpperCase()})),value:t.value,onChange:function(e){t.set(e),null===n||void 0===n||n(e)}})})),VT=["none","default","pointer","cross","move","grab","grabbing","text","ew-resize","ns-resize","nesw-resize","nwse-resize","nwse-rotate","nesw-rotate","senw-rotate","swne-rotate","zoom-in","zoom-out"];function WT(e){var n=e.title,r=void 0===n?"title":n,i=e.body,o=void 0===i?"hello hello hello":i,a=e.cancel,s=void 0===a?"Cancel":a,u=e.confirm,c=void 0===u?"Continue":u,d=e.displayDontShowAgain,f=void 0!==d&&d,p=e.onCancel,h=e.onContinue,v=l(t.useState(!1),2),g=v[0],m=v[1];return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)(Hx,{children:[(0,La.jsx)(Yx,{children:r}),(0,La.jsx)(Xx,{})]}),(0,La.jsx)(qx,{style:{maxWidth:350},children:o}),(0,La.jsxs)($x,{className:"tlui-dialog__footer__actions",children:[f&&(0,La.jsx)(Wx,{onClick:function(){return m(!g)},iconLeft:g?"checkbox-checked":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),(0,La.jsx)(Wx,{onClick:p,children:s}),(0,La.jsx)(Wx,{type:"primary",onClick:function(){var e=Ba(Na().mark((function e(){return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),children:c})]})]})}var HT=function(e){var n=e.id,r=e.component,i=e.onClose,o=UI().removeDialog,a=wu(),s=(0,t.useCallback)((function(e){if(!e){if(i)try{i()}catch(uD){console.warn(uD)}o(n)}}),[n,i,o]);return(0,La.jsx)(wx,{onOpenChange:s,defaultOpen:!0,children:(0,La.jsx)(xx,{container:a,children:(0,La.jsx)(kx,{dir:"ltr",className:"tlui-dialog__overlay",children:(0,La.jsx)(Sx,{dir:"ltr",className:"tlui-dialog__content",children:(0,La.jsx)(r,{onClose:function(){return s(!1)}})})})})})};var YT=t.memo((function(){var e=UI().dialogs;return(0,La.jsx)(La.Fragment,{children:e.map((function(e){return(0,La.jsx)(HT,Ce({},e),e.id)}))})}));function XT(){var e=Ka(),t=_e("follow",(function(){return e.instanceState.followingUserId}),[e]);return t?(0,La.jsx)(qT,{userId:t}):null}function qT(e){var t=Pc(e.userId);return t?(0,La.jsx)("div",{className:"tlui-following",style:{borderColor:t.color}}):null}function $T(){var e=Ka(),n=wT(),r=n.languages,i=n.currentLanguage,o=(0,t.useCallback)((function(t){return e.setLocale(t)}),[e]);return(0,La.jsxs)(DE,{id:"help menu language",children:[(0,La.jsx)(NE,{label:"menu.language","data-direction":"left"}),(0,La.jsx)(RE,{sideOffset:-4,children:(0,La.jsx)(BE,{children:r.map((function(e){var t=e.locale,n=e.label;return(0,La.jsx)(KE,{title:t,checked:t===i,onSelect:function(){return o(t)},children:(0,La.jsx)("span",{children:n})},t)}))})})]})}var GT=t.memo((function(){var e=wu(),t=Lx(),n=l(TE("help menu"),2),r=n[0],i=n[1];return(0,La.jsx)("div",{className:"tlui-help-menu",children:(0,La.jsxs)(hE,{dir:"ltr",open:r,onOpenChange:i,modal:!1,children:[(0,La.jsx)(vE,{className:"tlui-button tlui-help-menu__button",dir:"ltr",title:t("help-menu.title"),children:(0,La.jsx)(Nx,{icon:"question-mark"})}),(0,La.jsx)(gE,{container:e,dir:"ltr",children:(0,La.jsx)(mE,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:(0,La.jsx)(QT,{})})})]})})}));function QT(){var e=function(){var e=t.useContext(xT);if(!e)throw new Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return e}(),n=yT();return(0,La.jsx)(La.Fragment,{children:e.map((function e(t){if(n&&!t.readonlyOk)return null;switch(t.type){case"custom":if("LANGUAGE_MENU"===t.id)return(0,La.jsx)($T,{},"item");break;case"group":return(0,La.jsx)(BE,{size:"small",children:t.children.map(e)},t.id);case"submenu":return(0,La.jsxs)(DE,{id:"help menu ".concat(t.id),children:[(0,La.jsx)(NE,{label:t.label}),(0,La.jsx)(RE,{children:t.children.map(e)})]},t.id);case"item":var r=t.actionItem,i=r.id,o=r.kbd,a=r.label,s=r.onSelect,u=r.icon;return(0,La.jsx)(FE,{kbd:o,label:a,onClick:function(){return s("help-menu")},iconLeft:u},i)}}))})}function ZT(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).checkForDefaultPrevented,r=void 0===n||n;return function(n){if(null===e||void 0===e||e(n),!1===r||!n.defaultPrevented)return null===t||void 0===t?void 0:t(n)}}function JT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.forEach((function(t){return function(e,t){"function"===typeof e?e(t):null!==e&&void 0!==e&&(e.current=t)}(t,e)}))}}function eM(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0,t.useCallback)(JT.apply(void 0,n),n)}var tM=["scope","children"];function nM(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];var i=function(){var n=r.map((function(e){return(0,t.createContext)(e)}));return function(r){var i=(null===r||void 0===r?void 0:r[e])||n;return(0,t.useMemo)((function(){return D({},"__scope".concat(e),Ce(Ce({},r),{},D({},e,i)))}),[r,i])}};return i.scopeName=e,[function(n,i){var o=(0,t.createContext)(i),a=r.length;function s(n){var r=n.scope,i=n.children,s=gt(n,tM),u=(null===r||void 0===r?void 0:r[e][a])||o,l=(0,t.useMemo)((function(){return s}),Object.values(s));return(0,t.createElement)(u.Provider,{value:l},i)}return r=[].concat(d(r),[i]),s.displayName=n+"Provider",[s,function(r,s){var u=(null===s||void 0===s?void 0:s[e][a])||o,l=(0,t.useContext)(u);if(l)return l;if(void 0!==i)return i;throw new Error("`".concat(r,"` must be used within `").concat(n,"`"))}]},rM.apply(void 0,[i].concat(d(n)))]}function rM(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0];if(1===n.length)return i;var o=function(){var e=n.map((function(e){return{useScope:e(),scopeName:e.scopeName}}));return function(n){var r=e.reduce((function(e,t){var r=t.useScope,i=t.scopeName,o=r(n)["__scope".concat(i)];return Ce(Ce({},e),o)}),{});return(0,t.useMemo)((function(){return D({},"__scope".concat(i.scopeName),r)}),[r])}};return o.scopeName=i.scopeName,o}var iM=["children"],oM=["children"],aM=(0,t.forwardRef)((function(e,n){var r=e.children,i=gt(e,iM),o=t.Children.toArray(r),a=o.find(lM);if(a){var s=a.props.children,u=o.map((function(e){return e===a?t.Children.count(s)>1?t.Children.only(null):(0,t.isValidElement)(s)?s.props.children:null:e}));return(0,t.createElement)(sM,qy({},i,{ref:n}),(0,t.isValidElement)(s)?(0,t.cloneElement)(s,void 0,u):null)}return(0,t.createElement)(sM,qy({},i,{ref:n}),r)}));aM.displayName="Slot";var sM=(0,t.forwardRef)((function(e,n){var r=e.children,i=gt(e,oM);return(0,t.isValidElement)(r)?(0,t.cloneElement)(r,Ce(Ce({},function(e,t){var n=Ce({},t),r=function(){var r=e[i],o=t[i];/^on[A-Z]/.test(i)?r&&o?n[i]=function(){o.apply(void 0,arguments),r.apply(void 0,arguments)}:r&&(n[i]=r):"style"===i?n[i]=Ce(Ce({},r),o):"className"===i&&(n[i]=[r,o].filter(Boolean).join(" "))};for(var i in t)r();return Ce(Ce({},e),n)}(i,r.props)),{},{ref:JT(n,r.ref)})):t.Children.count(r)>1?t.Children.only(null):null}));sM.displayName="SlotClone";var uM=function(e){var n=e.children;return(0,t.createElement)(t.Fragment,null,n)};function lM(e){return(0,t.isValidElement)(e)&&e.type===uM}var cM=["asChild"],dM=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((function(e,n){var r=(0,t.forwardRef)((function(e,r){var i=e.asChild,o=gt(e,cM),a=i?aM:n;return(0,t.useEffect)((function(){window[Symbol.for("radix-ui")]=!0}),[]),(0,t.createElement)(a,qy({},o,{ref:r}))}));return r.displayName="Primitive.".concat(n),Ce(Ce({},e),{},D({},n,r))}),{});function fM(e){var n=(0,t.useRef)(e);return(0,t.useEffect)((function(){n.current=e})),(0,t.useMemo)((function(){return function(){for(var e,t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return null===(t=n.current)||void 0===t?void 0:(e=t).call.apply(e,[n].concat(i))}}),[])}var pM,hM=["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"],vM="dismissableLayer.update",gM="dismissableLayer.pointerDownOutside",mM="dismissableLayer.focusOutside",yM=(0,t.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),bM=(0,t.forwardRef)((function(e,n){var r,i=e.disableOutsidePointerEvents,o=void 0!==i&&i,a=e.onEscapeKeyDown,s=e.onPointerDownOutside,u=e.onFocusOutside,c=e.onInteractOutside,f=e.onDismiss,p=gt(e,hM),h=(0,t.useContext)(yM),v=l((0,t.useState)(null),2),g=v[0],m=v[1],y=null!==(r=null===g||void 0===g?void 0:g.ownerDocument)&&void 0!==r?r:null===globalThis||void 0===globalThis?void 0:globalThis.document,b=l((0,t.useState)({}),2)[1],w=eM(n,(function(e){return m(e)})),x=Array.from(h.layers),k=l(d(h.layersWithOutsidePointerEventsDisabled).slice(-1),1)[0],S=x.indexOf(k),_=g?x.indexOf(g):-1,P=h.layersWithOutsidePointerEventsDisabled.size>0,E=_>=S,C=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=fM(e),i=(0,t.useRef)(!1),o=(0,t.useRef)((function(){}));return(0,t.useEffect)((function(){var e=function(e){if(e.target&&!i.current){var t=function(){xM(gM,r,a,{discrete:!0})},a={originalEvent:e};"touch"===e.pointerType?(n.removeEventListener("click",o.current),o.current=t,n.addEventListener("click",o.current,{once:!0})):t()}i.current=!1},t=window.setTimeout((function(){n.addEventListener("pointerdown",e)}),0);return function(){window.clearTimeout(t),n.removeEventListener("pointerdown",e),n.removeEventListener("click",o.current)}}),[n,r]),{onPointerDownCapture:function(){return i.current=!0}}}((function(e){var t=e.target,n=d(h.branches).some((function(e){return e.contains(t)}));E&&!n&&(null===s||void 0===s||s(e),null===c||void 0===c||c(e),e.defaultPrevented||null===f||void 0===f||f())}),y),I=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=fM(e),i=(0,t.useRef)(!1);return(0,t.useEffect)((function(){var e=function(e){e.target&&!i.current&&xM(mM,r,{originalEvent:e},{discrete:!1})};return n.addEventListener("focusin",e),function(){return n.removeEventListener("focusin",e)}}),[n,r]),{onFocusCapture:function(){return i.current=!0},onBlurCapture:function(){return i.current=!1}}}((function(e){var t=e.target;d(h.branches).some((function(e){return e.contains(t)}))||(null===u||void 0===u||u(e),null===c||void 0===c||c(e),e.defaultPrevented||null===f||void 0===f||f())}),y);return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,r=fM(e);(0,t.useEffect)((function(){var e=function(e){"Escape"===e.key&&r(e)};return n.addEventListener("keydown",e),function(){return n.removeEventListener("keydown",e)}}),[r,n])}((function(e){_===h.layers.size-1&&(null===a||void 0===a||a(e),!e.defaultPrevented&&f&&(e.preventDefault(),f()))}),y),(0,t.useEffect)((function(){if(g)return o&&(0===h.layersWithOutsidePointerEventsDisabled.size&&(pM=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(g)),h.layers.add(g),wM(),function(){o&&1===h.layersWithOutsidePointerEventsDisabled.size&&(y.body.style.pointerEvents=pM)}}),[g,y,o,h]),(0,t.useEffect)((function(){return function(){g&&(h.layers.delete(g),h.layersWithOutsidePointerEventsDisabled.delete(g),wM())}}),[g,h]),(0,t.useEffect)((function(){var e=function(){return b({})};return document.addEventListener(vM,e),function(){return document.removeEventListener(vM,e)}}),[]),(0,t.createElement)(dM.div,qy({},p,{ref:w,style:Ce({pointerEvents:P?E?"auto":"none":void 0},e.style),onFocusCapture:ZT(e.onFocusCapture,I.onFocusCapture),onBlurCapture:ZT(e.onBlurCapture,I.onBlurCapture),onPointerDownCapture:ZT(e.onPointerDownCapture,C.onPointerDownCapture)}))}));function wM(){var e=new CustomEvent(vM);document.dispatchEvent(e)}function xM(e,t,n,r){var i=r.discrete,o=n.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),i?function(e,t){e&&(0,ub.flushSync)((function(){return e.dispatchEvent(t)}))}(o,a):o.dispatchEvent(a)}var kM=0;function SM(){(0,t.useEffect)((function(){var e,t,n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:_M()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:_M()),kM++,function(){1===kM&&document.querySelectorAll("[data-radix-focus-guard]").forEach((function(e){return e.remove()})),kM--}}),[])}function _M(){var e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var PM=["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"],EM="focusScope.autoFocusOnMount",CM="focusScope.autoFocusOnUnmount",IM={bubbles:!1,cancelable:!0},TM=(0,t.forwardRef)((function(e,n){var r=e.loop,i=void 0!==r&&r,o=e.trapped,a=void 0!==o&&o,s=e.onMountAutoFocus,u=e.onUnmountAutoFocus,c=gt(e,PM),d=l((0,t.useState)(null),2),f=d[0],p=d[1],h=fM(s),v=fM(u),g=(0,t.useRef)(null),m=eM(n,(function(e){return p(e)})),y=(0,t.useRef)({paused:!1,pause:function(){this.paused=!0},resume:function(){this.paused=!1}}).current;(0,t.useEffect)((function(){if(a){var e=function(e){if(!y.paused&&f){var t=e.target;f.contains(t)?g.current=t:OM(g.current,{select:!0})}},t=function(e){!y.paused&&f&&(f.contains(e.relatedTarget)||OM(g.current,{select:!0}))};return document.addEventListener("focusin",e),document.addEventListener("focusout",t),function(){document.removeEventListener("focusin",e),document.removeEventListener("focusout",t)}}}),[a,f,y.paused]),(0,t.useEffect)((function(){if(f){LM.add(y);var e=document.activeElement;if(!f.contains(e)){var t=new CustomEvent(EM,IM);f.addEventListener(EM,h),f.dispatchEvent(t),t.defaultPrevented||(!function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.select,i=void 0!==r&&r,o=document.activeElement,a=J(e);try{for(a.s();!(t=a.n()).done;){if(OM(t.value,{select:i}),document.activeElement!==o)return}}catch(uD){a.e(uD)}finally{a.f()}}((n=MM(f),n.filter((function(e){return"A"!==e.tagName}))),{select:!0}),document.activeElement===e&&OM(f))}return function(){f.removeEventListener(EM,h),setTimeout((function(){var t=new CustomEvent(CM,IM);f.addEventListener(CM,v),f.dispatchEvent(t),t.defaultPrevented||OM(null!==e&&void 0!==e?e:document.body,{select:!0}),f.removeEventListener(CM,v),LM.remove(y)}),0)}}var n}),[f,h,v,y]);var b=(0,t.useCallback)((function(e){if((i||a)&&!y.paused){var t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){var r=e.currentTarget,o=function(e){var t=MM(e),n=jM(t,e),r=jM(t.reverse(),e);return[n,r]}(r),s=l(o,2),u=s[0],c=s[1];u&&c?e.shiftKey||n!==c?e.shiftKey&&n===u&&(e.preventDefault(),i&&OM(c,{select:!0})):(e.preventDefault(),i&&OM(u,{select:!0})):n===r&&e.preventDefault()}}}),[i,a,y.paused]);return(0,t.createElement)(dM.div,qy({tabIndex:-1},c,{ref:m,onKeyDown:b}))}));function MM(e){for(var t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){var t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});n.nextNode();)t.push(n.currentNode);return t}function jM(e,t){var n,r=J(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!AM(i,{upTo:t}))return i}}catch(uD){r.e(uD)}finally{r.f()}}function AM(e,t){var n=t.upTo;if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==n&&e===n)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function OM(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).select,n=void 0!==t&&t;if(e&&e.focus){var r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&n&&e.select()}}var LM=function(){var e=[];return{add:function(t){var n=e[0];t!==n&&(null===n||void 0===n||n.pause()),(e=zM(e,t)).unshift(t)},remove:function(t){var n;null===(n=(e=zM(e,t))[0])||void 0===n||n.resume()}}}();function zM(e,t){var n=d(e),r=n.indexOf(t);return-1!==r&&n.splice(r,1),n}var DM=Boolean(null===globalThis||void 0===globalThis?void 0:globalThis.document)?t.useLayoutEffect:function(){},NM=r["useId".toString()]||function(){},RM=0;function BM(e){var n=l(t.useState(NM()),2),r=n[0],i=n[1];return DM((function(){e||i((function(e){return null!==e&&void 0!==e?e:String(RM++)}))}),[e]),e||(r?"radix-".concat(r):"")}var FM=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","flipAlignment"],UM=["strategy"],KM=["mainAxis","crossAxis","limiter"],VM=["apply"];function WM(e){return e.split("-")[0]}function HM(e){return e.split("-")[1]}function YM(e){return["top","bottom"].includes(WM(e))?"x":"y"}function XM(e){return"y"===e?"height":"width"}function qM(e,t,n){var r,i=e.reference,o=e.floating,a=i.x+i.width/2-o.width/2,s=i.y+i.height/2-o.height/2,u=YM(t),l=XM(u),c=i[l]/2-o[l]/2,d="x"===u;switch(WM(t)){case"top":r={x:a,y:i.y-o.height};break;case"bottom":r={x:a,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:s};break;case"left":r={x:i.x-o.width,y:s};break;default:r={x:i.x,y:i.y}}switch(HM(t)){case"start":r[u]-=c*(n&&d?-1:1);break;case"end":r[u]+=c*(n&&d?-1:1)}return r}var $M=function(){var e=Ba(Na().mark((function e(t,n,r){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.placement,o=void 0===i?"bottom":i,a=r.strategy,s=void 0===a?"absolute":a,u=r.middleware,l=void 0===u?[]:u,c=r.platform,e.next=9,null==c.isRTL?void 0:c.isRTL(n);case 9:return d=e.sent,e.next=12,c.getElementRects({reference:t,floating:n,strategy:s});case 12:f=e.sent,p=qM(f,o,d),h=p.x,v=p.y,g=o,m={},y=0,b=0;case 20:if(!(b<l.length)){e.next=55;break}return x=l[b],k=x.name,S=x.fn,e.next=26,S({x:h,y:v,initialPlacement:o,placement:g,strategy:s,middlewareData:m,rects:f,platform:c,elements:{reference:t,floating:n}});case 26:if(_=e.sent,P=_.x,E=_.y,C=_.data,I=_.reset,h=null!=P?P:h,v=null!=E?E:v,m=Ce(Ce({},m),{},D({},k,Ce(Ce({},m[k]),C))),e.t0=I&&y<=50,!e.t0){e.next=52;break}if(y++,e.t1="object"==typeof I,!e.t1){e.next=51;break}if(I.placement&&(g=I.placement),e.t2=I.rects,!e.t2){e.next=50;break}if(!0!==I.rects){e.next=48;break}return e.next=45,c.getElementRects({reference:t,floating:n,strategy:s});case 45:e.t3=e.sent,e.next=49;break;case 48:e.t3=I.rects;case 49:f=e.t3;case 50:w=qM(f,g,d),h=w.x,v=w.y;case 51:b=-1;case 52:b++,e.next=20;break;case 55:return e.abrupt("return",{x:h,y:v,placement:g,strategy:s,middlewareData:m});case 56:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function GM(e){return"number"!=typeof e?function(e){return Ce({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function QM(e){return Ce(Ce({},e),{},{top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height})}function ZM(e,t){return JM.apply(this,arguments)}function JM(){return JM=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),i=t.x,o=t.y,a=t.platform,s=t.rects,u=t.elements,l=t.strategy,d=(c=n).boundary,f=void 0===d?"clippingAncestors":d,p=c.rootBoundary,h=void 0===p?"viewport":p,v=c.elementContext,g=void 0===v?"floating":v,m=c.altBoundary,y=void 0!==m&&m,b=c.padding,w=GM(void 0===b?0:b),x=u[y?"floating"===g?"reference":"floating":g],e.t0=QM,e.t1=a,e.next=24,null==a.isElement?void 0:a.isElement(x);case 24:if(e.t3=r=e.sent,e.t2=null==e.t3,e.t2){e.next=28;break}e.t2=r;case 28:if(!e.t2){e.next=32;break}e.t4=x,e.next=38;break;case 32:if(e.t5=x.contextElement,e.t5){e.next=37;break}return e.next=36,null==a.getDocumentElement?void 0:a.getDocumentElement(u.floating);case 36:e.t5=e.sent;case 37:e.t4=e.t5;case 38:return e.t6=e.t4,e.t7=f,e.t8=h,e.t9=l,e.t10={element:e.t6,boundary:e.t7,rootBoundary:e.t8,strategy:e.t9},e.next=45,e.t1.getClippingRect.call(e.t1,e.t10);case 45:if(e.t11=e.sent,k=(0,e.t0)(e.t11),e.t12=QM,!a.convertOffsetParentRelativeRectToViewportRelativeRect){e.next=61;break}return e.t14=a,e.t15="floating"===g?Ce(Ce({},s.floating),{},{x:i,y:o}):s.reference,e.next=53,null==a.getOffsetParent?void 0:a.getOffsetParent(u.floating);case 53:return e.t16=e.sent,e.t17=l,e.t18={rect:e.t15,offsetParent:e.t16,strategy:e.t17},e.next=58,e.t14.convertOffsetParentRelativeRectToViewportRelativeRect.call(e.t14,e.t18);case 58:e.t13=e.sent,e.next=62;break;case 61:e.t13=s[g];case 62:return e.t19=e.t13,S=(0,e.t12)(e.t19),e.abrupt("return",{top:k.top-S.top+w.top,bottom:S.bottom-k.bottom+w.bottom,left:k.left-S.left+w.left,right:S.right-k.right+w.right});case 65:case"end":return e.stop()}}),e)}))),JM.apply(this,arguments)}var ej=Math.min,tj=Math.max;function nj(e,t,n){return tj(e,ej(t,n))}var rj=function(e){return{name:"arrow",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=(o=null!=e?e:{}).element,s=o.padding,u=void 0===s?0:s,l=t.x,c=t.y,d=t.placement,f=t.rects,p=t.platform,null!=a){n.next=3;break}return n.abrupt("return",{});case 3:return h=GM(u),v={x:l,y:c},g=YM(d),m=HM(d),y=XM(g),n.next=10,p.getDimensions(a);case 10:return b=n.sent,w="y"===g?"top":"left",x="y"===g?"bottom":"right",k=f.reference[y]+f.reference[g]-v[g]-f.floating[y],S=v[g]-f.reference[g],n.next=17,null==p.getOffsetParent?void 0:p.getOffsetParent(a);case 17:return _=n.sent,0===(P=_?"y"===g?_.clientHeight||0:_.clientWidth||0:0)&&(P=f.floating[y]),E=k/2-S/2,C=h[w],I=P-b[y]-h[x],T=P/2-b[y]/2+E,M=nj(C,T,I),j=("start"===m?h[w]:h[x])>0&&T!==M&&f.reference[y]<=f.floating[y],n.abrupt("return",(D(i={},g,v[g]-(j?T<C?C-T:I-T:0)),D(i,"data",(D(r={},g,M),D(r,"centerOffset",T-M),r)),i));case 22:case"end":return n.stop()}}),n)})))()}}},ij={left:"right",right:"left",bottom:"top",top:"bottom"};function oj(e){return e.replace(/left|right|bottom|top/g,(function(e){return ij[e]}))}function aj(e,t,n){void 0===n&&(n=!1);var r=HM(e),i=YM(e),o=XM(i),a="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=oj(a)),{main:a,cross:oj(a)}}var sj={start:"end",end:"start"};function uj(e){return e.replace(/start|end/g,(function(e){return sj[e]}))}var lj=["top","right","bottom","left"],cj=(lj.reduce((function(e,t){return e.concat(t,t+"-start",t+"-end")}),[]),function(e){return void 0===e&&(e={}),{name:"flip",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l,c,f,p,h,v,g,m,y,b,w,x,k,S,_,P,E,C,I,T,M,j,A,O,L,z,D,N;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.placement,o=t.middlewareData,a=t.rects,s=t.initialPlacement,u=t.platform,l=t.elements,f=(c=e).mainAxis,p=void 0===f||f,h=c.crossAxis,v=void 0===h||h,g=c.fallbackPlacements,m=c.fallbackStrategy,y=void 0===m?"bestFit":m,b=c.flipAlignment,w=void 0===b||b,x=gt(c,FM),k=WM(i),S=g||(k!==s&&w?function(e){var t=oj(e);return[uj(e),t,uj(t)]}(s):[oj(s)]),_=[s].concat(d(S)),n.next=22,ZM(t,x);case 22:if(P=n.sent,E=[],C=(null==(r=o.flip)?void 0:r.overflows)||[],p&&E.push(P[k]),!v){n.next=36;break}return n.t0=aj,n.t1=i,n.t2=a,n.next=31,null==u.isRTL?void 0:u.isRTL(l.floating);case 31:n.t3=n.sent,I=(0,n.t0)(n.t1,n.t2,n.t3),T=I.main,M=I.cross,E.push(P[T],P[M]);case 36:if(C=[].concat(d(C),[{placement:i,overflows:E}]),E.every((function(e){return e<=0}))){n.next=50;break}if(O=(null!=(j=null==(A=o.flip)?void 0:A.index)?j:0)+1,!(L=_[O])){n.next=40;break}return n.abrupt("return",{data:{index:O,overflows:C},reset:{placement:L}});case 40:z="bottom",n.t4=y,n.next="bestFit"===n.t4?44:"initialPlacement"===n.t4?47:48;break;case 44:return N=null==(D=C.map((function(e){return[e,e.overflows.filter((function(e){return e>0})).reduce((function(e,t){return e+t}),0)]})).sort((function(e,t){return e[1]-t[1]}))[0])?void 0:D[0].placement,N&&(z=N),n.abrupt("break",48);case 47:z=s;case 48:if(i===z){n.next=50;break}return n.abrupt("return",{reset:{placement:z}});case 50:return n.abrupt("return",{});case 51:case"end":return n.stop()}}),n)})))()}}});function dj(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function fj(e){return lj.some((function(t){return e[t]>=0}))}var pj=function(e){var t=void 0===e?{}:e,n=t.strategy,r=void 0===n?"referenceHidden":n,i=gt(t,UM);return{name:"hide",fn:function(e){return Ba(Na().mark((function t(){var n,o,a;return Na().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.rects,t.t0=r,t.next="referenceHidden"===t.t0?4:"escaped"===t.t0?11:18;break;case 4:return t.t1=dj,t.next=7,ZM(e,Ce(Ce({},i),{},{elementContext:"reference"}));case 7:return t.t2=t.sent,t.t3=n.reference,o=(0,t.t1)(t.t2,t.t3),t.abrupt("return",{data:{referenceHiddenOffsets:o,referenceHidden:fj(o)}});case 11:return t.t4=dj,t.next=14,ZM(e,Ce(Ce({},i),{},{altBoundary:!0}));case 14:return t.t5=t.sent,t.t6=n.floating,a=(0,t.t4)(t.t5,t.t6),t.abrupt("return",{data:{escapedOffsets:a,escaped:fj(a)}});case 18:return t.abrupt("return",{});case 19:case"end":return t.stop()}}),t)})))()}}},hj=function(e){return void 0===e&&(e=0),{name:"offset",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.x,i=t.y,n.next=4,function(){var e=Ba(Na().mark((function e(t,n){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return Na().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.placement,i=t.platform,o=t.elements,e.next=5,null==i.isRTL?void 0:i.isRTL(o.floating);case 5:return a=e.sent,s=WM(r),u=HM(r),l="x"===YM(r),c=["left","top"].includes(s)?-1:1,d=a&&l?-1:1,f="function"==typeof n?n(t):n,p="number"==typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:Ce({mainAxis:0,crossAxis:0,alignmentAxis:null},f),h=p.mainAxis,v=p.crossAxis,g=p.alignmentAxis,e.abrupt("return",(u&&"number"==typeof g&&(v="end"===u?-1*g:g),l?{x:v*d,y:h*c}:{x:h*c,y:v*d}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,e);case 4:return o=n.sent,n.abrupt("return",{x:r+o.x,y:i+o.y,data:o});case 6:case"end":return n.stop()}}),n)})))()}}};function vj(e){return"x"===e?"y":"x"}var gj=function(e){return void 0===e&&(e={}),{name:"shift",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,k,S;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.x,o=t.y,a=t.placement,u=(s=e).mainAxis,l=void 0===u||u,c=s.crossAxis,d=void 0!==c&&c,f=s.limiter,p=void 0===f?{fn:function(e){return{x:e.x,y:e.y}}}:f,h=gt(s,KM),v={x:i,y:o},n.next=14,ZM(t,h);case 14:return g=n.sent,m=YM(WM(a)),y=vj(m),b=v[m],w=v[y],l&&(x="y"===m?"bottom":"right",b=nj(b+g["y"===m?"top":"left"],b,b-g[x])),d&&(k="y"===y?"bottom":"right",w=nj(w+g["y"===y?"top":"left"],w,w-g[k])),S=p.fn(Ce(Ce({},t),{},(D(r={},m,b),D(r,y,w),r))),n.abrupt("return",Ce(Ce({},S),{},{data:{x:S.x-i,y:S.y-o}}));case 22:case"end":return n.stop()}}),n)})))()}}},mj=function(e){return void 0===e&&(e={}),{options:e,fn:function(t){var n,r=t.x,i=t.y,o=t.placement,a=t.rects,s=t.middlewareData,u=e,l=u.offset,c=void 0===l?0:l,d=u.mainAxis,f=void 0===d||d,p=u.crossAxis,h=void 0===p||p,v={x:r,y:i},g=YM(o),m=vj(g),y=v[g],b=v[m],w="function"==typeof c?c(Ce(Ce({},a),{},{placement:o})):c,x="number"==typeof w?{mainAxis:w,crossAxis:0}:Ce({mainAxis:0,crossAxis:0},w);if(f){var k="y"===g?"height":"width",S=a.reference[g]-a.floating[k]+x.mainAxis,_=a.reference[g]+a.reference[k]-x.mainAxis;y<S?y=S:y>_&&(y=_)}if(h){var P,E,C,I,T="y"===g?"width":"height",M=["top","left"].includes(WM(o)),j=a.reference[m]-a.floating[T]+(M&&null!=(P=null==(E=s.offset)?void 0:E[m])?P:0)+(M?0:x.crossAxis),A=a.reference[m]+a.reference[T]+(M?0:null!=(C=null==(I=s.offset)?void 0:I[m])?C:0)-(M?x.crossAxis:0);b<j?b=j:b>A&&(b=A)}return D(n={},g,y),D(n,m,b),n}}},yj=function(e){return void 0===e&&(e={}),{name:"size",options:e,fn:function(t){return Ba(Na().mark((function n(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x;return Na().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.placement,i=t.rects,o=t.platform,a=t.elements,u=(s=e).apply,l=gt(s,VM),n.next=9,ZM(t,l);case 9:if(c=n.sent,d=WM(r),f=HM(r),"top"!==d&&"bottom"!==d){n.next=31;break}return p=d,n.t0=f,n.next=17,null==o.isRTL?void 0:o.isRTL(a.floating);case 17:if(!n.sent){n.next=21;break}n.t1="start",n.next=22;break;case 21:n.t1="end";case 22:if(n.t2=n.t1,n.t0!==n.t2){n.next=27;break}n.t3="left",n.next=28;break;case 27:n.t3="right";case 28:h=n.t3,n.next=32;break;case 31:h=d,p="end"===f?"top":"bottom";case 32:return v=tj(c.left,0),g=tj(c.right,0),m=tj(c.top,0),y=tj(c.bottom,0),b={availableHeight:i.floating.height-(["left","right"].includes(r)?2*(0!==m||0!==y?m+y:tj(c.top,c.bottom)):c[p]),availableWidth:i.floating.width-(["top","bottom"].includes(r)?2*(0!==v||0!==g?v+g:tj(c.left,c.right)):c[h])},n.next=39,o.getDimensions(a.floating);case 39:return w=n.sent,null==u||u(Ce(Ce({},t),b)),n.next=43,o.getDimensions(a.floating);case 43:return x=n.sent,n.abrupt("return",w.width!==x.width||w.height!==x.height?{reset:{rects:!0}}:{});case 45:case"end":return n.stop()}}),n)})))()}}};function bj(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function wj(e){if(null==e)return window;if(!bj(e)){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function xj(e){return wj(e).getComputedStyle(e)}function kj(e){return bj(e)?"":e?(e.nodeName||"").toLowerCase():""}function Sj(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function _j(e){return e instanceof wj(e).HTMLElement}function Pj(e){return e instanceof wj(e).Element}function Ej(e){return"undefined"!=typeof ShadowRoot&&(e instanceof wj(e).ShadowRoot||e instanceof ShadowRoot)}function Cj(e){var t=xj(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function Ij(e){return["table","td","th"].includes(kj(e))}function Tj(e){var t=/firefox/i.test(Sj()),n=xj(e);return"none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||["transform","perspective"].includes(n.willChange)||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter}function Mj(){return!/^((?!chrome|android).)*safari/i.test(Sj())}var jj=Math.min,Aj=Math.max,Oj=Math.round;function Lj(e,t,n){var r,i,o,a;void 0===t&&(t=!1),void 0===n&&(n=!1);var s=e.getBoundingClientRect(),u=1,l=1;t&&_j(e)&&(u=e.offsetWidth>0&&Oj(s.width)/e.offsetWidth||1,l=e.offsetHeight>0&&Oj(s.height)/e.offsetHeight||1);var c=Pj(e)?wj(e):window,d=!Mj()&&n,f=(s.left+(d&&null!=(r=null==(i=c.visualViewport)?void 0:i.offsetLeft)?r:0))/u,p=(s.top+(d&&null!=(o=null==(a=c.visualViewport)?void 0:a.offsetTop)?o:0))/l,h=s.width/u,v=s.height/l;return{width:h,height:v,top:p,right:f+h,bottom:p+v,left:f,x:f,y:p}}function zj(e){return(t=e,(t instanceof wj(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function Dj(e){return Pj(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Nj(e){return Lj(zj(e)).left+Dj(e).scrollLeft}function Rj(e,t,n){var r=_j(t),i=zj(t),o=Lj(e,r&&function(e){var t=Lj(e);return Oj(t.width)!==e.offsetWidth||Oj(t.height)!==e.offsetHeight}(t),"fixed"===n),a={scrollLeft:0,scrollTop:0},s={x:0,y:0};if(r||!r&&"fixed"!==n)if(("body"!==kj(t)||Cj(i))&&(a=Dj(t)),_j(t)){var u=Lj(t,!0);s.x=u.x+t.clientLeft,s.y=u.y+t.clientTop}else i&&(s.x=Nj(i));return{x:o.left+a.scrollLeft-s.x,y:o.top+a.scrollTop-s.y,width:o.width,height:o.height}}function Bj(e){return"html"===kj(e)?e:e.assignedSlot||e.parentNode||(Ej(e)?e.host:null)||zj(e)}function Fj(e){return _j(e)&&"fixed"!==getComputedStyle(e).position?e.offsetParent:null}function Uj(e){for(var t=wj(e),n=Fj(e);n&&Ij(n)&&"static"===getComputedStyle(n).position;)n=Fj(n);return n&&("html"===kj(n)||"body"===kj(n)&&"static"===getComputedStyle(n).position&&!Tj(n))?t:n||function(e){var t=Bj(e);for(Ej(t)&&(t=t.host);_j(t)&&!["html","body"].includes(kj(t));){if(Tj(t))return t;t=t.parentNode}return null}(e)||t}function Kj(e){if(_j(e))return{width:e.offsetWidth,height:e.offsetHeight};var t=Lj(e);return{width:t.width,height:t.height}}function Vj(e){var t=Bj(e);return["html","body","#document"].includes(kj(t))?e.ownerDocument.body:_j(t)&&Cj(t)?t:Vj(t)}function Wj(e,t){var n;void 0===t&&(t=[]);var r=Vj(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=wj(r),a=i?[o].concat(o.visualViewport||[],Cj(r)?r:[]):r,s=t.concat(a);return i?s:s.concat(Wj(a))}function Hj(e,t,n){return"viewport"===t?QM(function(e,t){var n=wj(e),r=zj(e),i=n.visualViewport,o=r.clientWidth,a=r.clientHeight,s=0,u=0;if(i){o=i.width,a=i.height;var l=Mj();(l||!l&&"fixed"===t)&&(s=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:s,y:u}}(e,n)):Pj(t)?function(e,t){var n=Lj(e,!1,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft;return{top:r,left:i,x:i,y:r,right:i+e.clientWidth,bottom:r+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}(t,n):QM(function(e){var t,n=zj(e),r=Dj(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=Aj(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Aj(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-r.scrollLeft+Nj(e),u=-r.scrollTop;return"rtl"===xj(i||n).direction&&(s+=Aj(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:a,x:s,y:u}}(zj(e)))}var Yj={getClippingRect:function(e){var t=e.element,n=e.boundary,r=e.rootBoundary,i=e.strategy,o=[].concat(d("clippingAncestors"===n?function(e){var t=Wj(e),n=["absolute","fixed"].includes(xj(e).position)&&_j(e)?Uj(e):e;return Pj(n)?t.filter((function(e){return Pj(e)&&function(e,t){var n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&Ej(n)){var r=t;do{if(r&&e===r)return!0;r=r.parentNode||r.host}while(r)}return!1}(e,n)&&"body"!==kj(e)})):[]}(t):[].concat(n)),[r]),a=o[0],s=o.reduce((function(e,n){var r=Hj(t,n,i);return e.top=Aj(r.top,e.top),e.right=jj(r.right,e.right),e.bottom=jj(r.bottom,e.bottom),e.left=Aj(r.left,e.left),e}),Hj(t,a,i));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){var t=e.rect,n=e.offsetParent,r=e.strategy,i=_j(n),o=zj(n);if(n===o)return t;var a={scrollLeft:0,scrollTop:0},s={x:0,y:0};if((i||!i&&"fixed"!==r)&&(("body"!==kj(n)||Cj(o))&&(a=Dj(n)),_j(n))){var u=Lj(n,!0);s.x=u.x+n.clientLeft,s.y=u.y+n.clientTop}return Ce(Ce({},t),{},{x:t.x-a.scrollLeft+s.x,y:t.y-a.scrollTop+s.y})},isElement:Pj,getDimensions:Kj,getOffsetParent:Uj,getDocumentElement:zj,getElementRects:function(e){var t=e.reference,n=e.floating,r=e.strategy;return{reference:Rj(t,Uj(n),r),floating:Ce(Ce({},Kj(n)),{},{x:0,y:0})}},getClientRects:function(e){return Array.from(e.getClientRects())},isRTL:function(e){return"rtl"===xj(e).direction}};function Xj(e,t,n,r){void 0===r&&(r={});var i=r,o=i.ancestorScroll,a=void 0===o||o,s=i.ancestorResize,u=void 0===s||s,l=i.elementResize,c=void 0===l||l,f=i.animationFrame,p=void 0!==f&&f,h=a&&!p,v=u&&!p,g=h||v?[].concat(d(Pj(e)?Wj(e):[]),d(Wj(t))):[];g.forEach((function(e){h&&e.addEventListener("scroll",n,{passive:!0}),v&&e.addEventListener("resize",n)}));var m,y=null;if(c){var b=!0;y=new ResizeObserver((function(){b||n(),b=!1})),Pj(e)&&!p&&y.observe(e),y.observe(t)}var w=p?Lj(e):null;return p&&function t(){var r=Lj(e);!w||r.x===w.x&&r.y===w.y&&r.width===w.width&&r.height===w.height||n(),w=r,m=requestAnimationFrame(t)}(),n(),function(){var e;g.forEach((function(e){h&&e.removeEventListener("scroll",n),v&&e.removeEventListener("resize",n)})),null==(e=y)||e.disconnect(),y=null,p&&cancelAnimationFrame(m)}}var qj="undefined"!==typeof document?t.useLayoutEffect:t.useEffect;function $j(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;var n,r,i;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((n=e.length)!=t.length)return!1;for(r=n;0!==r--;)if(!$j(e[r],t[r]))return!1;return!0}if((n=(i=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=n;0!==r--;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;0!==r--;){var o=i[r];if(("_owner"!==o||!e.$$typeof)&&!$j(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function Gj(e){var n=void 0===e?{}:e,r=n.middleware,i=n.placement,o=void 0===i?"bottom":i,a=n.strategy,s=void 0===a?"absolute":a,u=n.whileElementsMounted,c=t.useRef(null),d=t.useRef(null),f=function(e){var n=t.useRef(e);return qj((function(){n.current=e})),n}(u),p=t.useRef(null),h=l(t.useState({x:null,y:null,strategy:s,placement:o,middlewareData:{}}),2),v=h[0],g=h[1],m=l(t.useState(r),2),y=m[0],b=m[1];$j(null==y?void 0:y.map((function(e){return e.options})),null==r?void 0:r.map((function(e){return e.options})))||b(r);var w=t.useCallback((function(){c.current&&d.current&&function(e,t,n){return $M(e,t,Ce({platform:Yj},n))}(c.current,d.current,{middleware:y,placement:o,strategy:s}).then((function(e){x.current&&ub.flushSync((function(){g(e)}))}))}),[y,o,s]);qj((function(){x.current&&w()}),[w]);var x=t.useRef(!1);qj((function(){return x.current=!0,function(){x.current=!1}}),[]);var k=t.useCallback((function(){if("function"===typeof p.current&&(p.current(),p.current=null),c.current&&d.current)if(f.current){var e=f.current(c.current,d.current,w);p.current=e}else w()}),[w,f]),S=t.useCallback((function(e){c.current=e,k()}),[k]),_=t.useCallback((function(e){d.current=e,k()}),[k]),P=t.useMemo((function(){return{reference:c,floating:d}}),[]);return t.useMemo((function(){return Ce(Ce({},v),{},{update:w,refs:P,reference:S,floating:_})}),[v,w,P,S,_])}var Qj=function(e){var t=e.element,n=e.padding;return{name:"arrow",options:e,fn:function(e){return r=t,Object.prototype.hasOwnProperty.call(r,"current")?null!=t.current?rj({element:t.current,padding:n}).fn(e):{}:t?rj({element:t,padding:n}).fn(e):{};var r}}};var Zj=["__scopePopper","virtualRef"],Jj=["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","collisionBoundary","collisionPadding","sticky","hideWhenDetached","avoidCollisions","onPlaced"],eA="Popper",tA=l(nM(eA),2),nA=tA[0],rA=tA[1],iA=l(nA(eA),2),oA=iA[0],aA=iA[1],sA=function(e){var n=e.__scopePopper,r=e.children,i=l((0,t.useState)(null),2),o=i[0],a=i[1];return(0,t.createElement)(oA,{scope:n,anchor:o,onAnchorChange:a},r)},uA="PopperAnchor",lA=(0,t.forwardRef)((function(e,n){var r=e.__scopePopper,i=e.virtualRef,o=gt(e,Zj),a=aA(uA,r),s=(0,t.useRef)(null),u=eM(n,s);return(0,t.useEffect)((function(){a.onAnchorChange((null===i||void 0===i?void 0:i.current)||s.current)})),i?null:(0,t.createElement)(dM.div,qy({},o,{ref:u}))})),cA="PopperContent",dA=l(nA(cA),2),fA=dA[0],pA=(dA[1],l(nA(cA,{hasParent:!1,positionUpdateFns:new Set}),2)),hA=pA[0],vA=pA[1],gA=(0,t.forwardRef)((function(e,n){var r,i,o,a,s,u,c,d,f=e.__scopePopper,p=e.side,h=void 0===p?"bottom":p,v=e.sideOffset,g=void 0===v?0:v,m=e.align,y=void 0===m?"center":m,b=e.alignOffset,w=void 0===b?0:b,x=e.arrowPadding,k=void 0===x?0:x,S=e.collisionBoundary,_=void 0===S?[]:S,P=e.collisionPadding,E=void 0===P?0:P,C=e.sticky,I=void 0===C?"partial":C,T=e.hideWhenDetached,M=void 0!==T&&T,j=e.avoidCollisions,A=void 0===j||j,O=e.onPlaced,L=gt(e,Jj),z=aA(cA,f),N=l((0,t.useState)(null),2),R=N[0],B=N[1],F=eM(n,(function(e){return B(e)})),U=l((0,t.useState)(null),2),K=U[0],V=U[1],W=function(e){var n=l((0,t.useState)(void 0),2),r=n[0],i=n[1];return DM((function(){if(e){i({width:e.offsetWidth,height:e.offsetHeight});var t=new ResizeObserver((function(t){if(Array.isArray(t)&&t.length){var n,r,o=t[0];if("borderBoxSize"in o){var a=o.borderBoxSize,s=Array.isArray(a)?a[0]:a;n=s.inlineSize,r=s.blockSize}else n=e.offsetWidth,r=e.offsetHeight;i({width:n,height:r})}}));return t.observe(e,{box:"border-box"}),function(){return t.unobserve(e)}}i(void 0)}),[e]),r}(K),H=null!==(r=null===W||void 0===W?void 0:W.width)&&void 0!==r?r:0,Y=null!==(i=null===W||void 0===W?void 0:W.height)&&void 0!==i?i:0,X=h+("center"!==y?"-"+y:""),q="number"===typeof E?E:Ce({top:0,right:0,bottom:0,left:0},E),$=Array.isArray(_)?_:[_],G=$.length>0,Q={padding:q,boundary:$.filter(yA),altBoundary:G},Z=Gj({strategy:"fixed",placement:X,whileElementsMounted:Xj,middleware:[hj({mainAxis:g+Y,alignmentAxis:w}),A?gj(Ce({mainAxis:!0,crossAxis:!1,limiter:"partial"===I?mj():void 0},Q)):void 0,A?cj(Ce({},Q)):void 0,yj(Ce(Ce({},Q),{},{apply:function(e){var t=e.elements,n=e.rects,r=e.availableWidth,i=e.availableHeight,o=n.reference,a=o.width,s=o.height,u=t.floating.style;u.setProperty("--radix-popper-available-width","".concat(r,"px")),u.setProperty("--radix-popper-available-height","".concat(i,"px")),u.setProperty("--radix-popper-anchor-width","".concat(a,"px")),u.setProperty("--radix-popper-anchor-height","".concat(s,"px"))}})),K?Qj({element:K,padding:k}):void 0,bA({arrowWidth:H,arrowHeight:Y}),M?pj({strategy:"referenceHidden"}):void 0].filter(mA)}),J=Z.reference,ee=Z.floating,te=Z.strategy,ne=Z.x,re=Z.y,ie=Z.placement,oe=Z.middlewareData,ae=Z.update;DM((function(){J(z.anchor)}),[J,z.anchor]);var se=null!==ne&&null!==re,ue=l(wA(ie),2),le=ue[0],ce=ue[1],de=fM(O);DM((function(){se&&(null===de||void 0===de||de())}),[se,de]);var fe=null===(o=oe.arrow)||void 0===o?void 0:o.x,pe=null===(a=oe.arrow)||void 0===a?void 0:a.y,he=0!==(null===(s=oe.arrow)||void 0===s?void 0:s.centerOffset),ve=l((0,t.useState)(),2),ge=ve[0],me=ve[1];DM((function(){R&&me(window.getComputedStyle(R).zIndex)}),[R]);var ye=vA(cA,f),be=ye.hasParent,we=ye.positionUpdateFns,xe=!be;(0,t.useLayoutEffect)((function(){if(!xe)return we.add(ae),function(){we.delete(ae)}}),[xe,we,ae]),DM((function(){xe&&se&&Array.from(we).reverse().forEach((function(e){return requestAnimationFrame(e)}))}),[xe,se,we]);var ke=Ce(Ce({"data-side":le,"data-align":ce},L),{},{ref:F,style:Ce(Ce({},L.style),{},{animation:se?void 0:"none",opacity:null!==(u=oe.hide)&&void 0!==u&&u.referenceHidden?0:void 0})});return(0,t.createElement)("div",{ref:ee,"data-radix-popper-content-wrapper":"",style:D({position:te,left:0,top:0,transform:se?"translate3d(".concat(Math.round(ne),"px, ").concat(Math.round(re),"px, 0)"):"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:ge},"--radix-popper-transform-origin",[null===(c=oe.transformOrigin)||void 0===c?void 0:c.x,null===(d=oe.transformOrigin)||void 0===d?void 0:d.y].join(" ")),dir:e.dir},(0,t.createElement)(fA,{scope:f,placedSide:le,onArrowChange:V,arrowX:fe,arrowY:pe,shouldHideArrow:he},xe?(0,t.createElement)(hA,{scope:f,hasParent:!0,positionUpdateFns:we},(0,t.createElement)(dM.div,ke)):(0,t.createElement)(dM.div,ke)))}));function mA(e){return void 0!==e}function yA(e){return null!==e}var bA=function(e){return{name:"transformOrigin",options:e,fn:function(t){var n,r,i,o,a,s=t.placement,u=t.rects,c=t.middlewareData,d=0!==(null===(n=c.arrow)||void 0===n?void 0:n.centerOffset),f=d?0:e.arrowWidth,p=d?0:e.arrowHeight,h=l(wA(s),2),v=h[0],g={start:"0%",center:"50%",end:"100%"}[h[1]],m=(null!==(r=null===(i=c.arrow)||void 0===i?void 0:i.x)&&void 0!==r?r:0)+f/2,y=(null!==(o=null===(a=c.arrow)||void 0===a?void 0:a.y)&&void 0!==o?o:0)+p/2,b="",w="";return"bottom"===v?(b=d?g:"".concat(m,"px"),w="".concat(-p,"px")):"top"===v?(b=d?g:"".concat(m,"px"),w="".concat(u.floating.height+p,"px")):"right"===v?(b="".concat(-p,"px"),w=d?g:"".concat(y,"px")):"left"===v&&(b="".concat(u.floating.width+p,"px"),w=d?g:"".concat(y,"px")),{data:{x:b,y:w}}}}};function wA(e){var t=l(e.split("-"),2),n=t[0],r=t[1];return[n,void 0===r?"center":r]}var xA=sA,kA=lA,SA=gA,_A=["container"],PA=(0,t.forwardRef)((function(e,n){var r,i=e.container,o=void 0===i?null===globalThis||void 0===globalThis||null===(r=globalThis.document)||void 0===r?void 0:r.body:i,a=gt(e,_A);return o?ub.createPortal((0,t.createElement)(dM.div,qy({},a,{ref:n})),o):null}));var EA=function(e){var n=e.present,r=e.children,i=function(e){var n=l((0,t.useState)(),2),r=n[0],i=n[1],o=(0,t.useRef)({}),a=(0,t.useRef)(e),s=(0,t.useRef)("none"),u=e?"mounted":"unmounted",c=function(e,n){return(0,t.useReducer)((function(e,t){var r=n[e][t];return null!==r&&void 0!==r?r:e}),e)}(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),d=l(c,2),f=d[0],p=d[1];return(0,t.useEffect)((function(){var e=CA(o.current);s.current="mounted"===f?e:"none"}),[f]),DM((function(){var t=o.current,n=a.current;if(n!==e){var r=s.current,i=CA(t);if(e)p("MOUNT");else if("none"===i||"none"===(null===t||void 0===t?void 0:t.display))p("UNMOUNT");else{p(n&&r!==i?"ANIMATION_OUT":"UNMOUNT")}a.current=e}}),[e,p]),DM((function(){if(r){var e=function(e){var t=CA(o.current).includes(e.animationName);e.target===r&&t&&(0,ub.flushSync)((function(){return p("ANIMATION_END")}))},t=function(e){e.target===r&&(s.current=CA(o.current))};return r.addEventListener("animationstart",t),r.addEventListener("animationcancel",e),r.addEventListener("animationend",e),function(){r.removeEventListener("animationstart",t),r.removeEventListener("animationcancel",e),r.removeEventListener("animationend",e)}}p("ANIMATION_END")}),[r,p]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:(0,t.useCallback)((function(e){e&&(o.current=getComputedStyle(e)),i(e)}),[])}}(n),o="function"===typeof r?r({present:i.isPresent}):t.Children.only(r),a=eM(i.ref,o.ref);return"function"===typeof r||i.isPresent?(0,t.cloneElement)(o,{ref:a}):null};function CA(e){return(null===e||void 0===e?void 0:e.animationName)||"none"}function IA(e){var n=e.prop,r=e.defaultProp,i=e.onChange,o=void 0===i?function(){}:i,a=function(e){var n=e.defaultProp,r=e.onChange,i=(0,t.useState)(n),o=l(i,1)[0],a=(0,t.useRef)(o),s=fM(r);return(0,t.useEffect)((function(){a.current!==o&&(s(o),a.current=o)}),[o,a,s]),i}({defaultProp:r,onChange:o}),s=l(a,2),u=s[0],c=s[1],d=void 0!==n,f=d?n:u,p=fM(o);return[f,(0,t.useCallback)((function(e){if(d){var t="function"===typeof e?e(n):e;t!==n&&p(t)}else c(e)}),[d,n,c,p])]}EA.displayName="Presence";var TA=["__scopePopover"],MA=["forceMount"],jA=["__scopePopover","trapFocus","onOpenAutoFocus","onCloseAutoFocus","disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside"],AA="Popover",OA=l(nM(AA,[rA]),2),LA=OA[0],zA=(OA[1],rA()),DA=l(LA(AA),2),NA=DA[0],RA=DA[1],BA=function(e){var n=e.__scopePopover,r=e.children,i=e.open,o=e.defaultOpen,a=e.onOpenChange,s=e.modal,u=void 0!==s&&s,c=zA(n),d=(0,t.useRef)(null),f=l((0,t.useState)(!1),2),p=f[0],h=f[1],v=l(IA({prop:i,defaultProp:o,onChange:a}),2),g=v[0],m=void 0!==g&&g,y=v[1];return(0,t.createElement)(xA,c,(0,t.createElement)(NA,{scope:n,contentId:BM(),triggerRef:d,open:m,onOpenChange:y,onOpenToggle:(0,t.useCallback)((function(){return y((function(e){return!e}))}),[y]),hasCustomAnchor:p,onCustomAnchorAdd:(0,t.useCallback)((function(){return h(!0)}),[]),onCustomAnchorRemove:(0,t.useCallback)((function(){return h(!1)}),[]),modal:u},r))},FA="PopoverTrigger",UA=(0,t.forwardRef)((function(e,n){var r=e.__scopePopover,i=gt(e,TA),o=RA(FA,r),a=zA(r),s=eM(n,o.triggerRef),u=(0,t.createElement)(dM.button,qy({type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":ZA(o.open)},i,{ref:s,onClick:ZT(e.onClick,o.onOpenToggle)}));return o.hasCustomAnchor?u:(0,t.createElement)(kA,qy({asChild:!0},a),u)})),KA="PopoverPortal",VA=l(LA(KA,{forceMount:void 0}),2),WA=VA[0],HA=VA[1],YA=function(e){var n=e.__scopePopover,r=e.forceMount,i=e.children,o=e.container,a=RA(KA,n);return(0,t.createElement)(WA,{scope:n,forceMount:r},(0,t.createElement)(EA,{present:r||a.open},(0,t.createElement)(PA,{asChild:!0,container:o},i)))},XA="PopoverContent",qA=(0,t.forwardRef)((function(e,n){var r=HA(XA,e.__scopePopover),i=e.forceMount,o=void 0===i?r.forceMount:i,a=gt(e,MA),s=RA(XA,e.__scopePopover);return(0,t.createElement)(EA,{present:o||s.open},s.modal?(0,t.createElement)($A,qy({},a,{ref:n})):(0,t.createElement)(GA,qy({},a,{ref:n})))})),$A=(0,t.forwardRef)((function(e,n){var r=RA(XA,e.__scopePopover),i=(0,t.useRef)(null),o=eM(n,i),a=(0,t.useRef)(!1);return(0,t.useEffect)((function(){var e=i.current;if(e)return Fw(e)}),[]),(0,t.createElement)(Aw,{as:aM,allowPinchZoom:!0},(0,t.createElement)(QA,qy({},e,{ref:o,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ZT(e.onCloseAutoFocus,(function(e){var t;e.preventDefault(),a.current||null===(t=r.triggerRef.current)||void 0===t||t.focus()})),onPointerDownOutside:ZT(e.onPointerDownOutside,(function(e){var t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;a.current=r}),{checkForDefaultPrevented:!1}),onFocusOutside:ZT(e.onFocusOutside,(function(e){return e.preventDefault()}),{checkForDefaultPrevented:!1})})))})),GA=(0,t.forwardRef)((function(e,n){var r=RA(XA,e.__scopePopover),i=(0,t.useRef)(!1),o=(0,t.useRef)(!1);return(0,t.createElement)(QA,qy({},e,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:function(t){var n,a;(null===(n=e.onCloseAutoFocus)||void 0===n||n.call(e,t),t.defaultPrevented)||(i.current||null===(a=r.triggerRef.current)||void 0===a||a.focus(),t.preventDefault());i.current=!1,o.current=!1},onInteractOutside:function(t){var n,a;null===(n=e.onInteractOutside)||void 0===n||n.call(e,t),t.defaultPrevented||(i.current=!0,"pointerdown"===t.detail.originalEvent.type&&(o.current=!0));var s=t.target;(null===(a=r.triggerRef.current)||void 0===a?void 0:a.contains(s))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&o.current&&t.preventDefault()}}))})),QA=(0,t.forwardRef)((function(e,n){var r=e.__scopePopover,i=e.trapFocus,o=e.onOpenAutoFocus,a=e.onCloseAutoFocus,s=e.disableOutsidePointerEvents,u=e.onEscapeKeyDown,l=e.onPointerDownOutside,c=e.onFocusOutside,d=e.onInteractOutside,f=gt(e,jA),p=RA(XA,r),h=zA(r);return SM(),(0,t.createElement)(TM,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:o,onUnmountAutoFocus:a},(0,t.createElement)(bM,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:d,onEscapeKeyDown:u,onPointerDownOutside:l,onFocusOutside:c,onDismiss:function(){return p.onOpenChange(!1)}},(0,t.createElement)(SA,qy({"data-state":ZA(p.open),role:"dialog",id:p.contentId},h,f,{ref:n,style:Ce(Ce({},f.style),{},{"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"})}))))}));function ZA(e){return e?"open":"closed"}var JA=BA,eO=UA,tO=YA,nO=qA,rO=function(e){var t=e.id,n=e.children,r=l(TE(t,e.onOpenChange),2),i=r[0],o=r[1];return(0,La.jsx)(JA,{onOpenChange:o,open:i,children:(0,La.jsx)("div",{className:"tlui-popover",children:n})})},iO=function(e){var t=e.children,n=e.disabled,r=e["data-testid"];return(0,La.jsx)(eO,{"data-testid":r,disabled:n,asChild:!0,dir:"ltr",children:t})},oO=function(e){var t=e.side,n=e.children,r=e.align,i=void 0===r?"center":r,o=e.sideOffset,a=void 0===o?8:o,s=e.alignOffset,u=void 0===s?0:s,l=wu();return(0,La.jsx)(tO,{dir:"ltr",container:l,children:(0,La.jsx)(nO,{className:"tlui-popover__content",side:t,sideOffset:a,align:i,alignOffset:u,dir:"ltr",children:n})})},aO=(0,t.memo)((function(){var e=Lx(),n=wu(),r=function(){var e=t.useContext(sT);if(!e)throw new Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return e}(),i=yT();return(0,La.jsxs)(rO,{id:"actions menu",children:[(0,La.jsx)(iO,{children:(0,La.jsx)(Wx,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:e("actions-menu.title"),smallIcon:!0})}),(0,La.jsx)(tO,{dir:"ltr",container:n,children:(0,La.jsx)(nO,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:(0,La.jsx)("div",{className:"tlui-actions-menu tlui-button-grid__four",children:r.map((function(t){if(i&&!t.readonlyOk)return null;if("item"===t.type){var n=t.actionItem,r=n.id,o=n.icon,a=n.label,s=n.kbd,u=n.onSelect;return(0,La.jsx)(Wx,{className:"tlui-button-grid__button","data-testid":"menu-item.".concat(t.id),icon:o,title:a?s?"".concat(e(a)," ").concat(Ux(s)):"".concat(e(a)):s?"".concat(Ux(s)):"",onClick:function(){return u("actions-menu")},disabled:t.disabled},r)}}))})})})]})})),sO=ke((function(){var e=Ka(),t=HI(),n=Lx(),r=t.duplicate,i=e.selectedIds.length<=0;return(0,La.jsx)(Wx,{icon:r.icon,onClick:function(){return r.onSelect("quick-actions")},disabled:i,title:"".concat(n(r.label)," ").concat(Ux(r.kbd)),smallIcon:!0})})),uO=t.memo((function(){var e=Lx();return(0,La.jsxs)(OE,{id:"main menu",children:[(0,La.jsx)(LE,{children:(0,La.jsx)(Wx,{className:"tlui-menu__trigger","data-testid":"main.menu",title:e("menu.title"),icon:"menu"})}),(0,La.jsx)(zE,{alignOffset:0,sideOffset:6,children:(0,La.jsx)(lO,{})})]})}));function lO(){var e=Ka(),n=Lx(),r=function(){var e=t.useContext(PT);if(!e)throw new Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return e}(),i=oT(),o=yT();function a(e,t,r,s){switch(t.type){case"custom":return o&&!t.readonlyOk?null:"LANGUAGE_MENU"===t.id?(0,La.jsx)($T,{},"item"):null;case"group":return o&&!t.readonlyOk?null:(0,La.jsx)(BE,{size:s<=1?"medium":i<3||"submenu"===(null===r||void 0===r?void 0:r.type)&&s>2?"tiny":"medium",children:t.children.map((function(n){return a(e,n,t,s+1)}))},t.id);case"submenu":return o&&!t.readonlyOk?null:(0,La.jsxs)(DE,{id:"main menu ".concat(r?r.id+" ":"").concat(t.id),children:[(0,La.jsx)(NE,{label:t.label,"data-testid":"menu-item.".concat(t.id)}),(0,La.jsx)(RE,{sideOffset:-4,alignOffset:-1,children:t.children.map((function(n){return a(e,n,t,s+1)}))})]},t.id);case"item":if(o&&!t.readonlyOk)return null;var u=t.actionItem,l=u.id,c=u.checkbox,d=u.menuLabel,f=u.label,p=u.onSelect,h=u.kbd,v=null!==d&&void 0!==d?d:f,g=v?n(v):void 0;return c?(0,La.jsxs)(UE,{onSelect:function(){return p("menu")},title:g||"",checked:t.checked,disabled:t.disabled,children:[g&&(0,La.jsx)("span",{children:g}),h&&(0,La.jsx)(Kx,{children:h})]},l):(0,La.jsx)(FE,{"data-testid":"menu-item.".concat(t.id),kbd:h,label:v,onClick:function(){return p("menu")},disabled:t.disabled},l)}}return(0,La.jsx)(La.Fragment,{children:r.map((function(t){return a(e,t,null,0)}))})}var cO=function(e){var n=e.name,r=e.id,i=e.isCurrentPage,o=Ka(),a=(0,t.useRef)(null),s=(0,t.useCallback)((function(e){o.renamePage(r,e||"New Page",!0)}),[o,r]),u=(0,t.useCallback)((function(e){o.mark("rename page"),o.renamePage(r,e||"New Page",!1)}),[o,r]);return(0,La.jsx)(VC,{className:"tlui-page-menu__item__input",ref:function(e){return a.current=e},defaultValue:n,onValueChange:s,onComplete:u,onCancel:u,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:i,autoselect:!0})},dO=function(e,t,n,r){var i,o=e.pages,a=n>r?o[r-1]:o[r],s=n>r?o[r]:o[r+1];(i=a&&!s?I(a.index):!a&&s?function(e){return _(void 0,e,1)[0]}(o[0].index):C(a.index,s.index))!==o[n].index&&(e.mark("moving page"),e.updatePage({id:t,index:i}))},fO=ke((function(e){var n=e.index,r=e.listSize,i=e.item,o=e.onRename,a=Ka(),s=Lx(),u=a.pages,l=(0,t.useCallback)((function(){a.mark("creating page");var e=Dn.createId();a.duplicatePage(i.id,e)}),[a,i]),c=(0,t.useCallback)((function(){dO(a,i.id,n,n-1)}),[a,i,n]),d=(0,t.useCallback)((function(){dO(a,i.id,n,n+1)}),[a,i,n]),f=(0,t.useCallback)((function(){a.mark("deleting page"),a.deletePage(i.id)}),[a,i]);return(0,La.jsxs)(OE,{id:"page item submenu ".concat(n),children:[(0,La.jsx)(LE,{children:(0,La.jsx)(Wx,{title:s("page-menu.submenu.title"),icon:"dots-vertical"})}),(0,La.jsxs)(zE,{alignOffset:0,children:[(0,La.jsxs)(BE,{children:[o&&(0,La.jsx)(bE,{dir:"ltr",onSelect:o,asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button",label:"page-menu.submenu.rename"})}),(0,La.jsx)(bE,{dir:"ltr",onSelect:l,disabled:u.length>=40,asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button",label:"page-menu.submenu.duplicate-page"})}),n>0&&(0,La.jsx)(bE,{dir:"ltr",onSelect:c,asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button",label:"page-menu.submenu.move-up"})}),n<r-1&&(0,La.jsx)(bE,{dir:"ltr",onSelect:d,asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button",label:"page-menu.submenu.move-down"})})]}),r>1&&(0,La.jsx)(BE,{children:(0,La.jsx)(bE,{dir:"ltr",onSelect:f,asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button",label:"page-menu.submenu.delete"})})})]})]})})),pO=function(){var e=Ka(),n=Lx(),r=oT(),i=l(TE("page-menu",(0,t.useCallback)((function(){return m(!1)}),[])),2),o=i[0],a=i[1],s=r<5?36:40,u=(0,t.useRef)(null),c=_e("pages",(function(){return e.pages}),[e]),d=_e("currentPage",(function(){return e.currentPage}),[e]),f=_e("isReadonlyMode",(function(){return e.isReadOnly}),[e]),p=_e("maxPageCountReached",(function(){return e.pages.length>=40}),[e]),h=_e("isCoarsePointer",(function(){return e.isCoarsePointer}),[e]),v=l((0,t.useState)(!1),2),g=v[0],m=v[1],y=(0,t.useCallback)((function(){f||m((function(e){return!e}))}),[f]),b=(0,t.useRef)({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),w=(0,t.useState)(Object.fromEntries(c.map((function(e,t){return[e.id,{y:t*s,offsetY:0,isSelected:!1}]})))),x=l(w,2),k=x[0],S=x[1];(0,t.useLayoutEffect)((function(){S(Object.fromEntries(c.map((function(e,t){return[e.id,{y:t*s,offsetY:0,isSelected:!1}]}))))}),[s,c]),(0,t.useEffect)((function(){o&&requestAnimationFrame((function(){var e=document.querySelector('[data-testid="page-menu-item-'.concat(d.id,'"]'));if(e){var t=u.current;if(!t)return;var n=e.offsetTop;n<t.scrollTop&&t.scrollTo({top:n});var r=n+s;r>t.scrollTop+t.offsetHeight&&t.scrollTo({top:r-t.offsetHeight})}}))}),[s,d,o]);var _=(0,t.useCallback)((function(e){var t=e.clientY,n=e.currentTarget.dataset,r=n.id,i=n.index;if(r&&i){var o=b.current;e.currentTarget.setPointerCapture(e.pointerId),o.status="pointing",o.pointing={id:r,index:+i};var a=k[r].y;o.startY=t,o.startIndex=Math.max(0,Math.min(Math.round(a/s),c.length-1))}}),[s,c.length,k]),P=(0,t.useCallback)((function(e){var t=b.current;if("pointing"===t.status){var n=e.clientY-t.startY;Math.abs(n)>5&&(t.status="dragging")}if("dragging"===t.status){var r=e.clientY-t.startY,i=k[t.pointing.id],o=t.startIndex,a=t.pointing,u=i.y+r,l=Math.max(0,Math.min(Math.round(u/s),c.length-1)),d=Ce({},k);if(d[a.id]={y:i.y,offsetY:r,isSelected:!0},l!==t.dragIndex){t.dragIndex=l;for(var f=0;f<c.length;f++){var p=c[f];if(p.id!==t.pointing.id){var h=d[p.id].y;l===o?h=f*s:l<o?h=l<=f&&f<o?(f+1)*s:f*s:l>o&&(h=l>=f&&f>o?(f-1)*s:f*s),h!==d[p.id].y&&(d[p.id]={y:h,offsetY:0,isSelected:!0})}}}S(d)}}),[s,c,k]),E=(0,t.useCallback)((function(t){var n=b.current;if("dragging"===n.status){var r=n.pointing,i=r.id,o=r.index;dO(e,i,o,n.dragIndex)}t.currentTarget.releasePointerCapture(t.pointerId),n.status="idle"}),[e]),C=(0,t.useCallback)((function(e){var t=b.current;"Escape"===e.key&&("dragging"===t.status&&S(Object.fromEntries(c.map((function(e,t){return[e.id,{y:t*s,offsetY:0,isSelected:!1}]})))),t.status="idle")}),[s,c]),I=(0,t.useCallback)((function(){if(!f){e.mark("creating page");var t=Dn.createId();e.createPage(n("page-menu.new-page-initial-name"),t),m(!0)}}),[e,n,f]);return(0,La.jsxs)(rO,{id:"page menu",onOpenChange:a,open:o,children:[(0,La.jsx)(iO,{children:(0,La.jsx)(Wx,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",title:d.name,children:(0,La.jsx)("div",{className:"tlui-page-menu__name",children:d.name})})}),(0,La.jsx)(oO,{side:"bottom",align:"start",sideOffset:6,children:(0,La.jsxs)("div",{className:"tlui-page-menu__wrapper",children:[(0,La.jsxs)("div",{className:"tlui-page-menu__header",children:[(0,La.jsx)("div",{className:"tlui-page-menu__header__title",children:n("page-menu.title")}),!f&&(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Wx,{"data-testid":"page-menu.edit",title:n(g?"page-menu.edit-done":"page-menu.edit-start"),icon:g?"check":"edit",onClick:y}),(0,La.jsx)(Wx,{"data-testid":"page-menu.create",icon:"plus",title:n(p?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:p,onClick:I})]})]}),(0,La.jsx)("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:s*c.length+4},ref:u,children:c.map((function(t,i){var o,a=null!==(o=k[t.id])&&void 0!==o?o:{position:40*i,offsetY:0};return g?(0,La.jsxs)("div",{"data-testid":"page-menu-item-".concat(t.id),className:"tlui-page_menu__item__sortable",style:{zIndex:t.id===d.id?888:i,transform:"translate(0px, ".concat(a.y+a.offsetY,"px)")},children:[(0,La.jsx)(Wx,{tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:_,onPointerUp:E,onPointerMove:P,onKeyDown:C,"data-id":t.id,"data-index":i}),r<5&&h?(0,La.jsx)(Wx,{className:"tlui-page-menu__item__button",onClick:function(){var n=window.prompt("Rename page",t.name);n&&n!==t.name&&e.renamePage(t.id,n)},onDoubleClick:y,isChecked:t.id===d.id,children:(0,La.jsx)("span",{children:t.name})}):(0,La.jsx)("div",{id:"page-menu-item-".concat(t.id),"data-testid":"page-menu-item-".concat(t.id),className:"tlui-page_menu__item__sortable__title",style:{height:s},children:(0,La.jsx)(cO,{id:t.id,name:t.name,isCurrentPage:t.id===d.id})}),!f&&(0,La.jsx)("div",{className:"tlui-page_menu__item__submenu","data-isediting":g,children:(0,La.jsx)(fO,{index:i,item:t,listSize:c.length})})]},t.id+"_editing"):(0,La.jsxs)("div",{"data-testid":"page-menu-item-".concat(t.id),className:"tlui-page-menu__item",children:[(0,La.jsxs)(Wx,{className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:function(){return e.setCurrentPageId(t.id)},onDoubleClick:y,isChecked:t.id===d.id,title:n("page-menu.go-to-page"),children:[(0,La.jsx)("div",{className:"tlui-page-menu__item__button__check",children:t.id===d.id&&(0,La.jsx)(Nx,{icon:"check"})}),(0,La.jsx)("span",{children:t.name})]}),!f&&(0,La.jsx)("div",{className:"tlui-page_menu__item__submenu",children:(0,La.jsx)(fO,{index:i,item:t,listSize:c.length,onRename:function(){if(e.isIos){var n=window.prompt("Rename page",t.name);n&&n!==t.name&&e.renamePage(t.id,n)}else m(!0),e.setCurrentPageId(t.id)}})})]},t.id)}))})]})})]})},hO=(0,t.memo)((function(){var e=Lx(),t=ST(),n=HI().redo;return(0,La.jsx)(Wx,{"data-testid":"main.redo",icon:n.icon,title:"".concat(e(n.label)," ").concat(Ux(n.kbd)),disabled:!t,onClick:function(){return n.onSelect("quick-actions")},smallIcon:!0})})),vO=ke((function(){var e=Ka(),t=HI(),n=Lx(),r=t.delete;if(yT())return null;var i=e.selectedIds.length<=0;return(0,La.jsx)(Wx,{icon:r.icon,onClick:function(){return r.onSelect("quick-actions")},disabled:i,title:"".concat(n(r.label)," ").concat(Ux(r.kbd)),smallIcon:!0})})),gO=(0,t.memo)((function(){var e=Lx(),t=_T(),n=HI().undo;return(0,La.jsx)(Wx,{"data-testid":"main.undo",icon:n.icon,title:"".concat(e(n.label)," ").concat(Ux(n.kbd)),disabled:!t,onClick:function(){return n.onSelect("quick-actions")},smallIcon:!0})})),mO=ke((function(){var e=Ka(),t=oT(),n=!yT()&&!e.isInAny("hand","zoom","eraser");return(0,La.jsx)("div",{className:"tlui-menu-zone",children:(0,La.jsxs)("div",{className:"tlui-menu-zone__controls",children:[(0,La.jsx)(uO,{}),(0,La.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,La.jsx)(pO,{}),t>=6&&n&&(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,La.jsx)(gO,{}),(0,La.jsx)(hO,{}),(0,La.jsx)(vO,{}),(0,La.jsx)(sO,{}),(0,La.jsx)(aO,{})]})]})})}));var yO=function(){function e(t,n){var r=this;j(this,e),D(this,"colors",{shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"}),D(this,"id",ef()),D(this,"cvs",null),D(this,"pageBounds",[]),D(this,"collaborators",[]),D(this,"canvasScreenBounds",new ws),D(this,"canvasPageBounds",new ws),D(this,"contentPageBounds",new ws),D(this,"contentScreenBounds",new ws),D(this,"originPagePoint",new Ya),D(this,"originPageCenter",new Ya),D(this,"isInViewport",!1),D(this,"debug",!1),D(this,"updateContentScreenBounds",(function(){var e=r.contentScreenBounds,t=r.contentPageBounds,n=r.canvasScreenBounds,i=e.x,o=e.y,a=e.w,s=e.h;if(t.w>t.h){var u=n.w/(t.w/t.h);u>n.h?(i=(n.w-n.w*(n.h/u))/2,o=0,a=n.w*(n.h/u),s=n.h):(i=0,o=(n.h-u)/2,a=n.w,s=u)}else if(t.w<t.h){var l=n.h/(t.h/t.w);i=(n.w-l)/2,o=0,a=l,s=n.h}else i=n.h/2,o=0,a=n.h,s=n.h;e.set(i,o,a,s)})),D(this,"updateCanvasPageBounds",(function(){var e=r.canvasPageBounds,t=r.canvasScreenBounds,n=r.contentPageBounds,i=r.contentScreenBounds;e.set(0,0,n.width/(i.width/t.width),n.height/(i.height/t.height)),e.center=n.center})),D(this,"getScreenPoint",(function(e,t){var n=r.canvasScreenBounds;return{x:(e-n.minX)*r.dpr,y:(t-n.minY)*r.dpr}})),D(this,"getPagePoint",(function(e,t){var n=r.contentPageBounds,i=r.contentScreenBounds,o=r.canvasPageBounds,a=r.getScreenPoint(e,t),s=a.x,u=a.y;return{x:o.minX+s*n.width/i.width,y:o.minY+u*n.height/i.height,z:1}})),D(this,"minimapScreenPointToPagePoint",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=r.editor.viewportPageBounds,a=r.getPagePoint(e,t),s=a.x,u=a.y;if(i){var l,c,d,f,p=r.editor.allShapesCommonBounds,h=o,v=(null!==(l=null===p||void 0===p?void 0:p.minX)&&void 0!==l?l:0)-h.width/2,g=(null!==(c=null===p||void 0===p?void 0:p.maxX)&&void 0!==c?c:0)+h.width/2,m=(null!==(d=null===p||void 0===p?void 0:p.minY)&&void 0!==d?d:0)-h.height/2,y=(null!==(f=null===p||void 0===p?void 0:p.maxY)&&void 0!==f?f:0)+h.height/2,b=Math.max(0,v+h.width-s),w=Math.max(0,-(g-h.width-s)),x=Math.max(0,m+h.height-u),k=Math.max(0,-(y-h.height-u)),S=Math.max(0,b-w),_=Math.max(0,w-b),P=Math.max(0,x-k),E=Math.max(0,k-x);S&&S>_?s+=S/2:_&&(s-=_/2),P&&P>E?u+=P/2:E&&(u-=E/2),s=Ja(s,v,g),u=Ja(u,m,y)}if(n){var C=r.originPagePoint;Math.abs(s-C.x)>Math.abs(u-C.y)?u=C.y:s=C.x}return{x:s,y:u}})),D(this,"render",(function(){var t=r.cvs,n=r.pageBounds;r.updateCanvasPageBounds();var i=r.editor,o=r.canvasScreenBounds,a=r.canvasPageBounds,s=r.contentPageBounds,u=r.contentScreenBounds,l=o.width,c=o.height,d=i.viewportPageBounds,f=i.selectedIds;if(t&&n){var p=t.getContext("2d");if(!p)throw new Error("Minimap (shapes): Could not get context");p.resetTransform(),p.globalAlpha=1,p.clearRect(0,0,l,c);var h=u.width/s.width,v=u.height/s.height;p.translate((l-u.width)/2,(c-u.height)/2),p.scale(h,v),p.translate(-s.minX,-s.minY);for(var g,m=8/h,y=8/h,b=1/h,w=1/h,x=m/4,k=y/4,S=new Path2D,_=new Path2D,P=r.colors,E=P.shapeFill,C=P.selectFill,I=P.viewportFill,T=0,M=n.length;T<M;T++)g=n[T],e.roundedRect(f.includes(g.id)?_:S,g.minX,g.minY,g.width,g.height,Ja(m,b,g.width/x),Ja(y,w,g.height/k));if(p.fillStyle=E,p.fill(S),p.fillStyle=C,p.fill(_),r.debug){var j=ws.Common(n),A=j.minX,O=j.minY,L=j.width,z=j.height;p.strokeStyle="green",p.lineWidth=2/h,p.strokeRect(A+1/h,O+1/v,L-2/h,z-2/v)}var D=i.brush;if(D){var N=D.x,R=D.y,B=D.w,F=D.h;p.beginPath(),e.sharpRect(p,N,R,B,F),p.closePath(),p.fillStyle=I,p.fill()}var U=d.minX,K=d.minY,V=d.width,W=d.height;p.beginPath();var H=12/h,Y=12/h;e.roundedRect(p,U,K,V,W,Math.min(V/4,H),Math.min(W/4,Y)),p.closePath(),p.fillStyle=I,p.fill(),r.debug&&(p.strokeStyle="orange",p.strokeRect(U+1/h,K+1/v,V-2/h,W-2/v));for(var X,q=2.5/h,$=2.5/v,G=i.currentPageId,Q=0;Q<r.collaborators.length;Q++)(X=r.collaborators[Q]).currentPageId===G&&(p.beginPath(),p.ellipse(Ja(X.cursor.x,a.minX+q,a.maxX-q),Ja(X.cursor.y,a.minY+$,a.maxY-$),5/h,5/v,0,0,Ga),p.fillStyle=X.color,p.fill());if(r.debug){p.lineWidth=2/h;var Z=s.minX,J=s.minY,ee=s.width,te=s.height;p.strokeStyle="red",p.strokeRect(Z+1/h,J+1/v,ee-2/h,te-2/v);var ne=a.minX,re=a.minY,ie=a.width,oe=a.height;p.strokeStyle="blue",p.strokeRect(ne+1/h,re+1/v,ie-2/h,oe-2/v)}}})),this.editor=t,this.dpr=n}return z(e,[{key:"setDpr",value:function(e){this.dpr=+e.toFixed(2)}}],[{key:"roundedRect",value:function(e,t,n,r,i,o,a){o<1&&a<1?e.rect(t,n,r,i):(e.moveTo(t+o,n),e.lineTo(t+r-o,n),e.quadraticCurveTo(t+r,n,t+r,n+a),e.lineTo(t+r,n+i-a),e.quadraticCurveTo(t+r,n+i,t+r-o,n+i),e.lineTo(t+o,n+i),e.quadraticCurveTo(t,n+i,t,n+i-a),e.lineTo(t,n+a),e.quadraticCurveTo(t,n,t+o,n))}},{key:"sharpRect",value:function(e,t,n,r,i,o,a){e.rect(t,n,r,i)}}]),e}(),bO=ke((function(e){var n=e.shapeFill,r=e.selectFill,i=e.viewportFill,o=Ka(),a=t.useRef(null),s=wu(),u=t.useRef(!1),l=t.useMemo((function(){return new yO(o,o.devicePixelRatio)}),[o]),c=o.isDarkMode;t.useEffect((function(){var e=requestAnimationFrame((function(){var e=getComputedStyle(s);l.colors={shapeFill:e.getPropertyValue(n).trim(),selectFill:e.getPropertyValue(r).trim(),viewportFill:e.getPropertyValue(i).trim()},l.render()}));return function(){cancelAnimationFrame(e)}}),[s,r,n,i,l,c]);var d=t.useCallback((function(e){if(o.currentPageShapeIds.size){var t=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!1),n=t.x,r=t.y,i=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!0);l.originPagePoint.setTo(i),l.originPageCenter.setTo(o.viewportPageBounds.center),o.centerOnPoint(n,r,{duration:Tu})}}),[o,l]),f=t.useCallback((function(e){if(e.currentTarget.setPointerCapture(e.pointerId),o.currentPageShapeIds.size){u.current=!0,l.isInViewport=!1;var t=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!1),n=t.x,r=t.y,i=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!0),a=o.viewportPageBounds;l.originPagePoint.setTo(i),l.originPageCenter.setTo(a.center),l.isInViewport=a.containsPoint(i),l.isInViewport||o.centerOnPoint(n,r,{duration:Tu})}}),[o,l]),p=t.useCallback((function(e){if(u.current){var t=l.minimapScreenPointToPagePoint(e.clientX,e.clientY,e.shiftKey,!0),n=t.x,r=t.y;if(l.isInViewport){var i=Ya.Sub({x:n,y:r},l.originPagePoint),a=Ya.Add(l.originPageCenter,i);return void o.centerOnPoint(a.x,a.y)}o.centerOnPoint(n,r)}var s=l.getPagePoint(e.clientX,e.clientY),c=o.pageToScreen(s.x,s.y),d=Ce(Ce({type:"pointer",target:"canvas",name:"pointer_move"},function(e){return e.isKilled=!0,{point:{x:e.clientX,y:e.clientY,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:"pen"===e.pointerType}}(e)),{},{point:c,isPen:o.isPenMode});o.dispatch(d)}),[o,l]),h=t.useCallback((function(e){u.current=!1}),[]),v=t.useCallback((function(e){var t=yc(e);o.dispatch({type:"wheel",name:"wheel",delta:t,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey})}),[o]);Se("update dpr",(function(){var e=o.devicePixelRatio;l.setDpr(e);var t=a.current,n=t.getBoundingClientRect(),r=n.width*e,i=n.height*e;t.width=r,t.height=i,l.canvasScreenBounds.set(n.x,n.y,r,i),l.cvs=a.current}),[o,l]);var g=t.useMemo((function(){return o.store.query.records("instance_presence")}),[o]);return Se("minimap render when pagebounds or collaborators changes",(function(){o.devicePixelRatio;var e=o.viewportPageBounds,t=o.allShapesCommonBounds;l.contentPageBounds=t?ws.Expand(t,e):e,l.updateContentScreenBounds();var n=[];o.currentPageShapeIds.forEach((function(e){var t=o.getPageBoundsById(e),r=o.getPageMaskById(e);if(r){var i=Hs(r,t.corners);if(!i)return;t=ws.FromPoints(i)}t&&(t.id=e,n.push(t))})),l.pageBounds=n,l.collaborators=g.value,l.render()}),[o,l]),(0,La.jsx)("div",{className:"tlui-minimap",children:(0,La.jsx)("canvas",{ref:a,className:"tlui-minimap__canvas",onDoubleClick:d,onPointerMove:p,onPointerDown:f,onPointerUp:h,onWheel:v})})}));var wO=ke((function(){var e=Ka(),n=Lx(),r=oT(),i=e.zoomLevel,o=e.currentPageShapeIds.size>0,a=e.selectedIds.length>0,s=1===e.zoomLevel,u=t.useCallback((function(){e.resetZoom(e.viewportScreenCenter,{duration:Tu})}),[e]);return(0,La.jsxs)(OE,{id:"zoom",children:[(0,La.jsx)(LE,{children:(0,La.jsx)(Wx,{title:"".concat(n("navigation-zone.zoom")),"data-testid":"minimap.zoom-menu",className:r<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:u,icon:r<4?"zoom-in":void 0,children:r<4?null:(0,La.jsxs)("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(100*i),"%"]})})}),(0,La.jsx)(zE,{side:"top",align:"start",alignOffset:0,children:(0,La.jsxs)(BE,{children:[(0,La.jsx)(xO,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),(0,La.jsx)(xO,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),(0,La.jsx)(xO,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:s}),(0,La.jsx)(xO,{action:"zoom-to-fit",disabled:!o,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),(0,La.jsx)(xO,{action:"zoom-to-selection",disabled:!a,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})}));function xO(e){var t=e.action,n=e.disabled,r=void 0!==n&&n,i=e.noClose,o=void 0!==i&&i,a=HI();return(0,La.jsx)(FE,{label:a[t].label,kbd:a[t].kbd,"data-testid":e["data-testid"],onClick:function(){return a[t].onSelect("zoom-menu")},noClose:o,disabled:r})}var kO=(0,t.memo)((function(){var e=HI(),n=Lx(),r=oT(),i=function(e,n){var r=l(t.useState(n),2),i=r[0],o=r[1];t.useLayoutEffect((function(){var t=localStorage.getItem(e);if(t)try{o(JSON.parse(t))}catch(ok){console.error("Could not restore value ".concat(e," from local storage."))}}),[e]);var a=t.useCallback((function(t){o((function(n){var r="function"===typeof t?t(n):t;return localStorage.setItem(e,JSON.stringify(r)),r}))}),[e]);return[i,a]}("minimap",!0),o=l(i,2),a=o[0],s=o[1],u=(0,t.useCallback)((function(){s((function(e){return!e}))}),[s]);return r<4?null:(0,La.jsxs)("div",{className:"tlui-navigation-zone",children:[(0,La.jsx)("div",{className:"tlui-navigation-zone__controls",children:r<6?(0,La.jsx)(wO,{}):a?(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(wO,{}),(0,La.jsx)(Wx,{title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle","data-testid":"minimap.toggle",onClick:u,icon:a?"chevrons-ne":"chevrons-sw"})]}):(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(Wx,{icon:"minus","data-testid":"minimap.zoom-out",title:"".concat(n(e["zoom-out"].label)," ").concat(Ux(e["zoom-out"].kbd)),onClick:function(){return e["zoom-out"].onSelect("navigation-zone")}}),(0,La.jsx)(wO,{}),(0,La.jsx)(Wx,{icon:"plus","data-testid":"minimap.zoom-in",title:"".concat(n(e["zoom-in"].label)," ").concat(Ux(e["zoom-in"].kbd)),onClick:function(){return e["zoom-in"].onSelect("navigation-zone")}}),(0,La.jsx)(Wx,{title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:u,icon:a?"chevrons-ne":"chevrons-sw"})]})}),r>=6&&!a&&(0,La.jsx)(bO,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})})),SO=ke((function(){var e=Ka().isPenMode,t=HI();if(!e)return null;var n=t["exit-pen-mode"];return(0,La.jsx)(Wx,{label:n.label,iconLeft:n.icon,onClick:function(){return n.onSelect("helper-buttons")}})})),_O=ke((function(){var e=Ka(),t=HI();if(!e.instanceState.followingUserId)return null;var n=t["stop-following"];return(0,La.jsx)(Wx,{label:n.label,iconLeft:n.icon,onClick:function(){return n.onSelect("people-menu")}})}));var PO=t.memo((function(e){var n=e.uiType,r=e.items,i=e.title,o=e.style,a=e.value,s=e.columns,u=void 0===s?Ja(r.length,2,4):s,l=e.onValueChange,c=Ka(),d=Lx(),f=(0,t.useRef)(!1),p=t.useMemo((function(){var e=function e(){f.current=!1,window.removeEventListener("pointerup",e)};return{handleButtonClick:function(e){var t=e.currentTarget.dataset.id;"shared"===a.type&&a.value===t||(c.mark("point picker item"),l(o,t,!1))},handleButtonPointerDown:function(t){var n=t.currentTarget.dataset.id;c.mark("point picker item"),l(o,n,!0),f.current=!0,window.addEventListener("pointerup",e)},handleButtonPointerEnter:function(e){if(f.current){var t=e.currentTarget.dataset.id;l(o,t,!0)}},handleButtonPointerUp:function(e){var t=e.currentTarget.dataset.id;l(o,t,!1)}}}),[a,c,l,o]),h=p.handleButtonClick,v=p.handleButtonPointerDown,g=p.handleButtonPointerEnter,m=p.handleButtonPointerUp,y=_e("theme",(function(){return Ji(c)}),[c]);return(0,La.jsx)("div",{className:Fa("tlui-button-grid",{"tlui-button-grid__two":2===u,"tlui-button-grid__three":3===u,"tlui-button-grid__four":4===u}),children:r.map((function(e){return(0,La.jsx)(Wx,{"data-id":e.value,"data-testid":"style.".concat(n,".").concat(e.value),"aria-label":e.value,"data-state":"shared"===a.type&&a.value===e.value?"hinted":void 0,title:i+" \u2014 "+d("".concat(n,"-style.").concat(e.value)),className:Fa("tlui-button-grid__button"),style:o===io?{color:y[e.value].solid}:void 0,onPointerEnter:g,onPointerDown:v,onPointerUp:m,onClick:h,icon:e.icon},e.value)}))})}));function EO(e,t){var n=l(t,2),r=n[0],i=n[1];return Math.min(i,Math.max(r,e))}var CO=["name","min","max","step","orientation","disabled","minStepsBetweenThumbs","defaultValue","value","onValueChange","onValueCommit","inverted"],IO=["min","max","dir","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"],TO=["min","max","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"],MO=["__scopeSlider","onSlideStart","onSlideMove","onSlideEnd","onHomeKeyDown","onEndKeyDown","onStepKeyDown"],jO=["__scopeSlider"],AO=["__scopeSlider"],OO=["__scopeSlider","index"],LO=["value"],zO=["PageUp","PageDown"],DO=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],NO={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},RO="Slider",BO=l(Qx(RO),3),FO=BO[0],UO=BO[1],KO=BO[2],VO=l(eb(RO,[KO]),2),WO=VO[0],HO=(VO[1],l(WO(RO),2)),YO=HO[0],XO=HO[1],qO=(0,t.forwardRef)((function(e,n){var r=e.name,i=e.min,o=void 0===i?0:i,a=e.max,s=void 0===a?100:a,u=e.step,c=void 0===u?1:u,f=e.orientation,p=void 0===f?"horizontal":f,h=e.disabled,v=void 0!==h&&h,g=e.minStepsBetweenThumbs,m=void 0===g?0:g,y=e.defaultValue,b=void 0===y?[o]:y,w=e.value,x=e.onValueChange,k=void 0===x?function(){}:x,S=e.onValueCommit,_=void 0===S?function(){}:S,P=e.inverted,E=void 0!==P&&P,C=gt(e,CO),I=l((0,t.useState)(null),2),T=I[0],M=I[1],j=Qy(n,(function(e){return M(e)})),A=(0,t.useRef)(new Set),O=(0,t.useRef)(0),L="horizontal"===p,z=!T||Boolean(T.closest("form")),D=L?ZO:JO,N=l(sb({prop:w,defaultProp:b,onChange:function(e){var t;null===(t=d(A.current)[O.current])||void 0===t||t.focus(),k(e)}}),2),R=N[0],B=void 0===R?[]:R,F=N[1],U=(0,t.useRef)(B);function K(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{commit:!1}).commit,r=function(e){return(String(e).split(".")[1]||"").length}(c),i=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}(Math.round((e-o)/c)*c+o,r),a=EO(i,[o,s]);F((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=d(e);return r[n]=t,r.sort((function(e,t){return e-t}))}(e,a,t);if(function(e,t){if(t>0){var n=function(e){return e.slice(0,-1).map((function(t,n){return e[n+1]-t}))}(e);return Math.min.apply(Math,d(n))>=t}return!0}(r,m*c)){O.current=r.indexOf(a);var i=String(r)!==String(e);return i&&n&&_(r),i?r:e}return e}))}return(0,t.createElement)(YO,{scope:e.__scopeSlider,disabled:v,min:o,max:s,valueIndexToChangeRef:O,thumbs:A.current,values:B,orientation:p},(0,t.createElement)(FO.Provider,{scope:e.__scopeSlider},(0,t.createElement)(FO.Slot,{scope:e.__scopeSlider},(0,t.createElement)(D,qy({"aria-disabled":v,"data-disabled":v?"":void 0},C,{ref:j,onPointerDown:$y(C.onPointerDown,(function(){v||(U.current=B)})),min:o,max:s,inverted:E,onSlideStart:v?void 0:function(e){var t=function(e,t){if(1===e.length)return 0;var n=e.map((function(e){return Math.abs(e-t)})),r=Math.min.apply(Math,d(n));return n.indexOf(r)}(B,e);K(e,t)},onSlideMove:v?void 0:function(e){K(e,O.current)},onSlideEnd:v?void 0:function(){var e=U.current[O.current];B[O.current]!==e&&_(B)},onHomeKeyDown:function(){return!v&&K(o,0,{commit:!0})},onEndKeyDown:function(){return!v&&K(s,B.length-1,{commit:!0})},onStepKeyDown:function(e){var t=e.event,n=e.direction;if(!v){var r=zO.includes(t.key)||t.shiftKey&&DO.includes(t.key)?10:1,i=O.current;K(B[i]+c*r*n,i,{commit:!0})}}})))),z&&B.map((function(e,n){return(0,t.createElement)(uL,{key:n,name:r?r+(B.length>1?"[]":""):void 0,value:e})})))})),$O=l(WO(RO,{startEdge:"left",endEdge:"right",size:"width",direction:1}),2),GO=$O[0],QO=$O[1],ZO=(0,t.forwardRef)((function(e,n){var r=e.min,i=e.max,o=e.dir,a=e.inverted,s=e.onSlideStart,u=e.onSlideMove,c=e.onSlideEnd,d=e.onStepKeyDown,f=gt(e,IO),p=l((0,t.useState)(null),2),h=p[0],v=p[1],g=Qy(n,(function(e){return v(e)})),m=(0,t.useRef)(),y=Jx(o),b="ltr"===y,w=b&&!a||!b&&a;function x(e){var t=m.current||h.getBoundingClientRect(),n=cL([0,t.width],w?[r,i]:[i,r]);return m.current=t,n(e-t.left)}return(0,t.createElement)(GO,{scope:e.__scopeSlider,startEdge:w?"left":"right",endEdge:w?"right":"left",direction:w?1:-1,size:"width"},(0,t.createElement)(eL,qy({dir:y,"data-orientation":"horizontal"},f,{ref:g,style:Ce(Ce({},f.style),{},D({},"--radix-slider-thumb-transform","translateX(-50%)")),onSlideStart:function(e){var t=x(e.clientX);null===s||void 0===s||s(t)},onSlideMove:function(e){var t=x(e.clientX);null===u||void 0===u||u(t)},onSlideEnd:function(){m.current=void 0,null===c||void 0===c||c()},onStepKeyDown:function(e){var t=NO[w?"from-left":"from-right"].includes(e.key);null===d||void 0===d||d({event:e,direction:t?-1:1})}})))})),JO=(0,t.forwardRef)((function(e,n){var r=e.min,i=e.max,o=e.inverted,a=e.onSlideStart,s=e.onSlideMove,u=e.onSlideEnd,l=e.onStepKeyDown,c=gt(e,TO),d=(0,t.useRef)(null),f=Qy(n,d),p=(0,t.useRef)(),h=!o;function v(e){var t=p.current||d.current.getBoundingClientRect(),n=cL([0,t.height],h?[i,r]:[r,i]);return p.current=t,n(e-t.top)}return(0,t.createElement)(GO,{scope:e.__scopeSlider,startEdge:h?"bottom":"top",endEdge:h?"top":"bottom",size:"height",direction:h?1:-1},(0,t.createElement)(eL,qy({"data-orientation":"vertical"},c,{ref:f,style:Ce(Ce({},c.style),{},D({},"--radix-slider-thumb-transform","translateY(50%)")),onSlideStart:function(e){var t=v(e.clientY);null===a||void 0===a||a(t)},onSlideMove:function(e){var t=v(e.clientY);null===s||void 0===s||s(t)},onSlideEnd:function(){p.current=void 0,null===u||void 0===u||u()},onStepKeyDown:function(e){var t=NO[h?"from-bottom":"from-top"].includes(e.key);null===l||void 0===l||l({event:e,direction:t?-1:1})}})))})),eL=(0,t.forwardRef)((function(e,n){var r=e.__scopeSlider,i=e.onSlideStart,o=e.onSlideMove,a=e.onSlideEnd,s=e.onHomeKeyDown,u=e.onEndKeyDown,l=e.onStepKeyDown,c=gt(e,MO),d=XO(RO,r);return(0,t.createElement)(gb.span,qy({},c,{ref:n,onKeyDown:$y(e.onKeyDown,(function(e){"Home"===e.key?(s(e),e.preventDefault()):"End"===e.key?(u(e),e.preventDefault()):zO.concat(DO).includes(e.key)&&(l(e),e.preventDefault())})),onPointerDown:$y(e.onPointerDown,(function(e){var t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),d.thumbs.has(t)?t.focus():i(e)})),onPointerMove:$y(e.onPointerMove,(function(e){e.target.hasPointerCapture(e.pointerId)&&o(e)})),onPointerUp:$y(e.onPointerUp,(function(e){var t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),a(e))}))}))})),tL="SliderTrack",nL=(0,t.forwardRef)((function(e,n){var r=e.__scopeSlider,i=gt(e,jO),o=XO(tL,r);return(0,t.createElement)(gb.span,qy({"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation},i,{ref:n}))})),rL="SliderRange",iL=(0,t.forwardRef)((function(e,n){var r,i=e.__scopeSlider,o=gt(e,AO),a=XO(rL,i),s=QO(rL,i),u=Qy(n,(0,t.useRef)(null)),l=a.values.length,c=a.values.map((function(e){return lL(e,a.min,a.max)})),f=l>1?Math.min.apply(Math,d(c)):0,p=100-Math.max.apply(Math,d(c));return(0,t.createElement)(gb.span,qy({"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0},o,{ref:u,style:Ce(Ce({},e.style),{},(r={},D(r,s.startEdge,f+"%"),D(r,s.endEdge,p+"%"),r))}))})),oL="SliderThumb",aL=(0,t.forwardRef)((function(e,n){var r=UO(e.__scopeSlider),i=l((0,t.useState)(null),2),o=i[0],a=i[1],s=Qy(n,(function(e){return a(e)})),u=(0,t.useMemo)((function(){return o?r().findIndex((function(e){return e.ref.current===o})):-1}),[r,o]);return(0,t.createElement)(sL,qy({},e,{ref:s,index:u}))})),sL=(0,t.forwardRef)((function(e,n){var r=e.__scopeSlider,i=e.index,o=gt(e,OO),a=XO(oL,r),s=QO(oL,r),u=l((0,t.useState)(null),2),c=u[0],d=u[1],f=Qy(n,(function(e){return d(e)})),p=kS(c),h=a.values[i],v=void 0===h?0:lL(h,a.min,a.max),g=function(e,t){return t>2?"Value ".concat(e+1," of ").concat(t):2===t?["Minimum","Maximum"][e]:void 0}(i,a.values.length),m=null===p||void 0===p?void 0:p[s.size],y=m?function(e,t,n){var r=e/2,i=cL([0,50],[0,r]);return(r-i(t)*n)*n}(m,v,s.direction):0;return(0,t.useEffect)((function(){if(c)return a.thumbs.add(c),function(){a.thumbs.delete(c)}}),[c,a.thumbs]),(0,t.createElement)("span",{style:D({transform:"var(--radix-slider-thumb-transform)",position:"absolute"},s.startEdge,"calc(".concat(v,"% + ").concat(y,"px)"))},(0,t.createElement)(FO.ItemSlot,{scope:e.__scopeSlider},(0,t.createElement)(gb.span,qy({role:"slider","aria-label":e["aria-label"]||g,"aria-valuemin":a.min,"aria-valuenow":h,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0},o,{ref:f,style:void 0===h?{display:"none"}:e.style,onFocus:$y(e.onFocus,(function(){a.valueIndexToChangeRef.current=i}))}))))})),uL=function(e){var n=e.value,r=gt(e,LO),i=(0,t.useRef)(null),o=function(e){var n=(0,t.useRef)({value:e,previous:e});return(0,t.useMemo)((function(){return n.current.value!==e&&(n.current.previous=n.current.value,n.current.value=e),n.current.previous}),[e])}(n);return(0,t.useEffect)((function(){var e=i.current,t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"value").set;if(o!==n&&r){var a=new Event("input",{bubbles:!0});r.call(e,n),e.dispatchEvent(a)}}),[o,n]),(0,t.createElement)("input",qy({style:{display:"none"}},r,{ref:i,defaultValue:n}))};function lL(e,t,n){return EO(100/(n-t)*(e-t),[0,100])}function cL(e,t){return function(n){if(e[0]===e[1]||t[0]===t[1])return t[0];var r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}var dL=qO,fL=nL,pL=iL,hL=aL,vL=(0,t.memo)((function(e){var n=e.title,r=e.steps,i=e.value,o=e.label,a=e.onValueChange,s=Ka(),u=Lx(),l=(0,t.useCallback)((function(e){a(e[0],!0)}),[a]),c=(0,t.useCallback)((function(){s.mark("click slider")}),[s]),d=(0,t.useCallback)((function(){i&&a(i,!1)}),[i,a]);return(0,La.jsx)("div",{className:"tlui-slider__container",children:(0,La.jsxs)(dL,{"data-testid":e["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:i?[i]:void 0,onPointerDown:c,onValueChange:l,onPointerUp:d,title:n+" \u2014 "+u(o),children:[(0,La.jsx)(fL,{className:"tlui-slider__track",dir:"ltr",children:null!==i&&(0,La.jsx)(pL,{className:"tlui-slider__range",dir:"ltr"})}),null!==i&&(0,La.jsx)(hL,{className:"tlui-slider__thumb",dir:"ltr"})]})})})),gL=t.memo((function(e){var n=e.label,r=e.uiTypeA,i=e.uiTypeB,o=e.labelA,a=e.labelB,s=e.itemsA,u=e.itemsB,l=e.styleA,c=e.styleB,d=e.valueA,f=e.valueB,p=e.onValueChange,h=Lx(),v=t.useMemo((function(){var e,t;return null!==(e=null===(t=s.find((function(e){return"shared"===d.type&&d.value===e.value})))||void 0===t?void 0:t.icon)&&void 0!==e?e:"mixed"}),[s,d]),g=t.useMemo((function(){var e,t;return null!==(e=null===(t=u.find((function(e){return"shared"===f.type&&f.value===e.value})))||void 0===t?void 0:t.icon)&&void 0!==e?e:"mixed"}),[u,f]);return void 0===d&&void 0===f?null:(0,La.jsxs)("div",{className:"tlui-style-panel__double-select-picker",children:[(0,La.jsx)("div",{title:h(n),className:"tlui-style-panel__double-select-picker-label",children:h(n)}),(0,La.jsxs)(OE,{id:"style panel ".concat(r," A"),children:[(0,La.jsx)(vE,{asChild:!0,children:(0,La.jsx)(Wx,{"data-testid":"style.".concat(r),title:h(o)+" \u2014 "+h(null===d?"style-panel.mixed":"".concat(r,"-style.").concat(d)),icon:v,invertIcon:!0,smallIcon:!0})}),(0,La.jsx)(zE,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,La.jsx)("div",{className:Fa("tlui-button-grid",{"tlui-button-grid__two":s.length<4,"tlui-button-grid__four":s.length>=4}),children:s.map((function(e){return(0,La.jsx)(FE,{className:"tlui-button-grid__button",title:h(o)+" \u2014 "+h("".concat(r,"-style.").concat(e.value)),"data-testid":"style.".concat(r,".").concat(e.value),icon:e.icon,onClick:function(){return p(l,e.value,!1)},invertIcon:!0},e.value)}))})})]}),(0,La.jsxs)(OE,{id:"style panel ".concat(i),children:[(0,La.jsx)(vE,{asChild:!0,children:(0,La.jsx)(Wx,{"data-testid":"style.".concat(i),title:h(a)+" \u2014 "+h(null===f?"style-panel.mixed":"".concat(i,"-style.").concat(f)),icon:g,smallIcon:!0})}),(0,La.jsx)(zE,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,La.jsx)("div",{className:Fa("tlui-button-grid",{"tlui-button-grid__two":s.length<4,"tlui-button-grid__four":s.length>=4}),children:u.map((function(e){return(0,La.jsx)(FE,{className:"tlui-button-grid__button",title:h(a)+" \u2014 "+h("".concat(i,"-style.").concat(e.value)),"data-testid":"style.".concat(i,".").concat(e.value),icon:e.icon,onClick:function(){return p(c,e.value,!1)}},e.value)}))})})]})]})})),mL=t.memo((function(e){var n=e.id,r=e.label,i=e.uiType,o=e.style,a=e.items,s=e.value,u=e.onValueChange,l=Lx(),c=t.useMemo((function(){var e;return null===(e=a.find((function(e){return"shared"===s.type&&e.value===s.value})))||void 0===e?void 0:e.icon}),[a,s]);return(0,La.jsxs)(OE,{id:"style panel ".concat(n),children:[(0,La.jsx)(vE,{asChild:!0,children:(0,La.jsx)(Wx,{"data-testid":"style.".concat(i),title:"mixed"===s.type?l("style-panel.mixed"):l("".concat(i,"-style.").concat(s.value)),label:r,icon:null!==c&&void 0!==c?c:"mixed"})}),(0,La.jsx)(zE,{side:"left",align:"center",alignOffset:0,children:(0,La.jsx)("div",{className:Fa("tlui-button-grid",{"tlui-button-grid__two":a.length<3,"tlui-button-grid__three":3==a.length,"tlui-button-grid__four":a.length>=4}),children:a.map((function(e){return(0,La.jsx)(FE,{className:"tlui-button-grid__button","data-testid":"style.".concat(i,".").concat(e.value),title:l("".concat(i,"-style.").concat(e.value)),icon:e.icon,onClick:function(){return u(o,e.value,!1)}},e.value)}))})})]})})),yL={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},bL=[io,ao,so,co];var wL=function(e){var n=e.isMobile,r=Ka(),i=_e("getRelevantStyles",(function(){return function(e){var t,n=new uv(e.sharedStyles),r=e.selectedIds.length>0||!(null===(t=e.root.current.value)||void 0===t||!t.shapeType);if(0===n.size&&e.isIn("select")&&0===e.selectedIds.length)for(var i=0,o=bL;i<o.length;i++){var a=o[i];n.applyValue(a,e.getStyleForNextShape(a))}return 0!==n.size||r?{styles:n,opacity:e.sharedOpacity}:null}(r)}),[r]),o=(0,t.useCallback)((function(){n||(r.isChangingStyle=!1)}),[r,n]);if(!i)return null;var a=i.styles,s=i.opacity,u=a.get($o),l=a.get(vo),c=a.get(ho),d=void 0===u,f=void 0===l&&void 0===c,p=void 0===a.get(pa),h=void 0===a.get(uo);return(0,La.jsxs)("div",{className:"tlui-style-panel","data-ismobile":n,onPointerLeave:o,children:[(0,La.jsx)(SL,{styles:a,opacity:s}),!h&&(0,La.jsx)(_L,{styles:a}),!(d&&f&&p)&&(0,La.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[(0,La.jsx)(PL,{styles:a}),(0,La.jsx)(CL,{styles:a}),(0,La.jsx)(EL,{styles:a})]})]})};function xL(){var e=Ka();return t.useMemo((function(){return function(t,n,r){e.setStyle(t,n,r),e.isChangingStyle=!0}}),[e])}var kL=[.1,.25,.5,.75,1];function SL(e){var n=e.styles,r=e.opacity,i=Ka(),o=Lx(),a=xL(),s=t.useCallback((function(e,t){var n=kL[e];i.setOpacity(n,t),i.isChangingStyle=!0}),[i]),u=n.get(io),l=n.get(so),c=n.get(ao),d=n.get(co),f=void 0!==l||void 0!==c||void 0!==d,p="mixed"===r.type?-1:kL.indexOf(je(kL,(function(e){return Math.abs(e-r.value)})));return(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)("div",{className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[void 0===u?null:(0,La.jsx)(PO,{title:o("style-panel.color"),uiType:"color",style:io,items:yL.color,value:u,onValueChange:a}),void 0===r?null:(0,La.jsx)(vL,{"data-testid":"style.opacity",value:p>=0?p:kL.length-1,label:"mixed"===r.type?"style-panel.mixed":"opacity-style.".concat(r),onValueChange:s,steps:kL.length-1,title:o("style-panel.opacity")})]}),f&&(0,La.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[void 0===l?null:(0,La.jsx)(PO,{title:o("style-panel.fill"),uiType:"fill",style:so,items:yL.fill,value:l,onValueChange:a}),void 0===c?null:(0,La.jsx)(PO,{title:o("style-panel.dash"),uiType:"dash",style:ao,items:yL.dash,value:c,onValueChange:a}),void 0===d?null:(0,La.jsx)(PO,{title:o("style-panel.size"),uiType:"size",style:co,items:yL.size,value:d,onValueChange:a})]})]})}function _L(e){var t=e.styles,n=Lx(),r=xL(),i=t.get(uo),o=t.get(Wo),a=t.get(Ho);return void 0===i&&void 0===o?null:(0,La.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[void 0===i?null:(0,La.jsx)(PO,{title:n("style-panel.font"),uiType:"font",style:uo,items:yL.font,value:i,onValueChange:r}),void 0===o?null:(0,La.jsxs)("div",{className:"tlui-style-panel__row",children:[(0,La.jsx)(PO,{title:n("style-panel.align"),uiType:"align",style:Wo,items:yL.horizontalAlign,value:o,onValueChange:r}),void 0===a?(0,La.jsx)(Wx,{title:n("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):(0,La.jsx)(mL,{id:"geo-vertical-alignment",uiType:"verticalAlign",style:Ho,items:yL.verticalAlign,value:a,onValueChange:r})]})]})}function PL(e){var t=e.styles,n=xL(),r=t.get($o);return void 0===r?null:(0,La.jsx)(mL,{id:"geo",label:"style-panel.geo",uiType:"geo",style:$o,items:yL.geo,value:r,onValueChange:n})}function EL(e){var t=e.styles,n=xL(),r=t.get(pa);return void 0===r?null:(0,La.jsx)(mL,{id:"spline",label:"style-panel.spline",uiType:"spline",style:pa,items:yL.spline,value:r,onValueChange:n})}function CL(e){var t=e.styles,n=xL(),r=t.get(vo),i=t.get(ho);return r&&i?(0,La.jsx)(gL,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:ho,itemsA:yL.arrowheadStart,valueA:i,uiTypeB:"arrowheadEnd",styleB:vo,itemsB:yL.arrowheadEnd,valueB:r,onValueChange:n,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"}):null}function IL(e){var t,n,r=e.toast,i=MI().removeToast,o=Lx(),a=r.actions&&r.actions.length>0;return(0,La.jsxs)(zC,{onOpenChange:function(e){e||i(r.id)},className:"tlui-toast__container",duration:r.keepOpen?1/0:5e3,children:[r.icon&&(0,La.jsx)("div",{className:"tlui-toast__icon",children:(0,La.jsx)(Nx,{icon:r.icon})}),(0,La.jsxs)("div",{className:"tlui-toast__main",children:[(0,La.jsxs)("div",{className:"tlui-toast__content",children:[(0,La.jsx)(DC,{className:"tlui-toast__title",children:r.title}),(0,La.jsx)(NC,{className:"tlui-toast__description",children:r.description})]}),r.actions&&(0,La.jsxs)("div",{className:"tlui-toast__actions",children:[r.actions.map((function(e,t){return(0,La.jsx)(RC,{altText:e.label,asChild:!0,onClick:e.onClick,children:(0,La.jsx)(Wx,{className:"warn"===e.type?"tlui-button__warning":"tlui-button__primary",children:e.label})},t)})),a&&(0,La.jsx)(BC,{asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-toast__close",style:{marginLeft:"auto"},children:null!==(t=r.closeLabel)&&void 0!==t?t:o("toast.close")})})]})]}),!a&&(0,La.jsx)(BC,{asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-toast__close",children:null!==(n=r.closeLabel)&&void 0!==n?n:o("toast.close")})})]})}var TL=t.memo((function(){var e=MI().toasts;return(0,La.jsx)(La.Fragment,{children:e.map((function(e){return(0,La.jsx)(IL,{toast:e},e.id)}))})}));function ML(){var e=MI().toasts,n=l(t.useState(!1),2),r=n[0],i=n[1];return t.useEffect((function(){var t=!1;return e.length?i(!0):setTimeout((function(){t||i(!1)}),1e3),function(){t=!0}}),[e.length,i]),r?(0,La.jsx)(hC,{className:"tlui-toast__viewport"}):null}function jL(){var e=Ka(),n=Lx(),r=_e("current color",(function(){var t=e.sharedStyles.get(io);return t?"mixed"===t.type?null:Ji(e)[t.value].solid:"var(--color-muted-1)"}),[e]),i=_e("isHandOrEraserToolActive",(function(){return e.isInAny("hand","zoom","eraser","laser")}),[e]),o=(0,t.useCallback)((function(t){t||(e.isChangingStyle=!1)}),[e]);return(0,La.jsxs)(rO,{id:"style menu",onOpenChange:o,children:[(0,La.jsx)(iO,{disabled:i,children:(0,La.jsx)(Wx,{className:"tlui-toolbar__tools__button tlui-toolbar__styles__button","data-testid":"mobile.styles",style:{color:null!==r&&void 0!==r?r:"var(--color-text)"},title:n("style-panel.title"),children:(0,La.jsx)(Nx,{icon:r?"blob":"mixed"})})}),(0,La.jsx)(oO,{side:"top",align:"end",children:(0,La.jsx)(wL,{isMobile:!0})})]})}var AL=["select","hand","draw","eraser","text","zoom","laser","highlight"];function OL(e){var t=e.activeToolId,n=Ka(),r=oT(),i=Lx(),o=_e("is tool locked",(function(){return n.instanceState.isToolLocked}),[n]);return!t||AL.includes(t)?null:(0,La.jsx)(Wx,{title:i("action.toggle-tool-lock"),className:Fa("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":r<5}),icon:o?"lock":"unlock",onClick:function(){return n.updateInstanceState({isToolLocked:!o})},smallIcon:!0})}var LL=(0,t.memo)((function(){var e=Ka(),n=Lx(),r=oT(),i=t.useRef(void 0),o=yT(),a=function(){var e=t.useContext(IT);if(!e)throw new Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return e}(),s=a.find((function(e){return"laser"===e.toolItem.id})),u=_e("current tool id",(function(){return e.currentToolId}),[e]),l="hand"===u,c=_e("geo",(function(){return e.sharedStyles.getAsKnownValue($o)}),[e]),d=!o,f=!(o||l),p=function(e){return e.label?"".concat(n(e.label)," ").concat(e.kbd?Ux(e.kbd):""):""},h=a.find((function(e){return NL(e.toolItem,u,c)})),v=t.useMemo((function(){for(var e,t=[],n=[],o=Math.min(8,5+r),s=4;s<a.length;s++){var u=a[s];s<o?t.push(u):(u===h&&(e=u),n.push(u))}return e||(i.current||(i.current=n[0]),e=i.current,n.includes(e)||(e=n[0])),i.current=e,n.length<=2&&(t.push.apply(t,n),n.length=0),{itemsInPanel:t,itemsInDropdown:n,dropdownFirstItem:e}}),[a,h,r]),g=v.itemsInPanel,m=v.itemsInDropdown,y=v.dropdownFirstItem;return(0,La.jsx)("div",{className:"tlui-toolbar",children:(0,La.jsxs)("div",{className:"tlui-toolbar__inner",children:[(0,La.jsxs)("div",{className:"tlui-toolbar__left",children:[!o&&(0,La.jsxs)("div",{className:Fa("tlui-toolbar__extras",{"tlui-toolbar__extras__hidden":!f}),children:[r<6&&(0,La.jsxs)("div",{className:"tlui-toolbar__extras__controls",children:[(0,La.jsx)(gO,{}),(0,La.jsx)(hO,{}),(0,La.jsx)(vO,{}),(0,La.jsx)(sO,{}),(0,La.jsx)(aO,{})]}),(0,La.jsx)(OL,{activeToolId:u})]}),(0,La.jsxs)("div",{className:Fa("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<5}),children:[a.slice(0,2).map((function(e){var t=e.toolItem;return(0,La.jsx)(DL,{item:t,title:p(t),isSelected:NL(t,u,c)},t.id)})),o&&s&&(0,La.jsx)(DL,{item:s.toolItem,title:p(s.toolItem),isSelected:NL(s.toolItem,u,c)},s.toolItem.id),d&&(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)("div",{className:"tlui-toolbar__divider"}),a.slice(2,4).map((function(e){var t=e.toolItem;return(0,La.jsx)(DL,{item:t,title:p(t),isSelected:NL(t,u,c)},t.id)})),(0,La.jsx)("div",{className:"tlui-toolbar__divider"}),g.map((function(e){var t=e.toolItem;return(0,La.jsx)(DL,{item:t,title:p(t),isSelected:NL(t,u,c)},t.id)})),m.length?(0,La.jsxs)(La.Fragment,{children:[(0,La.jsx)(DL,{item:y.toolItem,title:p(y.toolItem),isSelected:NL(y.toolItem,u,c)},y.toolItem.id),(0,La.jsxs)(OE,{id:"toolbar overflow",modal:!1,children:[(0,La.jsx)(LE,{children:(0,La.jsx)(Wx,{className:"tlui-toolbar__tools__button tlui-toolbar__overflow",icon:"chevron-up","data-testid":"tools.more",title:n("tool-panel.more")})}),(0,La.jsx)(zE,{side:"top",align:"center",children:(0,La.jsx)(zL,{toolbarItems:m})})]})]}):null]})]})]}),r<5&&!o&&(0,La.jsx)("div",{className:"tlui-toolbar__tools",children:(0,La.jsx)(jL,{})})]})})})),zL=ke((function(e){var t=e.toolbarItems,n=Lx();return(0,La.jsx)("div",{className:"tlui-button-grid__four tlui-button-grid__reverse",children:t.map((function(e){var t,r=e.toolItem,i=r.id,o=r.meta,a=r.kbd,s=r.label,u=r.onSelect,l=r.icon;return(0,La.jsx)(FE,{className:"tlui-button-grid__button","data-testid":"tools.".concat(i),"data-tool":i,"data-geo":null!==(t=null===o||void 0===o?void 0:o.geo)&&void 0!==t?t:"","aria-label":s,onClick:function(){return u("toolbar")},title:s?"".concat(n(s)," ").concat(a?Ux(a):""):"",icon:l},i)}))})}));function DL(e){var t,n,r=e.item,i=e.title,o=e.isSelected;return(0,La.jsx)(Wx,{className:"tlui-toolbar__tools__button","data-testid":"tools.".concat(r.id),"data-tool":r.id,"data-geo":null!==(t=null===(n=r.meta)||void 0===n?void 0:n.geo)&&void 0!==t?t:"","aria-label":r.label,title:i,icon:r.icon,"data-state":o?"selected":void 0,onClick:function(){return r.onSelect("toolbar")},onTouchStart:function(e){ou(e),r.onSelect("toolbar")}})}var NL=function(e,t,n){var r,i;return null!==(r=e.meta)&&void 0!==r&&r.geo?"geo"===t&&n===(null===(i=e.meta)||void 0===i?void 0:i.geo):t===e.id};var RL="undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function BL(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),(function(){n(window.event)}))}function FL(e,t){for(var n=t.slice(0,t.length-1),r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function UL(e){"string"!==typeof e&&(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),n=t.lastIndexOf("");n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}for(var KL={backspace:8,"\u232b":8,tab:9,clear:12,enter:13,"\u21a9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21ea":20,",":188,".":190,"/":191,"`":192,"-":RL?173:189,"=":RL?61:187,";":RL?59:186,"'":222,"[":219,"]":221,"\\":220},VL={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},WL={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},HL={16:!1,18:!1,17:!1,91:!1},YL={},XL=1;XL<20;XL++)KL["f".concat(XL)]=111+XL;var qL=[],$L=!1,GL="all",QL=[],ZL=function(e){return KL[e.toLowerCase()]||VL[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function JL(e){GL=e||"all"}function ez(){return GL||"all"}var tz=function(e){var t=e.key,n=e.scope,r=e.method,i=e.splitKey,o=void 0===i?"+":i;UL(t).forEach((function(e){var t=e.split(o),i=t.length,a=t[i-1],s="*"===a?"*":ZL(a);if(YL[s]){n||(n=ez());var u=i>1?FL(VL,t):[];YL[s]=YL[s].filter((function(e){return!((!r||e.method===r)&&e.scope===n&&function(e,t){for(var n=e.length>=t.length?e:t,r=e.length>=t.length?t:e,i=!0,o=0;o<n.length;o++)-1===r.indexOf(n[o])&&(i=!1);return i}(e.mods,u))}))}}))};function nz(e,t,n,r){var i;if(t.element===r&&(t.scope===n||"all"===t.scope)){for(var o in i=t.mods.length>0,HL)Object.prototype.hasOwnProperty.call(HL,o)&&(!HL[o]&&t.mods.indexOf(+o)>-1||HL[o]&&-1===t.mods.indexOf(+o))&&(i=!1);(0!==t.mods.length||HL[16]||HL[18]||HL[17]||HL[91])&&!i&&"*"!==t.shortcut||!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function rz(e,t){var n=YL["*"],r=e.keyCode||e.which||e.charCode;if(iz.filter.call(this,e)){if(93!==r&&224!==r||(r=91),-1===qL.indexOf(r)&&229!==r&&qL.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(t){var n=WL[t];e[t]&&-1===qL.indexOf(n)?qL.push(n):!e[t]&&qL.indexOf(n)>-1?qL.splice(qL.indexOf(n),1):"metaKey"===t&&e[t]&&3===qL.length&&(e.ctrlKey||e.shiftKey||e.altKey||(qL=qL.slice(qL.indexOf(n))))})),r in HL){for(var i in HL[r]=!0,VL)VL[i]===r&&(iz[i]=!0);if(!n)return}for(var o in HL)Object.prototype.hasOwnProperty.call(HL,o)&&(HL[o]=e[WL[o]]);e.getModifierState&&(!e.altKey||e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===qL.indexOf(17)&&qL.push(17),-1===qL.indexOf(18)&&qL.push(18),HL[17]=!0,HL[18]=!0);var a=ez();if(n)for(var s=0;s<n.length;s++)n[s].scope===a&&("keydown"===e.type&&n[s].keydown||"keyup"===e.type&&n[s].keyup)&&nz(e,n[s],a,t);if(r in YL)for(var u=0;u<YL[r].length;u++)if(("keydown"===e.type&&YL[r][u].keydown||"keyup"===e.type&&YL[r][u].keyup)&&YL[r][u].key){for(var l=YL[r][u],c=l.splitKey,d=l.key.split(c),f=[],p=0;p<d.length;p++)f.push(ZL(d[p]));f.sort().join("")===qL.sort().join("")&&nz(e,l,a,t)}}}function iz(e,t,n){qL=[];var r=UL(e),i=[],o="all",a=document,s=0,u=!1,l=!0,c="+",d=!1;for(void 0===n&&"function"===typeof t&&(n=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(o=t.scope),t.element&&(a=t.element),t.keyup&&(u=t.keyup),void 0!==t.keydown&&(l=t.keydown),void 0!==t.capture&&(d=t.capture),"string"===typeof t.splitKey&&(c=t.splitKey)),"string"===typeof t&&(o=t);s<r.length;s++)i=[],(e=r[s].split(c)).length>1&&(i=FL(VL,e)),(e="*"===(e=e[e.length-1])?"*":ZL(e))in YL||(YL[e]=[]),YL[e].push({keyup:u,keydown:l,scope:o,mods:i,shortcut:r[s],method:n,key:r[s],splitKey:c,element:a});"undefined"!==typeof a&&!function(e){return QL.indexOf(e)>-1}(a)&&window&&(QL.push(a),BL(a,"keydown",(function(e){rz(e,a)}),d),$L||($L=!0,BL(window,"focus",(function(){qL=[]}),d)),BL(a,"keyup",(function(e){rz(e,a),function(e){var t=e.keyCode||e.which||e.charCode,n=qL.indexOf(t);if(n>=0&&qL.splice(n,1),e.key&&"meta"===e.key.toLowerCase()&&qL.splice(0,qL.length),93!==t&&224!==t||(t=91),t in HL)for(var r in HL[t]=!1,VL)VL[r]===t&&(iz[r]=!1)}(e)}),d))}var oz={getPressedKeyString:function(){return qL.map((function(e){return function(e){return Object.keys(KL).find((function(t){return KL[t]===e}))}(e)||function(e){return Object.keys(VL).find((function(t){return VL[t]===e}))}(e)||String.fromCharCode(e)}))},setScope:JL,getScope:ez,deleteScope:function(e,t){var n,r;for(var i in e||(e=ez()),YL)if(Object.prototype.hasOwnProperty.call(YL,i))for(n=YL[i],r=0;r<n.length;)n[r].scope===e?n.splice(r,1):r++;ez()===e&&JL(t||"all")},getPressedKeyCodes:function(){return qL.slice(0)},isPressed:function(e){return"string"===typeof e&&(e=ZL(e)),-1!==qL.indexOf(e)},filter:function(e){var t=e.target||e.srcElement,n=t.tagName,r=!0;return!t.isContentEditable&&("INPUT"!==n&&"TEXTAREA"!==n&&"SELECT"!==n||t.readOnly)||(r=!1),r},trigger:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(YL).forEach((function(n){YL[n].filter((function(n){return n.scope===t&&n.shortcut===e})).forEach((function(e){e&&e.method&&e.method()}))}))},unbind:function(e){if("undefined"===typeof e)Object.keys(YL).forEach((function(e){return delete YL[e]}));else if(Array.isArray(e))e.forEach((function(e){e.key&&tz(e)}));else if("object"===typeof e)e.key&&tz(e);else if("string"===typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0],o=n[1];"function"===typeof i&&(o=i,i=""),tz({key:e,scope:i,method:o,splitKey:"+"})}},keyMap:KL,modifier:VL,modifierMap:WL};for(var az in oz)Object.prototype.hasOwnProperty.call(oz,az)&&(iz[az]=oz[az]);if("undefined"!==typeof window){var sz=window.hotkeys;iz.noConflict=function(e){return e&&window.hotkeys===iz&&(window.hotkeys=sz),iz},window.hotkeys=iz}var uz=["copy","cut","paste","asset"];function lz(e){return function(e){"string"!==typeof e&&(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),n=t.lastIndexOf("");n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}(e).map((function(e){var t=e.split("");return 1===t.length?t[0]:"!"===t[0]?"shift+".concat(t[1]):"?"===t[0]?"alt+".concat(t[1]):"$"===t[0]?"!"===t[1]?"cmd+shift+".concat(t[2],",ctrl+shift+").concat(t[2]):"?"===t[1]?"cmd+\u2325+".concat(t[2],",ctrl+alt+").concat(t[2]):"cmd+".concat(t[1],",ctrl+").concat(t[1]):e})).join(",")}var cz=["shareZone","topZone","renderDebugMenuItems","children","hideUi"],dz=["children","hideUi"],fz=t.memo((function(e){var t=e.shareZone,n=e.topZone,r=e.renderDebugMenuItems,i=e.children,o=e.hideUi,a=gt(e,cz);return(0,La.jsx)(OT,Ce(Ce({},a),{},{children:(0,La.jsx)(pz,{hideUi:o,shareZone:t,topZone:n,renderDebugMenuItems:r,children:i})}))})),pz=t.memo((function(e){var t=e.children,n=e.hideUi,r=gt(e,dz);return(0,La.jsxs)(La.Fragment,{children:[t,n?null:(0,La.jsx)(hz,Ce({},r))]})})),hz=t.memo((function(e){var n=e.shareZone,r=e.topZone,i=e.renderDebugMenuItems,o=Ka(),a=Lx(),s=oT(),u=_e("isReadOnlyMode",(function(){return o.isReadOnly}),[o]),l=_e("focus",(function(){return o.instanceState.isFocusMode}),[o]),c=_e("debug",(function(){return o.instanceState.isDebugMode}),[o]);!function(){var e=Ka(),n=vI(),r=yT(),i=HI(),o=vT();(0,t.useEffect)((function(){if(n){for(var t=e.getContainer(),a=function(n,r){iz(n,{element:t,scope:e.store.id},r)},s=function(){return e.isMenuOpen||null!==e.editingId||e.crashingError},u=function(){var e=c[l];return e.kbd?r&&!e.readonlyOk||uz.includes(e.id)?"continue":void a(lz(e.kbd),(function(t){s()||(ou(t),e.onSelect("kbd"))})):"continue"},l=0,c=Object.values(i);l<c.length;l++)u();for(var d=function(){var t=p[f];return!t.kbd||!t.readonlyOk&&e.isReadOnly||uz.includes(t.id)?"continue":void a(lz(t.kbd),(function(e){s()||(ou(e),t.onSelect("kbd"))}))},f=0,p=Object.values(o);f<p.length;f++)d();return iz.setScope(e.store.id),function(){iz.deleteScope(e.store.id)}}}),[i,o,r,e,n])}(),function(){var e=Ka(),n=IE(),r=vI();(0,t.useEffect)((function(){if(r){var t=function(){0===e.selectedIds.length||null!==e.editingId||mI(e)||(CI(e),n("copy",{source:"kbd"}))},i=!1,o=function(e){1===e.button&&(i=!0,requestAnimationFrame((function(){i=!1})))},a=function(t){i?t.stopPropagation():null!==e.editingId||mI(e)||(t.clipboardData&&!e.inputs.shiftKey?SI(e,t.clipboardData):navigator.clipboard.read().then((function(t){Array.isArray(t)&&t[0]instanceof ClipboardItem&&_I(e,t,e.inputs.currentPagePoint)})),n("paste",{source:"kbd"}))};return document.addEventListener("copy",t),document.addEventListener("cut",s),document.addEventListener("paste",a),document.addEventListener("pointerup",o),function(){document.removeEventListener("copy",t),document.removeEventListener("cut",s),document.removeEventListener("paste",a),document.removeEventListener("pointerup",o)}}function s(){0===e.selectedIds.length||null!==e.editingId||mI(e)||(CI(e),e.deleteShapes(),n("cut",{source:"kbd"}))}}),[e,n,r])}(),function(){var e=Ka(),n=MI().addToast;(0,t.useEffect)((function(){function t(e){var t=e.name,r=e.count;n({title:"Maximum Shapes Reached",description:"You've reached the maximum number of shapes allowed on ".concat(t," (").concat(r,"). Please delete some shapes or move to a different page to continue.")})}return e.addListener("max-shapes",t),function(){e.removeListener("max-shapes",t)}}),[e,n])}();var d=HI()["toggle-focus-mode"];return(0,La.jsx)(lC,{children:(0,La.jsxs)("main",{className:Fa("tlui-layout",{"tlui-layout__mobile":s<5}),children:[l?(0,La.jsx)("div",{className:"tlui-layout__top",children:(0,La.jsx)(Wx,{className:"tlui-focus-button",title:"".concat(a("focus-mode.toggle-focus-mode")),icon:"dot",onClick:function(){return d.onSelect("menu")}})}):(0,La.jsxs)(La.Fragment,{children:[(0,La.jsxs)("div",{className:"tlui-layout__top",children:[(0,La.jsxs)("div",{className:"tlui-layout__top__left",children:[(0,La.jsx)(mO,{}),(0,La.jsxs)("div",{className:"tlui-helper-buttons",children:[(0,La.jsx)(SO,{}),(0,La.jsx)(zT,{}),(0,La.jsx)(_O,{})]})]}),(0,La.jsx)("div",{className:"tlui-layout__top__center",children:r}),(0,La.jsxs)("div",{className:"tlui-layout__top__right",children:[n,s>=5&&!u&&(0,La.jsx)("div",{className:"tlui-style-panel__wrapper",children:(0,La.jsx)(wL,{})})]})]}),(0,La.jsxs)("div",{className:"tlui-layout__bottom",children:[(0,La.jsxs)("div",{className:"tlui-layout__bottom__main",children:[(0,La.jsx)(kO,{}),(0,La.jsx)(LL,{}),s>=4&&(0,La.jsx)(GT,{})]}),c&&(0,La.jsx)(NT,{renderDebugMenuItems:null!==i&&void 0!==i?i:null})]})]}),(0,La.jsx)(TL,{}),(0,La.jsx)(YT,{}),(0,La.jsx)(ML,{}),(0,La.jsx)(XT,{})]})})})),vz=["__scopeContextMenu","disabled"],gz=["__scopeContextMenu"],mz=["__scopeContextMenu"],yz=["__scopeContextMenu"],bz=["__scopeContextMenu"],wz=["__scopeContextMenu"],xz=["__scopeContextMenu"],kz=["__scopeContextMenu"],Sz="ContextMenu",_z=l(eb(Sz,[O_]),2),Pz=_z[0],Ez=(_z[1],O_()),Cz=l(Pz(Sz),2),Iz=Cz[0],Tz=Cz[1],Mz=function(e){var n=e.__scopeContextMenu,r=e.children,i=e.onOpenChange,o=e.dir,a=e.modal,s=void 0===a||a,u=l((0,t.useState)(!1),2),c=u[0],d=u[1],f=Ez(n),p=ab(i),h=(0,t.useCallback)((function(e){d(e),p(e)}),[p]);return(0,t.createElement)(Iz,{scope:n,open:c,onOpenChange:h,modal:s},(0,t.createElement)(TP,qy({},f,{dir:o,open:c,onOpenChange:h,modal:s}),r))},jz="ContextMenuTrigger",Az=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=e.disabled,o=void 0!==i&&i,a=gt(e,vz),s=Tz(jz,r),u=Ez(r),l=(0,t.useRef)({x:0,y:0}),c=(0,t.useRef)({getBoundingClientRect:function(){return DOMRect.fromRect(Ce({width:0,height:0},l.current))}}),d=(0,t.useRef)(0),f=(0,t.useCallback)((function(){return window.clearTimeout(d.current)}),[]),p=function(e){l.current={x:e.clientX,y:e.clientY},s.onOpenChange(!0)};return(0,t.useEffect)((function(){return f}),[f]),(0,t.useEffect)((function(){o&&f()}),[o,f]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(MP,qy({},u,{virtualRef:c})),(0,t.createElement)(gb.span,qy({"data-state":s.open?"open":"closed","data-disabled":o?"":void 0},a,{ref:n,style:Ce({WebkitTouchCallout:"none"},e.style),onContextMenu:o?e.onContextMenu:$y(e.onContextMenu,(function(e){f(),p(e),e.preventDefault()})),onPointerDown:o?e.onPointerDown:$y(e.onPointerDown,Kz((function(e){f(),d.current=window.setTimeout((function(){return p(e)}),700)}))),onPointerMove:o?e.onPointerMove:$y(e.onPointerMove,Kz(f)),onPointerCancel:o?e.onPointerCancel:$y(e.onPointerCancel,Kz(f)),onPointerUp:o?e.onPointerUp:$y(e.onPointerUp,Kz(f))})))})),Oz=function(e){var n=e.__scopeContextMenu,r=gt(e,gz),i=Ez(n);return(0,t.createElement)(jP,qy({},i,r))},Lz="ContextMenuContent",zz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,mz),o=Tz(Lz,r),a=Ez(r),s=(0,t.useRef)(!1);return(0,t.createElement)(AP,qy({},a,i,{ref:n,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:function(t){var n;null===(n=e.onCloseAutoFocus)||void 0===n||n.call(e,t),!t.defaultPrevented&&s.current&&t.preventDefault(),s.current=!1},onInteractOutside:function(t){var n;null===(n=e.onInteractOutside)||void 0===n||n.call(e,t),t.defaultPrevented||o.modal||(s.current=!0)},style:Ce(Ce({},e.style),{},{"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))})),Dz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,yz),o=Ez(r);return(0,t.createElement)(OP,qy({},o,i,{ref:n}))})),Nz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,bz),o=Ez(r);return(0,t.createElement)(LP,qy({},o,i,{ref:n}))})),Rz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,wz),o=Ez(r);return(0,t.createElement)(zP,qy({},o,i,{ref:n}))})),Bz=function(e){var n=e.__scopeContextMenu,r=e.children,i=e.onOpenChange,o=e.open,a=e.defaultOpen,s=Ez(n),u=l(sb({prop:o,defaultProp:a,onChange:i}),2),c=u[0],d=u[1];return(0,t.createElement)(NP,qy({},s,{open:c,onOpenChange:d}),r)},Fz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,xz),o=Ez(r);return(0,t.createElement)(RP,qy({},o,i,{ref:n}))})),Uz=(0,t.forwardRef)((function(e,n){var r=e.__scopeContextMenu,i=gt(e,kz),o=Ez(r);return(0,t.createElement)(BP,qy({},o,i,{ref:n,style:Ce(Ce({},e.style),{},{"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"})}))}));function Kz(e){return function(t){return"mouse"!==t.pointerType?e(t):void 0}}var Vz=Mz,Wz=Az,Hz=Oz,Yz=zz,Xz=Dz,qz=Nz,$z=Rz,Gz=Bz,Qz=Fz,Zz=Uz,Jz=ke((function(){var e=Ka(),t=wu(),n=e.pages,r=e.currentPageId,i=Lx(),o=MI().addToast;return(0,La.jsxs)(Gz,{children:[(0,La.jsx)(Qz,{dir:"ltr",asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),(0,La.jsx)(Hz,{container:t,dir:"ltr",children:(0,La.jsxs)(Zz,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[(0,La.jsx)(Xz,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:n.map((function(t){return(0,La.jsx)(qz,{disabled:r===t.id,onSelect:function(){e.mark("move_shapes_to_page"),e.moveShapesToPage(e.selectedIds,t.id);var n=e.getPageById(t.id);n&&o({title:"Changed Page",description:"Moved to ".concat(n.name,"."),actions:[{label:"Go Back",type:"primary",onClick:function(){e.mark("change-page"),e.setCurrentPageId(r)}}]})},asChild:!0,children:(0,La.jsx)(Wx,{title:t.name,className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:(0,La.jsx)("span",{children:t.name})})},t.id)}))},"pages"),(0,La.jsx)(Xz,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:(0,La.jsx)(qz,{onSelect:function(){e.mark("move_shapes_to_page");var t=Dn.createId(),n=e.selectedIds,r=e.currentPageId;e.batch((function(){e.createPage("Page 1",t),e.setCurrentPageId(r),e.moveShapesToPage(n,t)}))},asChild:!0,children:(0,La.jsx)(Wx,{title:i("context.pages.new-page"),className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:i("context.pages.new-page")})},"new-page")},"new-page")]})})]})})),eD=function(e){var n=e.children,r=Ka(),i=fT(),o=(0,t.useCallback)((function(e){if(e){if(r.isCoarsePointer){var t=r.selectedShapes,n=r.inputs.currentPagePoint,i=r.getShapesAtPoint(n);if(!r.selectedShapes.length||!i.some((function(e){return t.includes(e)}))){var o=i.filter((function(e){return r.isShapeOrAncestorLocked(e)}));o.length&&r.select.apply(r,d(o.map((function(e){return e.id}))))}}}else{var a=r.onlySelectedShape;a&&r.isShapeOrAncestorLocked(a)&&r.setSelectedIds([])}}),[r]),a=l(TE("context menu",o),2),s=(a[0],a[1]),u=yT(),c=0===i.length||u&&i.every((function(e){return!e.readonlyOk})),f=!_e("isSelectToolActive",(function(){return"select"===r.currentToolId}),[r])||c;return(0,La.jsxs)(Vz,{dir:"ltr",onOpenChange:s,children:[(0,La.jsx)(Wz,{onContextMenu:f?ou:void 0,dir:"ltr",disabled:f,children:n}),(0,La.jsx)(tD,{})]})};function tD(){var e=Ka(),n=Lx(),r=fT(),i=l(TE("context menu sub"),2),o=(i[0],i[1]),a=yT(),s=oT(),u=wu(),c=l((0,t.useState)(!1),2),d=c[0],f=c[1];function p(e,t,r,i){if(a&&!t.readonlyOk)return null;switch(t.type){case"custom":if("MOVE_TO_PAGE_MENU"===t.id)return(0,La.jsx)(Jz,{},t.id);break;case"group":return(0,La.jsx)(Xz,{dir:"ltr",className:Fa("tlui-menu__group",{"tlui-menu__group__small":"submenu"===(null===r||void 0===r?void 0:r.type)}),"data-testid":"menu-item.".concat(t.id),children:t.children.map((function(n){return p(e,n,t,i+1)}))},t.id);case"submenu":return(0,La.jsxs)(Gz,{onOpenChange:o,children:[(0,La.jsx)(Qz,{dir:"ltr",disabled:t.disabled,asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button",label:t.label,"data-testid":"menu-item.".concat(t.id),icon:"chevron-right"})}),(0,La.jsx)(Hz,{container:u,dir:"ltr",children:(0,La.jsx)(Zz,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:t.children.map((function(n){return p(e,n,t,i+1)}))})})]},t.id);case"item":if(a&&!t.readonlyOk)return null;var l=t.actionItem,c=l.id,h=l.checkbox,v=l.contextMenuLabel,g=l.label,m=l.onSelect,y=l.kbd,b=l.icon,w=null!==v&&void 0!==v?v:g,x=w?n(w):void 0;return h?(0,La.jsxs)($z,{className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",dir:"ltr",disabled:t.disabled,onSelect:function(e){m("context-menu"),ou(e)},title:x||void 0,checked:t.checked,children:[(0,La.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:"scale(".concat(t.checked?1:.5,")"),opacity:t.checked?1:.5},children:(0,La.jsx)(Nx,{small:!0,icon:t.checked?"check":"checkbox-empty"})}),x&&(0,La.jsx)("span",{children:x}),y&&(0,La.jsx)(Kx,{children:y})]},c):(0,La.jsx)(qz,{dir:"ltr",asChild:!0,children:(0,La.jsx)(Wx,{className:"tlui-menu__button","data-testid":"menu-item.".concat(c),kbd:y,label:w,disabled:t.disabled,iconLeft:s<3&&i>2?b:void 0,onClick:function(){d?f(!1):m("context-menu")}})},c)}}return(0,La.jsx)(Hz,{dir:"ltr",container:u,children:(0,La.jsx)(Yz,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:ou,children:r.map((function(t){return p(e,t,null,0)}))})})}var nD=["children"];function rD(e){var n=e.children,r=gt(e,nD),i=Ce(Ce({},r),{},{shapes:(0,t.useMemo)((function(){var e;return[].concat(d(iv),d(null!==(e=r.shapes)&&void 0!==e?e:[]))}),[r.shapes]),tools:(0,t.useMemo)((function(){var e;return[].concat(d(yy),d(null!==(e=r.tools)&&void 0!==e?e:[]))}),[r.tools])});return(0,La.jsx)(Jm,Ce(Ce({},i),{},{children:(0,La.jsxs)(fz,Ce(Ce({},i),{},{children:[(0,La.jsx)(eD,{children:(0,La.jsx)(Ld,{})}),n]}))}))}var iD=document.title;function oD(){var e=l((0,t.useState)((function(){return Um({shapes:iv})})),1)[0],n=(Ka(),window.matchMedia("(prefers-color-scheme: dark)").matches,l((0,t.useState)({status:"loading"}),2)),r=n[0],i=n[1];return(0,t.useLayoutEffect)((function(){i({status:"loading"});var t=localStorage.getItem(iD);if(t)try{var n=JSON.parse(t);e.loadSnapshot(n),i({status:"ready"})}catch(o){i({status:"error",error:o.message})}else i({status:"ready"});var r=e.listen(function(e,t){var n,r;return function(){return n||(n=!0,setTimeout((function(){return n=!1}),t),r=e.apply(void 0,arguments)),r}}((function(){var t=e.getSnapshot();localStorage.setItem(iD,JSON.stringify(t))}),500));return function(){r()}}),[e]),"loading"===r.status?(0,La.jsx)("div",{className:"tldraw__editor",children:(0,La.jsx)("h2",{children:"Loading..."})}):"error"===r.status?(0,La.jsxs)("div",{className:"tldraw__editor",children:[(0,La.jsx)("h2",{children:"Error!"}),(0,La.jsx)("p",{children:r.error})]}):(0,La.jsx)("div",{className:"tldraw__editor",children:(0,La.jsx)(rD,{onMount:function(e){window.addEventListener("onUpdateDarkMode",(function(t){e.setDarkMode(!e.isDarkMode),console.log("dark mode updated")})),window.addEventListener("setLightMode",(function(t){e.setDarkMode(!1)}))},store:e,autoFocus:!0})})}var aD=function(){return(0,La.jsx)("div",{className:"tldraw__editor",children:(0,La.jsx)(oD,{})})},sD=function(e){e&&e instanceof Function&&n.e(27).then(n.bind(n,4027)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),r(e),i(e),o(e),a(e)}))};i.createRoot(document.getElementById("root")).render((0,La.jsx)(t.StrictMode,{children:(0,La.jsx)(aD,{})})),sD()}()}();